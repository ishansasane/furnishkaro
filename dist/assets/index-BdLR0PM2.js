var Vk=Object.defineProperty;var qk=(e,t,r)=>t in e?Vk(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var zw=(e,t,r)=>qk(e,typeof t!="symbol"?t+"":t,r);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&a(o)}).observe(document,{childList:!0,subtree:!0});function r(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(n){if(n.ep)return;n.ep=!0;const s=r(n);fetch(n.href,s)}})();var I$=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function CS(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var pg={exports:{}},od={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Hw;function Gk(){if(Hw)return od;Hw=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function r(a,n,s){var o=null;if(s!==void 0&&(o=""+s),n.key!==void 0&&(o=""+n.key),"key"in n){s={};for(var c in n)c!=="key"&&(s[c]=n[c])}else s=n;return n=s.ref,{$$typeof:e,type:a,key:o,ref:n!==void 0?n:null,props:s}}return od.Fragment=t,od.jsx=r,od.jsxs=r,od}var Vw;function Wk(){return Vw||(Vw=1,pg.exports=Gk()),pg.exports}var f=Wk(),mg={exports:{}},Dr={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qw;function $k(){if(qw)return Dr;qw=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),n=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),o=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),x=Symbol.iterator;function v(G){return G===null||typeof G!="object"?null:(G=x&&G[x]||G["@@iterator"],typeof G=="function"?G:null)}var g={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,b={};function N(G,ye,D){this.props=G,this.context=ye,this.refs=b,this.updater=D||g}N.prototype.isReactComponent={},N.prototype.setState=function(G,ye){if(typeof G!="object"&&typeof G!="function"&&G!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,G,ye,"setState")},N.prototype.forceUpdate=function(G){this.updater.enqueueForceUpdate(this,G,"forceUpdate")};function _(){}_.prototype=N.prototype;function E(G,ye,D){this.props=G,this.context=ye,this.refs=b,this.updater=D||g}var j=E.prototype=new _;j.constructor=E,w(j,N.prototype),j.isPureReactComponent=!0;var M=Array.isArray,U={H:null,A:null,T:null,S:null},V=Object.prototype.hasOwnProperty;function I(G,ye,D,O,L,q){return D=q.ref,{$$typeof:e,type:G,key:ye,ref:D!==void 0?D:null,props:q}}function z(G,ye){return I(G.type,ye,void 0,void 0,void 0,G.props)}function H(G){return typeof G=="object"&&G!==null&&G.$$typeof===e}function re(G){var ye={"=":"=0",":":"=2"};return"$"+G.replace(/[=:]/g,function(D){return ye[D]})}var R=/\/+/g;function F(G,ye){return typeof G=="object"&&G!==null&&G.key!=null?re(""+G.key):ye.toString(36)}function Y(){}function K(G){switch(G.status){case"fulfilled":return G.value;case"rejected":throw G.reason;default:switch(typeof G.status=="string"?G.then(Y,Y):(G.status="pending",G.then(function(ye){G.status==="pending"&&(G.status="fulfilled",G.value=ye)},function(ye){G.status==="pending"&&(G.status="rejected",G.reason=ye)})),G.status){case"fulfilled":return G.value;case"rejected":throw G.reason}}throw G}function X(G,ye,D,O,L){var q=typeof G;(q==="undefined"||q==="boolean")&&(G=null);var oe=!1;if(G===null)oe=!0;else switch(q){case"bigint":case"string":case"number":oe=!0;break;case"object":switch(G.$$typeof){case e:case t:oe=!0;break;case p:return oe=G._init,X(oe(G._payload),ye,D,O,L)}}if(oe)return L=L(G),oe=O===""?"."+F(G,0):O,M(L)?(D="",oe!=null&&(D=oe.replace(R,"$&/")+"/"),X(L,ye,D,"",function(ue){return ue})):L!=null&&(H(L)&&(L=z(L,D+(L.key==null||G&&G.key===L.key?"":(""+L.key).replace(R,"$&/")+"/")+oe)),ye.push(L)),1;oe=0;var be=O===""?".":O+":";if(M(G))for(var ve=0;ve<G.length;ve++)O=G[ve],q=be+F(O,ve),oe+=X(O,ye,D,q,L);else if(ve=v(G),typeof ve=="function")for(G=ve.call(G),ve=0;!(O=G.next()).done;)O=O.value,q=be+F(O,ve++),oe+=X(O,ye,D,q,L);else if(q==="object"){if(typeof G.then=="function")return X(K(G),ye,D,O,L);throw ye=String(G),Error("Objects are not valid as a React child (found: "+(ye==="[object Object]"?"object with keys {"+Object.keys(G).join(", ")+"}":ye)+"). If you meant to render a collection of children, use an array instead.")}return oe}function Z(G,ye,D){if(G==null)return G;var O=[],L=0;return X(G,O,"","",function(q){return ye.call(D,q,L++)}),O}function ce(G){if(G._status===-1){var ye=G._result;ye=ye(),ye.then(function(D){(G._status===0||G._status===-1)&&(G._status=1,G._result=D)},function(D){(G._status===0||G._status===-1)&&(G._status=2,G._result=D)}),G._status===-1&&(G._status=0,G._result=ye)}if(G._status===1)return G._result.default;throw G._result}var te=typeof reportError=="function"?reportError:function(G){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ye=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof G=="object"&&G!==null&&typeof G.message=="string"?String(G.message):String(G),error:G});if(!window.dispatchEvent(ye))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",G);return}console.error(G)};function Q(){}return Dr.Children={map:Z,forEach:function(G,ye,D){Z(G,function(){ye.apply(this,arguments)},D)},count:function(G){var ye=0;return Z(G,function(){ye++}),ye},toArray:function(G){return Z(G,function(ye){return ye})||[]},only:function(G){if(!H(G))throw Error("React.Children.only expected to receive a single React element child.");return G}},Dr.Component=N,Dr.Fragment=r,Dr.Profiler=n,Dr.PureComponent=E,Dr.StrictMode=a,Dr.Suspense=u,Dr.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=U,Dr.act=function(){throw Error("act(...) is not supported in production builds of React.")},Dr.cache=function(G){return function(){return G.apply(null,arguments)}},Dr.cloneElement=function(G,ye,D){if(G==null)throw Error("The argument must be a React element, but you passed "+G+".");var O=w({},G.props),L=G.key,q=void 0;if(ye!=null)for(oe in ye.ref!==void 0&&(q=void 0),ye.key!==void 0&&(L=""+ye.key),ye)!V.call(ye,oe)||oe==="key"||oe==="__self"||oe==="__source"||oe==="ref"&&ye.ref===void 0||(O[oe]=ye[oe]);var oe=arguments.length-2;if(oe===1)O.children=D;else if(1<oe){for(var be=Array(oe),ve=0;ve<oe;ve++)be[ve]=arguments[ve+2];O.children=be}return I(G.type,L,void 0,void 0,q,O)},Dr.createContext=function(G){return G={$$typeof:o,_currentValue:G,_currentValue2:G,_threadCount:0,Provider:null,Consumer:null},G.Provider=G,G.Consumer={$$typeof:s,_context:G},G},Dr.createElement=function(G,ye,D){var O,L={},q=null;if(ye!=null)for(O in ye.key!==void 0&&(q=""+ye.key),ye)V.call(ye,O)&&O!=="key"&&O!=="__self"&&O!=="__source"&&(L[O]=ye[O]);var oe=arguments.length-2;if(oe===1)L.children=D;else if(1<oe){for(var be=Array(oe),ve=0;ve<oe;ve++)be[ve]=arguments[ve+2];L.children=be}if(G&&G.defaultProps)for(O in oe=G.defaultProps,oe)L[O]===void 0&&(L[O]=oe[O]);return I(G,q,void 0,void 0,null,L)},Dr.createRef=function(){return{current:null}},Dr.forwardRef=function(G){return{$$typeof:c,render:G}},Dr.isValidElement=H,Dr.lazy=function(G){return{$$typeof:p,_payload:{_status:-1,_result:G},_init:ce}},Dr.memo=function(G,ye){return{$$typeof:h,type:G,compare:ye===void 0?null:ye}},Dr.startTransition=function(G){var ye=U.T,D={};U.T=D;try{var O=G(),L=U.S;L!==null&&L(D,O),typeof O=="object"&&O!==null&&typeof O.then=="function"&&O.then(Q,te)}catch(q){te(q)}finally{U.T=ye}},Dr.unstable_useCacheRefresh=function(){return U.H.useCacheRefresh()},Dr.use=function(G){return U.H.use(G)},Dr.useActionState=function(G,ye,D){return U.H.useActionState(G,ye,D)},Dr.useCallback=function(G,ye){return U.H.useCallback(G,ye)},Dr.useContext=function(G){return U.H.useContext(G)},Dr.useDebugValue=function(){},Dr.useDeferredValue=function(G,ye){return U.H.useDeferredValue(G,ye)},Dr.useEffect=function(G,ye){return U.H.useEffect(G,ye)},Dr.useId=function(){return U.H.useId()},Dr.useImperativeHandle=function(G,ye,D){return U.H.useImperativeHandle(G,ye,D)},Dr.useInsertionEffect=function(G,ye){return U.H.useInsertionEffect(G,ye)},Dr.useLayoutEffect=function(G,ye){return U.H.useLayoutEffect(G,ye)},Dr.useMemo=function(G,ye){return U.H.useMemo(G,ye)},Dr.useOptimistic=function(G,ye){return U.H.useOptimistic(G,ye)},Dr.useReducer=function(G,ye,D){return U.H.useReducer(G,ye,D)},Dr.useRef=function(G){return U.H.useRef(G)},Dr.useState=function(G){return U.H.useState(G)},Dr.useSyncExternalStore=function(G,ye,D){return U.H.useSyncExternalStore(G,ye,D)},Dr.useTransition=function(){return U.H.useTransition()},Dr.version="19.0.0",Dr}var Gw;function P1(){return Gw||(Gw=1,mg.exports=$k()),mg.exports}var P=P1();const Pu=CS(P);var xg={exports:{}},ld={},gg={exports:{}},vg={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ww;function Xk(){return Ww||(Ww=1,function(e){function t(Z,ce){var te=Z.length;Z.push(ce);e:for(;0<te;){var Q=te-1>>>1,G=Z[Q];if(0<n(G,ce))Z[Q]=ce,Z[te]=G,te=Q;else break e}}function r(Z){return Z.length===0?null:Z[0]}function a(Z){if(Z.length===0)return null;var ce=Z[0],te=Z.pop();if(te!==ce){Z[0]=te;e:for(var Q=0,G=Z.length,ye=G>>>1;Q<ye;){var D=2*(Q+1)-1,O=Z[D],L=D+1,q=Z[L];if(0>n(O,te))L<G&&0>n(q,O)?(Z[Q]=q,Z[L]=te,Q=L):(Z[Q]=O,Z[D]=te,Q=D);else if(L<G&&0>n(q,te))Z[Q]=q,Z[L]=te,Q=L;else break e}}return ce}function n(Z,ce){var te=Z.sortIndex-ce.sortIndex;return te!==0?te:Z.id-ce.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var o=Date,c=o.now();e.unstable_now=function(){return o.now()-c}}var u=[],h=[],p=1,x=null,v=3,g=!1,w=!1,b=!1,N=typeof setTimeout=="function"?setTimeout:null,_=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;function j(Z){for(var ce=r(h);ce!==null;){if(ce.callback===null)a(h);else if(ce.startTime<=Z)a(h),ce.sortIndex=ce.expirationTime,t(u,ce);else break;ce=r(h)}}function M(Z){if(b=!1,j(Z),!w)if(r(u)!==null)w=!0,K();else{var ce=r(h);ce!==null&&X(M,ce.startTime-Z)}}var U=!1,V=-1,I=5,z=-1;function H(){return!(e.unstable_now()-z<I)}function re(){if(U){var Z=e.unstable_now();z=Z;var ce=!0;try{e:{w=!1,b&&(b=!1,_(V),V=-1),g=!0;var te=v;try{t:{for(j(Z),x=r(u);x!==null&&!(x.expirationTime>Z&&H());){var Q=x.callback;if(typeof Q=="function"){x.callback=null,v=x.priorityLevel;var G=Q(x.expirationTime<=Z);if(Z=e.unstable_now(),typeof G=="function"){x.callback=G,j(Z),ce=!0;break t}x===r(u)&&a(u),j(Z)}else a(u);x=r(u)}if(x!==null)ce=!0;else{var ye=r(h);ye!==null&&X(M,ye.startTime-Z),ce=!1}}break e}finally{x=null,v=te,g=!1}ce=void 0}}finally{ce?R():U=!1}}}var R;if(typeof E=="function")R=function(){E(re)};else if(typeof MessageChannel<"u"){var F=new MessageChannel,Y=F.port2;F.port1.onmessage=re,R=function(){Y.postMessage(null)}}else R=function(){N(re,0)};function K(){U||(U=!0,R())}function X(Z,ce){V=N(function(){Z(e.unstable_now())},ce)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Z){Z.callback=null},e.unstable_continueExecution=function(){w||g||(w=!0,K())},e.unstable_forceFrameRate=function(Z){0>Z||125<Z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<Z?Math.floor(1e3/Z):5},e.unstable_getCurrentPriorityLevel=function(){return v},e.unstable_getFirstCallbackNode=function(){return r(u)},e.unstable_next=function(Z){switch(v){case 1:case 2:case 3:var ce=3;break;default:ce=v}var te=v;v=ce;try{return Z()}finally{v=te}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Z,ce){switch(Z){case 1:case 2:case 3:case 4:case 5:break;default:Z=3}var te=v;v=Z;try{return ce()}finally{v=te}},e.unstable_scheduleCallback=function(Z,ce,te){var Q=e.unstable_now();switch(typeof te=="object"&&te!==null?(te=te.delay,te=typeof te=="number"&&0<te?Q+te:Q):te=Q,Z){case 1:var G=-1;break;case 2:G=250;break;case 5:G=1073741823;break;case 4:G=1e4;break;default:G=5e3}return G=te+G,Z={id:p++,callback:ce,priorityLevel:Z,startTime:te,expirationTime:G,sortIndex:-1},te>Q?(Z.sortIndex=te,t(h,Z),r(u)===null&&Z===r(h)&&(b?(_(V),V=-1):b=!0,X(M,te-Q))):(Z.sortIndex=G,t(u,Z),w||g||(w=!0,K())),Z},e.unstable_shouldYield=H,e.unstable_wrapCallback=function(Z){var ce=v;return function(){var te=v;v=ce;try{return Z.apply(this,arguments)}finally{v=te}}}}(vg)),vg}var $w;function Yk(){return $w||($w=1,gg.exports=Xk()),gg.exports}var yg={exports:{}},Is={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xw;function Jk(){if(Xw)return Is;Xw=1;var e=P1();function t(u){var h="https://react.dev/errors/"+u;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)h+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+u+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var a={d:{f:r,r:function(){throw Error(t(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},n=Symbol.for("react.portal");function s(u,h,p){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:n,key:x==null?null:""+x,children:u,containerInfo:h,implementation:p}}var o=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(u,h){if(u==="font")return"";if(typeof h=="string")return h==="use-credentials"?h:""}return Is.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=a,Is.createPortal=function(u,h){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11)throw Error(t(299));return s(u,h,null,p)},Is.flushSync=function(u){var h=o.T,p=a.p;try{if(o.T=null,a.p=2,u)return u()}finally{o.T=h,a.p=p,a.d.f()}},Is.preconnect=function(u,h){typeof u=="string"&&(h?(h=h.crossOrigin,h=typeof h=="string"?h==="use-credentials"?h:"":void 0):h=null,a.d.C(u,h))},Is.prefetchDNS=function(u){typeof u=="string"&&a.d.D(u)},Is.preinit=function(u,h){if(typeof u=="string"&&h&&typeof h.as=="string"){var p=h.as,x=c(p,h.crossOrigin),v=typeof h.integrity=="string"?h.integrity:void 0,g=typeof h.fetchPriority=="string"?h.fetchPriority:void 0;p==="style"?a.d.S(u,typeof h.precedence=="string"?h.precedence:void 0,{crossOrigin:x,integrity:v,fetchPriority:g}):p==="script"&&a.d.X(u,{crossOrigin:x,integrity:v,fetchPriority:g,nonce:typeof h.nonce=="string"?h.nonce:void 0})}},Is.preinitModule=function(u,h){if(typeof u=="string")if(typeof h=="object"&&h!==null){if(h.as==null||h.as==="script"){var p=c(h.as,h.crossOrigin);a.d.M(u,{crossOrigin:p,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0})}}else h==null&&a.d.M(u)},Is.preload=function(u,h){if(typeof u=="string"&&typeof h=="object"&&h!==null&&typeof h.as=="string"){var p=h.as,x=c(p,h.crossOrigin);a.d.L(u,p,{crossOrigin:x,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0,type:typeof h.type=="string"?h.type:void 0,fetchPriority:typeof h.fetchPriority=="string"?h.fetchPriority:void 0,referrerPolicy:typeof h.referrerPolicy=="string"?h.referrerPolicy:void 0,imageSrcSet:typeof h.imageSrcSet=="string"?h.imageSrcSet:void 0,imageSizes:typeof h.imageSizes=="string"?h.imageSizes:void 0,media:typeof h.media=="string"?h.media:void 0})}},Is.preloadModule=function(u,h){if(typeof u=="string")if(h){var p=c(h.as,h.crossOrigin);a.d.m(u,{as:typeof h.as=="string"&&h.as!=="script"?h.as:void 0,crossOrigin:p,integrity:typeof h.integrity=="string"?h.integrity:void 0})}else a.d.m(u)},Is.requestFormReset=function(u){a.d.r(u)},Is.unstable_batchedUpdates=function(u,h){return u(h)},Is.useFormState=function(u,h,p){return o.H.useFormState(u,h,p)},Is.useFormStatus=function(){return o.H.useHostTransitionStatus()},Is.version="19.0.0",Is}var Yw;function Kk(){if(Yw)return yg.exports;Yw=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),yg.exports=Jk(),yg.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Jw;function Zk(){if(Jw)return ld;Jw=1;var e=Yk(),t=P1(),r=Kk();function a(i){var l="https://react.dev/errors/"+i;if(1<arguments.length){l+="?args[]="+encodeURIComponent(arguments[1]);for(var d=2;d<arguments.length;d++)l+="&args[]="+encodeURIComponent(arguments[d])}return"Minified React error #"+i+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}var s=Symbol.for("react.element"),o=Symbol.for("react.transitional.element"),c=Symbol.for("react.portal"),u=Symbol.for("react.fragment"),h=Symbol.for("react.strict_mode"),p=Symbol.for("react.profiler"),x=Symbol.for("react.provider"),v=Symbol.for("react.consumer"),g=Symbol.for("react.context"),w=Symbol.for("react.forward_ref"),b=Symbol.for("react.suspense"),N=Symbol.for("react.suspense_list"),_=Symbol.for("react.memo"),E=Symbol.for("react.lazy"),j=Symbol.for("react.offscreen"),M=Symbol.for("react.memo_cache_sentinel"),U=Symbol.iterator;function V(i){return i===null||typeof i!="object"?null:(i=U&&i[U]||i["@@iterator"],typeof i=="function"?i:null)}var I=Symbol.for("react.client.reference");function z(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===I?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case u:return"Fragment";case c:return"Portal";case p:return"Profiler";case h:return"StrictMode";case b:return"Suspense";case N:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case g:return(i.displayName||"Context")+".Provider";case v:return(i._context.displayName||"Context")+".Consumer";case w:var l=i.render;return i=i.displayName,i||(i=l.displayName||l.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case _:return l=i.displayName||null,l!==null?l:z(i.type)||"Memo";case E:l=i._payload,i=i._init;try{return z(i(l))}catch{}}return null}var H=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,re=Object.assign,R,F;function Y(i){if(R===void 0)try{throw Error()}catch(d){var l=d.stack.trim().match(/\n( *(at )?)/);R=l&&l[1]||"",F=-1<d.stack.indexOf(`
    at`)?" (<anonymous>)":-1<d.stack.indexOf("@")?"@unknown:0:0":""}return`
`+R+i+F}var K=!1;function X(i,l){if(!i||K)return"";K=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var m={DetermineComponentFrameRoot:function(){try{if(l){var Tt=function(){throw Error()};if(Object.defineProperty(Tt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Tt,[])}catch(dt){var it=dt}Reflect.construct(i,[],Tt)}else{try{Tt.call()}catch(dt){it=dt}i.call(Tt.prototype)}}else{try{throw Error()}catch(dt){it=dt}(Tt=i())&&typeof Tt.catch=="function"&&Tt.catch(function(){})}}catch(dt){if(dt&&it&&typeof dt.stack=="string")return[dt.stack,it.stack]}return[null,null]}};m.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var S=Object.getOwnPropertyDescriptor(m.DetermineComponentFrameRoot,"name");S&&S.configurable&&Object.defineProperty(m.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var T=m.DetermineComponentFrameRoot(),W=T[0],me=T[1];if(W&&me){var je=W.split(`
`),Be=me.split(`
`);for(S=m=0;m<je.length&&!je[m].includes("DetermineComponentFrameRoot");)m++;for(;S<Be.length&&!Be[S].includes("DetermineComponentFrameRoot");)S++;if(m===je.length||S===Be.length)for(m=je.length-1,S=Be.length-1;1<=m&&0<=S&&je[m]!==Be[S];)S--;for(;1<=m&&0<=S;m--,S--)if(je[m]!==Be[S]){if(m!==1||S!==1)do if(m--,S--,0>S||je[m]!==Be[S]){var xt=`
`+je[m].replace(" at new "," at ");return i.displayName&&xt.includes("<anonymous>")&&(xt=xt.replace("<anonymous>",i.displayName)),xt}while(1<=m&&0<=S);break}}}finally{K=!1,Error.prepareStackTrace=d}return(d=i?i.displayName||i.name:"")?Y(d):""}function Z(i){switch(i.tag){case 26:case 27:case 5:return Y(i.type);case 16:return Y("Lazy");case 13:return Y("Suspense");case 19:return Y("SuspenseList");case 0:case 15:return i=X(i.type,!1),i;case 11:return i=X(i.type.render,!1),i;case 1:return i=X(i.type,!0),i;default:return""}}function ce(i){try{var l="";do l+=Z(i),i=i.return;while(i);return l}catch(d){return`
Error generating stack: `+d.message+`
`+d.stack}}function te(i){var l=i,d=i;if(i.alternate)for(;l.return;)l=l.return;else{i=l;do l=i,(l.flags&4098)!==0&&(d=l.return),i=l.return;while(i)}return l.tag===3?d:null}function Q(i){if(i.tag===13){var l=i.memoizedState;if(l===null&&(i=i.alternate,i!==null&&(l=i.memoizedState)),l!==null)return l.dehydrated}return null}function G(i){if(te(i)!==i)throw Error(a(188))}function ye(i){var l=i.alternate;if(!l){if(l=te(i),l===null)throw Error(a(188));return l!==i?null:i}for(var d=i,m=l;;){var S=d.return;if(S===null)break;var T=S.alternate;if(T===null){if(m=S.return,m!==null){d=m;continue}break}if(S.child===T.child){for(T=S.child;T;){if(T===d)return G(S),i;if(T===m)return G(S),l;T=T.sibling}throw Error(a(188))}if(d.return!==m.return)d=S,m=T;else{for(var W=!1,me=S.child;me;){if(me===d){W=!0,d=S,m=T;break}if(me===m){W=!0,m=S,d=T;break}me=me.sibling}if(!W){for(me=T.child;me;){if(me===d){W=!0,d=T,m=S;break}if(me===m){W=!0,m=T,d=S;break}me=me.sibling}if(!W)throw Error(a(189))}}if(d.alternate!==m)throw Error(a(190))}if(d.tag!==3)throw Error(a(188));return d.stateNode.current===d?i:l}function D(i){var l=i.tag;if(l===5||l===26||l===27||l===6)return i;for(i=i.child;i!==null;){if(l=D(i),l!==null)return l;i=i.sibling}return null}var O=Array.isArray,L=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,q={pending:!1,data:null,method:null,action:null},oe=[],be=-1;function ve(i){return{current:i}}function ue(i){0>be||(i.current=oe[be],oe[be]=null,be--)}function fe(i,l){be++,oe[be]=i.current,i.current=l}var Ee=ve(null),J=ve(null),Pe=ve(null),st=ve(null);function ke(i,l){switch(fe(Pe,l),fe(J,i),fe(Ee,null),i=l.nodeType,i){case 9:case 11:l=(l=l.documentElement)&&(l=l.namespaceURI)?xw(l):0;break;default:if(i=i===8?l.parentNode:l,l=i.tagName,i=i.namespaceURI)i=xw(i),l=gw(i,l);else switch(l){case"svg":l=1;break;case"math":l=2;break;default:l=0}}ue(Ee),fe(Ee,l)}function de(){ue(Ee),ue(J),ue(Pe)}function rt(i){i.memoizedState!==null&&fe(st,i);var l=Ee.current,d=gw(l,i.type);l!==d&&(fe(J,i),fe(Ee,d))}function Ue(i){J.current===i&&(ue(Ee),ue(J)),st.current===i&&(ue(st),rd._currentValue=q)}var Xe=Object.prototype.hasOwnProperty,ot=e.unstable_scheduleCallback,ut=e.unstable_cancelCallback,vt=e.unstable_shouldYield,At=e.unstable_requestPaint,ct=e.unstable_now,ze=e.unstable_getCurrentPriorityLevel,pt=e.unstable_ImmediatePriority,Ot=e.unstable_UserBlockingPriority,It=e.unstable_NormalPriority,Lt=e.unstable_LowPriority,Ct=e.unstable_IdlePriority,wt=e.log,hr=e.unstable_setDisableYieldValue,zt=null,Yt=null;function Sr(i){if(Yt&&typeof Yt.onCommitFiberRoot=="function")try{Yt.onCommitFiberRoot(zt,i,void 0,(i.current.flags&128)===128)}catch{}}function Mr(i){if(typeof wt=="function"&&hr(i),Yt&&typeof Yt.setStrictMode=="function")try{Yt.setStrictMode(zt,i)}catch{}}var fa=Math.clz32?Math.clz32:na,Ir=Math.log,gi=Math.LN2;function na(i){return i>>>=0,i===0?32:31-(Ir(i)/gi|0)|0}var Ja=128,Dn=4194304;function Br(i){var l=i&42;if(l!==0)return l;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194176;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function sr(i,l){var d=i.pendingLanes;if(d===0)return 0;var m=0,S=i.suspendedLanes,T=i.pingedLanes,W=i.warmLanes;i=i.finishedLanes!==0;var me=d&134217727;return me!==0?(d=me&~S,d!==0?m=Br(d):(T&=me,T!==0?m=Br(T):i||(W=me&~W,W!==0&&(m=Br(W))))):(me=d&~S,me!==0?m=Br(me):T!==0?m=Br(T):i||(W=d&~W,W!==0&&(m=Br(W)))),m===0?0:l!==0&&l!==m&&(l&S)===0&&(S=m&-m,W=l&-l,S>=W||S===32&&(W&4194176)!==0)?l:m}function kr(i,l){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&l)===0}function As(i,l){switch(i){case 1:case 2:case 4:case 8:return l+250;case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function ka(){var i=Ja;return Ja<<=1,(Ja&4194176)===0&&(Ja=128),i}function Ea(){var i=Dn;return Dn<<=1,(Dn&62914560)===0&&(Dn=4194304),i}function gn(i){for(var l=[],d=0;31>d;d++)l.push(i);return l}function Qt(i,l){i.pendingLanes|=l,l!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function Un(i,l,d,m,S,T){var W=i.pendingLanes;i.pendingLanes=d,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=d,i.entangledLanes&=d,i.errorRecoveryDisabledLanes&=d,i.shellSuspendCounter=0;var me=i.entanglements,je=i.expirationTimes,Be=i.hiddenUpdates;for(d=W&~d;0<d;){var xt=31-fa(d),Tt=1<<xt;me[xt]=0,je[xt]=-1;var it=Be[xt];if(it!==null)for(Be[xt]=null,xt=0;xt<it.length;xt++){var dt=it[xt];dt!==null&&(dt.lane&=-536870913)}d&=~Tt}m!==0&&Vr(i,m,0),T!==0&&S===0&&i.tag!==0&&(i.suspendedLanes|=T&~(W&~l))}function Vr(i,l,d){i.pendingLanes|=l,i.suspendedLanes&=~l;var m=31-fa(l);i.entangledLanes|=l,i.entanglements[m]=i.entanglements[m]|1073741824|d&4194218}function qa(i,l){var d=i.entangledLanes|=l;for(i=i.entanglements;d;){var m=31-fa(d),S=1<<m;S&l|i[m]&l&&(i[m]|=l),d&=~S}}function qr(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function ha(){var i=L.p;return i!==0?i:(i=window.event,i===void 0?32:Ow(i.type))}function ne(i,l){var d=L.p;try{return L.p=i,l()}finally{L.p=d}}var Ne=Math.random().toString(36).slice(2),pe="__reactFiber$"+Ne,ge="__reactProps$"+Ne,Se="__reactContainer$"+Ne,_e="__reactEvents$"+Ne,Ye="__reactListeners$"+Ne,lt="__reactHandles$"+Ne,We="__reactResources$"+Ne,$e="__reactMarker$"+Ne;function Qe(i){delete i[pe],delete i[ge],delete i[_e],delete i[Ye],delete i[lt]}function St(i){var l=i[pe];if(l)return l;for(var d=i.parentNode;d;){if(l=d[Se]||d[pe]){if(d=l.alternate,l.child!==null||d!==null&&d.child!==null)for(i=ww(i);i!==null;){if(d=i[pe])return d;i=ww(i)}return l}i=d,d=i.parentNode}return null}function jt(i){if(i=i[pe]||i[Se]){var l=i.tag;if(l===5||l===6||l===13||l===26||l===27||l===3)return i}return null}function Ut(i){var l=i.tag;if(l===5||l===26||l===27||l===6)return i.stateNode;throw Error(a(33))}function ie(i){var l=i[We];return l||(l=i[We]={hoistableStyles:new Map,hoistableScripts:new Map}),l}function Ce(i){i[$e]=!0}var Oe=new Set,Ve={};function kt(i,l){Ht(i,l),Ht(i+"Capture",l)}function Ht(i,l){for(Ve[i]=l,i=0;i<l.length;i++)Oe.add(l[i])}var Ft=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ir=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Gt={},yr={};function Pr(i){return Xe.call(yr,i)?!0:Xe.call(Gt,i)?!1:ir.test(i)?yr[i]=!0:(Gt[i]=!0,!1)}function er(i,l,d){if(Pr(l))if(d===null)i.removeAttribute(l);else{switch(typeof d){case"undefined":case"function":case"symbol":i.removeAttribute(l);return;case"boolean":var m=l.toLowerCase().slice(0,5);if(m!=="data-"&&m!=="aria-"){i.removeAttribute(l);return}}i.setAttribute(l,""+d)}}function rr(i,l,d){if(d===null)i.removeAttribute(l);else{switch(typeof d){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(l);return}i.setAttribute(l,""+d)}}function Ur(i,l,d,m){if(m===null)i.removeAttribute(d);else{switch(typeof m){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(d);return}i.setAttributeNS(l,d,""+m)}}function ja(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function zn(i){var l=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function ei(i){var l=zn(i)?"checked":"value",d=Object.getOwnPropertyDescriptor(i.constructor.prototype,l),m=""+i[l];if(!i.hasOwnProperty(l)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var S=d.get,T=d.set;return Object.defineProperty(i,l,{configurable:!0,get:function(){return S.call(this)},set:function(W){m=""+W,T.call(this,W)}}),Object.defineProperty(i,l,{enumerable:d.enumerable}),{getValue:function(){return m},setValue:function(W){m=""+W},stopTracking:function(){i._valueTracker=null,delete i[l]}}}}function ti(i){i._valueTracker||(i._valueTracker=ei(i))}function Ka(i){if(!i)return!1;var l=i._valueTracker;if(!l)return!0;var d=l.getValue(),m="";return i&&(m=zn(i)?i.checked?"true":"false":i.value),i=m,i!==d?(l.setValue(i),!0):!1}function Aa(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var da=/[\n"\\]/g;function ca(i){return i.replace(da,function(l){return"\\"+l.charCodeAt(0).toString(16)+" "})}function Kn(i,l,d,m,S,T,W,me){i.name="",W!=null&&typeof W!="function"&&typeof W!="symbol"&&typeof W!="boolean"?i.type=W:i.removeAttribute("type"),l!=null?W==="number"?(l===0&&i.value===""||i.value!=l)&&(i.value=""+ja(l)):i.value!==""+ja(l)&&(i.value=""+ja(l)):W!=="submit"&&W!=="reset"||i.removeAttribute("value"),l!=null?_s(i,W,ja(l)):d!=null?_s(i,W,ja(d)):m!=null&&i.removeAttribute("value"),S==null&&T!=null&&(i.defaultChecked=!!T),S!=null&&(i.checked=S&&typeof S!="function"&&typeof S!="symbol"),me!=null&&typeof me!="function"&&typeof me!="symbol"&&typeof me!="boolean"?i.name=""+ja(me):i.removeAttribute("name")}function ri(i,l,d,m,S,T,W,me){if(T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"&&(i.type=T),l!=null||d!=null){if(!(T!=="submit"&&T!=="reset"||l!=null))return;d=d!=null?""+ja(d):"",l=l!=null?""+ja(l):d,me||l===i.value||(i.value=l),i.defaultValue=l}m=m??S,m=typeof m!="function"&&typeof m!="symbol"&&!!m,i.checked=me?i.checked:!!m,i.defaultChecked=!!m,W!=null&&typeof W!="function"&&typeof W!="symbol"&&typeof W!="boolean"&&(i.name=W)}function _s(i,l,d){l==="number"&&Aa(i.ownerDocument)===i||i.defaultValue===""+d||(i.defaultValue=""+d)}function Ts(i,l,d,m){if(i=i.options,l){l={};for(var S=0;S<d.length;S++)l["$"+d[S]]=!0;for(d=0;d<i.length;d++)S=l.hasOwnProperty("$"+i[d].value),i[d].selected!==S&&(i[d].selected=S),S&&m&&(i[d].defaultSelected=!0)}else{for(d=""+ja(d),l=null,S=0;S<i.length;S++){if(i[S].value===d){i[S].selected=!0,m&&(i[S].defaultSelected=!0);return}l!==null||i[S].disabled||(l=i[S])}l!==null&&(l.selected=!0)}}function ai(i,l,d){if(l!=null&&(l=""+ja(l),l!==i.value&&(i.value=l),d==null)){i.defaultValue!==l&&(i.defaultValue=l);return}i.defaultValue=d!=null?""+ja(d):""}function xl(i,l,d,m){if(l==null){if(m!=null){if(d!=null)throw Error(a(92));if(O(m)){if(1<m.length)throw Error(a(93));m=m[0]}d=m}d==null&&(d=""),l=d}d=ja(l),i.defaultValue=d,m=i.textContent,m===d&&m!==""&&m!==null&&(i.value=m)}function ks(i,l){if(l){var d=i.firstChild;if(d&&d===i.lastChild&&d.nodeType===3){d.nodeValue=l;return}}i.textContent=l}var vi=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function fs(i,l,d){var m=l.indexOf("--")===0;d==null||typeof d=="boolean"||d===""?m?i.setProperty(l,""):l==="float"?i.cssFloat="":i[l]="":m?i.setProperty(l,d):typeof d!="number"||d===0||vi.has(l)?l==="float"?i.cssFloat=d:i[l]=(""+d).trim():i[l]=d+"px"}function ao(i,l,d){if(l!=null&&typeof l!="object")throw Error(a(62));if(i=i.style,d!=null){for(var m in d)!d.hasOwnProperty(m)||l!=null&&l.hasOwnProperty(m)||(m.indexOf("--")===0?i.setProperty(m,""):m==="float"?i.cssFloat="":i[m]="");for(var S in l)m=l[S],l.hasOwnProperty(S)&&d[S]!==m&&fs(i,S,m)}else for(var T in l)l.hasOwnProperty(T)&&fs(i,T,l[T])}function Zn(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Qn=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Fi=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function no(i){return Fi.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}var on=null;function tc(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var ni=null,nr=null;function $c(i){var l=jt(i);if(l&&(i=l.stateNode)){var d=i[ge]||null;e:switch(i=l.stateNode,l.type){case"input":if(Kn(i,d.value,d.defaultValue,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name),l=d.name,d.type==="radio"&&l!=null){for(d=i;d.parentNode;)d=d.parentNode;for(d=d.querySelectorAll('input[name="'+ca(""+l)+'"][type="radio"]'),l=0;l<d.length;l++){var m=d[l];if(m!==i&&m.form===i.form){var S=m[ge]||null;if(!S)throw Error(a(90));Kn(m,S.value,S.defaultValue,S.defaultValue,S.checked,S.defaultChecked,S.type,S.name)}}for(l=0;l<d.length;l++)m=d[l],m.form===i.form&&Ka(m)}break e;case"textarea":ai(i,d.value,d.defaultValue);break e;case"select":l=d.value,l!=null&&Ts(i,!!d.multiple,l,!1)}}}var gl=!1;function si(i,l,d){if(gl)return i(l,d);gl=!0;try{var m=i(l);return m}finally{if(gl=!1,(ni!==null||nr!==null)&&(em(),ni&&(l=ni,i=nr,nr=ni=null,$c(l),i)))for(l=0;l<i.length;l++)$c(i[l])}}function so(i,l){var d=i.stateNode;if(d===null)return null;var m=d[ge]||null;if(m===null)return null;d=m[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(m=!m.disabled)||(i=i.type,m=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!m;break e;default:i=!1}if(i)return null;if(d&&typeof d!="function")throw Error(a(231,l,typeof d));return d}var vl=!1;if(Ft)try{var yi={};Object.defineProperty(yi,"passive",{get:function(){vl=!0}}),window.addEventListener("test",yi,yi),window.removeEventListener("test",yi,yi)}catch{vl=!1}var Es=null,rc=null,yl=null;function Xc(){if(yl)return yl;var i,l=rc,d=l.length,m,S="value"in Es?Es.value:Es.textContent,T=S.length;for(i=0;i<d&&l[i]===S[i];i++);var W=d-i;for(m=1;m<=W&&l[d-m]===S[T-m];m++);return yl=S.slice(i,1<m?1-m:void 0)}function io(i){var l=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&l===13&&(i=13)):i=l,i===10&&(i=13),32<=i||i===13?i:0}function wi(){return!0}function Pi(){return!1}function Fn(i){function l(d,m,S,T,W){this._reactName=d,this._targetInst=S,this.type=m,this.nativeEvent=T,this.target=W,this.currentTarget=null;for(var me in i)i.hasOwnProperty(me)&&(d=i[me],this[me]=d?d(T):T[me]);return this.isDefaultPrevented=(T.defaultPrevented!=null?T.defaultPrevented:T.returnValue===!1)?wi:Pi,this.isPropagationStopped=Pi,this}return re(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var d=this.nativeEvent;d&&(d.preventDefault?d.preventDefault():typeof d.returnValue!="unknown"&&(d.returnValue=!1),this.isDefaultPrevented=wi)},stopPropagation:function(){var d=this.nativeEvent;d&&(d.stopPropagation?d.stopPropagation():typeof d.cancelBubble!="unknown"&&(d.cancelBubble=!0),this.isPropagationStopped=wi)},persist:function(){},isPersistent:wi}),l}var hs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ae=Fn(hs),He=re({},hs,{view:0,detail:0}),tt=Fn(He),nt,Pt,Jt,Dt=re({},He,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ds,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Jt&&(Jt&&i.type==="mousemove"?(nt=i.screenX-Jt.screenX,Pt=i.screenY-Jt.screenY):Pt=nt=0,Jt=i),nt)},movementY:function(i){return"movementY"in i?i.movementY:Pt}}),Wt=Fn(Dt),$t=re({},Dt,{dataTransfer:0}),Xt=Fn($t),lr=re({},He,{relatedTarget:0}),la=Fn(lr),Er=re({},hs,{animationName:0,elapsedTime:0,pseudoElement:0}),Ga=Fn(Er),vn=re({},hs,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),es=Fn(vn),Pn=re({},hs,{data:0}),yn=Fn(Pn),js={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ts={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Hn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Cs(i){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(i):(i=Hn[i])?!!l[i]:!1}function Ds(){return Cs}var Fo=re({},He,{key:function(i){if(i.key){var l=js[i.key]||i.key;if(l!=="Unidentified")return l}return i.type==="keypress"?(i=io(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?ts[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ds,charCode:function(i){return i.type==="keypress"?io(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?io(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),oo=Fn(Fo),lo=re({},Dt,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Po=Fn(lo),wl=re({},He,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ds}),Xu=Fn(wl),k=re({},hs,{propertyName:0,elapsedTime:0,pseudoElement:0}),ae=Fn(k),Te=re({},Dt,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),Fe=Fn(Te),qe=re({},hs,{newState:0,oldState:0}),ft=Fn(qe),_t=[9,13,27,32],qt=Ft&&"CompositionEvent"in window,tr=null;Ft&&"documentMode"in document&&(tr=document.documentMode);var Ar=Ft&&"TextEvent"in window&&!tr,br=Ft&&(!qt||tr&&8<tr&&11>=tr),Gr=" ",Ca=!1;function Ra(i,l){switch(i){case"keyup":return _t.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Za(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var Qa=!1;function Ln(i,l){switch(i){case"compositionend":return Za(l);case"keypress":return l.which!==32?null:(Ca=!0,Gr);case"textInput":return i=l.data,i===Gr&&Ca?null:i;default:return null}}function Li(i,l){if(Qa)return i==="compositionend"||!qt&&Ra(i,l)?(i=Xc(),yl=rc=Es=null,Qa=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return br&&l.locale!=="ko"?null:l.data;default:return null}}var ii={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Oi(i){var l=i&&i.nodeName&&i.nodeName.toLowerCase();return l==="input"?!!ii[i.type]:l==="textarea"}function Yu(i,l,d,m){ni?nr?nr.push(m):nr=[m]:ni=m,l=sm(l,"onChange"),0<l.length&&(d=new Ae("onChange","change",null,d,m),i.push({event:d,listeners:l}))}var Lo=null,Oo=null;function Yc(i){fw(i,0)}function bl(i){var l=Ut(i);if(Ka(l))return i}function Jc(i,l){if(i==="change")return l}var ac=!1;if(Ft){var wn;if(Ft){var Sl="oninput"in document;if(!Sl){var nc=document.createElement("div");nc.setAttribute("oninput","return;"),Sl=typeof nc.oninput=="function"}wn=Sl}else wn=!1;ac=wn&&(!document.documentMode||9<document.documentMode)}function sc(){Lo&&(Lo.detachEvent("onpropertychange",Kc),Oo=Lo=null)}function Kc(i){if(i.propertyName==="value"&&bl(Oo)){var l=[];Yu(l,Oo,i,tc(i)),si(Yc,l)}}function Fs(i,l,d){i==="focusin"?(sc(),Lo=l,Oo=d,Lo.attachEvent("onpropertychange",Kc)):i==="focusout"&&sc()}function Ah(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return bl(Oo)}function Ju(i,l){if(i==="click")return bl(l)}function o0(i,l){if(i==="input"||i==="change")return bl(l)}function bi(i,l){return i===l&&(i!==0||1/i===1/l)||i!==i&&l!==l}var On=typeof Object.is=="function"?Object.is:bi;function Nl(i,l){if(On(i,l))return!0;if(typeof i!="object"||i===null||typeof l!="object"||l===null)return!1;var d=Object.keys(i),m=Object.keys(l);if(d.length!==m.length)return!1;for(m=0;m<d.length;m++){var S=d[m];if(!Xe.call(l,S)||!On(i[S],l[S]))return!1}return!0}function Ku(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function Ro(i,l){var d=Ku(i);i=0;for(var m;d;){if(d.nodeType===3){if(m=i+d.textContent.length,i<=l&&m>=l)return{node:d,offset:l-i};i=m}e:{for(;d;){if(d.nextSibling){d=d.nextSibling;break e}d=d.parentNode}d=void 0}d=Ku(d)}}function Al(i,l){return i&&l?i===l?!0:i&&i.nodeType===3?!1:l&&l.nodeType===3?Al(i,l.parentNode):"contains"in i?i.contains(l):i.compareDocumentPosition?!!(i.compareDocumentPosition(l)&16):!1:!1}function ds(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var l=Aa(i.document);l instanceof i.HTMLIFrameElement;){try{var d=typeof l.contentWindow.location.href=="string"}catch{d=!1}if(d)i=l.contentWindow;else break;l=Aa(i.document)}return l}function Vn(i){var l=i&&i.nodeName&&i.nodeName.toLowerCase();return l&&(l==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||l==="textarea"||i.contentEditable==="true")}function _l(i,l){var d=ds(l);l=i.focusedElem;var m=i.selectionRange;if(d!==l&&l&&l.ownerDocument&&Al(l.ownerDocument.documentElement,l)){if(m!==null&&Vn(l)){if(i=m.start,d=m.end,d===void 0&&(d=i),"selectionStart"in l)l.selectionStart=i,l.selectionEnd=Math.min(d,l.value.length);else if(d=(i=l.ownerDocument||document)&&i.defaultView||window,d.getSelection){d=d.getSelection();var S=l.textContent.length,T=Math.min(m.start,S);m=m.end===void 0?T:Math.min(m.end,S),!d.extend&&T>m&&(S=m,m=T,T=S),S=Ro(l,T);var W=Ro(l,m);S&&W&&(d.rangeCount!==1||d.anchorNode!==S.node||d.anchorOffset!==S.offset||d.focusNode!==W.node||d.focusOffset!==W.offset)&&(i=i.createRange(),i.setStart(S.node,S.offset),d.removeAllRanges(),T>m?(d.addRange(i),d.extend(W.node,W.offset)):(i.setEnd(W.node,W.offset),d.addRange(i)))}}for(i=[],d=l;d=d.parentNode;)d.nodeType===1&&i.push({element:d,left:d.scrollLeft,top:d.scrollTop});for(typeof l.focus=="function"&&l.focus(),l=0;l<i.length;l++)d=i[l],d.element.scrollLeft=d.left,d.element.scrollTop=d.top}}var Mo=Ft&&"documentMode"in document&&11>=document.documentMode,Ps=null,Tl=null,oi=null,Ma=!1;function Zc(i,l,d){var m=d.window===d?d.document:d.nodeType===9?d:d.ownerDocument;Ma||Ps==null||Ps!==Aa(m)||(m=Ps,"selectionStart"in m&&Vn(m)?m={start:m.selectionStart,end:m.selectionEnd}:(m=(m.ownerDocument&&m.ownerDocument.defaultView||window).getSelection(),m={anchorNode:m.anchorNode,anchorOffset:m.anchorOffset,focusNode:m.focusNode,focusOffset:m.focusOffset}),oi&&Nl(oi,m)||(oi=m,m=sm(Tl,"onSelect"),0<m.length&&(l=new Ae("onSelect","select",null,l,d),i.push({event:l,listeners:m}),l.target=Ps)))}function en(i,l){var d={};return d[i.toLowerCase()]=l.toLowerCase(),d["Webkit"+i]="webkit"+l,d["Moz"+i]="moz"+l,d}var qn={animationend:en("Animation","AnimationEnd"),animationiteration:en("Animation","AnimationIteration"),animationstart:en("Animation","AnimationStart"),transitionrun:en("Transition","TransitionRun"),transitionstart:en("Transition","TransitionStart"),transitioncancel:en("Transition","TransitionCancel"),transitionend:en("Transition","TransitionEnd")},kl={},Zu={};Ft&&(Zu=document.createElement("div").style,"AnimationEvent"in window||(delete qn.animationend.animation,delete qn.animationiteration.animation,delete qn.animationstart.animation),"TransitionEvent"in window||delete qn.transitionend.transition);function Ri(i){if(kl[i])return kl[i];if(!qn[i])return i;var l=qn[i],d;for(d in l)if(l.hasOwnProperty(d)&&d in Zu)return kl[i]=l[d];return i}var El=Ri("animationend"),jl=Ri("animationiteration"),Io=Ri("animationstart"),ic=Ri("transitionrun"),Qc=Ri("transitionstart"),oc=Ri("transitioncancel"),Bo=Ri("transitionend"),eu=new Map,li="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll scrollEnd toggle touchMove waiting wheel".split(" ");function Wa(i,l){eu.set(i,l),kt(l,[i])}var Lr=[],ea=0,Ia=0;function $a(){for(var i=ea,l=Ia=ea=0;l<i;){var d=Lr[l];Lr[l++]=null;var m=Lr[l];Lr[l++]=null;var S=Lr[l];Lr[l++]=null;var T=Lr[l];if(Lr[l++]=null,m!==null&&S!==null){var W=m.pending;W===null?S.next=S:(S.next=W.next,W.next=S),m.pending=S}T!==0&&Qu(d,S,T)}}function Si(i,l,d,m){Lr[ea++]=i,Lr[ea++]=l,Lr[ea++]=d,Lr[ea++]=m,Ia|=m,i.lanes|=m,i=i.alternate,i!==null&&(i.lanes|=m)}function lc(i,l,d,m){return Si(i,l,d,m),tu(i)}function ci(i,l){return Si(i,null,null,l),tu(i)}function Qu(i,l,d){i.lanes|=d;var m=i.alternate;m!==null&&(m.lanes|=d);for(var S=!1,T=i.return;T!==null;)T.childLanes|=d,m=T.alternate,m!==null&&(m.childLanes|=d),T.tag===22&&(i=T.stateNode,i===null||i._visibility&1||(S=!0)),i=T,T=T.return;S&&l!==null&&i.tag===3&&(T=i.stateNode,S=31-fa(d),T=T.hiddenUpdates,i=T[S],i===null?T[S]=[l]:i.push(l),l.lane=d|536870912)}function tu(i){if(50<Yh)throw Yh=0,Ix=null,Error(a(185));for(var l=i.return;l!==null;)i=l,l=i.return;return i.tag===3?i.stateNode:null}var Uo={},Ls=new WeakMap;function Ba(i,l){if(typeof i=="object"&&i!==null){var d=Ls.get(i);return d!==void 0?d:(l={value:i,source:l,stack:ce(l)},Ls.set(i,l),l)}return{value:i,source:l,stack:ce(l)}}var zo=[],Ho=0,ef=null,cc=0,ps=[],Os=0,Cl=null,Mi=1,Ii="";function co(i,l){zo[Ho++]=cc,zo[Ho++]=ef,ef=i,cc=l}function l0(i,l,d){ps[Os++]=Mi,ps[Os++]=Ii,ps[Os++]=Cl,Cl=i;var m=Mi;i=Ii;var S=32-fa(m)-1;m&=~(1<<S),d+=1;var T=32-fa(l)+S;if(30<T){var W=S-S%5;T=(m&(1<<W)-1).toString(32),m>>=W,S-=W,Mi=1<<32-fa(l)+S|d<<S|m,Ii=T+i}else Mi=1<<T|d<<S|m,Ii=i}function _h(i){i.return!==null&&(co(i,1),l0(i,1,0))}function Th(i){for(;i===ef;)ef=zo[--Ho],zo[Ho]=null,cc=zo[--Ho],zo[Ho]=null;for(;i===Cl;)Cl=ps[--Os],ps[Os]=null,Ii=ps[--Os],ps[Os]=null,Mi=ps[--Os],ps[Os]=null}var rs=null,Gn=null,Zr=!1,Bi=null,uo=!1,kh=Error(a(519));function Vo(i){var l=Error(a(418,""));throw au(Ba(l,i)),kh}function c0(i){var l=i.stateNode,d=i.type,m=i.memoizedProps;switch(l[pe]=i,l[ge]=m,d){case"dialog":Kr("cancel",l),Kr("close",l);break;case"iframe":case"object":case"embed":Kr("load",l);break;case"video":case"audio":for(d=0;d<Kh.length;d++)Kr(Kh[d],l);break;case"source":Kr("error",l);break;case"img":case"image":case"link":Kr("error",l),Kr("load",l);break;case"details":Kr("toggle",l);break;case"input":Kr("invalid",l),ri(l,m.value,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name,!0),ti(l);break;case"select":Kr("invalid",l);break;case"textarea":Kr("invalid",l),xl(l,m.value,m.defaultValue,m.children),ti(l)}d=m.children,typeof d!="string"&&typeof d!="number"&&typeof d!="bigint"||l.textContent===""+d||m.suppressHydrationWarning===!0||mw(l.textContent,d)?(m.popover!=null&&(Kr("beforetoggle",l),Kr("toggle",l)),m.onScroll!=null&&Kr("scroll",l),m.onScrollEnd!=null&&Kr("scrollend",l),m.onClick!=null&&(l.onclick=im),l=!0):l=!1,l||Vo(i)}function ru(i){for(rs=i.return;rs;)switch(rs.tag){case 3:case 27:uo=!0;return;case 5:case 13:uo=!1;return;default:rs=rs.return}}function tf(i){if(i!==rs)return!1;if(!Zr)return ru(i),Zr=!0,!1;var l=!1,d;if((d=i.tag!==3&&i.tag!==27)&&((d=i.tag===5)&&(d=i.type,d=!(d!=="form"&&d!=="button")||tg(i.type,i.memoizedProps)),d=!d),d&&(l=!0),l&&Gn&&Vo(i),ru(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(a(317));e:{for(i=i.nextSibling,l=0;i;){if(i.nodeType===8)if(d=i.data,d==="/$"){if(l===0){Gn=Zo(i.nextSibling);break e}l--}else d!=="$"&&d!=="$!"&&d!=="$?"||l++;i=i.nextSibling}Gn=null}}else Gn=rs?Zo(i.stateNode.nextSibling):null;return!0}function rf(){Gn=rs=null,Zr=!1}function au(i){Bi===null?Bi=[i]:Bi.push(i)}var af=Error(a(460)),Ep=Error(a(474)),Eh={then:function(){}};function jp(i){return i=i.status,i==="fulfilled"||i==="rejected"}function Ui(){}function Ni(i,l,d){switch(d=i[d],d===void 0?i.push(l):d!==l&&(l.then(Ui,Ui),l=d),l.status){case"fulfilled":return l.value;case"rejected":throw i=l.reason,i===af?Error(a(483)):i;default:if(typeof l.status=="string")l.then(Ui,Ui);else{if(i=Fa,i!==null&&100<i.shellSuspendCounter)throw Error(a(482));i=l,i.status="pending",i.then(function(m){if(l.status==="pending"){var S=l;S.status="fulfilled",S.value=m}},function(m){if(l.status==="pending"){var S=l;S.status="rejected",S.reason=m}})}switch(l.status){case"fulfilled":return l.value;case"rejected":throw i=l.reason,i===af?Error(a(483)):i}throw ui=l,af}}var ui=null;function Cp(){if(ui===null)throw Error(a(459));var i=ui;return ui=null,i}var uc=null,Ai=0;function ms(i){var l=Ai;return Ai+=1,uc===null&&(uc=[]),Ni(uc,i,l)}function nf(i,l){l=l.props.ref,i.ref=l!==void 0?l:null}function u0(i,l){throw l.$$typeof===s?Error(a(525)):(i=Object.prototype.toString.call(l),Error(a(31,i==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":i)))}function jh(i){var l=i._init;return l(i._payload)}function Ch(i){function l(Ge,Me){if(i){var et=Ge.deletions;et===null?(Ge.deletions=[Me],Ge.flags|=16):et.push(Me)}}function d(Ge,Me){if(!i)return null;for(;Me!==null;)l(Ge,Me),Me=Me.sibling;return null}function m(Ge){for(var Me=new Map;Ge!==null;)Ge.key!==null?Me.set(Ge.key,Ge):Me.set(Ge.index,Ge),Ge=Ge.sibling;return Me}function S(Ge,Me){return Ge=vu(Ge,Me),Ge.index=0,Ge.sibling=null,Ge}function T(Ge,Me,et){return Ge.index=et,i?(et=Ge.alternate,et!==null?(et=et.index,et<Me?(Ge.flags|=33554434,Me):et):(Ge.flags|=33554434,Me)):(Ge.flags|=1048576,Me)}function W(Ge){return i&&Ge.alternate===null&&(Ge.flags|=33554434),Ge}function me(Ge,Me,et,bt){return Me===null||Me.tag!==6?(Me=Cx(et,Ge.mode,bt),Me.return=Ge,Me):(Me=S(Me,et),Me.return=Ge,Me)}function je(Ge,Me,et,bt){var Kt=et.type;return Kt===u?xt(Ge,Me,et.props.children,bt,et.key):Me!==null&&(Me.elementType===Kt||typeof Kt=="object"&&Kt!==null&&Kt.$$typeof===E&&jh(Kt)===Me.type)?(Me=S(Me,et.props),nf(Me,et),Me.return=Ge,Me):(Me=Yp(et.type,et.key,et.props,null,Ge.mode,bt),nf(Me,et),Me.return=Ge,Me)}function Be(Ge,Me,et,bt){return Me===null||Me.tag!==4||Me.stateNode.containerInfo!==et.containerInfo||Me.stateNode.implementation!==et.implementation?(Me=Dx(et,Ge.mode,bt),Me.return=Ge,Me):(Me=S(Me,et.children||[]),Me.return=Ge,Me)}function xt(Ge,Me,et,bt,Kt){return Me===null||Me.tag!==7?(Me=wf(et,Ge.mode,bt,Kt),Me.return=Ge,Me):(Me=S(Me,et),Me.return=Ge,Me)}function Tt(Ge,Me,et){if(typeof Me=="string"&&Me!==""||typeof Me=="number"||typeof Me=="bigint")return Me=Cx(""+Me,Ge.mode,et),Me.return=Ge,Me;if(typeof Me=="object"&&Me!==null){switch(Me.$$typeof){case o:return et=Yp(Me.type,Me.key,Me.props,null,Ge.mode,et),nf(et,Me),et.return=Ge,et;case c:return Me=Dx(Me,Ge.mode,et),Me.return=Ge,Me;case E:var bt=Me._init;return Me=bt(Me._payload),Tt(Ge,Me,et)}if(O(Me)||V(Me))return Me=wf(Me,Ge.mode,et,null),Me.return=Ge,Me;if(typeof Me.then=="function")return Tt(Ge,ms(Me),et);if(Me.$$typeof===g)return Tt(Ge,Wp(Ge,Me),et);u0(Ge,Me)}return null}function it(Ge,Me,et,bt){var Kt=Me!==null?Me.key:null;if(typeof et=="string"&&et!==""||typeof et=="number"||typeof et=="bigint")return Kt!==null?null:me(Ge,Me,""+et,bt);if(typeof et=="object"&&et!==null){switch(et.$$typeof){case o:return et.key===Kt?je(Ge,Me,et,bt):null;case c:return et.key===Kt?Be(Ge,Me,et,bt):null;case E:return Kt=et._init,et=Kt(et._payload),it(Ge,Me,et,bt)}if(O(et)||V(et))return Kt!==null?null:xt(Ge,Me,et,bt,null);if(typeof et.then=="function")return it(Ge,Me,ms(et),bt);if(et.$$typeof===g)return it(Ge,Me,Wp(Ge,et),bt);u0(Ge,et)}return null}function dt(Ge,Me,et,bt,Kt){if(typeof bt=="string"&&bt!==""||typeof bt=="number"||typeof bt=="bigint")return Ge=Ge.get(et)||null,me(Me,Ge,""+bt,Kt);if(typeof bt=="object"&&bt!==null){switch(bt.$$typeof){case o:return Ge=Ge.get(bt.key===null?et:bt.key)||null,je(Me,Ge,bt,Kt);case c:return Ge=Ge.get(bt.key===null?et:bt.key)||null,Be(Me,Ge,bt,Kt);case E:var zr=bt._init;return bt=zr(bt._payload),dt(Ge,Me,et,bt,Kt)}if(O(bt)||V(bt))return Ge=Ge.get(et)||null,xt(Me,Ge,bt,Kt,null);if(typeof bt.then=="function")return dt(Ge,Me,et,ms(bt),Kt);if(bt.$$typeof===g)return dt(Ge,Me,et,Wp(Me,bt),Kt);u0(Me,bt)}return null}function ar(Ge,Me,et,bt){for(var Kt=null,zr=null,or=Me,pr=Me=0,is=null;or!==null&&pr<et.length;pr++){or.index>pr?(is=or,or=null):is=or.sibling;var ia=it(Ge,or,et[pr],bt);if(ia===null){or===null&&(or=is);break}i&&or&&ia.alternate===null&&l(Ge,or),Me=T(ia,Me,pr),zr===null?Kt=ia:zr.sibling=ia,zr=ia,or=is}if(pr===et.length)return d(Ge,or),Zr&&co(Ge,pr),Kt;if(or===null){for(;pr<et.length;pr++)or=Tt(Ge,et[pr],bt),or!==null&&(Me=T(or,Me,pr),zr===null?Kt=or:zr.sibling=or,zr=or);return Zr&&co(Ge,pr),Kt}for(or=m(or);pr<et.length;pr++)is=dt(or,Ge,pr,et[pr],bt),is!==null&&(i&&is.alternate!==null&&or.delete(is.key===null?pr:is.key),Me=T(is,Me,pr),zr===null?Kt=is:zr.sibling=is,zr=is);return i&&or.forEach(function(_u){return l(Ge,_u)}),Zr&&co(Ge,pr),Kt}function _r(Ge,Me,et,bt){if(et==null)throw Error(a(151));for(var Kt=null,zr=null,or=Me,pr=Me=0,is=null,ia=et.next();or!==null&&!ia.done;pr++,ia=et.next()){or.index>pr?(is=or,or=null):is=or.sibling;var _u=it(Ge,or,ia.value,bt);if(_u===null){or===null&&(or=is);break}i&&or&&_u.alternate===null&&l(Ge,or),Me=T(_u,Me,pr),zr===null?Kt=_u:zr.sibling=_u,zr=_u,or=is}if(ia.done)return d(Ge,or),Zr&&co(Ge,pr),Kt;if(or===null){for(;!ia.done;pr++,ia=et.next())ia=Tt(Ge,ia.value,bt),ia!==null&&(Me=T(ia,Me,pr),zr===null?Kt=ia:zr.sibling=ia,zr=ia);return Zr&&co(Ge,pr),Kt}for(or=m(or);!ia.done;pr++,ia=et.next())ia=dt(or,Ge,pr,ia.value,bt),ia!==null&&(i&&ia.alternate!==null&&or.delete(ia.key===null?pr:ia.key),Me=T(ia,Me,pr),zr===null?Kt=ia:zr.sibling=ia,zr=ia);return i&&or.forEach(function(Hk){return l(Ge,Hk)}),Zr&&co(Ge,pr),Kt}function fn(Ge,Me,et,bt){if(typeof et=="object"&&et!==null&&et.type===u&&et.key===null&&(et=et.props.children),typeof et=="object"&&et!==null){switch(et.$$typeof){case o:e:{for(var Kt=et.key;Me!==null;){if(Me.key===Kt){if(Kt=et.type,Kt===u){if(Me.tag===7){d(Ge,Me.sibling),bt=S(Me,et.props.children),bt.return=Ge,Ge=bt;break e}}else if(Me.elementType===Kt||typeof Kt=="object"&&Kt!==null&&Kt.$$typeof===E&&jh(Kt)===Me.type){d(Ge,Me.sibling),bt=S(Me,et.props),nf(bt,et),bt.return=Ge,Ge=bt;break e}d(Ge,Me);break}else l(Ge,Me);Me=Me.sibling}et.type===u?(bt=wf(et.props.children,Ge.mode,bt,et.key),bt.return=Ge,Ge=bt):(bt=Yp(et.type,et.key,et.props,null,Ge.mode,bt),nf(bt,et),bt.return=Ge,Ge=bt)}return W(Ge);case c:e:{for(Kt=et.key;Me!==null;){if(Me.key===Kt)if(Me.tag===4&&Me.stateNode.containerInfo===et.containerInfo&&Me.stateNode.implementation===et.implementation){d(Ge,Me.sibling),bt=S(Me,et.children||[]),bt.return=Ge,Ge=bt;break e}else{d(Ge,Me);break}else l(Ge,Me);Me=Me.sibling}bt=Dx(et,Ge.mode,bt),bt.return=Ge,Ge=bt}return W(Ge);case E:return Kt=et._init,et=Kt(et._payload),fn(Ge,Me,et,bt)}if(O(et))return ar(Ge,Me,et,bt);if(V(et)){if(Kt=V(et),typeof Kt!="function")throw Error(a(150));return et=Kt.call(et),_r(Ge,Me,et,bt)}if(typeof et.then=="function")return fn(Ge,Me,ms(et),bt);if(et.$$typeof===g)return fn(Ge,Me,Wp(Ge,et),bt);u0(Ge,et)}return typeof et=="string"&&et!==""||typeof et=="number"||typeof et=="bigint"?(et=""+et,Me!==null&&Me.tag===6?(d(Ge,Me.sibling),bt=S(Me,et),bt.return=Ge,Ge=bt):(d(Ge,Me),bt=Cx(et,Ge.mode,bt),bt.return=Ge,Ge=bt),W(Ge)):d(Ge,Me)}return function(Ge,Me,et,bt){try{Ai=0;var Kt=fn(Ge,Me,et,bt);return uc=null,Kt}catch(or){if(or===af)throw or;var zr=xo(29,or,null,Ge.mode);return zr.lanes=bt,zr.return=Ge,zr}finally{}}}var Dl=Ch(!0),Dh=Ch(!1),nu=ve(null),fc=ve(0);function sf(i,l){i=_c,fe(fc,i),fe(nu,l),_c=i|l.baseLanes}function hc(){fe(fc,_c),fe(nu,nu.current)}function of(){_c=fc.current,ue(nu),ue(fc)}var _i=ve(null),zi=null;function Fl(i){var l=i.alternate;fe(bn,bn.current&1),fe(_i,i),zi===null&&(l===null||nu.current!==null||l.memoizedState!==null)&&(zi=i)}function Dp(i){if(i.tag===22){if(fe(bn,bn.current),fe(_i,i),zi===null){var l=i.alternate;l!==null&&l.memoizedState!==null&&(zi=i)}}else Pl()}function Pl(){fe(bn,bn.current),fe(_i,_i.current)}function qo(i){ue(_i),zi===i&&(zi=null),ue(bn)}var bn=ve(0);function f0(i){for(var l=i;l!==null;){if(l.tag===13){var d=l.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||d.data==="$?"||d.data==="$!"))return l}else if(l.tag===19&&l.memoizedProps.revealOrder!==void 0){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===i)break;for(;l.sibling===null;){if(l.return===null||l.return===i)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var Fp=typeof AbortController<"u"?AbortController:function(){var i=[],l=this.signal={aborted:!1,addEventListener:function(d,m){i.push(m)}};this.abort=function(){l.aborted=!0,i.forEach(function(d){return d()})}},h0=e.unstable_scheduleCallback,sx=e.unstable_NormalPriority,Sn={$$typeof:g,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function d0(){return{controller:new Fp,data:new Map,refCount:0}}function y(i){i.refCount--,i.refCount===0&&h0(sx,function(){i.controller.abort()})}var A=null,C=0,B=0,ee=null;function se(i,l){if(A===null){var d=A=[];C=0,B=Wx(),ee={status:"pending",value:void 0,then:function(m){d.push(m)}}}return C++,l.then(le,le),l}function le(){if(--C===0&&A!==null){ee!==null&&(ee.status="fulfilled");var i=A;A=null,B=0,ee=null;for(var l=0;l<i.length;l++)(0,i[l])()}}function he(i,l){var d=[],m={status:"pending",value:null,reason:null,then:function(S){d.push(S)}};return i.then(function(){m.status="fulfilled",m.value=l;for(var S=0;S<d.length;S++)(0,d[S])(l)},function(S){for(m.status="rejected",m.reason=S,S=0;S<d.length;S++)(0,d[S])(void 0)}),m}var xe=H.S;H.S=function(i,l){typeof l=="object"&&l!==null&&typeof l.then=="function"&&se(i,l),xe!==null&&xe(i,l)};var we=ve(null);function Le(){var i=we.current;return i!==null?i:Fa.pooledCache}function Je(i,l){l===null?fe(we,we.current):fe(we,l.pool)}function Ze(){var i=Le();return i===null?null:{parent:Sn._currentValue,pool:i}}var Ie=0,at=null,Ke=null,De=null,Re=!1,mt=!1,yt=!1,gt=0,Vt=0,Rt=null,fr=0;function Et(){throw Error(a(321))}function Yr(i,l){if(l===null)return!1;for(var d=0;d<l.length&&d<i.length;d++)if(!On(i[d],l[d]))return!1;return!0}function ta(i,l,d,m,S,T){return Ie=T,at=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,H.H=i===null||i.memoizedState===null?xc:ki,yt=!1,T=d(m,S),yt=!1,mt&&(T=Or(l,d,m,S)),$r(i),T}function $r(i){H.H=Vi;var l=Ke!==null&&Ke.next!==null;if(Ie=0,De=Ke=at=null,Re=!1,Vt=0,Rt=null,l)throw Error(a(300));i===null||ns||(i=i.dependencies,i!==null&&Gp(i)&&(ns=!0))}function Or(i,l,d,m){at=i;var S=0;do{if(mt&&(Rt=null),Vt=0,mt=!1,25<=S)throw Error(a(301));if(S+=1,De=Ke=null,i.updateQueue!=null){var T=i.updateQueue;T.lastEffect=null,T.events=null,T.stores=null,T.memoCache!=null&&(T.memoCache.index=0)}H.H=Xo,T=l(d,m)}while(mt);return T}function pa(){var i=H.H,l=i.useState()[0];return l=typeof l.then=="function"?Jr(l):l,i=i.useState()[0],(Ke!==null?Ke.memoizedState:null)!==i&&(at.flags|=1024),l}function sa(){var i=gt!==0;return gt=0,i}function Nr(i,l,d){l.updateQueue=i.updateQueue,l.flags&=-2053,i.lanes&=~d}function Xa(i){if(Re){for(i=i.memoizedState;i!==null;){var l=i.queue;l!==null&&(l.pending=null),i=i.next}Re=!1}Ie=0,De=Ke=at=null,mt=!1,Vt=gt=0,Rt=null}function ma(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return De===null?at.memoizedState=De=i:De=De.next=i,De}function Cr(){if(Ke===null){var i=at.alternate;i=i!==null?i.memoizedState:null}else i=Ke.next;var l=De===null?at.memoizedState:De.next;if(l!==null)De=l,Ke=i;else{if(i===null)throw at.alternate===null?Error(a(467)):Error(a(310));Ke=i,i={memoizedState:Ke.memoizedState,baseState:Ke.baseState,baseQueue:Ke.baseQueue,queue:Ke.queue,next:null},De===null?at.memoizedState=De=i:De=De.next=i}return De}var Wn;Wn=function(){return{lastEffect:null,events:null,stores:null,memoCache:null}};function Jr(i){var l=Vt;return Vt+=1,Rt===null&&(Rt=[]),i=Ni(Rt,i,l),l=at,(De===null?l.memoizedState:De.next)===null&&(l=l.alternate,H.H=l===null||l.memoizedState===null?xc:ki),i}function as(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return Jr(i);if(i.$$typeof===g)return Ms(i)}throw Error(a(438,String(i)))}function xs(i){var l=null,d=at.updateQueue;if(d!==null&&(l=d.memoCache),l==null){var m=at.alternate;m!==null&&(m=m.updateQueue,m!==null&&(m=m.memoCache,m!=null&&(l={data:m.data.map(function(S){return S.slice()}),index:0})))}if(l==null&&(l={data:[],index:0}),d===null&&(d=Wn(),at.updateQueue=d),d.memoCache=l,d=l.data[l.index],d===void 0)for(d=l.data[l.index]=Array(i),m=0;m<i;m++)d[m]=M;return l.index++,d}function ba(i,l){return typeof l=="function"?l(i):l}function ln(i){var l=Cr();return $n(l,Ke,i)}function $n(i,l,d){var m=i.queue;if(m===null)throw Error(a(311));m.lastRenderedReducer=d;var S=i.baseQueue,T=m.pending;if(T!==null){if(S!==null){var W=S.next;S.next=T.next,T.next=W}l.baseQueue=S=T,m.pending=null}if(T=i.baseState,S===null)i.memoizedState=T;else{l=S.next;var me=W=null,je=null,Be=l,xt=!1;do{var Tt=Be.lane&-536870913;if(Tt!==Be.lane?(Qr&Tt)===Tt:(Ie&Tt)===Tt){var it=Be.revertLane;if(it===0)je!==null&&(je=je.next={lane:0,revertLane:0,action:Be.action,hasEagerState:Be.hasEagerState,eagerState:Be.eagerState,next:null}),Tt===B&&(xt=!0);else if((Ie&it)===it){Be=Be.next,it===B&&(xt=!0);continue}else Tt={lane:0,revertLane:Be.revertLane,action:Be.action,hasEagerState:Be.hasEagerState,eagerState:Be.eagerState,next:null},je===null?(me=je=Tt,W=T):je=je.next=Tt,at.lanes|=it,yu|=it;Tt=Be.action,yt&&d(T,Tt),T=Be.hasEagerState?Be.eagerState:d(T,Tt)}else it={lane:Tt,revertLane:Be.revertLane,action:Be.action,hasEagerState:Be.hasEagerState,eagerState:Be.eagerState,next:null},je===null?(me=je=it,W=T):je=je.next=it,at.lanes|=Tt,yu|=Tt;Be=Be.next}while(Be!==null&&Be!==l);if(je===null?W=T:je.next=me,!On(T,i.memoizedState)&&(ns=!0,xt&&(d=ee,d!==null)))throw d;i.memoizedState=T,i.baseState=W,i.baseQueue=je,m.lastRenderedState=T}return S===null&&(m.lanes=0),[i.memoizedState,m.dispatch]}function Rs(i){var l=Cr(),d=l.queue;if(d===null)throw Error(a(311));d.lastRenderedReducer=i;var m=d.dispatch,S=d.pending,T=l.memoizedState;if(S!==null){d.pending=null;var W=S=S.next;do T=i(T,W.action),W=W.next;while(W!==S);On(T,l.memoizedState)||(ns=!0),l.memoizedState=T,l.baseQueue===null&&(l.baseState=T),d.lastRenderedState=T}return[T,m]}function Hi(i,l,d){var m=at,S=Cr(),T=Zr;if(T){if(d===void 0)throw Error(a(407));d=d()}else d=l();var W=!On((Ke||S).memoizedState,d);if(W&&(S.memoizedState=d,ns=!0),S=S.queue,hf(Ll.bind(null,m,S,i),[i]),S.getSnapshot!==l||W||De!==null&&De.memoizedState.tag&1){if(m.flags|=2048,Ol(9,fo.bind(null,m,S,d,l),{destroy:void 0},null),Fa===null)throw Error(a(349));T||(Ie&60)!==0||Nn(m,l,d)}return d}function Nn(i,l,d){i.flags|=16384,i={getSnapshot:l,value:d},l=at.updateQueue,l===null?(l=Wn(),at.updateQueue=l,l.stores=[i]):(d=l.stores,d===null?l.stores=[i]:d.push(i))}function fo(i,l,d,m){l.value=d,l.getSnapshot=m,dc(l)&&Go(i)}function Ll(i,l,d){return d(function(){dc(l)&&Go(i)})}function dc(i){var l=i.getSnapshot;i=i.value;try{var d=l();return!On(i,d)}catch{return!0}}function Go(i){var l=ci(i,2);l!==null&&fi(l,i,2)}function Da(i){var l=ma();if(typeof i=="function"){var d=i;if(i=d(),yt){Mr(!0);try{d()}finally{Mr(!1)}}}return l.memoizedState=l.baseState=i,l.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ba,lastRenderedState:i},l}function p0(i,l,d,m){return i.baseState=d,$n(i,Ke,typeof m=="function"?m:ba)}function Pp(i,l,d,m,S){if(S0(i))throw Error(a(485));if(i=l.action,i!==null){var T={payload:S,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(W){T.listeners.push(W)}};H.T!==null?d(!0):T.isTransition=!1,m(T),d=l.pending,d===null?(T.next=l.pending=T,Fh(l,T)):(T.next=d.next,l.pending=d.next=T)}}function Fh(i,l){var d=l.action,m=l.payload,S=i.state;if(l.isTransition){var T=H.T,W={};H.T=W;try{var me=d(S,m),je=H.S;je!==null&&je(W,me),lf(i,l,me)}catch(Be){iu(i,l,Be)}finally{H.T=T}}else try{T=d(S,m),lf(i,l,T)}catch(Be){iu(i,l,Be)}}function lf(i,l,d){d!==null&&typeof d=="object"&&typeof d.then=="function"?d.then(function(m){su(i,l,m)},function(m){return iu(i,l,m)}):su(i,l,d)}function su(i,l,d){l.status="fulfilled",l.value=d,Ti(l),i.state=d,l=i.pending,l!==null&&(d=l.next,d===l?i.pending=null:(d=d.next,l.next=d,Fh(i,d)))}function iu(i,l,d){var m=i.pending;if(i.pending=null,m!==null){m=m.next;do l.status="rejected",l.reason=d,Ti(l),l=l.next;while(l!==m)}i.action=null}function Ti(i){i=i.listeners;for(var l=0;l<i.length;l++)(0,i[l])()}function pc(i,l){return l}function mc(i,l){if(Zr){var d=Fa.formState;if(d!==null){e:{var m=at;if(Zr){if(Gn){t:{for(var S=Gn,T=uo;S.nodeType!==8;){if(!T){S=null;break t}if(S=Zo(S.nextSibling),S===null){S=null;break t}}T=S.data,S=T==="F!"||T==="F"?S:null}if(S){Gn=Zo(S.nextSibling),m=S.data==="F!";break e}}Vo(m)}m=!1}m&&(l=d[0])}}return d=ma(),d.memoizedState=d.baseState=l,m={pending:null,lanes:0,dispatch:null,lastRenderedReducer:pc,lastRenderedState:l},d.queue=m,d=Hp.bind(null,at,m),m.dispatch=d,m=Da(!1),T=Ml.bind(null,at,!1,m.queue),m=ma(),S={state:l,dispatch:null,action:i,pending:null},m.queue=S,d=Pp.bind(null,at,S,T,d),S.dispatch=d,m.memoizedState=i,[l,d,!1]}function Ph(i){var l=Cr();return cf(l,Ke,i)}function cf(i,l,d){l=$n(i,l,pc)[0],i=ln(ba)[0],l=typeof l=="object"&&l!==null&&typeof l.then=="function"?Jr(l):l;var m=Cr(),S=m.queue,T=S.dispatch;return d!==m.memoizedState&&(at.flags|=2048,Ol(9,Lp.bind(null,S,d),{destroy:void 0},null)),[l,T,i]}function Lp(i,l){i.action=l}function uf(i){var l=Cr(),d=Ke;if(d!==null)return cf(l,d,i);Cr(),l=l.memoizedState,d=Cr();var m=d.queue.dispatch;return d.memoizedState=i,[l,m,!1]}function Ol(i,l,d,m){return i={tag:i,create:l,inst:d,deps:m,next:null},l=at.updateQueue,l===null&&(l=Wn(),at.updateQueue=l),d=l.lastEffect,d===null?l.lastEffect=i.next=i:(m=d.next,d.next=i,i.next=m,l.lastEffect=i),i}function ff(){return Cr().memoizedState}function Rl(i,l,d,m){var S=ma();at.flags|=i,S.memoizedState=Ol(1|l,d,{destroy:void 0},m===void 0?null:m)}function m0(i,l,d,m){var S=Cr();m=m===void 0?null:m;var T=S.memoizedState.inst;Ke!==null&&m!==null&&Yr(m,Ke.memoizedState.deps)?S.memoizedState=Ol(l,d,T,m):(at.flags|=i,S.memoizedState=Ol(1|l,d,T,m))}function Op(i,l){Rl(8390656,8,i,l)}function hf(i,l){m0(2048,8,i,l)}function Wo(i,l){return m0(4,2,i,l)}function Rp(i,l){return m0(4,4,i,l)}function Mp(i,l){if(typeof l=="function"){i=i();var d=l(i);return function(){typeof d=="function"?d():l(null)}}if(l!=null)return i=i(),l.current=i,function(){l.current=null}}function Ip(i,l,d){d=d!=null?d.concat([i]):null,m0(4,4,Mp.bind(null,l,i),d)}function x0(){}function df(i,l){var d=Cr();l=l===void 0?null:l;var m=d.memoizedState;return l!==null&&Yr(l,m[1])?m[0]:(d.memoizedState=[i,l],i)}function Lh(i,l){var d=Cr();l=l===void 0?null:l;var m=d.memoizedState;if(l!==null&&Yr(l,m[1]))return m[0];if(m=i(),yt){Mr(!0);try{i()}finally{Mr(!1)}}return d.memoizedState=[m,l],m}function g0(i,l,d){return d===void 0||(Ie&1073741824)!==0?i.memoizedState=l:(i.memoizedState=d,i=$5(),at.lanes|=i,yu|=i,d)}function pf(i,l,d,m){return On(d,l)?d:nu.current!==null?(i=g0(i,d,m),On(i,l)||(ns=!0),i):(Ie&42)===0?(ns=!0,i.memoizedState=d):(i=$5(),at.lanes|=i,yu|=i,l)}function v0(i,l,d,m,S){var T=L.p;L.p=T!==0&&8>T?T:8;var W=H.T,me={};H.T=me,Ml(i,!1,l,d);try{var je=S(),Be=H.S;if(Be!==null&&Be(me,je),je!==null&&typeof je=="object"&&typeof je.then=="function"){var xt=he(je,m);ou(i,l,xt,Xi(i))}else ou(i,l,m,Xi(i))}catch(Tt){ou(i,l,{then:function(){},status:"rejected",reason:Tt},Xi())}finally{L.p=T,H.T=W}}function mf(){}function y0(i,l,d,m){if(i.tag!==5)throw Error(a(476));var S=Bp(i).queue;v0(i,S,l,q,d===null?mf:function(){return xf(i),d(m)})}function Bp(i){var l=i.memoizedState;if(l!==null)return l;l={memoizedState:q,baseState:q,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ba,lastRenderedState:q},next:null};var d={};return l.next={memoizedState:d,baseState:d,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ba,lastRenderedState:d},next:null},i.memoizedState=l,i=i.alternate,i!==null&&(i.memoizedState=l),l}function xf(i){var l=Bp(i).next.queue;ou(i,l,{},Xi())}function w0(){return Ms(rd)}function b0(){return Cr().memoizedState}function $o(){return Cr().memoizedState}function Up(i){for(var l=i.return;l!==null;){switch(l.tag){case 24:case 3:var d=Xi();i=du(d);var m=pu(l,i,d);m!==null&&(fi(m,l,d),Bh(m,l,d)),l={cache:d0()},i.payload=l;return}l=l.return}}function zp(i,l,d){var m=Xi();d={lane:m,revertLane:0,action:d,hasEagerState:!1,eagerState:null,next:null},S0(i)?Oh(l,d):(d=lc(i,l,d,m),d!==null&&(fi(d,i,m),Vp(d,l,m)))}function Hp(i,l,d){var m=Xi();ou(i,l,d,m)}function ou(i,l,d,m){var S={lane:m,revertLane:0,action:d,hasEagerState:!1,eagerState:null,next:null};if(S0(i))Oh(l,S);else{var T=i.alternate;if(i.lanes===0&&(T===null||T.lanes===0)&&(T=l.lastRenderedReducer,T!==null))try{var W=l.lastRenderedState,me=T(W,d);if(S.hasEagerState=!0,S.eagerState=me,On(me,W))return Si(i,l,S,0),Fa===null&&$a(),!1}catch{}finally{}if(d=lc(i,l,S,m),d!==null)return fi(d,i,m),Vp(d,l,m),!0}return!1}function Ml(i,l,d,m){if(m={lane:2,revertLane:Wx(),action:m,hasEagerState:!1,eagerState:null,next:null},S0(i)){if(l)throw Error(a(479))}else l=lc(i,d,m,2),l!==null&&fi(l,i,2)}function S0(i){var l=i.alternate;return i===at||l!==null&&l===at}function Oh(i,l){mt=Re=!0;var d=i.pending;d===null?l.next=l:(l.next=d.next,d.next=l),i.pending=l}function Vp(i,l,d){if((d&4194176)!==0){var m=l.lanes;m&=i.pendingLanes,d|=m,l.lanes=d,qa(i,d)}}var Vi={readContext:Ms,use:as,useCallback:Et,useContext:Et,useEffect:Et,useImperativeHandle:Et,useLayoutEffect:Et,useInsertionEffect:Et,useMemo:Et,useReducer:Et,useRef:Et,useState:Et,useDebugValue:Et,useDeferredValue:Et,useTransition:Et,useSyncExternalStore:Et,useId:Et};Vi.useCacheRefresh=Et,Vi.useMemoCache=Et,Vi.useHostTransitionStatus=Et,Vi.useFormState=Et,Vi.useActionState=Et,Vi.useOptimistic=Et;var xc={readContext:Ms,use:as,useCallback:function(i,l){return ma().memoizedState=[i,l===void 0?null:l],i},useContext:Ms,useEffect:Op,useImperativeHandle:function(i,l,d){d=d!=null?d.concat([i]):null,Rl(4194308,4,Mp.bind(null,l,i),d)},useLayoutEffect:function(i,l){return Rl(4194308,4,i,l)},useInsertionEffect:function(i,l){Rl(4,2,i,l)},useMemo:function(i,l){var d=ma();l=l===void 0?null:l;var m=i();if(yt){Mr(!0);try{i()}finally{Mr(!1)}}return d.memoizedState=[m,l],m},useReducer:function(i,l,d){var m=ma();if(d!==void 0){var S=d(l);if(yt){Mr(!0);try{d(l)}finally{Mr(!1)}}}else S=l;return m.memoizedState=m.baseState=S,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:S},m.queue=i,i=i.dispatch=zp.bind(null,at,i),[m.memoizedState,i]},useRef:function(i){var l=ma();return i={current:i},l.memoizedState=i},useState:function(i){i=Da(i);var l=i.queue,d=Hp.bind(null,at,l);return l.dispatch=d,[i.memoizedState,d]},useDebugValue:x0,useDeferredValue:function(i,l){var d=ma();return g0(d,i,l)},useTransition:function(){var i=Da(!1);return i=v0.bind(null,at,i.queue,!0,!1),ma().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,l,d){var m=at,S=ma();if(Zr){if(d===void 0)throw Error(a(407));d=d()}else{if(d=l(),Fa===null)throw Error(a(349));(Qr&60)!==0||Nn(m,l,d)}S.memoizedState=d;var T={value:d,getSnapshot:l};return S.queue=T,Op(Ll.bind(null,m,T,i),[i]),m.flags|=2048,Ol(9,fo.bind(null,m,T,d,l),{destroy:void 0},null),d},useId:function(){var i=ma(),l=Fa.identifierPrefix;if(Zr){var d=Ii,m=Mi;d=(m&~(1<<32-fa(m)-1)).toString(32)+d,l=":"+l+"R"+d,d=gt++,0<d&&(l+="H"+d.toString(32)),l+=":"}else d=fr++,l=":"+l+"r"+d.toString(32)+":";return i.memoizedState=l},useCacheRefresh:function(){return ma().memoizedState=Up.bind(null,at)}};xc.useMemoCache=xs,xc.useHostTransitionStatus=w0,xc.useFormState=mc,xc.useActionState=mc,xc.useOptimistic=function(i){var l=ma();l.memoizedState=l.baseState=i;var d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return l.queue=d,l=Ml.bind(null,at,!0,d),d.dispatch=l,[i,l]};var ki={readContext:Ms,use:as,useCallback:df,useContext:Ms,useEffect:hf,useImperativeHandle:Ip,useInsertionEffect:Wo,useLayoutEffect:Rp,useMemo:Lh,useReducer:ln,useRef:ff,useState:function(){return ln(ba)},useDebugValue:x0,useDeferredValue:function(i,l){var d=Cr();return pf(d,Ke.memoizedState,i,l)},useTransition:function(){var i=ln(ba)[0],l=Cr().memoizedState;return[typeof i=="boolean"?i:Jr(i),l]},useSyncExternalStore:Hi,useId:b0};ki.useCacheRefresh=$o,ki.useMemoCache=xs,ki.useHostTransitionStatus=w0,ki.useFormState=Ph,ki.useActionState=Ph,ki.useOptimistic=function(i,l){var d=Cr();return p0(d,Ke,i,l)};var Xo={readContext:Ms,use:as,useCallback:df,useContext:Ms,useEffect:hf,useImperativeHandle:Ip,useInsertionEffect:Wo,useLayoutEffect:Rp,useMemo:Lh,useReducer:Rs,useRef:ff,useState:function(){return Rs(ba)},useDebugValue:x0,useDeferredValue:function(i,l){var d=Cr();return Ke===null?g0(d,i,l):pf(d,Ke.memoizedState,i,l)},useTransition:function(){var i=Rs(ba)[0],l=Cr().memoizedState;return[typeof i=="boolean"?i:Jr(i),l]},useSyncExternalStore:Hi,useId:b0};Xo.useCacheRefresh=$o,Xo.useMemoCache=xs,Xo.useHostTransitionStatus=w0,Xo.useFormState=uf,Xo.useActionState=uf,Xo.useOptimistic=function(i,l){var d=Cr();return Ke!==null?p0(d,Ke,i,l):(d.baseState=i,[i,d.queue.dispatch])};function lu(i,l,d,m){l=i.memoizedState,d=d(m,l),d=d==null?l:re({},l,d),i.memoizedState=d,i.lanes===0&&(i.updateQueue.baseState=d)}var qi={isMounted:function(i){return(i=i._reactInternals)?te(i)===i:!1},enqueueSetState:function(i,l,d){i=i._reactInternals;var m=Xi(),S=du(m);S.payload=l,d!=null&&(S.callback=d),l=pu(i,S,m),l!==null&&(fi(l,i,m),Bh(l,i,m))},enqueueReplaceState:function(i,l,d){i=i._reactInternals;var m=Xi(),S=du(m);S.tag=1,S.payload=l,d!=null&&(S.callback=d),l=pu(i,S,m),l!==null&&(fi(l,i,m),Bh(l,i,m))},enqueueForceUpdate:function(i,l){i=i._reactInternals;var d=Xi(),m=du(d);m.tag=2,l!=null&&(m.callback=l),l=pu(i,m,d),l!==null&&(fi(l,i,d),Bh(l,i,d))}};function Yo(i,l,d,m,S,T,W){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(m,T,W):l.prototype&&l.prototype.isPureReactComponent?!Nl(d,m)||!Nl(S,T):!0}function Jo(i,l,d,m){i=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(d,m),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(d,m),l.state!==i&&qi.enqueueReplaceState(l,l.state,null)}function ho(i,l){var d=l;if("ref"in l){d={};for(var m in l)m!=="ref"&&(d[m]=l[m])}if(i=i.defaultProps){d===l&&(d=re({},d));for(var S in i)d[S]===void 0&&(d[S]=i[S])}return d}var cu=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var l=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(l))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)};function Rh(i){cu(i)}function qp(i){console.error(i)}function N0(i){cu(i)}function uu(i,l){try{var d=i.onUncaughtError;d(l.value,{componentStack:l.stack})}catch(m){setTimeout(function(){throw m})}}function i5(i,l,d){try{var m=i.onCaughtError;m(d.value,{componentStack:d.stack,errorBoundary:l.tag===1?l.stateNode:null})}catch(S){setTimeout(function(){throw S})}}function ix(i,l,d){return d=du(d),d.tag=3,d.payload={element:null},d.callback=function(){uu(i,l)},d}function o5(i){return i=du(i),i.tag=3,i}function l5(i,l,d,m){var S=d.type.getDerivedStateFromError;if(typeof S=="function"){var T=m.value;i.payload=function(){return S(T)},i.callback=function(){i5(l,d,m)}}var W=d.stateNode;W!==null&&typeof W.componentDidCatch=="function"&&(i.callback=function(){i5(l,d,m),typeof S!="function"&&(wu===null?wu=new Set([this]):wu.add(this));var me=m.stack;this.componentDidCatch(m.value,{componentStack:me!==null?me:""})})}function zT(i,l,d,m,S){if(d.flags|=32768,m!==null&&typeof m=="object"&&typeof m.then=="function"){if(l=d.alternate,l!==null&&Ih(l,d,S,!0),d=_i.current,d!==null){switch(d.tag){case 13:return zi===null?zx():d.alternate===null&&un===0&&(un=3),d.flags&=-257,d.flags|=65536,d.lanes=S,m===Eh?d.flags|=16384:(l=d.updateQueue,l===null?d.updateQueue=new Set([m]):l.add(m),Vx(i,m,S)),!1;case 22:return d.flags|=65536,m===Eh?d.flags|=16384:(l=d.updateQueue,l===null?(l={transitions:null,markerInstances:null,retryQueue:new Set([m])},d.updateQueue=l):(d=l.retryQueue,d===null?l.retryQueue=new Set([m]):d.add(m)),Vx(i,m,S)),!1}throw Error(a(435,d.tag))}return Vx(i,m,S),zx(),!1}if(Zr)return l=_i.current,l!==null?((l.flags&65536)===0&&(l.flags|=256),l.flags|=65536,l.lanes=S,m!==kh&&(i=Error(a(422),{cause:m}),au(Ba(i,d)))):(m!==kh&&(l=Error(a(423),{cause:m}),au(Ba(l,d))),i=i.current.alternate,i.flags|=65536,S&=-S,i.lanes|=S,m=Ba(m,d),S=ix(i.stateNode,m,S),bx(i,S),un!==4&&(un=2)),!1;var T=Error(a(520),{cause:m});if(T=Ba(T,d),$h===null?$h=[T]:$h.push(T),un!==4&&(un=2),l===null)return!0;m=Ba(m,d),d=l;do{switch(d.tag){case 3:return d.flags|=65536,i=S&-S,d.lanes|=i,i=ix(d.stateNode,m,i),bx(d,i),!1;case 1:if(l=d.type,T=d.stateNode,(d.flags&128)===0&&(typeof l.getDerivedStateFromError=="function"||T!==null&&typeof T.componentDidCatch=="function"&&(wu===null||!wu.has(T))))return d.flags|=65536,S&=-S,d.lanes|=S,S=o5(S),l5(S,i,d,m),bx(d,S),!1}d=d.return}while(d!==null);return!1}var c5=Error(a(461)),ns=!1;function gs(i,l,d,m){l.child=i===null?Dh(l,null,d,m):Dl(l,i.child,d,m)}function u5(i,l,d,m,S){d=d.render;var T=l.ref;if("ref"in m){var W={};for(var me in m)me!=="ref"&&(W[me]=m[me])}else W=m;return vf(l),m=ta(i,l,d,W,T,S),me=sa(),i!==null&&!ns?(Nr(i,l,S),gc(i,l,S)):(Zr&&me&&_h(l),l.flags|=1,gs(i,l,m,S),l.child)}function f5(i,l,d,m,S){if(i===null){var T=d.type;return typeof T=="function"&&!jx(T)&&T.defaultProps===void 0&&d.compare===null?(l.tag=15,l.type=T,h5(i,l,T,m,S)):(i=Yp(d.type,null,m,l,l.mode,S),i.ref=l.ref,i.return=l,l.child=i)}if(T=i.child,!mx(i,S)){var W=T.memoizedProps;if(d=d.compare,d=d!==null?d:Nl,d(W,m)&&i.ref===l.ref)return gc(i,l,S)}return l.flags|=1,i=vu(T,m),i.ref=l.ref,i.return=l,l.child=i}function h5(i,l,d,m,S){if(i!==null){var T=i.memoizedProps;if(Nl(T,m)&&i.ref===l.ref)if(ns=!1,l.pendingProps=m=T,mx(i,S))(i.flags&131072)!==0&&(ns=!0);else return l.lanes=i.lanes,gc(i,l,S)}return ox(i,l,d,m,S)}function d5(i,l,d){var m=l.pendingProps,S=m.children,T=(l.stateNode._pendingVisibility&2)!==0,W=i!==null?i.memoizedState:null;if(Mh(i,l),m.mode==="hidden"||T){if((l.flags&128)!==0){if(m=W!==null?W.baseLanes|d:d,i!==null){for(S=l.child=i.child,T=0;S!==null;)T=T|S.lanes|S.childLanes,S=S.sibling;l.childLanes=T&~m}else l.childLanes=0,l.child=null;return p5(i,l,m,d)}if((d&536870912)!==0)l.memoizedState={baseLanes:0,cachePool:null},i!==null&&Je(l,W!==null?W.cachePool:null),W!==null?sf(l,W):hc(),Dp(l);else return l.lanes=l.childLanes=536870912,p5(i,l,W!==null?W.baseLanes|d:d,d)}else W!==null?(Je(l,W.cachePool),sf(l,W),Pl(),l.memoizedState=null):(i!==null&&Je(l,null),hc(),Pl());return gs(i,l,S,d),l.child}function p5(i,l,d,m){var S=Le();return S=S===null?null:{parent:Sn._currentValue,pool:S},l.memoizedState={baseLanes:d,cachePool:S},i!==null&&Je(l,null),hc(),Dp(l),i!==null&&Ih(i,l,m,!0),null}function Mh(i,l){var d=l.ref;if(d===null)i!==null&&i.ref!==null&&(l.flags|=2097664);else{if(typeof d!="function"&&typeof d!="object")throw Error(a(284));(i===null||i.ref!==d)&&(l.flags|=2097664)}}function ox(i,l,d,m,S){return vf(l),d=ta(i,l,d,m,void 0,S),m=sa(),i!==null&&!ns?(Nr(i,l,S),gc(i,l,S)):(Zr&&m&&_h(l),l.flags|=1,gs(i,l,d,S),l.child)}function m5(i,l,d,m,S,T){return vf(l),l.updateQueue=null,d=Or(l,m,d,S),$r(i),m=sa(),i!==null&&!ns?(Nr(i,l,T),gc(i,l,T)):(Zr&&m&&_h(l),l.flags|=1,gs(i,l,d,T),l.child)}function x5(i,l,d,m,S){if(vf(l),l.stateNode===null){var T=Uo,W=d.contextType;typeof W=="object"&&W!==null&&(T=Ms(W)),T=new d(m,T),l.memoizedState=T.state!==null&&T.state!==void 0?T.state:null,T.updater=qi,l.stateNode=T,T._reactInternals=l,T=l.stateNode,T.props=m,T.state=l.memoizedState,T.refs={},yx(l),W=d.contextType,T.context=typeof W=="object"&&W!==null?Ms(W):Uo,T.state=l.memoizedState,W=d.getDerivedStateFromProps,typeof W=="function"&&(lu(l,d,W,m),T.state=l.memoizedState),typeof d.getDerivedStateFromProps=="function"||typeof T.getSnapshotBeforeUpdate=="function"||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(W=T.state,typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount(),W!==T.state&&qi.enqueueReplaceState(T,T.state,null),zh(l,m,T,S),Uh(),T.state=l.memoizedState),typeof T.componentDidMount=="function"&&(l.flags|=4194308),m=!0}else if(i===null){T=l.stateNode;var me=l.memoizedProps,je=ho(d,me);T.props=je;var Be=T.context,xt=d.contextType;W=Uo,typeof xt=="object"&&xt!==null&&(W=Ms(xt));var Tt=d.getDerivedStateFromProps;xt=typeof Tt=="function"||typeof T.getSnapshotBeforeUpdate=="function",me=l.pendingProps!==me,xt||typeof T.UNSAFE_componentWillReceiveProps!="function"&&typeof T.componentWillReceiveProps!="function"||(me||Be!==W)&&Jo(l,T,m,W),hu=!1;var it=l.memoizedState;T.state=it,zh(l,m,T,S),Uh(),Be=l.memoizedState,me||it!==Be||hu?(typeof Tt=="function"&&(lu(l,d,Tt,m),Be=l.memoizedState),(je=hu||Yo(l,d,je,m,it,Be,W))?(xt||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount()),typeof T.componentDidMount=="function"&&(l.flags|=4194308)):(typeof T.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=m,l.memoizedState=Be),T.props=m,T.state=Be,T.context=W,m=je):(typeof T.componentDidMount=="function"&&(l.flags|=4194308),m=!1)}else{T=l.stateNode,wx(i,l),W=l.memoizedProps,xt=ho(d,W),T.props=xt,Tt=l.pendingProps,it=T.context,Be=d.contextType,je=Uo,typeof Be=="object"&&Be!==null&&(je=Ms(Be)),me=d.getDerivedStateFromProps,(Be=typeof me=="function"||typeof T.getSnapshotBeforeUpdate=="function")||typeof T.UNSAFE_componentWillReceiveProps!="function"&&typeof T.componentWillReceiveProps!="function"||(W!==Tt||it!==je)&&Jo(l,T,m,je),hu=!1,it=l.memoizedState,T.state=it,zh(l,m,T,S),Uh();var dt=l.memoizedState;W!==Tt||it!==dt||hu||i!==null&&i.dependencies!==null&&Gp(i.dependencies)?(typeof me=="function"&&(lu(l,d,me,m),dt=l.memoizedState),(xt=hu||Yo(l,d,xt,m,it,dt,je)||i!==null&&i.dependencies!==null&&Gp(i.dependencies))?(Be||typeof T.UNSAFE_componentWillUpdate!="function"&&typeof T.componentWillUpdate!="function"||(typeof T.componentWillUpdate=="function"&&T.componentWillUpdate(m,dt,je),typeof T.UNSAFE_componentWillUpdate=="function"&&T.UNSAFE_componentWillUpdate(m,dt,je)),typeof T.componentDidUpdate=="function"&&(l.flags|=4),typeof T.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof T.componentDidUpdate!="function"||W===i.memoizedProps&&it===i.memoizedState||(l.flags|=4),typeof T.getSnapshotBeforeUpdate!="function"||W===i.memoizedProps&&it===i.memoizedState||(l.flags|=1024),l.memoizedProps=m,l.memoizedState=dt),T.props=m,T.state=dt,T.context=je,m=xt):(typeof T.componentDidUpdate!="function"||W===i.memoizedProps&&it===i.memoizedState||(l.flags|=4),typeof T.getSnapshotBeforeUpdate!="function"||W===i.memoizedProps&&it===i.memoizedState||(l.flags|=1024),m=!1)}return T=m,Mh(i,l),m=(l.flags&128)!==0,T||m?(T=l.stateNode,d=m&&typeof d.getDerivedStateFromError!="function"?null:T.render(),l.flags|=1,i!==null&&m?(l.child=Dl(l,i.child,null,S),l.child=Dl(l,null,d,S)):gs(i,l,d,S),l.memoizedState=T.state,i=l.child):i=gc(i,l,S),i}function g5(i,l,d,m){return rf(),l.flags|=256,gs(i,l,d,m),l.child}var lx={dehydrated:null,treeContext:null,retryLane:0};function cx(i){return{baseLanes:i,cachePool:Ze()}}function ux(i,l,d){return i=i!==null?i.childLanes&~d:0,l&&(i|=go),i}function v5(i,l,d){var m=l.pendingProps,S=!1,T=(l.flags&128)!==0,W;if((W=T)||(W=i!==null&&i.memoizedState===null?!1:(bn.current&2)!==0),W&&(S=!0,l.flags&=-129),W=(l.flags&32)!==0,l.flags&=-33,i===null){if(Zr){if(S?Fl(l):Pl(),Zr){var me=Gn,je;if(je=me){e:{for(je=me,me=uo;je.nodeType!==8;){if(!me){me=null;break e}if(je=Zo(je.nextSibling),je===null){me=null;break e}}me=je}me!==null?(l.memoizedState={dehydrated:me,treeContext:Cl!==null?{id:Mi,overflow:Ii}:null,retryLane:536870912},je=xo(18,null,null,0),je.stateNode=me,je.return=l,l.child=je,rs=l,Gn=null,je=!0):je=!1}je||Vo(l)}if(me=l.memoizedState,me!==null&&(me=me.dehydrated,me!==null))return me.data==="$!"?l.lanes=16:l.lanes=536870912,null;qo(l)}return me=m.children,m=m.fallback,S?(Pl(),S=l.mode,me=hx({mode:"hidden",children:me},S),m=wf(m,S,d,null),me.return=l,m.return=l,me.sibling=m,l.child=me,S=l.child,S.memoizedState=cx(d),S.childLanes=ux(i,W,d),l.memoizedState=lx,m):(Fl(l),fx(l,me))}if(je=i.memoizedState,je!==null&&(me=je.dehydrated,me!==null)){if(T)l.flags&256?(Fl(l),l.flags&=-257,l=dx(i,l,d)):l.memoizedState!==null?(Pl(),l.child=i.child,l.flags|=128,l=null):(Pl(),S=m.fallback,me=l.mode,m=hx({mode:"visible",children:m.children},me),S=wf(S,me,d,null),S.flags|=2,m.return=l,S.return=l,m.sibling=S,l.child=m,Dl(l,i.child,null,d),m=l.child,m.memoizedState=cx(d),m.childLanes=ux(i,W,d),l.memoizedState=lx,l=S);else if(Fl(l),me.data==="$!"){if(W=me.nextSibling&&me.nextSibling.dataset,W)var Be=W.dgst;W=Be,m=Error(a(419)),m.stack="",m.digest=W,au({value:m,source:null,stack:null}),l=dx(i,l,d)}else if(ns||Ih(i,l,d,!1),W=(d&i.childLanes)!==0,ns||W){if(W=Fa,W!==null){if(m=d&-d,(m&42)!==0)m=1;else switch(m){case 2:m=1;break;case 8:m=4;break;case 32:m=16;break;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:m=64;break;case 268435456:m=134217728;break;default:m=0}if(m=(m&(W.suspendedLanes|d))!==0?0:m,m!==0&&m!==je.retryLane)throw je.retryLane=m,ci(i,m),fi(W,i,m),c5}me.data==="$?"||zx(),l=dx(i,l,d)}else me.data==="$?"?(l.flags|=128,l.child=i.child,l=rk.bind(null,i),me._reactRetry=l,l=null):(i=je.treeContext,Gn=Zo(me.nextSibling),rs=l,Zr=!0,Bi=null,uo=!1,i!==null&&(ps[Os++]=Mi,ps[Os++]=Ii,ps[Os++]=Cl,Mi=i.id,Ii=i.overflow,Cl=l),l=fx(l,m.children),l.flags|=4096);return l}return S?(Pl(),S=m.fallback,me=l.mode,je=i.child,Be=je.sibling,m=vu(je,{mode:"hidden",children:m.children}),m.subtreeFlags=je.subtreeFlags&31457280,Be!==null?S=vu(Be,S):(S=wf(S,me,d,null),S.flags|=2),S.return=l,m.return=l,m.sibling=S,l.child=m,m=S,S=l.child,me=i.child.memoizedState,me===null?me=cx(d):(je=me.cachePool,je!==null?(Be=Sn._currentValue,je=je.parent!==Be?{parent:Be,pool:Be}:je):je=Ze(),me={baseLanes:me.baseLanes|d,cachePool:je}),S.memoizedState=me,S.childLanes=ux(i,W,d),l.memoizedState=lx,m):(Fl(l),d=i.child,i=d.sibling,d=vu(d,{mode:"visible",children:m.children}),d.return=l,d.sibling=null,i!==null&&(W=l.deletions,W===null?(l.deletions=[i],l.flags|=16):W.push(i)),l.child=d,l.memoizedState=null,d)}function fx(i,l){return l=hx({mode:"visible",children:l},i.mode),l.return=i,i.child=l}function hx(i,l){return q5(i,l,0,null)}function dx(i,l,d){return Dl(l,i.child,null,d),i=fx(l,l.pendingProps.children),i.flags|=2,l.memoizedState=null,i}function y5(i,l,d){i.lanes|=l;var m=i.alternate;m!==null&&(m.lanes|=l),gx(i.return,l,d)}function px(i,l,d,m,S){var T=i.memoizedState;T===null?i.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:m,tail:d,tailMode:S}:(T.isBackwards=l,T.rendering=null,T.renderingStartTime=0,T.last=m,T.tail=d,T.tailMode=S)}function w5(i,l,d){var m=l.pendingProps,S=m.revealOrder,T=m.tail;if(gs(i,l,m.children,d),m=bn.current,(m&2)!==0)m=m&1|2,l.flags|=128;else{if(i!==null&&(i.flags&128)!==0)e:for(i=l.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&y5(i,d,l);else if(i.tag===19)y5(i,d,l);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===l)break e;for(;i.sibling===null;){if(i.return===null||i.return===l)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}m&=1}switch(fe(bn,m),S){case"forwards":for(d=l.child,S=null;d!==null;)i=d.alternate,i!==null&&f0(i)===null&&(S=d),d=d.sibling;d=S,d===null?(S=l.child,l.child=null):(S=d.sibling,d.sibling=null),px(l,!1,S,d,T);break;case"backwards":for(d=null,S=l.child,l.child=null;S!==null;){if(i=S.alternate,i!==null&&f0(i)===null){l.child=S;break}i=S.sibling,S.sibling=d,d=S,S=i}px(l,!0,d,null,T);break;case"together":px(l,!1,null,null,void 0);break;default:l.memoizedState=null}return l.child}function gc(i,l,d){if(i!==null&&(l.dependencies=i.dependencies),yu|=l.lanes,(d&l.childLanes)===0)if(i!==null){if(Ih(i,l,d,!1),(d&l.childLanes)===0)return null}else return null;if(i!==null&&l.child!==i.child)throw Error(a(153));if(l.child!==null){for(i=l.child,d=vu(i,i.pendingProps),l.child=d,d.return=l;i.sibling!==null;)i=i.sibling,d=d.sibling=vu(i,i.pendingProps),d.return=l;d.sibling=null}return l.child}function mx(i,l){return(i.lanes&l)!==0?!0:(i=i.dependencies,!!(i!==null&&Gp(i)))}function HT(i,l,d){switch(l.tag){case 3:ke(l,l.stateNode.containerInfo),fu(l,Sn,i.memoizedState.cache),rf();break;case 27:case 5:rt(l);break;case 4:ke(l,l.stateNode.containerInfo);break;case 10:fu(l,l.type,l.memoizedProps.value);break;case 13:var m=l.memoizedState;if(m!==null)return m.dehydrated!==null?(Fl(l),l.flags|=128,null):(d&l.child.childLanes)!==0?v5(i,l,d):(Fl(l),i=gc(i,l,d),i!==null?i.sibling:null);Fl(l);break;case 19:var S=(i.flags&128)!==0;if(m=(d&l.childLanes)!==0,m||(Ih(i,l,d,!1),m=(d&l.childLanes)!==0),S){if(m)return w5(i,l,d);l.flags|=128}if(S=l.memoizedState,S!==null&&(S.rendering=null,S.tail=null,S.lastEffect=null),fe(bn,bn.current),m)break;return null;case 22:case 23:return l.lanes=0,d5(i,l,d);case 24:fu(l,Sn,i.memoizedState.cache)}return gc(i,l,d)}function b5(i,l,d){if(i!==null)if(i.memoizedProps!==l.pendingProps)ns=!0;else{if(!mx(i,d)&&(l.flags&128)===0)return ns=!1,HT(i,l,d);ns=(i.flags&131072)!==0}else ns=!1,Zr&&(l.flags&1048576)!==0&&l0(l,cc,l.index);switch(l.lanes=0,l.tag){case 16:e:{i=l.pendingProps;var m=l.elementType,S=m._init;if(m=S(m._payload),l.type=m,typeof m=="function")jx(m)?(i=ho(m,i),l.tag=1,l=x5(null,l,m,i,d)):(l.tag=0,l=ox(null,l,m,i,d));else{if(m!=null){if(S=m.$$typeof,S===w){l.tag=11,l=u5(null,l,m,i,d);break e}else if(S===_){l.tag=14,l=f5(null,l,m,i,d);break e}}throw l=z(m)||m,Error(a(306,l,""))}}return l;case 0:return ox(i,l,l.type,l.pendingProps,d);case 1:return m=l.type,S=ho(m,l.pendingProps),x5(i,l,m,S,d);case 3:e:{if(ke(l,l.stateNode.containerInfo),i===null)throw Error(a(387));var T=l.pendingProps;S=l.memoizedState,m=S.element,wx(i,l),zh(l,T,null,d);var W=l.memoizedState;if(T=W.cache,fu(l,Sn,T),T!==S.cache&&vx(l,[Sn],d,!0),Uh(),T=W.element,S.isDehydrated)if(S={element:T,isDehydrated:!1,cache:W.cache},l.updateQueue.baseState=S,l.memoizedState=S,l.flags&256){l=g5(i,l,T,d);break e}else if(T!==m){m=Ba(Error(a(424)),l),au(m),l=g5(i,l,T,d);break e}else for(Gn=Zo(l.stateNode.containerInfo.firstChild),rs=l,Zr=!0,Bi=null,uo=!0,d=Dh(l,null,T,d),l.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling;else{if(rf(),T===m){l=gc(i,l,d);break e}gs(i,l,T,d)}l=l.child}return l;case 26:return Mh(i,l),i===null?(d=Aw(l.type,null,l.pendingProps,null))?l.memoizedState=d:Zr||(d=l.type,i=l.pendingProps,m=om(Pe.current).createElement(d),m[pe]=l,m[ge]=i,vs(m,d,i),Ce(m),l.stateNode=m):l.memoizedState=Aw(l.type,i.memoizedProps,l.pendingProps,i.memoizedState),null;case 27:return rt(l),i===null&&Zr&&(m=l.stateNode=bw(l.type,l.pendingProps,Pe.current),rs=l,uo=!0,Gn=Zo(m.firstChild)),m=l.pendingProps.children,i!==null||Zr?gs(i,l,m,d):l.child=Dl(l,null,m,d),Mh(i,l),l.child;case 5:return i===null&&Zr&&((S=m=Gn)&&(m=vk(m,l.type,l.pendingProps,uo),m!==null?(l.stateNode=m,rs=l,Gn=Zo(m.firstChild),uo=!1,S=!0):S=!1),S||Vo(l)),rt(l),S=l.type,T=l.pendingProps,W=i!==null?i.memoizedProps:null,m=T.children,tg(S,T)?m=null:W!==null&&tg(S,W)&&(l.flags|=32),l.memoizedState!==null&&(S=ta(i,l,pa,null,null,d),rd._currentValue=S),Mh(i,l),gs(i,l,m,d),l.child;case 6:return i===null&&Zr&&((i=d=Gn)&&(d=yk(d,l.pendingProps,uo),d!==null?(l.stateNode=d,rs=l,Gn=null,i=!0):i=!1),i||Vo(l)),null;case 13:return v5(i,l,d);case 4:return ke(l,l.stateNode.containerInfo),m=l.pendingProps,i===null?l.child=Dl(l,null,m,d):gs(i,l,m,d),l.child;case 11:return u5(i,l,l.type,l.pendingProps,d);case 7:return gs(i,l,l.pendingProps,d),l.child;case 8:return gs(i,l,l.pendingProps.children,d),l.child;case 12:return gs(i,l,l.pendingProps.children,d),l.child;case 10:return m=l.pendingProps,fu(l,l.type,m.value),gs(i,l,m.children,d),l.child;case 9:return S=l.type._context,m=l.pendingProps.children,vf(l),S=Ms(S),m=m(S),l.flags|=1,gs(i,l,m,d),l.child;case 14:return f5(i,l,l.type,l.pendingProps,d);case 15:return h5(i,l,l.type,l.pendingProps,d);case 19:return w5(i,l,d);case 22:return d5(i,l,d);case 24:return vf(l),m=Ms(Sn),i===null?(S=Le(),S===null&&(S=Fa,T=d0(),S.pooledCache=T,T.refCount++,T!==null&&(S.pooledCacheLanes|=d),S=T),l.memoizedState={parent:m,cache:S},yx(l),fu(l,Sn,S)):((i.lanes&d)!==0&&(wx(i,l),zh(l,null,null,d),Uh()),S=i.memoizedState,T=l.memoizedState,S.parent!==m?(S={parent:m,cache:m},l.memoizedState=S,l.lanes===0&&(l.memoizedState=l.updateQueue.baseState=S),fu(l,Sn,m)):(m=T.cache,fu(l,Sn,m),m!==S.cache&&vx(l,[Sn],d,!0))),gs(i,l,l.pendingProps.children,d),l.child;case 29:throw l.pendingProps}throw Error(a(156,l.tag))}var xx=ve(null),gf=null,vc=null;function fu(i,l,d){fe(xx,l._currentValue),l._currentValue=d}function yc(i){i._currentValue=xx.current,ue(xx)}function gx(i,l,d){for(;i!==null;){var m=i.alternate;if((i.childLanes&l)!==l?(i.childLanes|=l,m!==null&&(m.childLanes|=l)):m!==null&&(m.childLanes&l)!==l&&(m.childLanes|=l),i===d)break;i=i.return}}function vx(i,l,d,m){var S=i.child;for(S!==null&&(S.return=i);S!==null;){var T=S.dependencies;if(T!==null){var W=S.child;T=T.firstContext;e:for(;T!==null;){var me=T;T=S;for(var je=0;je<l.length;je++)if(me.context===l[je]){T.lanes|=d,me=T.alternate,me!==null&&(me.lanes|=d),gx(T.return,d,i),m||(W=null);break e}T=me.next}}else if(S.tag===18){if(W=S.return,W===null)throw Error(a(341));W.lanes|=d,T=W.alternate,T!==null&&(T.lanes|=d),gx(W,d,i),W=null}else W=S.child;if(W!==null)W.return=S;else for(W=S;W!==null;){if(W===i){W=null;break}if(S=W.sibling,S!==null){S.return=W.return,W=S;break}W=W.return}S=W}}function Ih(i,l,d,m){i=null;for(var S=l,T=!1;S!==null;){if(!T){if((S.flags&524288)!==0)T=!0;else if((S.flags&262144)!==0)break}if(S.tag===10){var W=S.alternate;if(W===null)throw Error(a(387));if(W=W.memoizedProps,W!==null){var me=S.type;On(S.pendingProps.value,W.value)||(i!==null?i.push(me):i=[me])}}else if(S===st.current){if(W=S.alternate,W===null)throw Error(a(387));W.memoizedState.memoizedState!==S.memoizedState.memoizedState&&(i!==null?i.push(rd):i=[rd])}S=S.return}i!==null&&vx(l,i,d,m),l.flags|=262144}function Gp(i){for(i=i.firstContext;i!==null;){if(!On(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function vf(i){gf=i,vc=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function Ms(i){return S5(gf,i)}function Wp(i,l){return gf===null&&vf(i),S5(i,l)}function S5(i,l){var d=l._currentValue;if(l={context:l,memoizedValue:d,next:null},vc===null){if(i===null)throw Error(a(308));vc=l,i.dependencies={lanes:0,firstContext:l},i.flags|=524288}else vc=vc.next=l;return d}var hu=!1;function yx(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function wx(i,l){i=i.updateQueue,l.updateQueue===i&&(l.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function du(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function pu(i,l,d){var m=i.updateQueue;if(m===null)return null;if(m=m.shared,(rn&2)!==0){var S=m.pending;return S===null?l.next=l:(l.next=S.next,S.next=l),m.pending=l,l=tu(i),Qu(i,null,d),l}return Si(i,m,l,d),tu(i)}function Bh(i,l,d){if(l=l.updateQueue,l!==null&&(l=l.shared,(d&4194176)!==0)){var m=l.lanes;m&=i.pendingLanes,d|=m,l.lanes=d,qa(i,d)}}function bx(i,l){var d=i.updateQueue,m=i.alternate;if(m!==null&&(m=m.updateQueue,d===m)){var S=null,T=null;if(d=d.firstBaseUpdate,d!==null){do{var W={lane:d.lane,tag:d.tag,payload:d.payload,callback:null,next:null};T===null?S=T=W:T=T.next=W,d=d.next}while(d!==null);T===null?S=T=l:T=T.next=l}else S=T=l;d={baseState:m.baseState,firstBaseUpdate:S,lastBaseUpdate:T,shared:m.shared,callbacks:m.callbacks},i.updateQueue=d;return}i=d.lastBaseUpdate,i===null?d.firstBaseUpdate=l:i.next=l,d.lastBaseUpdate=l}var Sx=!1;function Uh(){if(Sx){var i=ee;if(i!==null)throw i}}function zh(i,l,d,m){Sx=!1;var S=i.updateQueue;hu=!1;var T=S.firstBaseUpdate,W=S.lastBaseUpdate,me=S.shared.pending;if(me!==null){S.shared.pending=null;var je=me,Be=je.next;je.next=null,W===null?T=Be:W.next=Be,W=je;var xt=i.alternate;xt!==null&&(xt=xt.updateQueue,me=xt.lastBaseUpdate,me!==W&&(me===null?xt.firstBaseUpdate=Be:me.next=Be,xt.lastBaseUpdate=je))}if(T!==null){var Tt=S.baseState;W=0,xt=Be=je=null,me=T;do{var it=me.lane&-536870913,dt=it!==me.lane;if(dt?(Qr&it)===it:(m&it)===it){it!==0&&it===B&&(Sx=!0),xt!==null&&(xt=xt.next={lane:0,tag:me.tag,payload:me.payload,callback:null,next:null});e:{var ar=i,_r=me;it=l;var fn=d;switch(_r.tag){case 1:if(ar=_r.payload,typeof ar=="function"){Tt=ar.call(fn,Tt,it);break e}Tt=ar;break e;case 3:ar.flags=ar.flags&-65537|128;case 0:if(ar=_r.payload,it=typeof ar=="function"?ar.call(fn,Tt,it):ar,it==null)break e;Tt=re({},Tt,it);break e;case 2:hu=!0}}it=me.callback,it!==null&&(i.flags|=64,dt&&(i.flags|=8192),dt=S.callbacks,dt===null?S.callbacks=[it]:dt.push(it))}else dt={lane:it,tag:me.tag,payload:me.payload,callback:me.callback,next:null},xt===null?(Be=xt=dt,je=Tt):xt=xt.next=dt,W|=it;if(me=me.next,me===null){if(me=S.shared.pending,me===null)break;dt=me,me=dt.next,dt.next=null,S.lastBaseUpdate=dt,S.shared.pending=null}}while(!0);xt===null&&(je=Tt),S.baseState=je,S.firstBaseUpdate=Be,S.lastBaseUpdate=xt,T===null&&(S.shared.lanes=0),yu|=W,i.lanes=W,i.memoizedState=Tt}}function N5(i,l){if(typeof i!="function")throw Error(a(191,i));i.call(l)}function A5(i,l){var d=i.callbacks;if(d!==null)for(i.callbacks=null,i=0;i<d.length;i++)N5(d[i],l)}function Hh(i,l){try{var d=l.updateQueue,m=d!==null?d.lastEffect:null;if(m!==null){var S=m.next;d=S;do{if((d.tag&i)===i){m=void 0;var T=d.create,W=d.inst;m=T(),W.destroy=m}d=d.next}while(d!==S)}}catch(me){_a(l,l.return,me)}}function mu(i,l,d){try{var m=l.updateQueue,S=m!==null?m.lastEffect:null;if(S!==null){var T=S.next;m=T;do{if((m.tag&i)===i){var W=m.inst,me=W.destroy;if(me!==void 0){W.destroy=void 0,S=l;var je=d;try{me()}catch(Be){_a(S,je,Be)}}}m=m.next}while(m!==T)}}catch(Be){_a(l,l.return,Be)}}function _5(i){var l=i.updateQueue;if(l!==null){var d=i.stateNode;try{A5(l,d)}catch(m){_a(i,i.return,m)}}}function T5(i,l,d){d.props=ho(i.type,i.memoizedProps),d.state=i.memoizedState;try{d.componentWillUnmount()}catch(m){_a(i,l,m)}}function yf(i,l){try{var d=i.ref;if(d!==null){var m=i.stateNode;switch(i.tag){case 26:case 27:case 5:var S=m;break;default:S=m}typeof d=="function"?i.refCleanup=d(S):d.current=S}}catch(T){_a(i,l,T)}}function Gi(i,l){var d=i.ref,m=i.refCleanup;if(d!==null)if(typeof m=="function")try{m()}catch(S){_a(i,l,S)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof d=="function")try{d(null)}catch(S){_a(i,l,S)}else d.current=null}function k5(i){var l=i.type,d=i.memoizedProps,m=i.stateNode;try{e:switch(l){case"button":case"input":case"select":case"textarea":d.autoFocus&&m.focus();break e;case"img":d.src?m.src=d.src:d.srcSet&&(m.srcset=d.srcSet)}}catch(S){_a(i,i.return,S)}}function E5(i,l,d){try{var m=i.stateNode;dk(m,i.type,d,l),m[ge]=l}catch(S){_a(i,i.return,S)}}function j5(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27||i.tag===4}function Nx(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||j5(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==27&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function Ax(i,l,d){var m=i.tag;if(m===5||m===6)i=i.stateNode,l?d.nodeType===8?d.parentNode.insertBefore(i,l):d.insertBefore(i,l):(d.nodeType===8?(l=d.parentNode,l.insertBefore(i,d)):(l=d,l.appendChild(i)),d=d._reactRootContainer,d!=null||l.onclick!==null||(l.onclick=im));else if(m!==4&&m!==27&&(i=i.child,i!==null))for(Ax(i,l,d),i=i.sibling;i!==null;)Ax(i,l,d),i=i.sibling}function $p(i,l,d){var m=i.tag;if(m===5||m===6)i=i.stateNode,l?d.insertBefore(i,l):d.appendChild(i);else if(m!==4&&m!==27&&(i=i.child,i!==null))for($p(i,l,d),i=i.sibling;i!==null;)$p(i,l,d),i=i.sibling}var wc=!1,cn=!1,_x=!1,C5=typeof WeakSet=="function"?WeakSet:Set,ss=null,D5=!1;function VT(i,l){if(i=i.containerInfo,Qx=dm,i=ds(i),Vn(i)){if("selectionStart"in i)var d={start:i.selectionStart,end:i.selectionEnd};else e:{d=(d=i.ownerDocument)&&d.defaultView||window;var m=d.getSelection&&d.getSelection();if(m&&m.rangeCount!==0){d=m.anchorNode;var S=m.anchorOffset,T=m.focusNode;m=m.focusOffset;try{d.nodeType,T.nodeType}catch{d=null;break e}var W=0,me=-1,je=-1,Be=0,xt=0,Tt=i,it=null;t:for(;;){for(var dt;Tt!==d||S!==0&&Tt.nodeType!==3||(me=W+S),Tt!==T||m!==0&&Tt.nodeType!==3||(je=W+m),Tt.nodeType===3&&(W+=Tt.nodeValue.length),(dt=Tt.firstChild)!==null;)it=Tt,Tt=dt;for(;;){if(Tt===i)break t;if(it===d&&++Be===S&&(me=W),it===T&&++xt===m&&(je=W),(dt=Tt.nextSibling)!==null)break;Tt=it,it=Tt.parentNode}Tt=dt}d=me===-1||je===-1?null:{start:me,end:je}}else d=null}d=d||{start:0,end:0}}else d=null;for(eg={focusedElem:i,selectionRange:d},dm=!1,ss=l;ss!==null;)if(l=ss,i=l.child,(l.subtreeFlags&1028)!==0&&i!==null)i.return=l,ss=i;else for(;ss!==null;){switch(l=ss,T=l.alternate,i=l.flags,l.tag){case 0:break;case 11:case 15:break;case 1:if((i&1024)!==0&&T!==null){i=void 0,d=l,S=T.memoizedProps,T=T.memoizedState,m=d.stateNode;try{var ar=ho(d.type,S,d.elementType===d.type);i=m.getSnapshotBeforeUpdate(ar,T),m.__reactInternalSnapshotBeforeUpdate=i}catch(_r){_a(d,d.return,_r)}}break;case 3:if((i&1024)!==0){if(i=l.stateNode.containerInfo,d=i.nodeType,d===9)ng(i);else if(d===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":ng(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(a(163))}if(i=l.sibling,i!==null){i.return=l.return,ss=i;break}ss=l.return}return ar=D5,D5=!1,ar}function F5(i,l,d){var m=d.flags;switch(d.tag){case 0:case 11:case 15:Sc(i,d),m&4&&Hh(5,d);break;case 1:if(Sc(i,d),m&4)if(i=d.stateNode,l===null)try{i.componentDidMount()}catch(me){_a(d,d.return,me)}else{var S=ho(d.type,l.memoizedProps);l=l.memoizedState;try{i.componentDidUpdate(S,l,i.__reactInternalSnapshotBeforeUpdate)}catch(me){_a(d,d.return,me)}}m&64&&_5(d),m&512&&yf(d,d.return);break;case 3:if(Sc(i,d),m&64&&(m=d.updateQueue,m!==null)){if(i=null,d.child!==null)switch(d.child.tag){case 27:case 5:i=d.child.stateNode;break;case 1:i=d.child.stateNode}try{A5(m,i)}catch(me){_a(d,d.return,me)}}break;case 26:Sc(i,d),m&512&&yf(d,d.return);break;case 27:case 5:Sc(i,d),l===null&&m&4&&k5(d),m&512&&yf(d,d.return);break;case 12:Sc(i,d);break;case 13:Sc(i,d),m&4&&O5(i,d);break;case 22:if(S=d.memoizedState!==null||wc,!S){l=l!==null&&l.memoizedState!==null||cn;var T=wc,W=cn;wc=S,(cn=l)&&!W?xu(i,d,(d.subtreeFlags&8772)!==0):Sc(i,d),wc=T,cn=W}m&512&&(d.memoizedProps.mode==="manual"?yf(d,d.return):Gi(d,d.return));break;default:Sc(i,d)}}function P5(i){var l=i.alternate;l!==null&&(i.alternate=null,P5(l)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(l=i.stateNode,l!==null&&Qe(l)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var Rn=null,Wi=!1;function bc(i,l,d){for(d=d.child;d!==null;)L5(i,l,d),d=d.sibling}function L5(i,l,d){if(Yt&&typeof Yt.onCommitFiberUnmount=="function")try{Yt.onCommitFiberUnmount(zt,d)}catch{}switch(d.tag){case 26:cn||Gi(d,l),bc(i,l,d),d.memoizedState?d.memoizedState.count--:d.stateNode&&(d=d.stateNode,d.parentNode.removeChild(d));break;case 27:cn||Gi(d,l);var m=Rn,S=Wi;for(Rn=d.stateNode,bc(i,l,d),d=d.stateNode,l=d.attributes;l.length;)d.removeAttributeNode(l[0]);Qe(d),Rn=m,Wi=S;break;case 5:cn||Gi(d,l);case 6:S=Rn;var T=Wi;if(Rn=null,bc(i,l,d),Rn=S,Wi=T,Rn!==null)if(Wi)try{i=Rn,m=d.stateNode,i.nodeType===8?i.parentNode.removeChild(m):i.removeChild(m)}catch(W){_a(d,l,W)}else try{Rn.removeChild(d.stateNode)}catch(W){_a(d,l,W)}break;case 18:Rn!==null&&(Wi?(l=Rn,d=d.stateNode,l.nodeType===8?ag(l.parentNode,d):l.nodeType===1&&ag(l,d),id(l)):ag(Rn,d.stateNode));break;case 4:m=Rn,S=Wi,Rn=d.stateNode.containerInfo,Wi=!0,bc(i,l,d),Rn=m,Wi=S;break;case 0:case 11:case 14:case 15:cn||mu(2,d,l),cn||mu(4,d,l),bc(i,l,d);break;case 1:cn||(Gi(d,l),m=d.stateNode,typeof m.componentWillUnmount=="function"&&T5(d,l,m)),bc(i,l,d);break;case 21:bc(i,l,d);break;case 22:cn||Gi(d,l),cn=(m=cn)||d.memoizedState!==null,bc(i,l,d),cn=m;break;default:bc(i,l,d)}}function O5(i,l){if(l.memoizedState===null&&(i=l.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{id(i)}catch(d){_a(l,l.return,d)}}function qT(i){switch(i.tag){case 13:case 19:var l=i.stateNode;return l===null&&(l=i.stateNode=new C5),l;case 22:return i=i.stateNode,l=i._retryCache,l===null&&(l=i._retryCache=new C5),l;default:throw Error(a(435,i.tag))}}function Tx(i,l){var d=qT(i);l.forEach(function(m){var S=ak.bind(null,i,m);d.has(m)||(d.add(m),m.then(S,S))})}function po(i,l){var d=l.deletions;if(d!==null)for(var m=0;m<d.length;m++){var S=d[m],T=i,W=l,me=W;e:for(;me!==null;){switch(me.tag){case 27:case 5:Rn=me.stateNode,Wi=!1;break e;case 3:Rn=me.stateNode.containerInfo,Wi=!0;break e;case 4:Rn=me.stateNode.containerInfo,Wi=!0;break e}me=me.return}if(Rn===null)throw Error(a(160));L5(T,W,S),Rn=null,Wi=!1,T=S.alternate,T!==null&&(T.return=null),S.return=null}if(l.subtreeFlags&13878)for(l=l.child;l!==null;)R5(l,i),l=l.sibling}var Ko=null;function R5(i,l){var d=i.alternate,m=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:po(l,i),mo(i),m&4&&(mu(3,i,i.return),Hh(3,i),mu(5,i,i.return));break;case 1:po(l,i),mo(i),m&512&&(cn||d===null||Gi(d,d.return)),m&64&&wc&&(i=i.updateQueue,i!==null&&(m=i.callbacks,m!==null&&(d=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=d===null?m:d.concat(m))));break;case 26:var S=Ko;if(po(l,i),mo(i),m&512&&(cn||d===null||Gi(d,d.return)),m&4){var T=d!==null?d.memoizedState:null;if(m=i.memoizedState,d===null)if(m===null)if(i.stateNode===null){e:{m=i.type,d=i.memoizedProps,S=S.ownerDocument||S;t:switch(m){case"title":T=S.getElementsByTagName("title")[0],(!T||T[$e]||T[pe]||T.namespaceURI==="http://www.w3.org/2000/svg"||T.hasAttribute("itemprop"))&&(T=S.createElement(m),S.head.insertBefore(T,S.querySelector("head > title"))),vs(T,m,d),T[pe]=i,Ce(T),m=T;break e;case"link":var W=kw("link","href",S).get(m+(d.href||""));if(W){for(var me=0;me<W.length;me++)if(T=W[me],T.getAttribute("href")===(d.href==null?null:d.href)&&T.getAttribute("rel")===(d.rel==null?null:d.rel)&&T.getAttribute("title")===(d.title==null?null:d.title)&&T.getAttribute("crossorigin")===(d.crossOrigin==null?null:d.crossOrigin)){W.splice(me,1);break t}}T=S.createElement(m),vs(T,m,d),S.head.appendChild(T);break;case"meta":if(W=kw("meta","content",S).get(m+(d.content||""))){for(me=0;me<W.length;me++)if(T=W[me],T.getAttribute("content")===(d.content==null?null:""+d.content)&&T.getAttribute("name")===(d.name==null?null:d.name)&&T.getAttribute("property")===(d.property==null?null:d.property)&&T.getAttribute("http-equiv")===(d.httpEquiv==null?null:d.httpEquiv)&&T.getAttribute("charset")===(d.charSet==null?null:d.charSet)){W.splice(me,1);break t}}T=S.createElement(m),vs(T,m,d),S.head.appendChild(T);break;default:throw Error(a(468,m))}T[pe]=i,Ce(T),m=T}i.stateNode=m}else Ew(S,i.type,i.stateNode);else i.stateNode=Tw(S,m,i.memoizedProps);else T!==m?(T===null?d.stateNode!==null&&(d=d.stateNode,d.parentNode.removeChild(d)):T.count--,m===null?Ew(S,i.type,i.stateNode):Tw(S,m,i.memoizedProps)):m===null&&i.stateNode!==null&&E5(i,i.memoizedProps,d.memoizedProps)}break;case 27:if(m&4&&i.alternate===null){S=i.stateNode,T=i.memoizedProps;try{for(var je=S.firstChild;je;){var Be=je.nextSibling,xt=je.nodeName;je[$e]||xt==="HEAD"||xt==="BODY"||xt==="SCRIPT"||xt==="STYLE"||xt==="LINK"&&je.rel.toLowerCase()==="stylesheet"||S.removeChild(je),je=Be}for(var Tt=i.type,it=S.attributes;it.length;)S.removeAttributeNode(it[0]);vs(S,Tt,T),S[pe]=i,S[ge]=T}catch(ar){_a(i,i.return,ar)}}case 5:if(po(l,i),mo(i),m&512&&(cn||d===null||Gi(d,d.return)),i.flags&32){S=i.stateNode;try{ks(S,"")}catch(ar){_a(i,i.return,ar)}}m&4&&i.stateNode!=null&&(S=i.memoizedProps,E5(i,S,d!==null?d.memoizedProps:S)),m&1024&&(_x=!0);break;case 6:if(po(l,i),mo(i),m&4){if(i.stateNode===null)throw Error(a(162));m=i.memoizedProps,d=i.stateNode;try{d.nodeValue=m}catch(ar){_a(i,i.return,ar)}}break;case 3:if(um=null,S=Ko,Ko=lm(l.containerInfo),po(l,i),Ko=S,mo(i),m&4&&d!==null&&d.memoizedState.isDehydrated)try{id(l.containerInfo)}catch(ar){_a(i,i.return,ar)}_x&&(_x=!1,M5(i));break;case 4:m=Ko,Ko=lm(i.stateNode.containerInfo),po(l,i),mo(i),Ko=m;break;case 12:po(l,i),mo(i);break;case 13:po(l,i),mo(i),i.child.flags&8192&&i.memoizedState!==null!=(d!==null&&d.memoizedState!==null)&&(Ox=ct()),m&4&&(m=i.updateQueue,m!==null&&(i.updateQueue=null,Tx(i,m)));break;case 22:if(m&512&&(cn||d===null||Gi(d,d.return)),je=i.memoizedState!==null,Be=d!==null&&d.memoizedState!==null,xt=wc,Tt=cn,wc=xt||je,cn=Tt||Be,po(l,i),cn=Tt,wc=xt,mo(i),l=i.stateNode,l._current=i,l._visibility&=-3,l._visibility|=l._pendingVisibility&2,m&8192&&(l._visibility=je?l._visibility&-2:l._visibility|1,je&&(l=wc||cn,d===null||Be||l||A0(i)),i.memoizedProps===null||i.memoizedProps.mode!=="manual"))e:for(d=null,l=i;;){if(l.tag===5||l.tag===26||l.tag===27){if(d===null){Be=d=l;try{if(S=Be.stateNode,je)T=S.style,typeof T.setProperty=="function"?T.setProperty("display","none","important"):T.display="none";else{W=Be.stateNode,me=Be.memoizedProps.style;var dt=me!=null&&me.hasOwnProperty("display")?me.display:null;W.style.display=dt==null||typeof dt=="boolean"?"":(""+dt).trim()}}catch(ar){_a(Be,Be.return,ar)}}}else if(l.tag===6){if(d===null){Be=l;try{Be.stateNode.nodeValue=je?"":Be.memoizedProps}catch(ar){_a(Be,Be.return,ar)}}}else if((l.tag!==22&&l.tag!==23||l.memoizedState===null||l===i)&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===i)break e;for(;l.sibling===null;){if(l.return===null||l.return===i)break e;d===l&&(d=null),l=l.return}d===l&&(d=null),l.sibling.return=l.return,l=l.sibling}m&4&&(m=i.updateQueue,m!==null&&(d=m.retryQueue,d!==null&&(m.retryQueue=null,Tx(i,d))));break;case 19:po(l,i),mo(i),m&4&&(m=i.updateQueue,m!==null&&(i.updateQueue=null,Tx(i,m)));break;case 21:break;default:po(l,i),mo(i)}}function mo(i){var l=i.flags;if(l&2){try{if(i.tag!==27){e:{for(var d=i.return;d!==null;){if(j5(d)){var m=d;break e}d=d.return}throw Error(a(160))}switch(m.tag){case 27:var S=m.stateNode,T=Nx(i);$p(i,T,S);break;case 5:var W=m.stateNode;m.flags&32&&(ks(W,""),m.flags&=-33);var me=Nx(i);$p(i,me,W);break;case 3:case 4:var je=m.stateNode.containerInfo,Be=Nx(i);Ax(i,Be,je);break;default:throw Error(a(161))}}}catch(xt){_a(i,i.return,xt)}i.flags&=-3}l&4096&&(i.flags&=-4097)}function M5(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var l=i;M5(l),l.tag===5&&l.flags&1024&&l.stateNode.reset(),i=i.sibling}}function Sc(i,l){if(l.subtreeFlags&8772)for(l=l.child;l!==null;)F5(i,l.alternate,l),l=l.sibling}function A0(i){for(i=i.child;i!==null;){var l=i;switch(l.tag){case 0:case 11:case 14:case 15:mu(4,l,l.return),A0(l);break;case 1:Gi(l,l.return);var d=l.stateNode;typeof d.componentWillUnmount=="function"&&T5(l,l.return,d),A0(l);break;case 26:case 27:case 5:Gi(l,l.return),A0(l);break;case 22:Gi(l,l.return),l.memoizedState===null&&A0(l);break;default:A0(l)}i=i.sibling}}function xu(i,l,d){for(d=d&&(l.subtreeFlags&8772)!==0,l=l.child;l!==null;){var m=l.alternate,S=i,T=l,W=T.flags;switch(T.tag){case 0:case 11:case 15:xu(S,T,d),Hh(4,T);break;case 1:if(xu(S,T,d),m=T,S=m.stateNode,typeof S.componentDidMount=="function")try{S.componentDidMount()}catch(Be){_a(m,m.return,Be)}if(m=T,S=m.updateQueue,S!==null){var me=m.stateNode;try{var je=S.shared.hiddenCallbacks;if(je!==null)for(S.shared.hiddenCallbacks=null,S=0;S<je.length;S++)N5(je[S],me)}catch(Be){_a(m,m.return,Be)}}d&&W&64&&_5(T),yf(T,T.return);break;case 26:case 27:case 5:xu(S,T,d),d&&m===null&&W&4&&k5(T),yf(T,T.return);break;case 12:xu(S,T,d);break;case 13:xu(S,T,d),d&&W&4&&O5(S,T);break;case 22:T.memoizedState===null&&xu(S,T,d),yf(T,T.return);break;default:xu(S,T,d)}l=l.sibling}}function kx(i,l){var d=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(d=i.memoizedState.cachePool.pool),i=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(i=l.memoizedState.cachePool.pool),i!==d&&(i!=null&&i.refCount++,d!=null&&y(d))}function Ex(i,l){i=null,l.alternate!==null&&(i=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==i&&(l.refCount++,i!=null&&y(i))}function gu(i,l,d,m){if(l.subtreeFlags&10256)for(l=l.child;l!==null;)I5(i,l,d,m),l=l.sibling}function I5(i,l,d,m){var S=l.flags;switch(l.tag){case 0:case 11:case 15:gu(i,l,d,m),S&2048&&Hh(9,l);break;case 3:gu(i,l,d,m),S&2048&&(i=null,l.alternate!==null&&(i=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==i&&(l.refCount++,i!=null&&y(i)));break;case 12:if(S&2048){gu(i,l,d,m),i=l.stateNode;try{var T=l.memoizedProps,W=T.id,me=T.onPostCommit;typeof me=="function"&&me(W,l.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(je){_a(l,l.return,je)}}else gu(i,l,d,m);break;case 23:break;case 22:T=l.stateNode,l.memoizedState!==null?T._visibility&4?gu(i,l,d,m):Vh(i,l):T._visibility&4?gu(i,l,d,m):(T._visibility|=4,_0(i,l,d,m,(l.subtreeFlags&10256)!==0)),S&2048&&kx(l.alternate,l);break;case 24:gu(i,l,d,m),S&2048&&Ex(l.alternate,l);break;default:gu(i,l,d,m)}}function _0(i,l,d,m,S){for(S=S&&(l.subtreeFlags&10256)!==0,l=l.child;l!==null;){var T=i,W=l,me=d,je=m,Be=W.flags;switch(W.tag){case 0:case 11:case 15:_0(T,W,me,je,S),Hh(8,W);break;case 23:break;case 22:var xt=W.stateNode;W.memoizedState!==null?xt._visibility&4?_0(T,W,me,je,S):Vh(T,W):(xt._visibility|=4,_0(T,W,me,je,S)),S&&Be&2048&&kx(W.alternate,W);break;case 24:_0(T,W,me,je,S),S&&Be&2048&&Ex(W.alternate,W);break;default:_0(T,W,me,je,S)}l=l.sibling}}function Vh(i,l){if(l.subtreeFlags&10256)for(l=l.child;l!==null;){var d=i,m=l,S=m.flags;switch(m.tag){case 22:Vh(d,m),S&2048&&kx(m.alternate,m);break;case 24:Vh(d,m),S&2048&&Ex(m.alternate,m);break;default:Vh(d,m)}l=l.sibling}}var qh=8192;function T0(i){if(i.subtreeFlags&qh)for(i=i.child;i!==null;)B5(i),i=i.sibling}function B5(i){switch(i.tag){case 26:T0(i),i.flags&qh&&i.memoizedState!==null&&Fk(Ko,i.memoizedState,i.memoizedProps);break;case 5:T0(i);break;case 3:case 4:var l=Ko;Ko=lm(i.stateNode.containerInfo),T0(i),Ko=l;break;case 22:i.memoizedState===null&&(l=i.alternate,l!==null&&l.memoizedState!==null?(l=qh,qh=16777216,T0(i),qh=l):T0(i));break;default:T0(i)}}function U5(i){var l=i.alternate;if(l!==null&&(i=l.child,i!==null)){l.child=null;do l=i.sibling,i.sibling=null,i=l;while(i!==null)}}function Gh(i){var l=i.deletions;if((i.flags&16)!==0){if(l!==null)for(var d=0;d<l.length;d++){var m=l[d];ss=m,H5(m,i)}U5(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)z5(i),i=i.sibling}function z5(i){switch(i.tag){case 0:case 11:case 15:Gh(i),i.flags&2048&&mu(9,i,i.return);break;case 3:Gh(i);break;case 12:Gh(i);break;case 22:var l=i.stateNode;i.memoizedState!==null&&l._visibility&4&&(i.return===null||i.return.tag!==13)?(l._visibility&=-5,Xp(i)):Gh(i);break;default:Gh(i)}}function Xp(i){var l=i.deletions;if((i.flags&16)!==0){if(l!==null)for(var d=0;d<l.length;d++){var m=l[d];ss=m,H5(m,i)}U5(i)}for(i=i.child;i!==null;){switch(l=i,l.tag){case 0:case 11:case 15:mu(8,l,l.return),Xp(l);break;case 22:d=l.stateNode,d._visibility&4&&(d._visibility&=-5,Xp(l));break;default:Xp(l)}i=i.sibling}}function H5(i,l){for(;ss!==null;){var d=ss;switch(d.tag){case 0:case 11:case 15:mu(8,d,l);break;case 23:case 22:if(d.memoizedState!==null&&d.memoizedState.cachePool!==null){var m=d.memoizedState.cachePool.pool;m!=null&&m.refCount++}break;case 24:y(d.memoizedState.cache)}if(m=d.child,m!==null)m.return=d,ss=m;else e:for(d=i;ss!==null;){m=ss;var S=m.sibling,T=m.return;if(P5(m),m===d){ss=null;break e}if(S!==null){S.return=T,ss=S;break e}ss=T}}}function GT(i,l,d,m){this.tag=i,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=m,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function xo(i,l,d,m){return new GT(i,l,d,m)}function jx(i){return i=i.prototype,!(!i||!i.isReactComponent)}function vu(i,l){var d=i.alternate;return d===null?(d=xo(i.tag,l,i.key,i.mode),d.elementType=i.elementType,d.type=i.type,d.stateNode=i.stateNode,d.alternate=i,i.alternate=d):(d.pendingProps=l,d.type=i.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=i.flags&31457280,d.childLanes=i.childLanes,d.lanes=i.lanes,d.child=i.child,d.memoizedProps=i.memoizedProps,d.memoizedState=i.memoizedState,d.updateQueue=i.updateQueue,l=i.dependencies,d.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},d.sibling=i.sibling,d.index=i.index,d.ref=i.ref,d.refCleanup=i.refCleanup,d}function V5(i,l){i.flags&=31457282;var d=i.alternate;return d===null?(i.childLanes=0,i.lanes=l,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=d.childLanes,i.lanes=d.lanes,i.child=d.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=d.memoizedProps,i.memoizedState=d.memoizedState,i.updateQueue=d.updateQueue,i.type=d.type,l=d.dependencies,i.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),i}function Yp(i,l,d,m,S,T){var W=0;if(m=i,typeof i=="function")jx(i)&&(W=1);else if(typeof i=="string")W=Ck(i,d,Ee.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case u:return wf(d.children,S,T,l);case h:W=8,S|=24;break;case p:return i=xo(12,d,l,S|2),i.elementType=p,i.lanes=T,i;case b:return i=xo(13,d,l,S),i.elementType=b,i.lanes=T,i;case N:return i=xo(19,d,l,S),i.elementType=N,i.lanes=T,i;case j:return q5(d,S,T,l);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case x:case g:W=10;break e;case v:W=9;break e;case w:W=11;break e;case _:W=14;break e;case E:W=16,m=null;break e}W=29,d=Error(a(130,i===null?"null":typeof i,"")),m=null}return l=xo(W,d,l,S),l.elementType=i,l.type=m,l.lanes=T,l}function wf(i,l,d,m){return i=xo(7,i,m,l),i.lanes=d,i}function q5(i,l,d,m){i=xo(22,i,m,l),i.elementType=j,i.lanes=d;var S={_visibility:1,_pendingVisibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null,_current:null,detach:function(){var T=S._current;if(T===null)throw Error(a(456));if((S._pendingVisibility&2)===0){var W=ci(T,2);W!==null&&(S._pendingVisibility|=2,fi(W,T,2))}},attach:function(){var T=S._current;if(T===null)throw Error(a(456));if((S._pendingVisibility&2)!==0){var W=ci(T,2);W!==null&&(S._pendingVisibility&=-3,fi(W,T,2))}}};return i.stateNode=S,i}function Cx(i,l,d){return i=xo(6,i,null,l),i.lanes=d,i}function Dx(i,l,d){return l=xo(4,i.children!==null?i.children:[],i.key,l),l.lanes=d,l.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},l}function Nc(i){i.flags|=4}function G5(i,l){if(l.type!=="stylesheet"||(l.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!jw(l)){if(l=_i.current,l!==null&&((Qr&4194176)===Qr?zi!==null:(Qr&62914560)!==Qr&&(Qr&536870912)===0||l!==zi))throw ui=Eh,Ep;i.flags|=8192}}function Jp(i,l){l!==null&&(i.flags|=4),i.flags&16384&&(l=i.tag!==22?Ea():536870912,i.lanes|=l,E0|=l)}function Wh(i,l){if(!Zr)switch(i.tailMode){case"hidden":l=i.tail;for(var d=null;l!==null;)l.alternate!==null&&(d=l),l=l.sibling;d===null?i.tail=null:d.sibling=null;break;case"collapsed":d=i.tail;for(var m=null;d!==null;)d.alternate!==null&&(m=d),d=d.sibling;m===null?l||i.tail===null?i.tail=null:i.tail.sibling=null:m.sibling=null}}function tn(i){var l=i.alternate!==null&&i.alternate.child===i.child,d=0,m=0;if(l)for(var S=i.child;S!==null;)d|=S.lanes|S.childLanes,m|=S.subtreeFlags&31457280,m|=S.flags&31457280,S.return=i,S=S.sibling;else for(S=i.child;S!==null;)d|=S.lanes|S.childLanes,m|=S.subtreeFlags,m|=S.flags,S.return=i,S=S.sibling;return i.subtreeFlags|=m,i.childLanes=d,l}function WT(i,l,d){var m=l.pendingProps;switch(Th(l),l.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return tn(l),null;case 1:return tn(l),null;case 3:return d=l.stateNode,m=null,i!==null&&(m=i.memoizedState.cache),l.memoizedState.cache!==m&&(l.flags|=2048),yc(Sn),de(),d.pendingContext&&(d.context=d.pendingContext,d.pendingContext=null),(i===null||i.child===null)&&(tf(l)?Nc(l):i===null||i.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,Bi!==null&&(Bx(Bi),Bi=null))),tn(l),null;case 26:return d=l.memoizedState,i===null?(Nc(l),d!==null?(tn(l),G5(l,d)):(tn(l),l.flags&=-16777217)):d?d!==i.memoizedState?(Nc(l),tn(l),G5(l,d)):(tn(l),l.flags&=-16777217):(i.memoizedProps!==m&&Nc(l),tn(l),l.flags&=-16777217),null;case 27:Ue(l),d=Pe.current;var S=l.type;if(i!==null&&l.stateNode!=null)i.memoizedProps!==m&&Nc(l);else{if(!m){if(l.stateNode===null)throw Error(a(166));return tn(l),null}i=Ee.current,tf(l)?c0(l):(i=bw(S,m,d),l.stateNode=i,Nc(l))}return tn(l),null;case 5:if(Ue(l),d=l.type,i!==null&&l.stateNode!=null)i.memoizedProps!==m&&Nc(l);else{if(!m){if(l.stateNode===null)throw Error(a(166));return tn(l),null}if(i=Ee.current,tf(l))c0(l);else{switch(S=om(Pe.current),i){case 1:i=S.createElementNS("http://www.w3.org/2000/svg",d);break;case 2:i=S.createElementNS("http://www.w3.org/1998/Math/MathML",d);break;default:switch(d){case"svg":i=S.createElementNS("http://www.w3.org/2000/svg",d);break;case"math":i=S.createElementNS("http://www.w3.org/1998/Math/MathML",d);break;case"script":i=S.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild);break;case"select":i=typeof m.is=="string"?S.createElement("select",{is:m.is}):S.createElement("select"),m.multiple?i.multiple=!0:m.size&&(i.size=m.size);break;default:i=typeof m.is=="string"?S.createElement(d,{is:m.is}):S.createElement(d)}}i[pe]=l,i[ge]=m;e:for(S=l.child;S!==null;){if(S.tag===5||S.tag===6)i.appendChild(S.stateNode);else if(S.tag!==4&&S.tag!==27&&S.child!==null){S.child.return=S,S=S.child;continue}if(S===l)break e;for(;S.sibling===null;){if(S.return===null||S.return===l)break e;S=S.return}S.sibling.return=S.return,S=S.sibling}l.stateNode=i;e:switch(vs(i,d,m),d){case"button":case"input":case"select":case"textarea":i=!!m.autoFocus;break e;case"img":i=!0;break e;default:i=!1}i&&Nc(l)}}return tn(l),l.flags&=-16777217,null;case 6:if(i&&l.stateNode!=null)i.memoizedProps!==m&&Nc(l);else{if(typeof m!="string"&&l.stateNode===null)throw Error(a(166));if(i=Pe.current,tf(l)){if(i=l.stateNode,d=l.memoizedProps,m=null,S=rs,S!==null)switch(S.tag){case 27:case 5:m=S.memoizedProps}i[pe]=l,i=!!(i.nodeValue===d||m!==null&&m.suppressHydrationWarning===!0||mw(i.nodeValue,d)),i||Vo(l)}else i=om(i).createTextNode(m),i[pe]=l,l.stateNode=i}return tn(l),null;case 13:if(m=l.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(S=tf(l),m!==null&&m.dehydrated!==null){if(i===null){if(!S)throw Error(a(318));if(S=l.memoizedState,S=S!==null?S.dehydrated:null,!S)throw Error(a(317));S[pe]=l}else rf(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;tn(l),S=!1}else Bi!==null&&(Bx(Bi),Bi=null),S=!0;if(!S)return l.flags&256?(qo(l),l):(qo(l),null)}if(qo(l),(l.flags&128)!==0)return l.lanes=d,l;if(d=m!==null,i=i!==null&&i.memoizedState!==null,d){m=l.child,S=null,m.alternate!==null&&m.alternate.memoizedState!==null&&m.alternate.memoizedState.cachePool!==null&&(S=m.alternate.memoizedState.cachePool.pool);var T=null;m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(T=m.memoizedState.cachePool.pool),T!==S&&(m.flags|=2048)}return d!==i&&d&&(l.child.flags|=8192),Jp(l,l.updateQueue),tn(l),null;case 4:return de(),i===null&&Jx(l.stateNode.containerInfo),tn(l),null;case 10:return yc(l.type),tn(l),null;case 19:if(ue(bn),S=l.memoizedState,S===null)return tn(l),null;if(m=(l.flags&128)!==0,T=S.rendering,T===null)if(m)Wh(S,!1);else{if(un!==0||i!==null&&(i.flags&128)!==0)for(i=l.child;i!==null;){if(T=f0(i),T!==null){for(l.flags|=128,Wh(S,!1),i=T.updateQueue,l.updateQueue=i,Jp(l,i),l.subtreeFlags=0,i=d,d=l.child;d!==null;)V5(d,i),d=d.sibling;return fe(bn,bn.current&1|2),l.child}i=i.sibling}S.tail!==null&&ct()>Kp&&(l.flags|=128,m=!0,Wh(S,!1),l.lanes=4194304)}else{if(!m)if(i=f0(T),i!==null){if(l.flags|=128,m=!0,i=i.updateQueue,l.updateQueue=i,Jp(l,i),Wh(S,!0),S.tail===null&&S.tailMode==="hidden"&&!T.alternate&&!Zr)return tn(l),null}else 2*ct()-S.renderingStartTime>Kp&&d!==536870912&&(l.flags|=128,m=!0,Wh(S,!1),l.lanes=4194304);S.isBackwards?(T.sibling=l.child,l.child=T):(i=S.last,i!==null?i.sibling=T:l.child=T,S.last=T)}return S.tail!==null?(l=S.tail,S.rendering=l,S.tail=l.sibling,S.renderingStartTime=ct(),l.sibling=null,i=bn.current,fe(bn,m?i&1|2:i&1),l):(tn(l),null);case 22:case 23:return qo(l),of(),m=l.memoizedState!==null,i!==null?i.memoizedState!==null!==m&&(l.flags|=8192):m&&(l.flags|=8192),m?(d&536870912)!==0&&(l.flags&128)===0&&(tn(l),l.subtreeFlags&6&&(l.flags|=8192)):tn(l),d=l.updateQueue,d!==null&&Jp(l,d.retryQueue),d=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(d=i.memoizedState.cachePool.pool),m=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(m=l.memoizedState.cachePool.pool),m!==d&&(l.flags|=2048),i!==null&&ue(we),null;case 24:return d=null,i!==null&&(d=i.memoizedState.cache),l.memoizedState.cache!==d&&(l.flags|=2048),yc(Sn),tn(l),null;case 25:return null}throw Error(a(156,l.tag))}function $T(i,l){switch(Th(l),l.tag){case 1:return i=l.flags,i&65536?(l.flags=i&-65537|128,l):null;case 3:return yc(Sn),de(),i=l.flags,(i&65536)!==0&&(i&128)===0?(l.flags=i&-65537|128,l):null;case 26:case 27:case 5:return Ue(l),null;case 13:if(qo(l),i=l.memoizedState,i!==null&&i.dehydrated!==null){if(l.alternate===null)throw Error(a(340));rf()}return i=l.flags,i&65536?(l.flags=i&-65537|128,l):null;case 19:return ue(bn),null;case 4:return de(),null;case 10:return yc(l.type),null;case 22:case 23:return qo(l),of(),i!==null&&ue(we),i=l.flags,i&65536?(l.flags=i&-65537|128,l):null;case 24:return yc(Sn),null;case 25:return null;default:return null}}function W5(i,l){switch(Th(l),l.tag){case 3:yc(Sn),de();break;case 26:case 27:case 5:Ue(l);break;case 4:de();break;case 13:qo(l);break;case 19:ue(bn);break;case 10:yc(l.type);break;case 22:case 23:qo(l),of(),i!==null&&ue(we);break;case 24:yc(Sn)}}var XT={getCacheForType:function(i){var l=Ms(Sn),d=l.data.get(i);return d===void 0&&(d=i(),l.data.set(i,d)),d}},YT=typeof WeakMap=="function"?WeakMap:Map,rn=0,Fa=null,Wr=null,Qr=0,Pa=0,$i=null,Ac=!1,k0=!1,Fx=!1,_c=0,un=0,yu=0,bf=0,Px=0,go=0,E0=0,$h=null,Il=null,Lx=!1,Ox=0,Kp=1/0,Zp=null,wu=null,Qp=!1,Sf=null,Xh=0,Rx=0,Mx=null,Yh=0,Ix=null;function Xi(){if((rn&2)!==0&&Qr!==0)return Qr&-Qr;if(H.T!==null){var i=B;return i!==0?i:Wx()}return ha()}function $5(){go===0&&(go=(Qr&536870912)===0||Zr?ka():536870912);var i=_i.current;return i!==null&&(i.flags|=32),go}function fi(i,l,d){(i===Fa&&Pa===2||i.cancelPendingCommit!==null)&&(j0(i,0),Tc(i,Qr,go,!1)),Qt(i,d),((rn&2)===0||i!==Fa)&&(i===Fa&&((rn&2)===0&&(bf|=d),un===4&&Tc(i,Qr,go,!1)),Bl(i))}function X5(i,l,d){if((rn&6)!==0)throw Error(a(327));var m=!d&&(l&60)===0&&(l&i.expiredLanes)===0||kr(i,l),S=m?ZT(i,l):Hx(i,l,!0),T=m;do{if(S===0){k0&&!m&&Tc(i,l,0,!1);break}else if(S===6)Tc(i,l,0,!Ac);else{if(d=i.current.alternate,T&&!JT(d)){S=Hx(i,l,!1),T=!1;continue}if(S===2){if(T=l,i.errorRecoveryDisabledLanes&T)var W=0;else W=i.pendingLanes&-536870913,W=W!==0?W:W&536870912?536870912:0;if(W!==0){l=W;e:{var me=i;S=$h;var je=me.current.memoizedState.isDehydrated;if(je&&(j0(me,W).flags|=256),W=Hx(me,W,!1),W!==2){if(Fx&&!je){me.errorRecoveryDisabledLanes|=T,bf|=T,S=4;break e}T=Il,Il=S,T!==null&&Bx(T)}S=W}if(T=!1,S!==2)continue}}if(S===1){j0(i,0),Tc(i,l,0,!0);break}e:{switch(m=i,S){case 0:case 1:throw Error(a(345));case 4:if((l&4194176)===l){Tc(m,l,go,!Ac);break e}break;case 2:Il=null;break;case 3:case 5:break;default:throw Error(a(329))}if(m.finishedWork=d,m.finishedLanes=l,(l&62914560)===l&&(T=Ox+300-ct(),10<T)){if(Tc(m,l,go,!Ac),sr(m,0)!==0)break e;m.timeoutHandle=vw(Y5.bind(null,m,d,Il,Zp,Lx,l,go,bf,E0,Ac,2,-0,0),T);break e}Y5(m,d,Il,Zp,Lx,l,go,bf,E0,Ac,0,-0,0)}}break}while(!0);Bl(i)}function Bx(i){Il===null?Il=i:Il.push.apply(Il,i)}function Y5(i,l,d,m,S,T,W,me,je,Be,xt,Tt,it){var dt=l.subtreeFlags;if((dt&8192||(dt&16785408)===16785408)&&(td={stylesheets:null,count:0,unsuspend:Dk},B5(l),l=Pk(),l!==null)){i.cancelPendingCommit=l(rw.bind(null,i,d,m,S,W,me,je,1,Tt,it)),Tc(i,T,W,!Be);return}rw(i,d,m,S,W,me,je,xt,Tt,it)}function JT(i){for(var l=i;;){var d=l.tag;if((d===0||d===11||d===15)&&l.flags&16384&&(d=l.updateQueue,d!==null&&(d=d.stores,d!==null)))for(var m=0;m<d.length;m++){var S=d[m],T=S.getSnapshot;S=S.value;try{if(!On(T(),S))return!1}catch{return!1}}if(d=l.child,l.subtreeFlags&16384&&d!==null)d.return=l,l=d;else{if(l===i)break;for(;l.sibling===null;){if(l.return===null||l.return===i)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function Tc(i,l,d,m){l&=~Px,l&=~bf,i.suspendedLanes|=l,i.pingedLanes&=~l,m&&(i.warmLanes|=l),m=i.expirationTimes;for(var S=l;0<S;){var T=31-fa(S),W=1<<T;m[T]=-1,S&=~W}d!==0&&Vr(i,d,l)}function em(){return(rn&6)===0?(Jh(0),!1):!0}function Ux(){if(Wr!==null){if(Pa===0)var i=Wr.return;else i=Wr,vc=gf=null,Xa(i),uc=null,Ai=0,i=Wr;for(;i!==null;)W5(i.alternate,i),i=i.return;Wr=null}}function j0(i,l){i.finishedWork=null,i.finishedLanes=0;var d=i.timeoutHandle;d!==-1&&(i.timeoutHandle=-1,mk(d)),d=i.cancelPendingCommit,d!==null&&(i.cancelPendingCommit=null,d()),Ux(),Fa=i,Wr=d=vu(i.current,null),Qr=l,Pa=0,$i=null,Ac=!1,k0=kr(i,l),Fx=!1,E0=go=Px=bf=yu=un=0,Il=$h=null,Lx=!1,(l&8)!==0&&(l|=l&32);var m=i.entangledLanes;if(m!==0)for(i=i.entanglements,m&=l;0<m;){var S=31-fa(m),T=1<<S;l|=i[S],m&=~T}return _c=l,$a(),d}function J5(i,l){at=null,H.H=Vi,l===af?(l=Cp(),Pa=3):l===Ep?(l=Cp(),Pa=4):Pa=l===c5?8:l!==null&&typeof l=="object"&&typeof l.then=="function"?6:1,$i=l,Wr===null&&(un=1,uu(i,Ba(l,i.current)))}function K5(){var i=H.H;return H.H=Vi,i===null?Vi:i}function Z5(){var i=H.A;return H.A=XT,i}function zx(){un=4,Ac||(Qr&4194176)!==Qr&&_i.current!==null||(k0=!0),(yu&134217727)===0&&(bf&134217727)===0||Fa===null||Tc(Fa,Qr,go,!1)}function Hx(i,l,d){var m=rn;rn|=2;var S=K5(),T=Z5();(Fa!==i||Qr!==l)&&(Zp=null,j0(i,l)),l=!1;var W=un;e:do try{if(Pa!==0&&Wr!==null){var me=Wr,je=$i;switch(Pa){case 8:Ux(),W=6;break e;case 3:case 2:case 6:_i.current===null&&(l=!0);var Be=Pa;if(Pa=0,$i=null,C0(i,me,je,Be),d&&k0){W=0;break e}break;default:Be=Pa,Pa=0,$i=null,C0(i,me,je,Be)}}KT(),W=un;break}catch(xt){J5(i,xt)}while(!0);return l&&i.shellSuspendCounter++,vc=gf=null,rn=m,H.H=S,H.A=T,Wr===null&&(Fa=null,Qr=0,$a()),W}function KT(){for(;Wr!==null;)Q5(Wr)}function ZT(i,l){var d=rn;rn|=2;var m=K5(),S=Z5();Fa!==i||Qr!==l?(Zp=null,Kp=ct()+500,j0(i,l)):k0=kr(i,l);e:do try{if(Pa!==0&&Wr!==null){l=Wr;var T=$i;t:switch(Pa){case 1:Pa=0,$i=null,C0(i,l,T,1);break;case 2:if(jp(T)){Pa=0,$i=null,ew(l);break}l=function(){Pa===2&&Fa===i&&(Pa=7),Bl(i)},T.then(l,l);break e;case 3:Pa=7;break e;case 4:Pa=5;break e;case 7:jp(T)?(Pa=0,$i=null,ew(l)):(Pa=0,$i=null,C0(i,l,T,7));break;case 5:var W=null;switch(Wr.tag){case 26:W=Wr.memoizedState;case 5:case 27:var me=Wr;if(!W||jw(W)){Pa=0,$i=null;var je=me.sibling;if(je!==null)Wr=je;else{var Be=me.return;Be!==null?(Wr=Be,tm(Be)):Wr=null}break t}}Pa=0,$i=null,C0(i,l,T,5);break;case 6:Pa=0,$i=null,C0(i,l,T,6);break;case 8:Ux(),un=6;break e;default:throw Error(a(462))}}QT();break}catch(xt){J5(i,xt)}while(!0);return vc=gf=null,H.H=m,H.A=S,rn=d,Wr!==null?0:(Fa=null,Qr=0,$a(),un)}function QT(){for(;Wr!==null&&!vt();)Q5(Wr)}function Q5(i){var l=b5(i.alternate,i,_c);i.memoizedProps=i.pendingProps,l===null?tm(i):Wr=l}function ew(i){var l=i,d=l.alternate;switch(l.tag){case 15:case 0:l=m5(d,l,l.pendingProps,l.type,void 0,Qr);break;case 11:l=m5(d,l,l.pendingProps,l.type.render,l.ref,Qr);break;case 5:Xa(l);default:W5(d,l),l=Wr=V5(l,_c),l=b5(d,l,_c)}i.memoizedProps=i.pendingProps,l===null?tm(i):Wr=l}function C0(i,l,d,m){vc=gf=null,Xa(l),uc=null,Ai=0;var S=l.return;try{if(zT(i,S,l,d,Qr)){un=1,uu(i,Ba(d,i.current)),Wr=null;return}}catch(T){if(S!==null)throw Wr=S,T;un=1,uu(i,Ba(d,i.current)),Wr=null;return}l.flags&32768?(Zr||m===1?i=!0:k0||(Qr&536870912)!==0?i=!1:(Ac=i=!0,(m===2||m===3||m===6)&&(m=_i.current,m!==null&&m.tag===13&&(m.flags|=16384))),tw(l,i)):tm(l)}function tm(i){var l=i;do{if((l.flags&32768)!==0){tw(l,Ac);return}i=l.return;var d=WT(l.alternate,l,_c);if(d!==null){Wr=d;return}if(l=l.sibling,l!==null){Wr=l;return}Wr=l=i}while(l!==null);un===0&&(un=5)}function tw(i,l){do{var d=$T(i.alternate,i);if(d!==null){d.flags&=32767,Wr=d;return}if(d=i.return,d!==null&&(d.flags|=32768,d.subtreeFlags=0,d.deletions=null),!l&&(i=i.sibling,i!==null)){Wr=i;return}Wr=i=d}while(i!==null);un=6,Wr=null}function rw(i,l,d,m,S,T,W,me,je,Be){var xt=H.T,Tt=L.p;try{L.p=2,H.T=null,ek(i,l,d,m,Tt,S,T,W,me,je,Be)}finally{H.T=xt,L.p=Tt}}function ek(i,l,d,m,S,T,W,me){do D0();while(Sf!==null);if((rn&6)!==0)throw Error(a(327));var je=i.finishedWork;if(m=i.finishedLanes,je===null)return null;if(i.finishedWork=null,i.finishedLanes=0,je===i.current)throw Error(a(177));i.callbackNode=null,i.callbackPriority=0,i.cancelPendingCommit=null;var Be=je.lanes|je.childLanes;if(Be|=Ia,Un(i,m,Be,T,W,me),i===Fa&&(Wr=Fa=null,Qr=0),(je.subtreeFlags&10256)===0&&(je.flags&10256)===0||Qp||(Qp=!0,Rx=Be,Mx=d,nk(It,function(){return D0(),null})),d=(je.flags&15990)!==0,(je.subtreeFlags&15990)!==0||d?(d=H.T,H.T=null,T=L.p,L.p=2,W=rn,rn|=4,VT(i,je),R5(je,i),_l(eg,i.containerInfo),dm=!!Qx,eg=Qx=null,i.current=je,F5(i,je.alternate,je),At(),rn=W,L.p=T,H.T=d):i.current=je,Qp?(Qp=!1,Sf=i,Xh=m):aw(i,Be),Be=i.pendingLanes,Be===0&&(wu=null),Sr(je.stateNode),Bl(i),l!==null)for(S=i.onRecoverableError,je=0;je<l.length;je++)Be=l[je],S(Be.value,{componentStack:Be.stack});return(Xh&3)!==0&&D0(),Be=i.pendingLanes,(m&4194218)!==0&&(Be&42)!==0?i===Ix?Yh++:(Yh=0,Ix=i):Yh=0,Jh(0),null}function aw(i,l){(i.pooledCacheLanes&=l)===0&&(l=i.pooledCache,l!=null&&(i.pooledCache=null,y(l)))}function D0(){if(Sf!==null){var i=Sf,l=Rx;Rx=0;var d=qr(Xh),m=H.T,S=L.p;try{if(L.p=32>d?32:d,H.T=null,Sf===null)var T=!1;else{d=Mx,Mx=null;var W=Sf,me=Xh;if(Sf=null,Xh=0,(rn&6)!==0)throw Error(a(331));var je=rn;if(rn|=4,z5(W.current),I5(W,W.current,me,d),rn=je,Jh(0,!1),Yt&&typeof Yt.onPostCommitFiberRoot=="function")try{Yt.onPostCommitFiberRoot(zt,W)}catch{}T=!0}return T}finally{L.p=S,H.T=m,aw(i,l)}}return!1}function nw(i,l,d){l=Ba(d,l),l=ix(i.stateNode,l,2),i=pu(i,l,2),i!==null&&(Qt(i,2),Bl(i))}function _a(i,l,d){if(i.tag===3)nw(i,i,d);else for(;l!==null;){if(l.tag===3){nw(l,i,d);break}else if(l.tag===1){var m=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof m.componentDidCatch=="function"&&(wu===null||!wu.has(m))){i=Ba(d,i),d=o5(2),m=pu(l,d,2),m!==null&&(l5(d,m,l,i),Qt(m,2),Bl(m));break}}l=l.return}}function Vx(i,l,d){var m=i.pingCache;if(m===null){m=i.pingCache=new YT;var S=new Set;m.set(l,S)}else S=m.get(l),S===void 0&&(S=new Set,m.set(l,S));S.has(d)||(Fx=!0,S.add(d),i=tk.bind(null,i,l,d),l.then(i,i))}function tk(i,l,d){var m=i.pingCache;m!==null&&m.delete(l),i.pingedLanes|=i.suspendedLanes&d,i.warmLanes&=~d,Fa===i&&(Qr&d)===d&&(un===4||un===3&&(Qr&62914560)===Qr&&300>ct()-Ox?(rn&2)===0&&j0(i,0):Px|=d,E0===Qr&&(E0=0)),Bl(i)}function sw(i,l){l===0&&(l=Ea()),i=ci(i,l),i!==null&&(Qt(i,l),Bl(i))}function rk(i){var l=i.memoizedState,d=0;l!==null&&(d=l.retryLane),sw(i,d)}function ak(i,l){var d=0;switch(i.tag){case 13:var m=i.stateNode,S=i.memoizedState;S!==null&&(d=S.retryLane);break;case 19:m=i.stateNode;break;case 22:m=i.stateNode._retryCache;break;default:throw Error(a(314))}m!==null&&m.delete(l),sw(i,d)}function nk(i,l){return ot(i,l)}var rm=null,F0=null,qx=!1,am=!1,Gx=!1,Nf=0;function Bl(i){i!==F0&&i.next===null&&(F0===null?rm=F0=i:F0=F0.next=i),am=!0,qx||(qx=!0,ik(sk))}function Jh(i,l){if(!Gx&&am){Gx=!0;do for(var d=!1,m=rm;m!==null;){if(i!==0){var S=m.pendingLanes;if(S===0)var T=0;else{var W=m.suspendedLanes,me=m.pingedLanes;T=(1<<31-fa(42|i)+1)-1,T&=S&~(W&~me),T=T&201326677?T&201326677|1:T?T|2:0}T!==0&&(d=!0,lw(m,T))}else T=Qr,T=sr(m,m===Fa?T:0),(T&3)===0||kr(m,T)||(d=!0,lw(m,T));m=m.next}while(d);Gx=!1}}function sk(){am=qx=!1;var i=0;Nf!==0&&(pk()&&(i=Nf),Nf=0);for(var l=ct(),d=null,m=rm;m!==null;){var S=m.next,T=iw(m,l);T===0?(m.next=null,d===null?rm=S:d.next=S,S===null&&(F0=d)):(d=m,(i!==0||(T&3)!==0)&&(am=!0)),m=S}Jh(i)}function iw(i,l){for(var d=i.suspendedLanes,m=i.pingedLanes,S=i.expirationTimes,T=i.pendingLanes&-62914561;0<T;){var W=31-fa(T),me=1<<W,je=S[W];je===-1?((me&d)===0||(me&m)!==0)&&(S[W]=As(me,l)):je<=l&&(i.expiredLanes|=me),T&=~me}if(l=Fa,d=Qr,d=sr(i,i===l?d:0),m=i.callbackNode,d===0||i===l&&Pa===2||i.cancelPendingCommit!==null)return m!==null&&m!==null&&ut(m),i.callbackNode=null,i.callbackPriority=0;if((d&3)===0||kr(i,d)){if(l=d&-d,l===i.callbackPriority)return l;switch(m!==null&&ut(m),qr(d)){case 2:case 8:d=Ot;break;case 32:d=It;break;case 268435456:d=Ct;break;default:d=It}return m=ow.bind(null,i),d=ot(d,m),i.callbackPriority=l,i.callbackNode=d,l}return m!==null&&m!==null&&ut(m),i.callbackPriority=2,i.callbackNode=null,2}function ow(i,l){var d=i.callbackNode;if(D0()&&i.callbackNode!==d)return null;var m=Qr;return m=sr(i,i===Fa?m:0),m===0?null:(X5(i,m,l),iw(i,ct()),i.callbackNode!=null&&i.callbackNode===d?ow.bind(null,i):null)}function lw(i,l){if(D0())return null;X5(i,l,!0)}function ik(i){xk(function(){(rn&6)!==0?ot(pt,i):i()})}function Wx(){return Nf===0&&(Nf=ka()),Nf}function cw(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:no(""+i)}function uw(i,l){var d=l.ownerDocument.createElement("input");return d.name=l.name,d.value=l.value,i.id&&d.setAttribute("form",i.id),l.parentNode.insertBefore(d,l),i=new FormData(i),d.parentNode.removeChild(d),i}function ok(i,l,d,m,S){if(l==="submit"&&d&&d.stateNode===S){var T=cw((S[ge]||null).action),W=m.submitter;W&&(l=(l=W[ge]||null)?cw(l.formAction):W.getAttribute("formAction"),l!==null&&(T=l,W=null));var me=new Ae("action","action",null,m,S);i.push({event:me,listeners:[{instance:null,listener:function(){if(m.defaultPrevented){if(Nf!==0){var je=W?uw(S,W):new FormData(S);y0(d,{pending:!0,data:je,method:S.method,action:T},null,je)}}else typeof T=="function"&&(me.preventDefault(),je=W?uw(S,W):new FormData(S),y0(d,{pending:!0,data:je,method:S.method,action:T},T,je))},currentTarget:S}]})}}for(var $x=0;$x<li.length;$x++){var Xx=li[$x],lk=Xx.toLowerCase(),ck=Xx[0].toUpperCase()+Xx.slice(1);Wa(lk,"on"+ck)}Wa(El,"onAnimationEnd"),Wa(jl,"onAnimationIteration"),Wa(Io,"onAnimationStart"),Wa("dblclick","onDoubleClick"),Wa("focusin","onFocus"),Wa("focusout","onBlur"),Wa(ic,"onTransitionRun"),Wa(Qc,"onTransitionStart"),Wa(oc,"onTransitionCancel"),Wa(Bo,"onTransitionEnd"),Ht("onMouseEnter",["mouseout","mouseover"]),Ht("onMouseLeave",["mouseout","mouseover"]),Ht("onPointerEnter",["pointerout","pointerover"]),Ht("onPointerLeave",["pointerout","pointerover"]),kt("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),kt("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),kt("onBeforeInput",["compositionend","keypress","textInput","paste"]),kt("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),kt("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),kt("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Kh="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),uk=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Kh));function fw(i,l){l=(l&4)!==0;for(var d=0;d<i.length;d++){var m=i[d],S=m.event;m=m.listeners;e:{var T=void 0;if(l)for(var W=m.length-1;0<=W;W--){var me=m[W],je=me.instance,Be=me.currentTarget;if(me=me.listener,je!==T&&S.isPropagationStopped())break e;T=me,S.currentTarget=Be;try{T(S)}catch(xt){cu(xt)}S.currentTarget=null,T=je}else for(W=0;W<m.length;W++){if(me=m[W],je=me.instance,Be=me.currentTarget,me=me.listener,je!==T&&S.isPropagationStopped())break e;T=me,S.currentTarget=Be;try{T(S)}catch(xt){cu(xt)}S.currentTarget=null,T=je}}}}function Kr(i,l){var d=l[_e];d===void 0&&(d=l[_e]=new Set);var m=i+"__bubble";d.has(m)||(hw(l,i,2,!1),d.add(m))}function Yx(i,l,d){var m=0;l&&(m|=4),hw(d,i,m,l)}var nm="_reactListening"+Math.random().toString(36).slice(2);function Jx(i){if(!i[nm]){i[nm]=!0,Oe.forEach(function(d){d!=="selectionchange"&&(uk.has(d)||Yx(d,!1,i),Yx(d,!0,i))});var l=i.nodeType===9?i:i.ownerDocument;l===null||l[nm]||(l[nm]=!0,Yx("selectionchange",!1,l))}}function hw(i,l,d,m){switch(Ow(l)){case 2:var S=Rk;break;case 8:S=Mk;break;default:S=cg}d=S.bind(null,l,d,i),S=void 0,!vl||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(S=!0),m?S!==void 0?i.addEventListener(l,d,{capture:!0,passive:S}):i.addEventListener(l,d,!0):S!==void 0?i.addEventListener(l,d,{passive:S}):i.addEventListener(l,d,!1)}function Kx(i,l,d,m,S){var T=m;if((l&1)===0&&(l&2)===0&&m!==null)e:for(;;){if(m===null)return;var W=m.tag;if(W===3||W===4){var me=m.stateNode.containerInfo;if(me===S||me.nodeType===8&&me.parentNode===S)break;if(W===4)for(W=m.return;W!==null;){var je=W.tag;if((je===3||je===4)&&(je=W.stateNode.containerInfo,je===S||je.nodeType===8&&je.parentNode===S))return;W=W.return}for(;me!==null;){if(W=St(me),W===null)return;if(je=W.tag,je===5||je===6||je===26||je===27){m=T=W;continue e}me=me.parentNode}}m=m.return}si(function(){var Be=T,xt=tc(d),Tt=[];e:{var it=eu.get(i);if(it!==void 0){var dt=Ae,ar=i;switch(i){case"keypress":if(io(d)===0)break e;case"keydown":case"keyup":dt=oo;break;case"focusin":ar="focus",dt=la;break;case"focusout":ar="blur",dt=la;break;case"beforeblur":case"afterblur":dt=la;break;case"click":if(d.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":dt=Wt;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":dt=Xt;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":dt=Xu;break;case El:case jl:case Io:dt=Ga;break;case Bo:dt=ae;break;case"scroll":case"scrollend":dt=tt;break;case"wheel":dt=Fe;break;case"copy":case"cut":case"paste":dt=es;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":dt=Po;break;case"toggle":case"beforetoggle":dt=ft}var _r=(l&4)!==0,fn=!_r&&(i==="scroll"||i==="scrollend"),Ge=_r?it!==null?it+"Capture":null:it;_r=[];for(var Me=Be,et;Me!==null;){var bt=Me;if(et=bt.stateNode,bt=bt.tag,bt!==5&&bt!==26&&bt!==27||et===null||Ge===null||(bt=so(Me,Ge),bt!=null&&_r.push(Zh(Me,bt,et))),fn)break;Me=Me.return}0<_r.length&&(it=new dt(it,ar,null,d,xt),Tt.push({event:it,listeners:_r}))}}if((l&7)===0){e:{if(it=i==="mouseover"||i==="pointerover",dt=i==="mouseout"||i==="pointerout",it&&d!==on&&(ar=d.relatedTarget||d.fromElement)&&(St(ar)||ar[Se]))break e;if((dt||it)&&(it=xt.window===xt?xt:(it=xt.ownerDocument)?it.defaultView||it.parentWindow:window,dt?(ar=d.relatedTarget||d.toElement,dt=Be,ar=ar?St(ar):null,ar!==null&&(fn=te(ar),_r=ar.tag,ar!==fn||_r!==5&&_r!==27&&_r!==6)&&(ar=null)):(dt=null,ar=Be),dt!==ar)){if(_r=Wt,bt="onMouseLeave",Ge="onMouseEnter",Me="mouse",(i==="pointerout"||i==="pointerover")&&(_r=Po,bt="onPointerLeave",Ge="onPointerEnter",Me="pointer"),fn=dt==null?it:Ut(dt),et=ar==null?it:Ut(ar),it=new _r(bt,Me+"leave",dt,d,xt),it.target=fn,it.relatedTarget=et,bt=null,St(xt)===Be&&(_r=new _r(Ge,Me+"enter",ar,d,xt),_r.target=et,_r.relatedTarget=fn,bt=_r),fn=bt,dt&&ar)t:{for(_r=dt,Ge=ar,Me=0,et=_r;et;et=P0(et))Me++;for(et=0,bt=Ge;bt;bt=P0(bt))et++;for(;0<Me-et;)_r=P0(_r),Me--;for(;0<et-Me;)Ge=P0(Ge),et--;for(;Me--;){if(_r===Ge||Ge!==null&&_r===Ge.alternate)break t;_r=P0(_r),Ge=P0(Ge)}_r=null}else _r=null;dt!==null&&dw(Tt,it,dt,_r,!1),ar!==null&&fn!==null&&dw(Tt,fn,ar,_r,!0)}}e:{if(it=Be?Ut(Be):window,dt=it.nodeName&&it.nodeName.toLowerCase(),dt==="select"||dt==="input"&&it.type==="file")var Kt=Jc;else if(Oi(it))if(ac)Kt=o0;else{Kt=Ah;var zr=Fs}else dt=it.nodeName,!dt||dt.toLowerCase()!=="input"||it.type!=="checkbox"&&it.type!=="radio"?Be&&Zn(Be.elementType)&&(Kt=Jc):Kt=Ju;if(Kt&&(Kt=Kt(i,Be))){Yu(Tt,Kt,d,xt);break e}zr&&zr(i,it,Be),i==="focusout"&&Be&&it.type==="number"&&Be.memoizedProps.value!=null&&_s(it,"number",it.value)}switch(zr=Be?Ut(Be):window,i){case"focusin":(Oi(zr)||zr.contentEditable==="true")&&(Ps=zr,Tl=Be,oi=null);break;case"focusout":oi=Tl=Ps=null;break;case"mousedown":Ma=!0;break;case"contextmenu":case"mouseup":case"dragend":Ma=!1,Zc(Tt,d,xt);break;case"selectionchange":if(Mo)break;case"keydown":case"keyup":Zc(Tt,d,xt)}var or;if(qt)e:{switch(i){case"compositionstart":var pr="onCompositionStart";break e;case"compositionend":pr="onCompositionEnd";break e;case"compositionupdate":pr="onCompositionUpdate";break e}pr=void 0}else Qa?Ra(i,d)&&(pr="onCompositionEnd"):i==="keydown"&&d.keyCode===229&&(pr="onCompositionStart");pr&&(br&&d.locale!=="ko"&&(Qa||pr!=="onCompositionStart"?pr==="onCompositionEnd"&&Qa&&(or=Xc()):(Es=xt,rc="value"in Es?Es.value:Es.textContent,Qa=!0)),zr=sm(Be,pr),0<zr.length&&(pr=new yn(pr,i,null,d,xt),Tt.push({event:pr,listeners:zr}),or?pr.data=or:(or=Za(d),or!==null&&(pr.data=or)))),(or=Ar?Ln(i,d):Li(i,d))&&(pr=sm(Be,"onBeforeInput"),0<pr.length&&(zr=new yn("onBeforeInput","beforeinput",null,d,xt),Tt.push({event:zr,listeners:pr}),zr.data=or)),ok(Tt,i,Be,d,xt)}fw(Tt,l)})}function Zh(i,l,d){return{instance:i,listener:l,currentTarget:d}}function sm(i,l){for(var d=l+"Capture",m=[];i!==null;){var S=i,T=S.stateNode;S=S.tag,S!==5&&S!==26&&S!==27||T===null||(S=so(i,d),S!=null&&m.unshift(Zh(i,S,T)),S=so(i,l),S!=null&&m.push(Zh(i,S,T))),i=i.return}return m}function P0(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function dw(i,l,d,m,S){for(var T=l._reactName,W=[];d!==null&&d!==m;){var me=d,je=me.alternate,Be=me.stateNode;if(me=me.tag,je!==null&&je===m)break;me!==5&&me!==26&&me!==27||Be===null||(je=Be,S?(Be=so(d,T),Be!=null&&W.unshift(Zh(d,Be,je))):S||(Be=so(d,T),Be!=null&&W.push(Zh(d,Be,je)))),d=d.return}W.length!==0&&i.push({event:l,listeners:W})}var fk=/\r\n?/g,hk=/\u0000|\uFFFD/g;function pw(i){return(typeof i=="string"?i:""+i).replace(fk,`
`).replace(hk,"")}function mw(i,l){return l=pw(l),pw(i)===l}function im(){}function Sa(i,l,d,m,S,T){switch(d){case"children":typeof m=="string"?l==="body"||l==="textarea"&&m===""||ks(i,m):(typeof m=="number"||typeof m=="bigint")&&l!=="body"&&ks(i,""+m);break;case"className":rr(i,"class",m);break;case"tabIndex":rr(i,"tabindex",m);break;case"dir":case"role":case"viewBox":case"width":case"height":rr(i,d,m);break;case"style":ao(i,m,T);break;case"data":if(l!=="object"){rr(i,"data",m);break}case"src":case"href":if(m===""&&(l!=="a"||d!=="href")){i.removeAttribute(d);break}if(m==null||typeof m=="function"||typeof m=="symbol"||typeof m=="boolean"){i.removeAttribute(d);break}m=no(""+m),i.setAttribute(d,m);break;case"action":case"formAction":if(typeof m=="function"){i.setAttribute(d,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof T=="function"&&(d==="formAction"?(l!=="input"&&Sa(i,l,"name",S.name,S,null),Sa(i,l,"formEncType",S.formEncType,S,null),Sa(i,l,"formMethod",S.formMethod,S,null),Sa(i,l,"formTarget",S.formTarget,S,null)):(Sa(i,l,"encType",S.encType,S,null),Sa(i,l,"method",S.method,S,null),Sa(i,l,"target",S.target,S,null)));if(m==null||typeof m=="symbol"||typeof m=="boolean"){i.removeAttribute(d);break}m=no(""+m),i.setAttribute(d,m);break;case"onClick":m!=null&&(i.onclick=im);break;case"onScroll":m!=null&&Kr("scroll",i);break;case"onScrollEnd":m!=null&&Kr("scrollend",i);break;case"dangerouslySetInnerHTML":if(m!=null){if(typeof m!="object"||!("__html"in m))throw Error(a(61));if(d=m.__html,d!=null){if(S.children!=null)throw Error(a(60));i.innerHTML=d}}break;case"multiple":i.multiple=m&&typeof m!="function"&&typeof m!="symbol";break;case"muted":i.muted=m&&typeof m!="function"&&typeof m!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(m==null||typeof m=="function"||typeof m=="boolean"||typeof m=="symbol"){i.removeAttribute("xlink:href");break}d=no(""+m),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",d);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":m!=null&&typeof m!="function"&&typeof m!="symbol"?i.setAttribute(d,""+m):i.removeAttribute(d);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":m&&typeof m!="function"&&typeof m!="symbol"?i.setAttribute(d,""):i.removeAttribute(d);break;case"capture":case"download":m===!0?i.setAttribute(d,""):m!==!1&&m!=null&&typeof m!="function"&&typeof m!="symbol"?i.setAttribute(d,m):i.removeAttribute(d);break;case"cols":case"rows":case"size":case"span":m!=null&&typeof m!="function"&&typeof m!="symbol"&&!isNaN(m)&&1<=m?i.setAttribute(d,m):i.removeAttribute(d);break;case"rowSpan":case"start":m==null||typeof m=="function"||typeof m=="symbol"||isNaN(m)?i.removeAttribute(d):i.setAttribute(d,m);break;case"popover":Kr("beforetoggle",i),Kr("toggle",i),er(i,"popover",m);break;case"xlinkActuate":Ur(i,"http://www.w3.org/1999/xlink","xlink:actuate",m);break;case"xlinkArcrole":Ur(i,"http://www.w3.org/1999/xlink","xlink:arcrole",m);break;case"xlinkRole":Ur(i,"http://www.w3.org/1999/xlink","xlink:role",m);break;case"xlinkShow":Ur(i,"http://www.w3.org/1999/xlink","xlink:show",m);break;case"xlinkTitle":Ur(i,"http://www.w3.org/1999/xlink","xlink:title",m);break;case"xlinkType":Ur(i,"http://www.w3.org/1999/xlink","xlink:type",m);break;case"xmlBase":Ur(i,"http://www.w3.org/XML/1998/namespace","xml:base",m);break;case"xmlLang":Ur(i,"http://www.w3.org/XML/1998/namespace","xml:lang",m);break;case"xmlSpace":Ur(i,"http://www.w3.org/XML/1998/namespace","xml:space",m);break;case"is":er(i,"is",m);break;case"innerText":case"textContent":break;default:(!(2<d.length)||d[0]!=="o"&&d[0]!=="O"||d[1]!=="n"&&d[1]!=="N")&&(d=Qn.get(d)||d,er(i,d,m))}}function Zx(i,l,d,m,S,T){switch(d){case"style":ao(i,m,T);break;case"dangerouslySetInnerHTML":if(m!=null){if(typeof m!="object"||!("__html"in m))throw Error(a(61));if(d=m.__html,d!=null){if(S.children!=null)throw Error(a(60));i.innerHTML=d}}break;case"children":typeof m=="string"?ks(i,m):(typeof m=="number"||typeof m=="bigint")&&ks(i,""+m);break;case"onScroll":m!=null&&Kr("scroll",i);break;case"onScrollEnd":m!=null&&Kr("scrollend",i);break;case"onClick":m!=null&&(i.onclick=im);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Ve.hasOwnProperty(d))e:{if(d[0]==="o"&&d[1]==="n"&&(S=d.endsWith("Capture"),l=d.slice(2,S?d.length-7:void 0),T=i[ge]||null,T=T!=null?T[d]:null,typeof T=="function"&&i.removeEventListener(l,T,S),typeof m=="function")){typeof T!="function"&&T!==null&&(d in i?i[d]=null:i.hasAttribute(d)&&i.removeAttribute(d)),i.addEventListener(l,m,S);break e}d in i?i[d]=m:m===!0?i.setAttribute(d,""):er(i,d,m)}}}function vs(i,l,d){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Kr("error",i),Kr("load",i);var m=!1,S=!1,T;for(T in d)if(d.hasOwnProperty(T)){var W=d[T];if(W!=null)switch(T){case"src":m=!0;break;case"srcSet":S=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,l));default:Sa(i,l,T,W,d,null)}}S&&Sa(i,l,"srcSet",d.srcSet,d,null),m&&Sa(i,l,"src",d.src,d,null);return;case"input":Kr("invalid",i);var me=T=W=S=null,je=null,Be=null;for(m in d)if(d.hasOwnProperty(m)){var xt=d[m];if(xt!=null)switch(m){case"name":S=xt;break;case"type":W=xt;break;case"checked":je=xt;break;case"defaultChecked":Be=xt;break;case"value":T=xt;break;case"defaultValue":me=xt;break;case"children":case"dangerouslySetInnerHTML":if(xt!=null)throw Error(a(137,l));break;default:Sa(i,l,m,xt,d,null)}}ri(i,T,me,je,Be,W,S,!1),ti(i);return;case"select":Kr("invalid",i),m=W=T=null;for(S in d)if(d.hasOwnProperty(S)&&(me=d[S],me!=null))switch(S){case"value":T=me;break;case"defaultValue":W=me;break;case"multiple":m=me;default:Sa(i,l,S,me,d,null)}l=T,d=W,i.multiple=!!m,l!=null?Ts(i,!!m,l,!1):d!=null&&Ts(i,!!m,d,!0);return;case"textarea":Kr("invalid",i),T=S=m=null;for(W in d)if(d.hasOwnProperty(W)&&(me=d[W],me!=null))switch(W){case"value":m=me;break;case"defaultValue":S=me;break;case"children":T=me;break;case"dangerouslySetInnerHTML":if(me!=null)throw Error(a(91));break;default:Sa(i,l,W,me,d,null)}xl(i,m,S,T),ti(i);return;case"option":for(je in d)if(d.hasOwnProperty(je)&&(m=d[je],m!=null))switch(je){case"selected":i.selected=m&&typeof m!="function"&&typeof m!="symbol";break;default:Sa(i,l,je,m,d,null)}return;case"dialog":Kr("cancel",i),Kr("close",i);break;case"iframe":case"object":Kr("load",i);break;case"video":case"audio":for(m=0;m<Kh.length;m++)Kr(Kh[m],i);break;case"image":Kr("error",i),Kr("load",i);break;case"details":Kr("toggle",i);break;case"embed":case"source":case"link":Kr("error",i),Kr("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Be in d)if(d.hasOwnProperty(Be)&&(m=d[Be],m!=null))switch(Be){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,l));default:Sa(i,l,Be,m,d,null)}return;default:if(Zn(l)){for(xt in d)d.hasOwnProperty(xt)&&(m=d[xt],m!==void 0&&Zx(i,l,xt,m,d,void 0));return}}for(me in d)d.hasOwnProperty(me)&&(m=d[me],m!=null&&Sa(i,l,me,m,d,null))}function dk(i,l,d,m){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var S=null,T=null,W=null,me=null,je=null,Be=null,xt=null;for(dt in d){var Tt=d[dt];if(d.hasOwnProperty(dt)&&Tt!=null)switch(dt){case"checked":break;case"value":break;case"defaultValue":je=Tt;default:m.hasOwnProperty(dt)||Sa(i,l,dt,null,m,Tt)}}for(var it in m){var dt=m[it];if(Tt=d[it],m.hasOwnProperty(it)&&(dt!=null||Tt!=null))switch(it){case"type":T=dt;break;case"name":S=dt;break;case"checked":Be=dt;break;case"defaultChecked":xt=dt;break;case"value":W=dt;break;case"defaultValue":me=dt;break;case"children":case"dangerouslySetInnerHTML":if(dt!=null)throw Error(a(137,l));break;default:dt!==Tt&&Sa(i,l,it,dt,m,Tt)}}Kn(i,W,me,je,Be,xt,T,S);return;case"select":dt=W=me=it=null;for(T in d)if(je=d[T],d.hasOwnProperty(T)&&je!=null)switch(T){case"value":break;case"multiple":dt=je;default:m.hasOwnProperty(T)||Sa(i,l,T,null,m,je)}for(S in m)if(T=m[S],je=d[S],m.hasOwnProperty(S)&&(T!=null||je!=null))switch(S){case"value":it=T;break;case"defaultValue":me=T;break;case"multiple":W=T;default:T!==je&&Sa(i,l,S,T,m,je)}l=me,d=W,m=dt,it!=null?Ts(i,!!d,it,!1):!!m!=!!d&&(l!=null?Ts(i,!!d,l,!0):Ts(i,!!d,d?[]:"",!1));return;case"textarea":dt=it=null;for(me in d)if(S=d[me],d.hasOwnProperty(me)&&S!=null&&!m.hasOwnProperty(me))switch(me){case"value":break;case"children":break;default:Sa(i,l,me,null,m,S)}for(W in m)if(S=m[W],T=d[W],m.hasOwnProperty(W)&&(S!=null||T!=null))switch(W){case"value":it=S;break;case"defaultValue":dt=S;break;case"children":break;case"dangerouslySetInnerHTML":if(S!=null)throw Error(a(91));break;default:S!==T&&Sa(i,l,W,S,m,T)}ai(i,it,dt);return;case"option":for(var ar in d)if(it=d[ar],d.hasOwnProperty(ar)&&it!=null&&!m.hasOwnProperty(ar))switch(ar){case"selected":i.selected=!1;break;default:Sa(i,l,ar,null,m,it)}for(je in m)if(it=m[je],dt=d[je],m.hasOwnProperty(je)&&it!==dt&&(it!=null||dt!=null))switch(je){case"selected":i.selected=it&&typeof it!="function"&&typeof it!="symbol";break;default:Sa(i,l,je,it,m,dt)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var _r in d)it=d[_r],d.hasOwnProperty(_r)&&it!=null&&!m.hasOwnProperty(_r)&&Sa(i,l,_r,null,m,it);for(Be in m)if(it=m[Be],dt=d[Be],m.hasOwnProperty(Be)&&it!==dt&&(it!=null||dt!=null))switch(Be){case"children":case"dangerouslySetInnerHTML":if(it!=null)throw Error(a(137,l));break;default:Sa(i,l,Be,it,m,dt)}return;default:if(Zn(l)){for(var fn in d)it=d[fn],d.hasOwnProperty(fn)&&it!==void 0&&!m.hasOwnProperty(fn)&&Zx(i,l,fn,void 0,m,it);for(xt in m)it=m[xt],dt=d[xt],!m.hasOwnProperty(xt)||it===dt||it===void 0&&dt===void 0||Zx(i,l,xt,it,m,dt);return}}for(var Ge in d)it=d[Ge],d.hasOwnProperty(Ge)&&it!=null&&!m.hasOwnProperty(Ge)&&Sa(i,l,Ge,null,m,it);for(Tt in m)it=m[Tt],dt=d[Tt],!m.hasOwnProperty(Tt)||it===dt||it==null&&dt==null||Sa(i,l,Tt,it,m,dt)}var Qx=null,eg=null;function om(i){return i.nodeType===9?i:i.ownerDocument}function xw(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function gw(i,l){if(i===0)switch(l){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&l==="foreignObject"?0:i}function tg(i,l){return i==="textarea"||i==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.children=="bigint"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var rg=null;function pk(){var i=window.event;return i&&i.type==="popstate"?i===rg?!1:(rg=i,!0):(rg=null,!1)}var vw=typeof setTimeout=="function"?setTimeout:void 0,mk=typeof clearTimeout=="function"?clearTimeout:void 0,yw=typeof Promise=="function"?Promise:void 0,xk=typeof queueMicrotask=="function"?queueMicrotask:typeof yw<"u"?function(i){return yw.resolve(null).then(i).catch(gk)}:vw;function gk(i){setTimeout(function(){throw i})}function ag(i,l){var d=l,m=0;do{var S=d.nextSibling;if(i.removeChild(d),S&&S.nodeType===8)if(d=S.data,d==="/$"){if(m===0){i.removeChild(S),id(l);return}m--}else d!=="$"&&d!=="$?"&&d!=="$!"||m++;d=S}while(d);id(l)}function ng(i){var l=i.firstChild;for(l&&l.nodeType===10&&(l=l.nextSibling);l;){var d=l;switch(l=l.nextSibling,d.nodeName){case"HTML":case"HEAD":case"BODY":ng(d),Qe(d);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(d.rel.toLowerCase()==="stylesheet")continue}i.removeChild(d)}}function vk(i,l,d,m){for(;i.nodeType===1;){var S=d;if(i.nodeName.toLowerCase()!==l.toLowerCase()){if(!m&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(m){if(!i[$e])switch(l){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(T=i.getAttribute("rel"),T==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(T!==S.rel||i.getAttribute("href")!==(S.href==null?null:S.href)||i.getAttribute("crossorigin")!==(S.crossOrigin==null?null:S.crossOrigin)||i.getAttribute("title")!==(S.title==null?null:S.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(T=i.getAttribute("src"),(T!==(S.src==null?null:S.src)||i.getAttribute("type")!==(S.type==null?null:S.type)||i.getAttribute("crossorigin")!==(S.crossOrigin==null?null:S.crossOrigin))&&T&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(l==="input"&&i.type==="hidden"){var T=S.name==null?null:""+S.name;if(S.type==="hidden"&&i.getAttribute("name")===T)return i}else return i;if(i=Zo(i.nextSibling),i===null)break}return null}function yk(i,l,d){if(l==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!d||(i=Zo(i.nextSibling),i===null))return null;return i}function Zo(i){for(;i!=null;i=i.nextSibling){var l=i.nodeType;if(l===1||l===3)break;if(l===8){if(l=i.data,l==="$"||l==="$!"||l==="$?"||l==="F!"||l==="F")break;if(l==="/$")return null}}return i}function ww(i){i=i.previousSibling;for(var l=0;i;){if(i.nodeType===8){var d=i.data;if(d==="$"||d==="$!"||d==="$?"){if(l===0)return i;l--}else d==="/$"&&l++}i=i.previousSibling}return null}function bw(i,l,d){switch(l=om(d),i){case"html":if(i=l.documentElement,!i)throw Error(a(452));return i;case"head":if(i=l.head,!i)throw Error(a(453));return i;case"body":if(i=l.body,!i)throw Error(a(454));return i;default:throw Error(a(451))}}var vo=new Map,Sw=new Set;function lm(i){return typeof i.getRootNode=="function"?i.getRootNode():i.ownerDocument}var kc=L.d;L.d={f:wk,r:bk,D:Sk,C:Nk,L:Ak,m:_k,X:kk,S:Tk,M:Ek};function wk(){var i=kc.f(),l=em();return i||l}function bk(i){var l=jt(i);l!==null&&l.tag===5&&l.type==="form"?xf(l):kc.r(i)}var L0=typeof document>"u"?null:document;function Nw(i,l,d){var m=L0;if(m&&typeof l=="string"&&l){var S=ca(l);S='link[rel="'+i+'"][href="'+S+'"]',typeof d=="string"&&(S+='[crossorigin="'+d+'"]'),Sw.has(S)||(Sw.add(S),i={rel:i,crossOrigin:d,href:l},m.querySelector(S)===null&&(l=m.createElement("link"),vs(l,"link",i),Ce(l),m.head.appendChild(l)))}}function Sk(i){kc.D(i),Nw("dns-prefetch",i,null)}function Nk(i,l){kc.C(i,l),Nw("preconnect",i,l)}function Ak(i,l,d){kc.L(i,l,d);var m=L0;if(m&&i&&l){var S='link[rel="preload"][as="'+ca(l)+'"]';l==="image"&&d&&d.imageSrcSet?(S+='[imagesrcset="'+ca(d.imageSrcSet)+'"]',typeof d.imageSizes=="string"&&(S+='[imagesizes="'+ca(d.imageSizes)+'"]')):S+='[href="'+ca(i)+'"]';var T=S;switch(l){case"style":T=O0(i);break;case"script":T=R0(i)}vo.has(T)||(i=re({rel:"preload",href:l==="image"&&d&&d.imageSrcSet?void 0:i,as:l},d),vo.set(T,i),m.querySelector(S)!==null||l==="style"&&m.querySelector(Qh(T))||l==="script"&&m.querySelector(ed(T))||(l=m.createElement("link"),vs(l,"link",i),Ce(l),m.head.appendChild(l)))}}function _k(i,l){kc.m(i,l);var d=L0;if(d&&i){var m=l&&typeof l.as=="string"?l.as:"script",S='link[rel="modulepreload"][as="'+ca(m)+'"][href="'+ca(i)+'"]',T=S;switch(m){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":T=R0(i)}if(!vo.has(T)&&(i=re({rel:"modulepreload",href:i},l),vo.set(T,i),d.querySelector(S)===null)){switch(m){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(d.querySelector(ed(T)))return}m=d.createElement("link"),vs(m,"link",i),Ce(m),d.head.appendChild(m)}}}function Tk(i,l,d){kc.S(i,l,d);var m=L0;if(m&&i){var S=ie(m).hoistableStyles,T=O0(i);l=l||"default";var W=S.get(T);if(!W){var me={loading:0,preload:null};if(W=m.querySelector(Qh(T)))me.loading=5;else{i=re({rel:"stylesheet",href:i,"data-precedence":l},d),(d=vo.get(T))&&sg(i,d);var je=W=m.createElement("link");Ce(je),vs(je,"link",i),je._p=new Promise(function(Be,xt){je.onload=Be,je.onerror=xt}),je.addEventListener("load",function(){me.loading|=1}),je.addEventListener("error",function(){me.loading|=2}),me.loading|=4,cm(W,l,m)}W={type:"stylesheet",instance:W,count:1,state:me},S.set(T,W)}}}function kk(i,l){kc.X(i,l);var d=L0;if(d&&i){var m=ie(d).hoistableScripts,S=R0(i),T=m.get(S);T||(T=d.querySelector(ed(S)),T||(i=re({src:i,async:!0},l),(l=vo.get(S))&&ig(i,l),T=d.createElement("script"),Ce(T),vs(T,"link",i),d.head.appendChild(T)),T={type:"script",instance:T,count:1,state:null},m.set(S,T))}}function Ek(i,l){kc.M(i,l);var d=L0;if(d&&i){var m=ie(d).hoistableScripts,S=R0(i),T=m.get(S);T||(T=d.querySelector(ed(S)),T||(i=re({src:i,async:!0,type:"module"},l),(l=vo.get(S))&&ig(i,l),T=d.createElement("script"),Ce(T),vs(T,"link",i),d.head.appendChild(T)),T={type:"script",instance:T,count:1,state:null},m.set(S,T))}}function Aw(i,l,d,m){var S=(S=Pe.current)?lm(S):null;if(!S)throw Error(a(446));switch(i){case"meta":case"title":return null;case"style":return typeof d.precedence=="string"&&typeof d.href=="string"?(l=O0(d.href),d=ie(S).hoistableStyles,m=d.get(l),m||(m={type:"style",instance:null,count:0,state:null},d.set(l,m)),m):{type:"void",instance:null,count:0,state:null};case"link":if(d.rel==="stylesheet"&&typeof d.href=="string"&&typeof d.precedence=="string"){i=O0(d.href);var T=ie(S).hoistableStyles,W=T.get(i);if(W||(S=S.ownerDocument||S,W={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},T.set(i,W),(T=S.querySelector(Qh(i)))&&!T._p&&(W.instance=T,W.state.loading=5),vo.has(i)||(d={rel:"preload",as:"style",href:d.href,crossOrigin:d.crossOrigin,integrity:d.integrity,media:d.media,hrefLang:d.hrefLang,referrerPolicy:d.referrerPolicy},vo.set(i,d),T||jk(S,i,d,W.state))),l&&m===null)throw Error(a(528,""));return W}if(l&&m!==null)throw Error(a(529,""));return null;case"script":return l=d.async,d=d.src,typeof d=="string"&&l&&typeof l!="function"&&typeof l!="symbol"?(l=R0(d),d=ie(S).hoistableScripts,m=d.get(l),m||(m={type:"script",instance:null,count:0,state:null},d.set(l,m)),m):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,i))}}function O0(i){return'href="'+ca(i)+'"'}function Qh(i){return'link[rel="stylesheet"]['+i+"]"}function _w(i){return re({},i,{"data-precedence":i.precedence,precedence:null})}function jk(i,l,d,m){i.querySelector('link[rel="preload"][as="style"]['+l+"]")?m.loading=1:(l=i.createElement("link"),m.preload=l,l.addEventListener("load",function(){return m.loading|=1}),l.addEventListener("error",function(){return m.loading|=2}),vs(l,"link",d),Ce(l),i.head.appendChild(l))}function R0(i){return'[src="'+ca(i)+'"]'}function ed(i){return"script[async]"+i}function Tw(i,l,d){if(l.count++,l.instance===null)switch(l.type){case"style":var m=i.querySelector('style[data-href~="'+ca(d.href)+'"]');if(m)return l.instance=m,Ce(m),m;var S=re({},d,{"data-href":d.href,"data-precedence":d.precedence,href:null,precedence:null});return m=(i.ownerDocument||i).createElement("style"),Ce(m),vs(m,"style",S),cm(m,d.precedence,i),l.instance=m;case"stylesheet":S=O0(d.href);var T=i.querySelector(Qh(S));if(T)return l.state.loading|=4,l.instance=T,Ce(T),T;m=_w(d),(S=vo.get(S))&&sg(m,S),T=(i.ownerDocument||i).createElement("link"),Ce(T);var W=T;return W._p=new Promise(function(me,je){W.onload=me,W.onerror=je}),vs(T,"link",m),l.state.loading|=4,cm(T,d.precedence,i),l.instance=T;case"script":return T=R0(d.src),(S=i.querySelector(ed(T)))?(l.instance=S,Ce(S),S):(m=d,(S=vo.get(T))&&(m=re({},d),ig(m,S)),i=i.ownerDocument||i,S=i.createElement("script"),Ce(S),vs(S,"link",m),i.head.appendChild(S),l.instance=S);case"void":return null;default:throw Error(a(443,l.type))}else l.type==="stylesheet"&&(l.state.loading&4)===0&&(m=l.instance,l.state.loading|=4,cm(m,d.precedence,i));return l.instance}function cm(i,l,d){for(var m=d.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),S=m.length?m[m.length-1]:null,T=S,W=0;W<m.length;W++){var me=m[W];if(me.dataset.precedence===l)T=me;else if(T!==S)break}T?T.parentNode.insertBefore(i,T.nextSibling):(l=d.nodeType===9?d.head:d,l.insertBefore(i,l.firstChild))}function sg(i,l){i.crossOrigin==null&&(i.crossOrigin=l.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=l.referrerPolicy),i.title==null&&(i.title=l.title)}function ig(i,l){i.crossOrigin==null&&(i.crossOrigin=l.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=l.referrerPolicy),i.integrity==null&&(i.integrity=l.integrity)}var um=null;function kw(i,l,d){if(um===null){var m=new Map,S=um=new Map;S.set(d,m)}else S=um,m=S.get(d),m||(m=new Map,S.set(d,m));if(m.has(i))return m;for(m.set(i,null),d=d.getElementsByTagName(i),S=0;S<d.length;S++){var T=d[S];if(!(T[$e]||T[pe]||i==="link"&&T.getAttribute("rel")==="stylesheet")&&T.namespaceURI!=="http://www.w3.org/2000/svg"){var W=T.getAttribute(l)||"";W=i+W;var me=m.get(W);me?me.push(T):m.set(W,[T])}}return m}function Ew(i,l,d){i=i.ownerDocument||i,i.head.insertBefore(d,l==="title"?i.querySelector("head > title"):null)}function Ck(i,l,d){if(d===1||l.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof l.precedence!="string"||typeof l.href!="string"||l.href==="")break;return!0;case"link":if(typeof l.rel!="string"||typeof l.href!="string"||l.href===""||l.onLoad||l.onError)break;switch(l.rel){case"stylesheet":return i=l.disabled,typeof l.precedence=="string"&&i==null;default:return!0}case"script":if(l.async&&typeof l.async!="function"&&typeof l.async!="symbol"&&!l.onLoad&&!l.onError&&l.src&&typeof l.src=="string")return!0}return!1}function jw(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}var td=null;function Dk(){}function Fk(i,l,d){if(td===null)throw Error(a(475));var m=td;if(l.type==="stylesheet"&&(typeof d.media!="string"||matchMedia(d.media).matches!==!1)&&(l.state.loading&4)===0){if(l.instance===null){var S=O0(d.href),T=i.querySelector(Qh(S));if(T){i=T._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(m.count++,m=fm.bind(m),i.then(m,m)),l.state.loading|=4,l.instance=T,Ce(T);return}T=i.ownerDocument||i,d=_w(d),(S=vo.get(S))&&sg(d,S),T=T.createElement("link"),Ce(T);var W=T;W._p=new Promise(function(me,je){W.onload=me,W.onerror=je}),vs(T,"link",d),l.instance=T}m.stylesheets===null&&(m.stylesheets=new Map),m.stylesheets.set(l,i),(i=l.state.preload)&&(l.state.loading&3)===0&&(m.count++,l=fm.bind(m),i.addEventListener("load",l),i.addEventListener("error",l))}}function Pk(){if(td===null)throw Error(a(475));var i=td;return i.stylesheets&&i.count===0&&og(i,i.stylesheets),0<i.count?function(l){var d=setTimeout(function(){if(i.stylesheets&&og(i,i.stylesheets),i.unsuspend){var m=i.unsuspend;i.unsuspend=null,m()}},6e4);return i.unsuspend=l,function(){i.unsuspend=null,clearTimeout(d)}}:null}function fm(){if(this.count--,this.count===0){if(this.stylesheets)og(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var hm=null;function og(i,l){i.stylesheets=null,i.unsuspend!==null&&(i.count++,hm=new Map,l.forEach(Lk,i),hm=null,fm.call(i))}function Lk(i,l){if(!(l.state.loading&4)){var d=hm.get(i);if(d)var m=d.get(null);else{d=new Map,hm.set(i,d);for(var S=i.querySelectorAll("link[data-precedence],style[data-precedence]"),T=0;T<S.length;T++){var W=S[T];(W.nodeName==="LINK"||W.getAttribute("media")!=="not all")&&(d.set(W.dataset.precedence,W),m=W)}m&&d.set(null,m)}S=l.instance,W=S.getAttribute("data-precedence"),T=d.get(W)||m,T===m&&d.set(null,S),d.set(W,S),this.count++,m=fm.bind(this),S.addEventListener("load",m),S.addEventListener("error",m),T?T.parentNode.insertBefore(S,T.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(S,i.firstChild)),l.state.loading|=4}}var rd={$$typeof:g,Provider:null,Consumer:null,_currentValue:q,_currentValue2:q,_threadCount:0};function Ok(i,l,d,m,S,T,W,me){this.tag=1,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=gn(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.finishedLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gn(0),this.hiddenUpdates=gn(null),this.identifierPrefix=m,this.onUncaughtError=S,this.onCaughtError=T,this.onRecoverableError=W,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=me,this.incompleteTransitions=new Map}function Cw(i,l,d,m,S,T,W,me,je,Be,xt,Tt){return i=new Ok(i,l,d,W,me,je,Be,Tt),l=1,T===!0&&(l|=24),T=xo(3,null,null,l),i.current=T,T.stateNode=i,l=d0(),l.refCount++,i.pooledCache=l,l.refCount++,T.memoizedState={element:m,isDehydrated:d,cache:l},yx(T),i}function Dw(i){return i?(i=Uo,i):Uo}function Fw(i,l,d,m,S,T){S=Dw(S),m.context===null?m.context=S:m.pendingContext=S,m=du(l),m.payload={element:d},T=T===void 0?null:T,T!==null&&(m.callback=T),d=pu(i,m,l),d!==null&&(fi(d,i,l),Bh(d,i,l))}function Pw(i,l){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var d=i.retryLane;i.retryLane=d!==0&&d<l?d:l}}function lg(i,l){Pw(i,l),(i=i.alternate)&&Pw(i,l)}function Lw(i){if(i.tag===13){var l=ci(i,67108864);l!==null&&fi(l,i,67108864),lg(i,67108864)}}var dm=!0;function Rk(i,l,d,m){var S=H.T;H.T=null;var T=L.p;try{L.p=2,cg(i,l,d,m)}finally{L.p=T,H.T=S}}function Mk(i,l,d,m){var S=H.T;H.T=null;var T=L.p;try{L.p=8,cg(i,l,d,m)}finally{L.p=T,H.T=S}}function cg(i,l,d,m){if(dm){var S=ug(m);if(S===null)Kx(i,l,m,pm,d),Rw(i,m);else if(Bk(S,i,l,d,m))m.stopPropagation();else if(Rw(i,m),l&4&&-1<Ik.indexOf(i)){for(;S!==null;){var T=jt(S);if(T!==null)switch(T.tag){case 3:if(T=T.stateNode,T.current.memoizedState.isDehydrated){var W=Br(T.pendingLanes);if(W!==0){var me=T;for(me.pendingLanes|=2,me.entangledLanes|=2;W;){var je=1<<31-fa(W);me.entanglements[1]|=je,W&=~je}Bl(T),(rn&6)===0&&(Kp=ct()+500,Jh(0))}}break;case 13:me=ci(T,2),me!==null&&fi(me,T,2),em(),lg(T,2)}if(T=ug(m),T===null&&Kx(i,l,m,pm,d),T===S)break;S=T}S!==null&&m.stopPropagation()}else Kx(i,l,m,null,d)}}function ug(i){return i=tc(i),fg(i)}var pm=null;function fg(i){if(pm=null,i=St(i),i!==null){var l=te(i);if(l===null)i=null;else{var d=l.tag;if(d===13){if(i=Q(l),i!==null)return i;i=null}else if(d===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;i=null}else l!==i&&(i=null)}}return pm=i,null}function Ow(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ze()){case pt:return 2;case Ot:return 8;case It:case Lt:return 32;case Ct:return 268435456;default:return 32}default:return 32}}var hg=!1,bu=null,Su=null,Nu=null,ad=new Map,nd=new Map,Au=[],Ik="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Rw(i,l){switch(i){case"focusin":case"focusout":bu=null;break;case"dragenter":case"dragleave":Su=null;break;case"mouseover":case"mouseout":Nu=null;break;case"pointerover":case"pointerout":ad.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":nd.delete(l.pointerId)}}function sd(i,l,d,m,S,T){return i===null||i.nativeEvent!==T?(i={blockedOn:l,domEventName:d,eventSystemFlags:m,nativeEvent:T,targetContainers:[S]},l!==null&&(l=jt(l),l!==null&&Lw(l)),i):(i.eventSystemFlags|=m,l=i.targetContainers,S!==null&&l.indexOf(S)===-1&&l.push(S),i)}function Bk(i,l,d,m,S){switch(l){case"focusin":return bu=sd(bu,i,l,d,m,S),!0;case"dragenter":return Su=sd(Su,i,l,d,m,S),!0;case"mouseover":return Nu=sd(Nu,i,l,d,m,S),!0;case"pointerover":var T=S.pointerId;return ad.set(T,sd(ad.get(T)||null,i,l,d,m,S)),!0;case"gotpointercapture":return T=S.pointerId,nd.set(T,sd(nd.get(T)||null,i,l,d,m,S)),!0}return!1}function Mw(i){var l=St(i.target);if(l!==null){var d=te(l);if(d!==null){if(l=d.tag,l===13){if(l=Q(d),l!==null){i.blockedOn=l,ne(i.priority,function(){if(d.tag===13){var m=Xi(),S=ci(d,m);S!==null&&fi(S,d,m),lg(d,m)}});return}}else if(l===3&&d.stateNode.current.memoizedState.isDehydrated){i.blockedOn=d.tag===3?d.stateNode.containerInfo:null;return}}}i.blockedOn=null}function mm(i){if(i.blockedOn!==null)return!1;for(var l=i.targetContainers;0<l.length;){var d=ug(i.nativeEvent);if(d===null){d=i.nativeEvent;var m=new d.constructor(d.type,d);on=m,d.target.dispatchEvent(m),on=null}else return l=jt(d),l!==null&&Lw(l),i.blockedOn=d,!1;l.shift()}return!0}function Iw(i,l,d){mm(i)&&d.delete(l)}function Uk(){hg=!1,bu!==null&&mm(bu)&&(bu=null),Su!==null&&mm(Su)&&(Su=null),Nu!==null&&mm(Nu)&&(Nu=null),ad.forEach(Iw),nd.forEach(Iw)}function xm(i,l){i.blockedOn===l&&(i.blockedOn=null,hg||(hg=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Uk)))}var gm=null;function Bw(i){gm!==i&&(gm=i,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){gm===i&&(gm=null);for(var l=0;l<i.length;l+=3){var d=i[l],m=i[l+1],S=i[l+2];if(typeof m!="function"){if(fg(m||d)===null)continue;break}var T=jt(d);T!==null&&(i.splice(l,3),l-=3,y0(T,{pending:!0,data:S,method:d.method,action:m},m,S))}}))}function id(i){function l(je){return xm(je,i)}bu!==null&&xm(bu,i),Su!==null&&xm(Su,i),Nu!==null&&xm(Nu,i),ad.forEach(l),nd.forEach(l);for(var d=0;d<Au.length;d++){var m=Au[d];m.blockedOn===i&&(m.blockedOn=null)}for(;0<Au.length&&(d=Au[0],d.blockedOn===null);)Mw(d),d.blockedOn===null&&Au.shift();if(d=(i.ownerDocument||i).$$reactFormReplay,d!=null)for(m=0;m<d.length;m+=3){var S=d[m],T=d[m+1],W=S[ge]||null;if(typeof T=="function")W||Bw(d);else if(W){var me=null;if(T&&T.hasAttribute("formAction")){if(S=T,W=T[ge]||null)me=W.formAction;else if(fg(S)!==null)continue}else me=W.action;typeof me=="function"?d[m+1]=me:(d.splice(m,3),m-=3),Bw(d)}}}function dg(i){this._internalRoot=i}vm.prototype.render=dg.prototype.render=function(i){var l=this._internalRoot;if(l===null)throw Error(a(409));var d=l.current,m=Xi();Fw(d,m,i,l,null,null)},vm.prototype.unmount=dg.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var l=i.containerInfo;i.tag===0&&D0(),Fw(i.current,2,null,i,null,null),em(),l[Se]=null}};function vm(i){this._internalRoot=i}vm.prototype.unstable_scheduleHydration=function(i){if(i){var l=ha();i={blockedOn:null,target:i,priority:l};for(var d=0;d<Au.length&&l!==0&&l<Au[d].priority;d++);Au.splice(d,0,i),d===0&&Mw(i)}};var Uw=t.version;if(Uw!=="19.0.0")throw Error(a(527,Uw,"19.0.0"));L.findDOMNode=function(i){var l=i._reactInternals;if(l===void 0)throw typeof i.render=="function"?Error(a(188)):(i=Object.keys(i).join(","),Error(a(268,i)));return i=ye(l),i=i!==null?D(i):null,i=i===null?null:i.stateNode,i};var zk={bundleType:0,version:"19.0.0",rendererPackageName:"react-dom",currentDispatcherRef:H,findFiberByHostInstance:St,reconcilerVersion:"19.0.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ym=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ym.isDisabled&&ym.supportsFiber)try{zt=ym.inject(zk),Yt=ym}catch{}}return ld.createRoot=function(i,l){if(!n(i))throw Error(a(299));var d=!1,m="",S=Rh,T=qp,W=N0,me=null;return l!=null&&(l.unstable_strictMode===!0&&(d=!0),l.identifierPrefix!==void 0&&(m=l.identifierPrefix),l.onUncaughtError!==void 0&&(S=l.onUncaughtError),l.onCaughtError!==void 0&&(T=l.onCaughtError),l.onRecoverableError!==void 0&&(W=l.onRecoverableError),l.unstable_transitionCallbacks!==void 0&&(me=l.unstable_transitionCallbacks)),l=Cw(i,1,!1,null,null,d,m,S,T,W,me,null),i[Se]=l.current,Jx(i.nodeType===8?i.parentNode:i),new dg(l)},ld.hydrateRoot=function(i,l,d){if(!n(i))throw Error(a(299));var m=!1,S="",T=Rh,W=qp,me=N0,je=null,Be=null;return d!=null&&(d.unstable_strictMode===!0&&(m=!0),d.identifierPrefix!==void 0&&(S=d.identifierPrefix),d.onUncaughtError!==void 0&&(T=d.onUncaughtError),d.onCaughtError!==void 0&&(W=d.onCaughtError),d.onRecoverableError!==void 0&&(me=d.onRecoverableError),d.unstable_transitionCallbacks!==void 0&&(je=d.unstable_transitionCallbacks),d.formState!==void 0&&(Be=d.formState)),l=Cw(i,1,!0,l,d??null,m,S,T,W,me,je,Be),l.context=Dw(null),d=l.current,m=Xi(),S=du(m),S.callback=null,pu(d,S,m),l.current.lanes=m,Qt(l,m),Bl(l),i[Se]=l.current,Jx(i),new vm(l)},ld.version="19.0.0",ld}var Kw;function Qk(){if(Kw)return xg.exports;Kw=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),xg.exports=Zk(),xg.exports}var eE=Qk(),cd={},Zw;function tE(){if(Zw)return cd;Zw=1,Object.defineProperty(cd,"__esModule",{value:!0}),cd.parse=o,cd.serialize=h;const e=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,t=/^[\u0021-\u003A\u003C-\u007E]*$/,r=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,a=/^[\u0020-\u003A\u003D-\u007E]*$/,n=Object.prototype.toString,s=(()=>{const v=function(){};return v.prototype=Object.create(null),v})();function o(v,g){const w=new s,b=v.length;if(b<2)return w;const N=(g==null?void 0:g.decode)||p;let _=0;do{const E=v.indexOf("=",_);if(E===-1)break;const j=v.indexOf(";",_),M=j===-1?b:j;if(E>M){_=v.lastIndexOf(";",E-1)+1;continue}const U=c(v,_,E),V=u(v,E,U),I=v.slice(U,V);if(w[I]===void 0){let z=c(v,E+1,M),H=u(v,M,z);const re=N(v.slice(z,H));w[I]=re}_=M+1}while(_<b);return w}function c(v,g,w){do{const b=v.charCodeAt(g);if(b!==32&&b!==9)return g}while(++g<w);return w}function u(v,g,w){for(;g>w;){const b=v.charCodeAt(--g);if(b!==32&&b!==9)return g+1}return w}function h(v,g,w){const b=(w==null?void 0:w.encode)||encodeURIComponent;if(!e.test(v))throw new TypeError(`argument name is invalid: ${v}`);const N=b(g);if(!t.test(N))throw new TypeError(`argument val is invalid: ${g}`);let _=v+"="+N;if(!w)return _;if(w.maxAge!==void 0){if(!Number.isInteger(w.maxAge))throw new TypeError(`option maxAge is invalid: ${w.maxAge}`);_+="; Max-Age="+w.maxAge}if(w.domain){if(!r.test(w.domain))throw new TypeError(`option domain is invalid: ${w.domain}`);_+="; Domain="+w.domain}if(w.path){if(!a.test(w.path))throw new TypeError(`option path is invalid: ${w.path}`);_+="; Path="+w.path}if(w.expires){if(!x(w.expires)||!Number.isFinite(w.expires.valueOf()))throw new TypeError(`option expires is invalid: ${w.expires}`);_+="; Expires="+w.expires.toUTCString()}if(w.httpOnly&&(_+="; HttpOnly"),w.secure&&(_+="; Secure"),w.partitioned&&(_+="; Partitioned"),w.priority)switch(typeof w.priority=="string"?w.priority.toLowerCase():void 0){case"low":_+="; Priority=Low";break;case"medium":_+="; Priority=Medium";break;case"high":_+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${w.priority}`)}if(w.sameSite)switch(typeof w.sameSite=="string"?w.sameSite.toLowerCase():w.sameSite){case!0:case"strict":_+="; SameSite=Strict";break;case"lax":_+="; SameSite=Lax";break;case"none":_+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${w.sameSite}`)}return _}function p(v){if(v.indexOf("%")===-1)return v;try{return decodeURIComponent(v)}catch{return v}}function x(v){return n.call(v)==="[object Date]"}return cd}tE();/**
 * react-router v7.2.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var Qw="popstate";function rE(e={}){function t(a,n){let{pathname:s,search:o,hash:c}=a.location;return y2("",{pathname:s,search:o,hash:c},n.state&&n.state.usr||null,n.state&&n.state.key||"default")}function r(a,n){return typeof n=="string"?n:Bd(n)}return nE(t,r,null,e)}function Ya(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function ul(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function aE(){return Math.random().toString(36).substring(2,10)}function eb(e,t){return{usr:e.state,key:e.key,idx:t}}function y2(e,t,r=null,a){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?mh(t):t,state:r,key:t&&t.key||a||aE()}}function Bd({pathname:e="/",search:t="",hash:r=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function mh(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substring(r),e=e.substring(0,r));let a=e.indexOf("?");a>=0&&(t.search=e.substring(a),e=e.substring(0,a)),e&&(t.pathname=e)}return t}function nE(e,t,r,a={}){let{window:n=document.defaultView,v5Compat:s=!1}=a,o=n.history,c="POP",u=null,h=p();h==null&&(h=0,o.replaceState({...o.state,idx:h},""));function p(){return(o.state||{idx:null}).idx}function x(){c="POP";let N=p(),_=N==null?null:N-h;h=N,u&&u({action:c,location:b.location,delta:_})}function v(N,_){c="PUSH";let E=y2(b.location,N,_);h=p()+1;let j=eb(E,h),M=b.createHref(E);try{o.pushState(j,"",M)}catch(U){if(U instanceof DOMException&&U.name==="DataCloneError")throw U;n.location.assign(M)}s&&u&&u({action:c,location:b.location,delta:1})}function g(N,_){c="REPLACE";let E=y2(b.location,N,_);h=p();let j=eb(E,h),M=b.createHref(E);o.replaceState(j,"",M),s&&u&&u({action:c,location:b.location,delta:0})}function w(N){let _=n.location.origin!=="null"?n.location.origin:n.location.href,E=typeof N=="string"?N:Bd(N);return E=E.replace(/ $/,"%20"),Ya(_,`No window.location.(origin|href) available to create URL for href: ${E}`),new URL(E,_)}let b={get action(){return c},get location(){return e(n,o)},listen(N){if(u)throw new Error("A history only accepts one active listener");return n.addEventListener(Qw,x),u=N,()=>{n.removeEventListener(Qw,x),u=null}},createHref(N){return t(n,N)},createURL:w,encodeLocation(N){let _=w(N);return{pathname:_.pathname,search:_.search,hash:_.hash}},push:v,replace:g,go(N){return o.go(N)}};return b}function DS(e,t,r="/"){return sE(e,t,r,!1)}function sE(e,t,r,a){let n=typeof t=="string"?mh(t):t,s=Lu(n.pathname||"/",r);if(s==null)return null;let o=FS(e);iE(o);let c=null;for(let u=0;c==null&&u<o.length;++u){let h=gE(s);c=mE(o[u],h,a)}return c}function FS(e,t=[],r=[],a=""){let n=(s,o,c)=>{let u={relativePath:c===void 0?s.path||"":c,caseSensitive:s.caseSensitive===!0,childrenIndex:o,route:s};u.relativePath.startsWith("/")&&(Ya(u.relativePath.startsWith(a),`Absolute route path "${u.relativePath}" nested under path "${a}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),u.relativePath=u.relativePath.slice(a.length));let h=Fc([a,u.relativePath]),p=r.concat(u);s.children&&s.children.length>0&&(Ya(s.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${h}".`),FS(s.children,t,p,h)),!(s.path==null&&!s.index)&&t.push({path:h,score:dE(h,s.index),routesMeta:p})};return e.forEach((s,o)=>{var c;if(s.path===""||!((c=s.path)!=null&&c.includes("?")))n(s,o);else for(let u of PS(s.path))n(s,o,u)}),t}function PS(e){let t=e.split("/");if(t.length===0)return[];let[r,...a]=t,n=r.endsWith("?"),s=r.replace(/\?$/,"");if(a.length===0)return n?[s,""]:[s];let o=PS(a.join("/")),c=[];return c.push(...o.map(u=>u===""?s:[s,u].join("/"))),n&&c.push(...o),c.map(u=>e.startsWith("/")&&u===""?"/":u)}function iE(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:pE(t.routesMeta.map(a=>a.childrenIndex),r.routesMeta.map(a=>a.childrenIndex)))}var oE=/^:[\w-]+$/,lE=3,cE=2,uE=1,fE=10,hE=-2,tb=e=>e==="*";function dE(e,t){let r=e.split("/"),a=r.length;return r.some(tb)&&(a+=hE),t&&(a+=cE),r.filter(n=>!tb(n)).reduce((n,s)=>n+(oE.test(s)?lE:s===""?uE:fE),a)}function pE(e,t){return e.length===t.length&&e.slice(0,-1).every((a,n)=>a===t[n])?e[e.length-1]-t[t.length-1]:0}function mE(e,t,r=!1){let{routesMeta:a}=e,n={},s="/",o=[];for(let c=0;c<a.length;++c){let u=a[c],h=c===a.length-1,p=s==="/"?t:t.slice(s.length)||"/",x=e1({path:u.relativePath,caseSensitive:u.caseSensitive,end:h},p),v=u.route;if(!x&&h&&r&&!a[a.length-1].route.index&&(x=e1({path:u.relativePath,caseSensitive:u.caseSensitive,end:!1},p)),!x)return null;Object.assign(n,x.params),o.push({params:n,pathname:Fc([s,x.pathname]),pathnameBase:bE(Fc([s,x.pathnameBase])),route:v}),x.pathnameBase!=="/"&&(s=Fc([s,x.pathnameBase]))}return o}function e1(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,a]=xE(e.path,e.caseSensitive,e.end),n=t.match(r);if(!n)return null;let s=n[0],o=s.replace(/(.)\/+$/,"$1"),c=n.slice(1);return{params:a.reduce((h,{paramName:p,isOptional:x},v)=>{if(p==="*"){let w=c[v]||"";o=s.slice(0,s.length-w.length).replace(/(.)\/+$/,"$1")}const g=c[v];return x&&!g?h[p]=void 0:h[p]=(g||"").replace(/%2F/g,"/"),h},{}),pathname:s,pathnameBase:o,pattern:e}}function xE(e,t=!1,r=!0){ul(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let a=[],n="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,c,u)=>(a.push({paramName:c,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(a.push({paramName:"*"}),n+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?n+="\\/*$":e!==""&&e!=="/"&&(n+="(?:(?=\\/|$))"),[new RegExp(n,t?void 0:"i"),a]}function gE(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return ul(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function Lu(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,a=e.charAt(r);return a&&a!=="/"?null:e.slice(r)||"/"}function vE(e,t="/"){let{pathname:r,search:a="",hash:n=""}=typeof e=="string"?mh(e):e;return{pathname:r?r.startsWith("/")?r:yE(r,t):t,search:SE(a),hash:NE(n)}}function yE(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(n=>{n===".."?r.length>1&&r.pop():n!=="."&&r.push(n)}),r.length>1?r.join("/"):"/"}function wg(e,t,r,a){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(a)}].  Please separate it out to the \`to.${r}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function wE(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function wv(e){let t=wE(e);return t.map((r,a)=>a===t.length-1?r.pathname:r.pathnameBase)}function bv(e,t,r,a=!1){let n;typeof e=="string"?n=mh(e):(n={...e},Ya(!n.pathname||!n.pathname.includes("?"),wg("?","pathname","search",n)),Ya(!n.pathname||!n.pathname.includes("#"),wg("#","pathname","hash",n)),Ya(!n.search||!n.search.includes("#"),wg("#","search","hash",n)));let s=e===""||n.pathname==="",o=s?"/":n.pathname,c;if(o==null)c=r;else{let x=t.length-1;if(!a&&o.startsWith("..")){let v=o.split("/");for(;v[0]==="..";)v.shift(),x-=1;n.pathname=v.join("/")}c=x>=0?t[x]:"/"}let u=vE(n,c),h=o&&o!=="/"&&o.endsWith("/"),p=(s||o===".")&&r.endsWith("/");return!u.pathname.endsWith("/")&&(h||p)&&(u.pathname+="/"),u}var Fc=e=>e.join("/").replace(/\/\/+/g,"/"),bE=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),SE=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,NE=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function AE(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var LS=["POST","PUT","PATCH","DELETE"];new Set(LS);var _E=["GET",...LS];new Set(_E);var xh=P.createContext(null);xh.displayName="DataRouter";var L1=P.createContext(null);L1.displayName="DataRouterState";var OS=P.createContext({isTransitioning:!1});OS.displayName="ViewTransition";var TE=P.createContext(new Map);TE.displayName="Fetchers";var kE=P.createContext(null);kE.displayName="Await";var fl=P.createContext(null);fl.displayName="Navigation";var pp=P.createContext(null);pp.displayName="Location";var hl=P.createContext({outlet:null,matches:[],isDataRoute:!1});hl.displayName="Route";var Sv=P.createContext(null);Sv.displayName="RouteError";function EE(e,{relative:t}={}){Ya(gh(),"useHref() may be used only in the context of a <Router> component.");let{basename:r,navigator:a}=P.useContext(fl),{hash:n,pathname:s,search:o}=mp(e,{relative:t}),c=s;return r!=="/"&&(c=s==="/"?r:Fc([r,s])),a.createHref({pathname:c,search:o,hash:n})}function gh(){return P.useContext(pp)!=null}function dl(){return Ya(gh(),"useLocation() may be used only in the context of a <Router> component."),P.useContext(pp).location}var RS="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function MS(e){P.useContext(fl).static||P.useLayoutEffect(e)}function ua(){let{isDataRoute:e}=P.useContext(hl);return e?HE():jE()}function jE(){Ya(gh(),"useNavigate() may be used only in the context of a <Router> component.");let e=P.useContext(xh),{basename:t,navigator:r}=P.useContext(fl),{matches:a}=P.useContext(hl),{pathname:n}=dl(),s=JSON.stringify(wv(a)),o=P.useRef(!1);return MS(()=>{o.current=!0}),P.useCallback((u,h={})=>{if(ul(o.current,RS),!o.current)return;if(typeof u=="number"){r.go(u);return}let p=bv(u,JSON.parse(s),n,h.relative==="path");e==null&&t!=="/"&&(p.pathname=p.pathname==="/"?t:Fc([t,p.pathname])),(h.replace?r.replace:r.push)(p,h.state,h)},[t,r,s,n,e])}P.createContext(null);function CE(){let{matches:e}=P.useContext(hl),t=e[e.length-1];return t?t.params:{}}function mp(e,{relative:t}={}){let{matches:r}=P.useContext(hl),{pathname:a}=dl(),n=JSON.stringify(wv(r));return P.useMemo(()=>bv(e,JSON.parse(n),a,t==="path"),[e,n,a,t])}function DE(e,t){return IS(e,t)}function IS(e,t,r,a){var E;Ya(gh(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:n,static:s}=P.useContext(fl),{matches:o}=P.useContext(hl),c=o[o.length-1],u=c?c.params:{},h=c?c.pathname:"/",p=c?c.pathnameBase:"/",x=c&&c.route;{let j=x&&x.path||"";BS(h,!x||j.endsWith("*")||j.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${h}" (under <Route path="${j}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${j}"> to <Route path="${j==="/"?"*":`${j}/*`}">.`)}let v=dl(),g;if(t){let j=typeof t=="string"?mh(t):t;Ya(p==="/"||((E=j.pathname)==null?void 0:E.startsWith(p)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${p}" but pathname "${j.pathname}" was given in the \`location\` prop.`),g=j}else g=v;let w=g.pathname||"/",b=w;if(p!=="/"){let j=p.replace(/^\//,"").split("/");b="/"+w.replace(/^\//,"").split("/").slice(j.length).join("/")}let N=!s&&r&&r.matches&&r.matches.length>0?r.matches:DS(e,{pathname:b});ul(x||N!=null,`No routes matched location "${g.pathname}${g.search}${g.hash}" `),ul(N==null||N[N.length-1].route.element!==void 0||N[N.length-1].route.Component!==void 0||N[N.length-1].route.lazy!==void 0,`Matched leaf route at location "${g.pathname}${g.search}${g.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let _=RE(N&&N.map(j=>Object.assign({},j,{params:Object.assign({},u,j.params),pathname:Fc([p,n.encodeLocation?n.encodeLocation(j.pathname).pathname:j.pathname]),pathnameBase:j.pathnameBase==="/"?p:Fc([p,n.encodeLocation?n.encodeLocation(j.pathnameBase).pathname:j.pathnameBase])})),o,r,a);return t&&_?P.createElement(pp.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...g},navigationType:"POP"}},_):_}function FE(){let e=zE(),t=AE(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,a="rgba(200,200,200, 0.5)",n={padding:"0.5rem",backgroundColor:a},s={padding:"2px 4px",backgroundColor:a},o=null;return console.error("Error handled by React Router default ErrorBoundary:",e),o=P.createElement(P.Fragment,null,P.createElement("p",null,"💿 Hey developer 👋"),P.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",P.createElement("code",{style:s},"ErrorBoundary")," or"," ",P.createElement("code",{style:s},"errorElement")," prop on your route.")),P.createElement(P.Fragment,null,P.createElement("h2",null,"Unexpected Application Error!"),P.createElement("h3",{style:{fontStyle:"italic"}},t),r?P.createElement("pre",{style:n},r):null,o)}var PE=P.createElement(FE,null),LE=class extends P.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?P.createElement(hl.Provider,{value:this.props.routeContext},P.createElement(Sv.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function OE({routeContext:e,match:t,children:r}){let a=P.useContext(xh);return a&&a.static&&a.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=t.route.id),P.createElement(hl.Provider,{value:e},r)}function RE(e,t=[],r=null,a=null){if(e==null){if(!r)return null;if(r.errors)e=r.matches;else if(t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let n=e,s=r==null?void 0:r.errors;if(s!=null){let u=n.findIndex(h=>h.route.id&&(s==null?void 0:s[h.route.id])!==void 0);Ya(u>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(s).join(",")}`),n=n.slice(0,Math.min(n.length,u+1))}let o=!1,c=-1;if(r)for(let u=0;u<n.length;u++){let h=n[u];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(c=u),h.route.id){let{loaderData:p,errors:x}=r,v=h.route.loader&&!p.hasOwnProperty(h.route.id)&&(!x||x[h.route.id]===void 0);if(h.route.lazy||v){o=!0,c>=0?n=n.slice(0,c+1):n=[n[0]];break}}}return n.reduceRight((u,h,p)=>{let x,v=!1,g=null,w=null;r&&(x=s&&h.route.id?s[h.route.id]:void 0,g=h.route.errorElement||PE,o&&(c<0&&p===0?(BS("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),v=!0,w=null):c===p&&(v=!0,w=h.route.hydrateFallbackElement||null)));let b=t.concat(n.slice(0,p+1)),N=()=>{let _;return x?_=g:v?_=w:h.route.Component?_=P.createElement(h.route.Component,null):h.route.element?_=h.route.element:_=u,P.createElement(OE,{match:h,routeContext:{outlet:u,matches:b,isDataRoute:r!=null},children:_})};return r&&(h.route.ErrorBoundary||h.route.errorElement||p===0)?P.createElement(LE,{location:r.location,revalidation:r.revalidation,component:g,error:x,children:N(),routeContext:{outlet:null,matches:b,isDataRoute:!0}}):N()},null)}function Nv(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function ME(e){let t=P.useContext(xh);return Ya(t,Nv(e)),t}function IE(e){let t=P.useContext(L1);return Ya(t,Nv(e)),t}function BE(e){let t=P.useContext(hl);return Ya(t,Nv(e)),t}function Av(e){let t=BE(e),r=t.matches[t.matches.length-1];return Ya(r.route.id,`${e} can only be used on routes that contain a unique "id"`),r.route.id}function UE(){return Av("useRouteId")}function zE(){var a;let e=P.useContext(Sv),t=IE("useRouteError"),r=Av("useRouteError");return e!==void 0?e:(a=t.errors)==null?void 0:a[r]}function HE(){let{router:e}=ME("useNavigate"),t=Av("useNavigate"),r=P.useRef(!1);return MS(()=>{r.current=!0}),P.useCallback(async(n,s={})=>{ul(r.current,RS),r.current&&(typeof n=="number"?e.navigate(n):await e.navigate(n,{fromRouteId:t,...s}))},[e,t])}var rb={};function BS(e,t,r){!t&&!rb[e]&&(rb[e]=!0,ul(!1,r))}P.memo(VE);function VE({routes:e,future:t,state:r}){return IS(e,void 0,r,t)}function qE({to:e,replace:t,state:r,relative:a}){Ya(gh(),"<Navigate> may be used only in the context of a <Router> component.");let{static:n}=P.useContext(fl);ul(!n,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:s}=P.useContext(hl),{pathname:o}=dl(),c=ua(),u=bv(e,wv(s),o,a==="path"),h=JSON.stringify(u);return P.useEffect(()=>{c(JSON.parse(h),{replace:t,state:r,relative:a})},[c,h,a,t,r]),null}function Xr(e){Ya(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function GE({basename:e="/",children:t=null,location:r,navigationType:a="POP",navigator:n,static:s=!1}){Ya(!gh(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=e.replace(/^\/*/,"/"),c=P.useMemo(()=>({basename:o,navigator:n,static:s,future:{}}),[o,n,s]);typeof r=="string"&&(r=mh(r));let{pathname:u="/",search:h="",hash:p="",state:x=null,key:v="default"}=r,g=P.useMemo(()=>{let w=Lu(u,o);return w==null?null:{location:{pathname:w,search:h,hash:p,state:x,key:v},navigationType:a}},[o,u,h,p,x,v,a]);return ul(g!=null,`<Router basename="${o}"> is not able to match the URL "${u}${h}${p}" because it does not start with the basename, so the <Router> won't render anything.`),g==null?null:P.createElement(fl.Provider,{value:c},P.createElement(pp.Provider,{children:t,value:g}))}function ab({children:e,location:t}){return DE(w2(e),t)}function w2(e,t=[]){let r=[];return P.Children.forEach(e,(a,n)=>{if(!P.isValidElement(a))return;let s=[...t,n];if(a.type===P.Fragment){r.push.apply(r,w2(a.props.children,s));return}Ya(a.type===Xr,`[${typeof a.type=="string"?a.type:a.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Ya(!a.props.index||!a.props.children,"An index route cannot have child routes.");let o={id:a.props.id||s.join("-"),caseSensitive:a.props.caseSensitive,element:a.props.element,Component:a.props.Component,index:a.props.index,path:a.props.path,loader:a.props.loader,action:a.props.action,hydrateFallbackElement:a.props.hydrateFallbackElement,HydrateFallback:a.props.HydrateFallback,errorElement:a.props.errorElement,ErrorBoundary:a.props.ErrorBoundary,hasErrorBoundary:a.props.hasErrorBoundary===!0||a.props.ErrorBoundary!=null||a.props.errorElement!=null,shouldRevalidate:a.props.shouldRevalidate,handle:a.props.handle,lazy:a.props.lazy};a.props.children&&(o.children=w2(a.props.children,s)),r.push(o)}),r}var qm="get",Gm="application/x-www-form-urlencoded";function O1(e){return e!=null&&typeof e.tagName=="string"}function WE(e){return O1(e)&&e.tagName.toLowerCase()==="button"}function $E(e){return O1(e)&&e.tagName.toLowerCase()==="form"}function XE(e){return O1(e)&&e.tagName.toLowerCase()==="input"}function YE(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function JE(e,t){return e.button===0&&(!t||t==="_self")&&!YE(e)}var wm=null;function KE(){if(wm===null)try{new FormData(document.createElement("form"),0),wm=!1}catch{wm=!0}return wm}var ZE=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function bg(e){return e!=null&&!ZE.has(e)?(ul(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Gm}"`),null):e}function QE(e,t){let r,a,n,s,o;if($E(e)){let c=e.getAttribute("action");a=c?Lu(c,t):null,r=e.getAttribute("method")||qm,n=bg(e.getAttribute("enctype"))||Gm,s=new FormData(e)}else if(WE(e)||XE(e)&&(e.type==="submit"||e.type==="image")){let c=e.form;if(c==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let u=e.getAttribute("formaction")||c.getAttribute("action");if(a=u?Lu(u,t):null,r=e.getAttribute("formmethod")||c.getAttribute("method")||qm,n=bg(e.getAttribute("formenctype"))||bg(c.getAttribute("enctype"))||Gm,s=new FormData(c,e),!KE()){let{name:h,type:p,value:x}=e;if(p==="image"){let v=h?`${h}.`:"";s.append(`${v}x`,"0"),s.append(`${v}y`,"0")}else h&&s.append(h,x)}}else{if(O1(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');r=qm,a=null,n=Gm,o=e}return s&&n==="text/plain"&&(o=s,s=void 0),{action:a,method:r.toLowerCase(),encType:n,formData:s,body:o}}function _v(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}async function e8(e,t){if(e.id in t)return t[e.id];try{let r=await import(e.module);return t[e.id]=r,r}catch(r){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(r),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function t8(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function r8(e,t,r){let a=await Promise.all(e.map(async n=>{let s=t.routes[n.route.id];if(s){let o=await e8(s,r);return o.links?o.links():[]}return[]}));return i8(a.flat(1).filter(t8).filter(n=>n.rel==="stylesheet"||n.rel==="preload").map(n=>n.rel==="stylesheet"?{...n,rel:"prefetch",as:"style"}:{...n,rel:"prefetch"}))}function nb(e,t,r,a,n,s){let o=(u,h)=>r[h]?u.route.id!==r[h].route.id:!0,c=(u,h)=>{var p;return r[h].pathname!==u.pathname||((p=r[h].route.path)==null?void 0:p.endsWith("*"))&&r[h].params["*"]!==u.params["*"]};return s==="assets"?t.filter((u,h)=>o(u,h)||c(u,h)):s==="data"?t.filter((u,h)=>{var x;let p=a.routes[u.route.id];if(!p||!p.hasLoader)return!1;if(o(u,h)||c(u,h))return!0;if(u.route.shouldRevalidate){let v=u.route.shouldRevalidate({currentUrl:new URL(n.pathname+n.search+n.hash,window.origin),currentParams:((x=r[0])==null?void 0:x.params)||{},nextUrl:new URL(e,window.origin),nextParams:u.params,defaultShouldRevalidate:!0});if(typeof v=="boolean")return v}return!0}):[]}function a8(e,t,{includeHydrateFallback:r}={}){return n8(e.map(a=>{let n=t.routes[a.route.id];if(!n)return[];let s=[n.module];return n.clientActionModule&&(s=s.concat(n.clientActionModule)),n.clientLoaderModule&&(s=s.concat(n.clientLoaderModule)),r&&n.hydrateFallbackModule&&(s=s.concat(n.hydrateFallbackModule)),n.imports&&(s=s.concat(n.imports)),s}).flat(1))}function n8(e){return[...new Set(e)]}function s8(e){let t={},r=Object.keys(e).sort();for(let a of r)t[a]=e[a];return t}function i8(e,t){let r=new Set;return new Set(t),e.reduce((a,n)=>{let s=JSON.stringify(s8(n));return r.has(s)||(r.add(s),a.push({key:s,link:n})),a},[])}function o8(e){let t=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return t.pathname==="/"?t.pathname="_root.data":t.pathname=`${t.pathname.replace(/\/$/,"")}.data`,t}function l8(){let e=P.useContext(xh);return _v(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function c8(){let e=P.useContext(L1);return _v(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var Tv=P.createContext(void 0);Tv.displayName="FrameworkContext";function US(){let e=P.useContext(Tv);return _v(e,"You must render this element inside a <HydratedRouter> element"),e}function u8(e,t){let r=P.useContext(Tv),[a,n]=P.useState(!1),[s,o]=P.useState(!1),{onFocus:c,onBlur:u,onMouseEnter:h,onMouseLeave:p,onTouchStart:x}=t,v=P.useRef(null);P.useEffect(()=>{if(e==="render"&&o(!0),e==="viewport"){let b=_=>{_.forEach(E=>{o(E.isIntersecting)})},N=new IntersectionObserver(b,{threshold:.5});return v.current&&N.observe(v.current),()=>{N.disconnect()}}},[e]),P.useEffect(()=>{if(a){let b=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(b)}}},[a]);let g=()=>{n(!0)},w=()=>{n(!1),o(!1)};return r?e!=="intent"?[s,v,{}]:[s,v,{onFocus:ud(c,g),onBlur:ud(u,w),onMouseEnter:ud(h,g),onMouseLeave:ud(p,w),onTouchStart:ud(x,g)}]:[!1,v,{}]}function ud(e,t){return r=>{e&&e(r),r.defaultPrevented||t(r)}}function f8({page:e,...t}){let{router:r}=l8(),a=P.useMemo(()=>DS(r.routes,e,r.basename),[r.routes,e,r.basename]);return a?P.createElement(d8,{page:e,matches:a,...t}):null}function h8(e){let{manifest:t,routeModules:r}=US(),[a,n]=P.useState([]);return P.useEffect(()=>{let s=!1;return r8(e,t,r).then(o=>{s||n(o)}),()=>{s=!0}},[e,t,r]),a}function d8({page:e,matches:t,...r}){let a=dl(),{manifest:n,routeModules:s}=US(),{loaderData:o,matches:c}=c8(),u=P.useMemo(()=>nb(e,t,c,n,a,"data"),[e,t,c,n,a]),h=P.useMemo(()=>nb(e,t,c,n,a,"assets"),[e,t,c,n,a]),p=P.useMemo(()=>{if(e===a.pathname+a.search+a.hash)return[];let g=new Set,w=!1;if(t.forEach(N=>{var E;let _=n.routes[N.route.id];!_||!_.hasLoader||(!u.some(j=>j.route.id===N.route.id)&&N.route.id in o&&((E=s[N.route.id])!=null&&E.shouldRevalidate)||_.hasClientLoader?w=!0:g.add(N.route.id))}),g.size===0)return[];let b=o8(e);return w&&g.size>0&&b.searchParams.set("_routes",t.filter(N=>g.has(N.route.id)).map(N=>N.route.id).join(",")),[b.pathname+b.search]},[o,a,n,u,t,e,s]),x=P.useMemo(()=>a8(h,n),[h,n]),v=h8(h);return P.createElement(P.Fragment,null,p.map(g=>P.createElement("link",{key:g,rel:"prefetch",as:"fetch",href:g,...r})),x.map(g=>P.createElement("link",{key:g,rel:"modulepreload",href:g,...r})),v.map(({key:g,link:w})=>P.createElement("link",{key:g,...w})))}function p8(...e){return t=>{e.forEach(r=>{typeof r=="function"?r(t):r!=null&&(r.current=t)})}}var zS=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{zS&&(window.__reactRouterVersion="7.2.0")}catch{}function m8({basename:e,children:t,window:r}){let a=P.useRef();a.current==null&&(a.current=rE({window:r,v5Compat:!0}));let n=a.current,[s,o]=P.useState({action:n.action,location:n.location}),c=P.useCallback(u=>{P.startTransition(()=>o(u))},[o]);return P.useLayoutEffect(()=>n.listen(c),[n,c]),P.createElement(GE,{basename:e,children:t,location:s.location,navigationType:s.action,navigator:n})}var HS=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,xi=P.forwardRef(function({onClick:t,discover:r="render",prefetch:a="none",relative:n,reloadDocument:s,replace:o,state:c,target:u,to:h,preventScrollReset:p,viewTransition:x,...v},g){let{basename:w}=P.useContext(fl),b=typeof h=="string"&&HS.test(h),N,_=!1;if(typeof h=="string"&&b&&(N=h,zS))try{let H=new URL(window.location.href),re=h.startsWith("//")?new URL(H.protocol+h):new URL(h),R=Lu(re.pathname,w);re.origin===H.origin&&R!=null?h=R+re.search+re.hash:_=!0}catch{ul(!1,`<Link to="${h}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let E=EE(h,{relative:n}),[j,M,U]=u8(a,v),V=y8(h,{replace:o,state:c,target:u,preventScrollReset:p,relative:n,viewTransition:x});function I(H){t&&t(H),H.defaultPrevented||V(H)}let z=P.createElement("a",{...v,...U,href:N||E,onClick:_||s?t:I,ref:p8(g,M),target:u,"data-discover":!b&&r==="render"?"true":void 0});return j&&!b?P.createElement(P.Fragment,null,z,P.createElement(f8,{page:E})):z});xi.displayName="Link";var x8=P.forwardRef(function({"aria-current":t="page",caseSensitive:r=!1,className:a="",end:n=!1,style:s,to:o,viewTransition:c,children:u,...h},p){let x=mp(o,{relative:h.relative}),v=dl(),g=P.useContext(L1),{navigator:w,basename:b}=P.useContext(fl),N=g!=null&&A8(x)&&c===!0,_=w.encodeLocation?w.encodeLocation(x).pathname:x.pathname,E=v.pathname,j=g&&g.navigation&&g.navigation.location?g.navigation.location.pathname:null;r||(E=E.toLowerCase(),j=j?j.toLowerCase():null,_=_.toLowerCase()),j&&b&&(j=Lu(j,b)||j);const M=_!=="/"&&_.endsWith("/")?_.length-1:_.length;let U=E===_||!n&&E.startsWith(_)&&E.charAt(M)==="/",V=j!=null&&(j===_||!n&&j.startsWith(_)&&j.charAt(_.length)==="/"),I={isActive:U,isPending:V,isTransitioning:N},z=U?t:void 0,H;typeof a=="function"?H=a(I):H=[a,U?"active":null,V?"pending":null,N?"transitioning":null].filter(Boolean).join(" ");let re=typeof s=="function"?s(I):s;return P.createElement(xi,{...h,"aria-current":z,className:H,ref:p,style:re,to:o,viewTransition:c},typeof u=="function"?u(I):u)});x8.displayName="NavLink";var g8=P.forwardRef(({discover:e="render",fetcherKey:t,navigate:r,reloadDocument:a,replace:n,state:s,method:o=qm,action:c,onSubmit:u,relative:h,preventScrollReset:p,viewTransition:x,...v},g)=>{let w=S8(),b=N8(c,{relative:h}),N=o.toLowerCase()==="get"?"get":"post",_=typeof c=="string"&&HS.test(c),E=j=>{if(u&&u(j),j.defaultPrevented)return;j.preventDefault();let M=j.nativeEvent.submitter,U=(M==null?void 0:M.getAttribute("formmethod"))||o;w(M||j.currentTarget,{fetcherKey:t,method:U,navigate:r,replace:n,state:s,relative:h,preventScrollReset:p,viewTransition:x})};return P.createElement("form",{ref:g,method:N,action:b,onSubmit:a?u:E,...v,"data-discover":!_&&e==="render"?"true":void 0})});g8.displayName="Form";function v8(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function VS(e){let t=P.useContext(xh);return Ya(t,v8(e)),t}function y8(e,{target:t,replace:r,state:a,preventScrollReset:n,relative:s,viewTransition:o}={}){let c=ua(),u=dl(),h=mp(e,{relative:s});return P.useCallback(p=>{if(JE(p,t)){p.preventDefault();let x=r!==void 0?r:Bd(u)===Bd(h);c(e,{replace:x,state:a,preventScrollReset:n,relative:s,viewTransition:o})}},[u,c,h,r,a,t,e,n,s,o])}var w8=0,b8=()=>`__${String(++w8)}__`;function S8(){let{router:e}=VS("useSubmit"),{basename:t}=P.useContext(fl),r=UE();return P.useCallback(async(a,n={})=>{let{action:s,method:o,encType:c,formData:u,body:h}=QE(a,t);if(n.navigate===!1){let p=n.fetcherKey||b8();await e.fetch(p,r,n.action||s,{preventScrollReset:n.preventScrollReset,formData:u,body:h,formMethod:n.method||o,formEncType:n.encType||c,flushSync:n.flushSync})}else await e.navigate(n.action||s,{preventScrollReset:n.preventScrollReset,formData:u,body:h,formMethod:n.method||o,formEncType:n.encType||c,replace:n.replace,state:n.state,fromRouteId:r,flushSync:n.flushSync,viewTransition:n.viewTransition})},[e,t,r])}function N8(e,{relative:t}={}){let{basename:r}=P.useContext(fl),a=P.useContext(hl);Ya(a,"useFormAction must be used inside a RouteContext");let[n]=a.matches.slice(-1),s={...mp(e||".",{relative:t})},o=dl();if(e==null){s.search=o.search;let c=new URLSearchParams(s.search),u=c.getAll("index");if(u.some(p=>p==="")){c.delete("index"),u.filter(x=>x).forEach(x=>c.append("index",x));let p=c.toString();s.search=p?`?${p}`:""}}return(!e||e===".")&&n.route.index&&(s.search=s.search?s.search.replace(/^\?/,"?index&"):"?index"),r!=="/"&&(s.pathname=s.pathname==="/"?r:Fc([r,s.pathname])),Bd(s)}function A8(e,t={}){let r=P.useContext(OS);Ya(r!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:a}=VS("useViewTransitionState"),n=mp(e,{relative:t.relative});if(!r.isTransitioning)return!1;let s=Lu(r.currentLocation.pathname,a)||r.currentLocation.pathname,o=Lu(r.nextLocation.pathname,a)||r.nextLocation.pathname;return e1(n.pathname,o)!=null||e1(n.pathname,s)!=null}new TextEncoder;/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _8=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),qS=(...e)=>e.filter((t,r,a)=>!!t&&t.trim()!==""&&a.indexOf(t)===r).join(" ").trim();/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var T8={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k8=P.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:a,className:n="",children:s,iconNode:o,...c},u)=>P.createElement("svg",{ref:u,...T8,width:t,height:t,stroke:e,strokeWidth:a?Number(r)*24/Number(t):r,className:qS("lucide",n),...c},[...o.map(([h,p])=>P.createElement(h,p)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jn=(e,t)=>{const r=P.forwardRef(({className:a,...n},s)=>P.createElement(k8,{ref:s,iconNode:t,className:qS(`lucide-${_8(e)}`,a),...n}));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E8=[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]],j8=Jn("Briefcase",E8);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C8=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],D8=Jn("ChevronDown",C8);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F8=[["path",{d:"m17 18-6-6 6-6",key:"1yerx2"}],["path",{d:"M7 6v12",key:"1p53r6"}]],GS=Jn("ChevronFirst",F8);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P8=[["path",{d:"m7 18 6-6-6-6",key:"lwmzdw"}],["path",{d:"M17 6v12",key:"1o0aio"}]],L8=Jn("ChevronLast",P8);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O8=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],Kf=Jn("CircleX",O8);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R8=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],M8=Jn("ClipboardList",R8);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I8=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]],B8=Jn("Download",I8);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U8=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]],kv=Jn("EllipsisVertical",U8);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z8=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],H8=Jn("FileText",z8);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V8=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]],q8=Jn("LayoutDashboard",V8);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G8=[["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]],W8=Jn("ListChecks",G8);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $8=[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]],X8=Jn("Menu",$8);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y8=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],Zf=Jn("Pencil",Y8);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J8=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Vc=Jn("Plus",J8);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K8=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Z8=Jn("Settings",K8);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q8=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],R1=Jn("SquarePen",Q8);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ej=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],WS=Jn("Trash2",ej);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tj=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]],rj=Jn("Users",tj);/**
 * @license lucide-react v0.475.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aj=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],nj=Jn("X",aj),Ud=P.createContext(void 0);function sj(){const e=ua(),[t,r]=P.useState(!0),[a,n]=P.useState(!1),[s,o]=P.useState(!1),c=()=>r(u=>!u);return P.useEffect(()=>{const u=()=>{window.innerWidth>=768&&s&&o(!1)};return window.addEventListener("resize",u),()=>window.removeEventListener("resize",u)},[s]),f.jsxs(Ud.Provider,{value:{expanded:t,toggleSidebar:c},children:[f.jsxs("nav",{className:`h-full flex-col hidden md:flex transition-all duration-300 ease-in-out ${t?"w-64":"w-24"}`,children:[f.jsxs("div",{className:"p-4 pb-2 flex justify-between items-center",children:[f.jsx("img",{src:"https://img.logoipsum.com/243.svg",className:`overflow-hidden transition-all duration-300 ${t?"w-32":"w-0"}`,alt:"Logo",onClick:()=>e("/")}),f.jsx("button",{onClick:c,className:"p-1.5 rounded-lg bg-gray-50 hover:bg-gray-100",children:t?f.jsx(GS,{}):f.jsx(L8,{})})]}),f.jsx(sb,{mastersOpen:a,setMastersOpen:n,setMobileMenuOpen:o})]}),f.jsxs("div",{className:"md:hidden p-4 flex items-center justify-between bg-white shadow fixed w-full z-50",children:[f.jsx("button",{onClick:()=>o(!s),className:"text-gray-700",children:s?f.jsx(nj,{size:28}):f.jsx(X8,{size:28})}),f.jsx("img",{src:"https://img.logoipsum.com/243.svg",onClick:()=>e("/"),className:"w-28",alt:"Logo"})]}),f.jsx("div",{className:`md:hidden fixed top-16 left-0 w-full z-40 bg-white shadow-lg overflow-hidden transform transition-all duration-300 ease-in-out ${s?"translate-y-0 opacity-100":"-translate-y-10 opacity-0 pointer-events-none"}`,children:f.jsx(Ud.Provider,{value:{expanded:!0,toggleSidebar:()=>{}},children:f.jsx(sb,{mastersOpen:a,setMastersOpen:n,setMobileMenuOpen:o})})})]})}function sb({mastersOpen:e,setMastersOpen:t,setMobileMenuOpen:r}){const a=P.useContext(Ud),[n,s]=P.useState(!1),{expanded:o}=a,c={name:localStorage.getItem("auth_name")||"User",email:localStorage.getItem("auth_email")||"user@example.com"};return f.jsxs(f.Fragment,{children:[f.jsxs("ul",{className:"flex-1 px-3 pt-4 pb-2",children:[f.jsx(M0,{icon:f.jsx(q8,{size:20}),text:"Dashboard",path:"/",setMobileMenuOpen:r}),f.jsx(M0,{icon:f.jsx(j8,{size:20}),text:"Projects",path:"/projects",setMobileMenuOpen:r}),f.jsx(M0,{icon:f.jsx(rj,{size:20}),text:"Customers",path:"/customers",setMobileMenuOpen:r}),f.jsxs("li",{className:"relative",children:[f.jsxs("button",{onClick:()=>t(!e),className:"flex items-center w-full py-2 px-3 my-1 font-medium rounded-md transition-all text-gray-600 hover:bg-gray-200",children:[f.jsx(M8,{size:20}),f.jsx("span",{className:`transition-all ${o?"ml-3 w-10":"w-0 overflow-hidden"}`,children:"Masters"}),f.jsx(D8,{className:`ml-auto transform transition-transform duration-300 ${e?"rotate-180":"rotate-0"}`})]}),f.jsx("div",{className:`transition-all duration-300 overflow-hidden ${e?"max-h-96 opacity-100":"max-h-0 opacity-0"}`,children:f.jsx("ul",{className:"ml-8 mt-1 space-y-1",children:[["Products","/masters/items"],["Product Groups","/masters/product-groups"],["Brands","/masters/brands"],["Catalogues","/masters/catalogues"],["Interiors","/masters/interiors"],["Tailors","/masters/tailors"],["Sales Associate","/masters/sales-associate"],["Stores","/masters/stores"]].map(([u,h])=>f.jsx(M0,{icon:null,text:u,path:h,setMobileMenuOpen:r},h))})})]}),f.jsx(M0,{icon:f.jsx(W8,{size:20}),text:"Tasks",path:"/tasks",setMobileMenuOpen:r}),f.jsx(M0,{icon:f.jsx(H8,{size:20}),text:"Reports",path:"/reports",setMobileMenuOpen:r}),f.jsxs("a",{href:"http://sheeladecor.free.nf/user-management.php",target:"_blank",rel:"noopener noreferrer",style:{display:"flex",alignItems:"center",padding:"10px",textDecoration:"none",color:"inherit"},children:[f.jsx(Z8,{size:20,style:{marginRight:"8px"}}),f.jsx("span",{children:"Settings"})]})]}),f.jsxs("div",{className:"relative border-t flex items-center p-3 cursor-pointer group",children:[f.jsx("img",{src:`https://ui-avatars.com/api/?background=c7d2fe&color=3730a3&bold=true&name=${encodeURIComponent(c.name)}`,alt:"User Avatar",className:"w-10 h-10 rounded-md"}),f.jsxs("div",{className:`flex justify-between items-center overflow-hidden transition-all ${o?"w-52 ml-3":"w-0"}`,onClick:()=>s(!n),children:[f.jsxs("div",{className:"leading-4",children:[f.jsx("h4",{className:"font-semibold",children:c.name}),f.jsx("span",{className:"text-xs text-gray-600",children:c.email})]}),f.jsx(kv,{size:20,className:"ml-2"})]}),n&&o&&f.jsx("div",{className:"absolute bottom-14 right-4 bg-white shadow-lg rounded-md border w-40 z-50",children:f.jsx("button",{onClick:()=>{localStorage.clear(),window.location.href="https://sheeladecor.free.nf/logout.php"},className:"w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-gray-100",children:"Logout"})})]})]})}function M0({icon:e,text:t,path:r,setMobileMenuOpen:a}){const n=P.useContext(Ud);if(!n)return null;const{expanded:s}=n,o=dl();return f.jsx(xi,{to:r,onClick:()=>{window.innerWidth<768&&a(!1)},className:"block !no-underline hover:!no-underline",children:f.jsxs("li",{className:`relative flex items-center py-2 px-3 my-1 font-medium rounded-md cursor-pointer transition-all group
        ${o.pathname===r?"bg-indigo-100 text-indigo-800":"hover:bg-gray-200 text-gray-600"}`,children:[e&&e,f.jsx("span",{className:`overflow-hidden transition-all ${s?"ml-3 w-40":"w-0"}`,children:s&&t})]})})}const bm=({title:e,value:t,color:r,isCurrency:a=!1})=>f.jsxs("div",{className:"flex items-center bg-transparent shadow-md border border-zinc-790 rounded-lg p-2 w-full max-w-sm",children:[f.jsx("div",{className:`w-1 h-full ${r} rounded-full`}),f.jsxs("div",{className:"ml-4 flex flex-col",children:[f.jsx("p",{className:"md:text-[1.3vw] font-semibold",children:e}),f.jsx("p",{className:"md:text-[1.1vw] mb-1 font-semibold text-gray-900",children:a?`₹${t.toLocaleString("en-IN")}`:t.toLocaleString("en-IN")})]})]}),ij=({projectName:e,project:t,date:r,setSendProject:a,setIndex:n,index:s,setTax:o,setAmount:c,setProjectDiscount:u,setFlag:h})=>f.jsxs("div",{className:"bg-blue-50 shadow-lg rounded-xl m-1 p-4 border-l-4 border-blue-500 transition-transform transform hover:scale-102 hover:shadow-xl w-max inline-block",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("p",{className:"text-xs text-gray-600 font-medium",children:"Name:"}),f.jsx("p",{className:"text-sm font-semibold text-gray-800 truncate",children:e})]}),f.jsxs("div",{className:"flex items-center gap-3 mt-0.5",children:[f.jsx("p",{className:"text-xs text-gray-600 font-medium",children:"Date:"}),f.jsx("p",{className:"text-xs text-gray-600",children:r})]}),f.jsxs("div",{className:"flex flex-col gap-0.5 mt-0.5",children:[f.jsx("p",{className:"text-xs text-gray-600 font-medium",children:"Items:"}),f.jsx("div",{className:"flex flex-wrap gap-3",children:t.goodsArray&&t.goodsArray.map((p,x)=>{var v;return f.jsxs("p",{className:"text-xs text-gray-600",children:[(v=p.item)==null?void 0:v[0],x<t.goodsArray.length-1?",":""]},x)})})]})]}),oj=({taskData:e})=>{const t={High:"bg-red-500",Moderate:"bg-yellow-500",Low:"bg-green-500"};return f.jsx("div",{className:"bg-white shadow-md rounded-xl m-2 p-3 border-l-4 border-gray-100 transition-transform transform hover:scale-102 hover:shadow-xl",children:f.jsxs("div",{className:"flex justify-between !gap-0 items-start",children:[f.jsxs("div",{className:"flex-col",children:[f.jsx("h3",{className:"!text-lg font-semibold text-gray-900 truncate",children:e[0]}),f.jsx("p",{className:"text-sm text-gray-500 mt-0.5 line-clamp-2",children:e[5]}),f.jsxs("p",{className:"text-xs text-gray-600 mt-0.5",children:[f.jsx("strong",{children:"Date:"})," ",e[2]]})]}),f.jsxs("div",{className:"flex flex-col gap-2 items-end text-xs text-gray-600",children:[f.jsx("span",{className:`px-1.5 py-0.5 text-xs font-medium text-white rounded-full ${t[e[6]]}`,children:e[6]}),f.jsxs("p",{className:`font-medium ${e[7]==="In Progress"?"text-yellow-500":""} ${e[7]==="Completed"?"text-green-500":""} ${e[7]==="To Do"?"text-red-500":""}`,children:["Status: ",e[7]]}),f.jsxs("p",{children:[f.jsx("strong",{children:"To:"})," ",e[4]]})]})]})})},lj=({project:e,comments:t,inquiryDate:r,followUpDate:a,status:n,handlestatuschange:s,onCardClick:o,customer:c})=>f.jsxs("div",{className:"max-w-sm w-full bg-white border border-gray-200 rounded-2xl shadow-sm hover:shadow-md transition-shadow duration-200 p-4 cursor-pointer",onClick:o,children:[f.jsxs("div",{className:"space-y-1",children:[f.jsx("h3",{className:"text-lg font-bold text-indigo-600 truncate",children:e}),f.jsx("p",{className:"text-sm text-gray-800 font-medium truncate",children:c}),f.jsx("p",{className:"text-sm text-gray-600 line-clamp-2",children:t})]}),f.jsxs("div",{className:"mt-3 space-y-1 text-xs text-gray-500",children:[f.jsxs("p",{children:[" Inquiry: ",f.jsx("span",{className:"text-gray-700",children:r})]}),f.jsxs("p",{children:[" Follow-up: ",f.jsx("span",{className:"text-gray-700",children:a})]})]}),f.jsx("div",{className:"mt-3",children:f.jsxs("select",{value:n,onClick:u=>u.stopPropagation(),onChange:u=>s(e,u.target.value),className:"w-full bg-gray-50 border border-gray-300 text-sm text-gray-700 rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[f.jsx("option",{value:"New Inquiry",children:" New Inquiry"}),f.jsx("option",{value:"In Progress",children:" In Progress"}),f.jsx("option",{value:"Convert to Project",children:" Convert to Project"}),f.jsx("option",{value:"Not Interested",children:" Not Interested"})]})})]});var Sg={exports:{}},Ng={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ib;function cj(){if(ib)return Ng;ib=1;var e=P1();function t(u,h){return u===h&&(u!==0||1/u===1/h)||u!==u&&h!==h}var r=typeof Object.is=="function"?Object.is:t,a=e.useSyncExternalStore,n=e.useRef,s=e.useEffect,o=e.useMemo,c=e.useDebugValue;return Ng.useSyncExternalStoreWithSelector=function(u,h,p,x,v){var g=n(null);if(g.current===null){var w={hasValue:!1,value:null};g.current=w}else w=g.current;g=o(function(){function N(U){if(!_){if(_=!0,E=U,U=x(U),v!==void 0&&w.hasValue){var V=w.value;if(v(V,U))return j=V}return j=U}if(V=j,r(E,U))return V;var I=x(U);return v!==void 0&&v(V,I)?(E=U,V):(E=U,j=I)}var _=!1,E,j,M=p===void 0?null:p;return[function(){return N(h())},M===null?void 0:function(){return N(M())}]},[h,p,x,v]);var b=a(u,g[0],g[1]);return s(function(){w.hasValue=!0,w.value=b},[b]),c(b),b},Ng}var ob;function uj(){return ob||(ob=1,Sg.exports=cj()),Sg.exports}var fj=uj();function hj(e){e()}function dj(){let e=null,t=null;return{clear(){e=null,t=null},notify(){hj(()=>{let r=e;for(;r;)r.callback(),r=r.next})},get(){const r=[];let a=e;for(;a;)r.push(a),a=a.next;return r},subscribe(r){let a=!0;const n=t={callback:r,next:null,prev:t};return n.prev?n.prev.next=n:e=n,function(){!a||e===null||(a=!1,n.next?n.next.prev=n.prev:t=n.prev,n.prev?n.prev.next=n.next:e=n.next)}}}}var lb={notify(){},get:()=>[]};function pj(e,t){let r,a=lb,n=0,s=!1;function o(b){p();const N=a.subscribe(b);let _=!1;return()=>{_||(_=!0,N(),x())}}function c(){a.notify()}function u(){w.onStateChange&&w.onStateChange()}function h(){return s}function p(){n++,r||(r=e.subscribe(u),a=dj())}function x(){n--,r&&n===0&&(r(),r=void 0,a.clear(),a=lb)}function v(){s||(s=!0,p())}function g(){s&&(s=!1,x())}const w={addNestedSub:o,notifyNestedSubs:c,handleChangeWrapper:u,isSubscribed:h,trySubscribe:v,tryUnsubscribe:g,getListeners:()=>a};return w}var mj=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",xj=mj(),gj=()=>typeof navigator<"u"&&navigator.product==="ReactNative",vj=gj(),yj=()=>xj||vj?P.useLayoutEffect:P.useEffect,wj=yj(),Ag=Symbol.for("react-redux-context"),_g=typeof globalThis<"u"?globalThis:{};function bj(){if(!P.createContext)return{};const e=_g[Ag]??(_g[Ag]=new Map);let t=e.get(P.createContext);return t||(t=P.createContext(null),e.set(P.createContext,t)),t}var Ou=bj();function Sj(e){const{children:t,context:r,serverState:a,store:n}=e,s=P.useMemo(()=>{const u=pj(n);return{store:n,subscription:u,getServerState:a?()=>a:void 0}},[n,a]),o=P.useMemo(()=>n.getState(),[n]);wj(()=>{const{subscription:u}=s;return u.onStateChange=u.notifyNestedSubs,u.trySubscribe(),o!==n.getState()&&u.notifyNestedSubs(),()=>{u.tryUnsubscribe(),u.onStateChange=void 0}},[s,o]);const c=r||Ou;return P.createElement(c.Provider,{value:s},t)}var Nj=Sj;function Ev(e=Ou){return function(){return P.useContext(e)}}var $S=Ev();function XS(e=Ou){const t=e===Ou?$S:Ev(e),r=()=>{const{store:a}=t();return a};return Object.assign(r,{withTypes:()=>r}),r}var Aj=XS();function _j(e=Ou){const t=e===Ou?Aj:XS(e),r=()=>t().dispatch;return Object.assign(r,{withTypes:()=>r}),r}var wa=_j(),Tj=(e,t)=>e===t;function kj(e=Ou){const t=e===Ou?$S:Ev(e),r=(a,n={})=>{const{equalityFn:s=Tj}=typeof n=="function"?{equalityFn:n}:n,o=t(),{store:c,subscription:u,getServerState:h}=o;P.useRef(!0);const p=P.useCallback({[a.name](v){return a(v)}}[a.name],[a]),x=fj.useSyncExternalStoreWithSelector(u.addNestedSub,c.getState,h||c.getState,p,s);return P.useDebugValue(x),x};return Object.assign(r,{withTypes:()=>r}),r}var ur=kj();function ws(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var Ej=typeof Symbol=="function"&&Symbol.observable||"@@observable",cb=Ej,Tg=()=>Math.random().toString(36).substring(7).split("").join("."),jj={INIT:`@@redux/INIT${Tg()}`,REPLACE:`@@redux/REPLACE${Tg()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${Tg()}`},t1=jj;function jv(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function YS(e,t,r){if(typeof e!="function")throw new Error(ws(2));if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(ws(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(ws(1));return r(YS)(e,t)}let a=e,n=t,s=new Map,o=s,c=0,u=!1;function h(){o===s&&(o=new Map,s.forEach((N,_)=>{o.set(_,N)}))}function p(){if(u)throw new Error(ws(3));return n}function x(N){if(typeof N!="function")throw new Error(ws(4));if(u)throw new Error(ws(5));let _=!0;h();const E=c++;return o.set(E,N),function(){if(_){if(u)throw new Error(ws(6));_=!1,h(),o.delete(E),s=null}}}function v(N){if(!jv(N))throw new Error(ws(7));if(typeof N.type>"u")throw new Error(ws(8));if(typeof N.type!="string")throw new Error(ws(17));if(u)throw new Error(ws(9));try{u=!0,n=a(n,N)}finally{u=!1}return(s=o).forEach(E=>{E()}),N}function g(N){if(typeof N!="function")throw new Error(ws(10));a=N,v({type:t1.REPLACE})}function w(){const N=x;return{subscribe(_){if(typeof _!="object"||_===null)throw new Error(ws(11));function E(){const M=_;M.next&&M.next(p())}return E(),{unsubscribe:N(E)}},[cb](){return this}}}return v({type:t1.INIT}),{dispatch:v,subscribe:x,getState:p,replaceReducer:g,[cb]:w}}function Cj(e){Object.keys(e).forEach(t=>{const r=e[t];if(typeof r(void 0,{type:t1.INIT})>"u")throw new Error(ws(12));if(typeof r(void 0,{type:t1.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(ws(13))})}function Dj(e){const t=Object.keys(e),r={};for(let s=0;s<t.length;s++){const o=t[s];typeof e[o]=="function"&&(r[o]=e[o])}const a=Object.keys(r);let n;try{Cj(r)}catch(s){n=s}return function(o={},c){if(n)throw n;let u=!1;const h={};for(let p=0;p<a.length;p++){const x=a[p],v=r[x],g=o[x],w=v(g,c);if(typeof w>"u")throw c&&c.type,new Error(ws(14));h[x]=w,u=u||w!==g}return u=u||a.length!==Object.keys(o).length,u?h:o}}function r1(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,r)=>(...a)=>t(r(...a)))}function Fj(...e){return t=>(r,a)=>{const n=t(r,a);let s=()=>{throw new Error(ws(15))};const o={getState:n.getState,dispatch:(u,...h)=>s(u,...h)},c=e.map(u=>u(o));return s=r1(...c)(n.dispatch),{...n,dispatch:s}}}function Pj(e){return jv(e)&&"type"in e&&typeof e.type=="string"}var JS=Symbol.for("immer-nothing"),ub=Symbol.for("immer-draftable"),eo=Symbol.for("immer-state");function nl(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var lh=Object.getPrototypeOf;function zf(e){return!!e&&!!e[eo]}function Ic(e){var t;return e?KS(e)||Array.isArray(e)||!!e[ub]||!!((t=e.constructor)!=null&&t[ub])||I1(e)||B1(e):!1}var Lj=Object.prototype.constructor.toString();function KS(e){if(!e||typeof e!="object")return!1;const t=lh(e);if(t===null)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===Lj}function a1(e,t){M1(e)===0?Reflect.ownKeys(e).forEach(r=>{t(r,e[r],e)}):e.forEach((r,a)=>t(a,r,e))}function M1(e){const t=e[eo];return t?t.type_:Array.isArray(e)?1:I1(e)?2:B1(e)?3:0}function b2(e,t){return M1(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function ZS(e,t,r){const a=M1(e);a===2?e.set(t,r):a===3?e.add(r):e[t]=r}function Oj(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function I1(e){return e instanceof Map}function B1(e){return e instanceof Set}function _f(e){return e.copy_||e.base_}function S2(e,t){if(I1(e))return new Map(e);if(B1(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=KS(e);if(t===!0||t==="class_only"&&!r){const a=Object.getOwnPropertyDescriptors(e);delete a[eo];let n=Reflect.ownKeys(a);for(let s=0;s<n.length;s++){const o=n[s],c=a[o];c.writable===!1&&(c.writable=!0,c.configurable=!0),(c.get||c.set)&&(a[o]={configurable:!0,writable:!0,enumerable:c.enumerable,value:e[o]})}return Object.create(lh(e),a)}else{const a=lh(e);if(a!==null&&r)return{...e};const n=Object.create(a);return Object.assign(n,e)}}function Cv(e,t=!1){return U1(e)||zf(e)||!Ic(e)||(M1(e)>1&&(e.set=e.add=e.clear=e.delete=Rj),Object.freeze(e),t&&Object.entries(e).forEach(([r,a])=>Cv(a,!0))),e}function Rj(){nl(2)}function U1(e){return Object.isFrozen(e)}var Mj={};function Hf(e){const t=Mj[e];return t||nl(0,e),t}var zd;function QS(){return zd}function Ij(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function fb(e,t){t&&(Hf("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function N2(e){A2(e),e.drafts_.forEach(Bj),e.drafts_=null}function A2(e){e===zd&&(zd=e.parent_)}function hb(e){return zd=Ij(zd,e)}function Bj(e){const t=e[eo];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function db(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return e!==void 0&&e!==r?(r[eo].modified_&&(N2(t),nl(4)),Ic(e)&&(e=n1(t,e),t.parent_||s1(t,e)),t.patches_&&Hf("Patches").generateReplacementPatches_(r[eo].base_,e,t.patches_,t.inversePatches_)):e=n1(t,r,[]),N2(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==JS?e:void 0}function n1(e,t,r){if(U1(t))return t;const a=t[eo];if(!a)return a1(t,(n,s)=>pb(e,a,t,n,s,r)),t;if(a.scope_!==e)return t;if(!a.modified_)return s1(e,a.base_,!0),a.base_;if(!a.finalized_){a.finalized_=!0,a.scope_.unfinalizedDrafts_--;const n=a.copy_;let s=n,o=!1;a.type_===3&&(s=new Set(n),n.clear(),o=!0),a1(s,(c,u)=>pb(e,a,n,c,u,r,o)),s1(e,n,!1),r&&e.patches_&&Hf("Patches").generatePatches_(a,r,e.patches_,e.inversePatches_)}return a.copy_}function pb(e,t,r,a,n,s,o){if(zf(n)){const c=s&&t&&t.type_!==3&&!b2(t.assigned_,a)?s.concat(a):void 0,u=n1(e,n,c);if(ZS(r,a,u),zf(u))e.canAutoFreeze_=!1;else return}else o&&r.add(n);if(Ic(n)&&!U1(n)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;n1(e,n),(!t||!t.scope_.parent_)&&typeof a!="symbol"&&Object.prototype.propertyIsEnumerable.call(r,a)&&s1(e,n)}}function s1(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&Cv(t,r)}function Uj(e,t){const r=Array.isArray(e),a={type_:r?1:0,scope_:t?t.scope_:QS(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let n=a,s=Dv;r&&(n=[a],s=Hd);const{revoke:o,proxy:c}=Proxy.revocable(n,s);return a.draft_=c,a.revoke_=o,c}var Dv={get(e,t){if(t===eo)return e;const r=_f(e);if(!b2(r,t))return zj(e,r,t);const a=r[t];return e.finalized_||!Ic(a)?a:a===kg(e.base_,t)?(Eg(e),e.copy_[t]=T2(a,e)):a},has(e,t){return t in _f(e)},ownKeys(e){return Reflect.ownKeys(_f(e))},set(e,t,r){const a=eN(_f(e),t);if(a!=null&&a.set)return a.set.call(e.draft_,r),!0;if(!e.modified_){const n=kg(_f(e),t),s=n==null?void 0:n[eo];if(s&&s.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(Oj(r,n)&&(r!==void 0||b2(e.base_,t)))return!0;Eg(e),_2(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return kg(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,Eg(e),_2(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=_f(e),a=Reflect.getOwnPropertyDescriptor(r,t);return a&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:a.enumerable,value:r[t]}},defineProperty(){nl(11)},getPrototypeOf(e){return lh(e.base_)},setPrototypeOf(){nl(12)}},Hd={};a1(Dv,(e,t)=>{Hd[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});Hd.deleteProperty=function(e,t){return Hd.set.call(this,e,t,void 0)};Hd.set=function(e,t,r){return Dv.set.call(this,e[0],t,r,e[0])};function kg(e,t){const r=e[eo];return(r?_f(r):e)[t]}function zj(e,t,r){var n;const a=eN(t,r);return a?"value"in a?a.value:(n=a.get)==null?void 0:n.call(e.draft_):void 0}function eN(e,t){if(!(t in e))return;let r=lh(e);for(;r;){const a=Object.getOwnPropertyDescriptor(r,t);if(a)return a;r=lh(r)}}function _2(e){e.modified_||(e.modified_=!0,e.parent_&&_2(e.parent_))}function Eg(e){e.copy_||(e.copy_=S2(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var Hj=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,r,a)=>{if(typeof t=="function"&&typeof r!="function"){const s=r;r=t;const o=this;return function(u=s,...h){return o.produce(u,p=>r.call(this,p,...h))}}typeof r!="function"&&nl(6),a!==void 0&&typeof a!="function"&&nl(7);let n;if(Ic(t)){const s=hb(this),o=T2(t,void 0);let c=!0;try{n=r(o),c=!1}finally{c?N2(s):A2(s)}return fb(s,a),db(n,s)}else if(!t||typeof t!="object"){if(n=r(t),n===void 0&&(n=t),n===JS&&(n=void 0),this.autoFreeze_&&Cv(n,!0),a){const s=[],o=[];Hf("Patches").generateReplacementPatches_(t,n,s,o),a(s,o)}return n}else nl(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(o,...c)=>this.produceWithPatches(o,u=>t(u,...c));let a,n;return[this.produce(t,r,(o,c)=>{a=o,n=c}),a,n]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){Ic(e)||nl(8),zf(e)&&(e=Vj(e));const t=hb(this),r=T2(e,void 0);return r[eo].isManual_=!0,A2(t),r}finishDraft(e,t){const r=e&&e[eo];(!r||!r.isManual_)&&nl(9);const{scope_:a}=r;return fb(a,t),db(void 0,a)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const n=t[r];if(n.path.length===0&&n.op==="replace"){e=n.value;break}}r>-1&&(t=t.slice(r+1));const a=Hf("Patches").applyPatches_;return zf(e)?a(e,t):this.produce(e,n=>a(n,t))}};function T2(e,t){const r=I1(e)?Hf("MapSet").proxyMap_(e,t):B1(e)?Hf("MapSet").proxySet_(e,t):Uj(e,t);return(t?t.scope_:QS()).drafts_.push(r),r}function Vj(e){return zf(e)||nl(10,e),tN(e)}function tN(e){if(!Ic(e)||U1(e))return e;const t=e[eo];let r;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=S2(e,t.scope_.immer_.useStrictShallowCopy_)}else r=S2(e,!0);return a1(r,(a,n)=>{ZS(r,a,tN(n))}),t&&(t.finalized_=!1),r}var to=new Hj,rN=to.produce;to.produceWithPatches.bind(to);to.setAutoFreeze.bind(to);to.setUseStrictShallowCopy.bind(to);to.applyPatches.bind(to);to.createDraft.bind(to);to.finishDraft.bind(to);function aN(e){return({dispatch:r,getState:a})=>n=>s=>typeof s=="function"?s(r,a,e):n(s)}var qj=aN(),Gj=aN,Wj=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?r1:r1.apply(null,arguments)};function mb(e,t){function r(...a){if(t){let n=t(...a);if(!n)throw new Error(Pc(0));return{type:e,payload:n.payload,..."meta"in n&&{meta:n.meta},..."error"in n&&{error:n.error}}}return{type:e,payload:a[0]}}return r.toString=()=>`${e}`,r.type=e,r.match=a=>Pj(a)&&a.type===e,r}var nN=class vd extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,vd.prototype)}static get[Symbol.species](){return vd}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new vd(...t[0].concat(this)):new vd(...t.concat(this))}};function xb(e){return Ic(e)?rN(e,()=>{}):e}function gb(e,t,r){return e.has(t)?e.get(t):e.set(t,r(t)).get(t)}function $j(e){return typeof e=="boolean"}var Xj=()=>function(t){const{thunk:r=!0,immutableCheck:a=!0,serializableCheck:n=!0,actionCreatorCheck:s=!0}=t??{};let o=new nN;return r&&($j(r)?o.push(qj):o.push(Gj(r.extraArgument))),o},Yj="RTK_autoBatch",vb=e=>t=>{setTimeout(t,e)},Jj=(e={type:"raf"})=>t=>(...r)=>{const a=t(...r);let n=!0,s=!1,o=!1;const c=new Set,u=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:vb(10):e.type==="callback"?e.queueNotification:vb(e.timeout),h=()=>{o=!1,s&&(s=!1,c.forEach(p=>p()))};return Object.assign({},a,{subscribe(p){const x=()=>n&&p(),v=a.subscribe(x);return c.add(p),()=>{v(),c.delete(p)}},dispatch(p){var x;try{return n=!((x=p==null?void 0:p.meta)!=null&&x[Yj]),s=!n,s&&(o||(o=!0,u(h))),a.dispatch(p)}finally{n=!0}}})},Kj=e=>function(r){const{autoBatch:a=!0}=r??{};let n=new nN(e);return a&&n.push(Jj(typeof a=="object"?a:void 0)),n};function Zj(e){const t=Xj(),{reducer:r=void 0,middleware:a,devTools:n=!0,preloadedState:s=void 0,enhancers:o=void 0}=e||{};let c;if(typeof r=="function")c=r;else if(jv(r))c=Dj(r);else throw new Error(Pc(1));let u;typeof a=="function"?u=a(t):u=t();let h=r1;n&&(h=Wj({trace:!1,...typeof n=="object"&&n}));const p=Fj(...u),x=Kj(p);let v=typeof o=="function"?o(x):x();const g=h(...v);return YS(c,s,g)}function sN(e){const t={},r=[];let a;const n={addCase(s,o){const c=typeof s=="string"?s:s.type;if(!c)throw new Error(Pc(28));if(c in t)throw new Error(Pc(29));return t[c]=o,n},addMatcher(s,o){return r.push({matcher:s,reducer:o}),n},addDefaultCase(s){return a=s,n}};return e(n),[t,r,a]}function Qj(e){return typeof e=="function"}function eC(e,t){let[r,a,n]=sN(t),s;if(Qj(e))s=()=>xb(e());else{const c=xb(e);s=()=>c}function o(c=s(),u){let h=[r[u.type],...a.filter(({matcher:p})=>p(u)).map(({reducer:p})=>p)];return h.filter(p=>!!p).length===0&&(h=[n]),h.reduce((p,x)=>{if(x)if(zf(p)){const g=x(p,u);return g===void 0?p:g}else{if(Ic(p))return rN(p,v=>x(v,u));{const v=x(p,u);if(v===void 0){if(p===null)return p;throw Error("A case reducer on a non-draftable value must not return undefined")}return v}}return p},c)}return o.getInitialState=s,o}var tC=Symbol.for("rtk-slice-createasyncthunk");function rC(e,t){return`${e}/${t}`}function aC({creators:e}={}){var r;const t=(r=e==null?void 0:e.asyncThunk)==null?void 0:r[tC];return function(n){const{name:s,reducerPath:o=s}=n;if(!s)throw new Error(Pc(11));const c=(typeof n.reducers=="function"?n.reducers(iC()):n.reducers)||{},u=Object.keys(c),h={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},p={addCase(j,M){const U=typeof j=="string"?j:j.type;if(!U)throw new Error(Pc(12));if(U in h.sliceCaseReducersByType)throw new Error(Pc(13));return h.sliceCaseReducersByType[U]=M,p},addMatcher(j,M){return h.sliceMatchers.push({matcher:j,reducer:M}),p},exposeAction(j,M){return h.actionCreators[j]=M,p},exposeCaseReducer(j,M){return h.sliceCaseReducersByName[j]=M,p}};u.forEach(j=>{const M=c[j],U={reducerName:j,type:rC(s,j),createNotation:typeof n.reducers=="function"};lC(M)?uC(U,M,p,t):oC(U,M,p)});function x(){const[j={},M=[],U=void 0]=typeof n.extraReducers=="function"?sN(n.extraReducers):[n.extraReducers],V={...j,...h.sliceCaseReducersByType};return eC(n.initialState,I=>{for(let z in V)I.addCase(z,V[z]);for(let z of h.sliceMatchers)I.addMatcher(z.matcher,z.reducer);for(let z of M)I.addMatcher(z.matcher,z.reducer);U&&I.addDefaultCase(U)})}const v=j=>j,g=new Map;let w;function b(j,M){return w||(w=x()),w(j,M)}function N(){return w||(w=x()),w.getInitialState()}function _(j,M=!1){function U(I){let z=I[j];return typeof z>"u"&&M&&(z=N()),z}function V(I=v){const z=gb(g,M,()=>new WeakMap);return gb(z,I,()=>{const H={};for(const[re,R]of Object.entries(n.selectors??{}))H[re]=nC(R,I,N,M);return H})}return{reducerPath:j,getSelectors:V,get selectors(){return V(U)},selectSlice:U}}const E={name:s,reducer:b,actions:h.actionCreators,caseReducers:h.sliceCaseReducersByName,getInitialState:N,..._(o),injectInto(j,{reducerPath:M,...U}={}){const V=M??o;return j.inject({reducerPath:V,reducer:b},U),{...E,..._(V,!0)}}};return E}}function nC(e,t,r,a){function n(s,...o){let c=t(s);return typeof c>"u"&&a&&(c=r()),e(c,...o)}return n.unwrapped=e,n}var sC=aC();function iC(){function e(t,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:t,...r}}return e.withTypes=()=>e,{reducer(t){return Object.assign({[t.name](...r){return t(...r)}}[t.name],{_reducerDefinitionType:"reducer"})},preparedReducer(t,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:r}},asyncThunk:e}}function oC({type:e,reducerName:t,createNotation:r},a,n){let s,o;if("reducer"in a){if(r&&!cC(a))throw new Error(Pc(17));s=a.reducer,o=a.prepare}else s=a;n.addCase(e,s).exposeCaseReducer(t,s).exposeAction(t,o?mb(e,o):mb(e))}function lC(e){return e._reducerDefinitionType==="asyncThunk"}function cC(e){return e._reducerDefinitionType==="reducerWithPrepare"}function uC({type:e,reducerName:t},r,a,n){if(!n)throw new Error(Pc(18));const{payloadCreator:s,fulfilled:o,pending:c,rejected:u,settled:h,options:p}=r,x=n(e,s,p);a.exposeAction(t,x),o&&a.addCase(x.fulfilled,o),c&&a.addCase(x.pending,c),u&&a.addCase(x.rejected,u),h&&a.addMatcher(x.settled,h),a.exposeCaseReducer(t,{fulfilled:o||Sm,pending:c||Sm,rejected:u||Sm,settled:h||Sm})}function Sm(){}function Pc(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}const fC={products:[],brands:[],catalogs:[],interiors:[],tailors:[],salesAssociates:[],tasks:[],projects:[],customers:[],stores:[],items:[],taskDialogOpen:!1,projectFlag:!1,paymentData:[],companyData:[],designData:[],inquiry:[]},iN=sC({name:"data",initialState:fC,reducers:{setProducts:(e,t)=>{e.products=t.payload},setBrandData:(e,t)=>{e.brands=t.payload},setCatalogs:(e,t)=>{e.catalogs=t.payload},setInteriorData:(e,t)=>{e.interiors=t.payload},setTailorData:(e,t)=>{e.tailors=t.payload},setSalesAssociateData:(e,t)=>{e.salesAssociates=t.payload},setTasks:(e,t)=>{e.tasks=t.payload},setProjects:(e,t)=>{e.projects=t.payload},setCustomerData:(e,t)=>{e.customers=t.payload},setStoreData:(e,t)=>{e.stores=t.payload},setItemData:(e,t)=>{e.items=t.payload},setTaskDialogOpen:(e,t)=>{e.taskDialogOpen=t.payload},setProjectFlag:(e,t)=>{e.projectFlag=t.payload},setPaymentData:(e,t)=>{e.paymentData=t.payload},setCompanyData:(e,t)=>{e.companyData=t.payload},setDesignData:(e,t)=>{e.designData=t.payload},setInquiryData:(e,t)=>{e.inquiry=t.payload}}}),{setProducts:Cf,setBrandData:yb,setCatalogs:Fv,setInteriorData:Lf,setTailorData:i1,setSalesAssociateData:Vf,setTasks:sl,setProjects:La,setCustomerData:Lc,setStoreData:jg,setItemData:jc,setTaskDialogOpen:Ad,setProjectFlag:ch,setPaymentData:Kl,setCompanyData:wb,setDesignData:hC,setInquiryData:fd}=iN.actions,dC=iN.reducer,Cg=async()=>{const t=await(await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/gettasks")).json();return t.body?t.body:[]},Vd=({setAdded:e,onClose:t,isEditing:r,setediting:a,name:n,setrefresh:s,refresh:o,projectData:c,taskDialogOpen:u,setProjectFlag:h,setTaskDialogOpen:p,dashboard:x})=>{const[v,g]=P.useState(void 0),[w,b]=P.useState(void 0),[N,_]=P.useState(void 0),[E,j]=P.useState(void 0),[M,U]=P.useState(void 0),[V,I]=P.useState(r?r[6]:"Moderate"),[z,H]=P.useState(r?r[7]:"To Do"),re=wa(),R=ua();P.useEffect(()=>{r!=null&&(g(r[0]),b(r[1]),_(r[2]),j(r[4]),U(r[5]),I(r[6]),H(r[7]))},[r]);const F=async()=>{if(!N){alert("Please select a date and time");return}try{if((await Cg()).some(G=>{var ye;return((ye=G[0])==null?void 0:ye.toLowerCase())===v.toLowerCase()})){alert("Task name already exists. Please choose a different name.");return}const te=new Date().toISOString().slice(0,16);if((await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/addtask",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({title:v,description:w,dateTime:N,date:te,assigneeLink:E,projectLink:M,priority:V,status:z})})).status===200){alert("Task Added");const ye=(await Cg()).sort((D,O)=>new Date(D[2]).getTime()-new Date(O[2]).getTime());re(sl(ye)),localStorage.setItem("taskData",JSON.stringify({data:ye,time:Date.now()})),a(null),s(!o),t()}else alert("Error adding task")}catch(X){console.error("Error adding task:",X),alert("Something went wrong while adding the task.")}},Y=async()=>{try{const X=r[3];if((await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/updatetask",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({title:v,description:w,dateTime:N,date:X,assigneeLink:E,projectLink:M,priority:V,status:z})})).status===200){alert("Task updated");const te=(await Cg()).sort((Q,G)=>new Date(Q[2]).getTime()-new Date(G[2]).getTime());re(sl(te)),localStorage.setItem("taskData",JSON.stringify({data:te,time:Date.now()})),a(null),s(!0),t()}else alert("Error updating task")}catch(X){console.error("Error updating task:",X),alert("Something went wrong while updating the task.")}},K=()=>{u&&(re(h(!0)),re||R("/projects"),re(p(!1))),a(null),t()};return f.jsx("div",{className:"absolute top-10 left-1/2 transform -translate-x-1/2 z-50 w-full max-w-lg",children:f.jsxs("div",{className:"relative bg-white shadow-lg rounded-lg p-6 w-full border",children:[f.jsxs("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:["📝 ",r?"Edit Task":"Add Task"]}),!r&&f.jsx("input",{type:"text",placeholder:"Task Name",value:v,onChange:X=>g(X.target.value),className:"w-full border p-2 rounded mb-3"}),f.jsx("textarea",{placeholder:"Description (optional)",value:w,onChange:X=>b(X.target.value),className:"w-full border p-2 rounded mb-3"}),f.jsx("input",{type:"date",value:N,onChange:X=>_(X.target.value),className:"w-full border p-2 rounded mb-3"}),f.jsx("input",{type:"text",placeholder:"Assignee",value:E,onChange:X=>j(X.target.value),className:"w-full border p-2 rounded mb-3"}),f.jsxs("select",{value:M,onChange:X=>U(X.target.value),className:"w-full border p-2 rounded mb-3",children:[f.jsx("option",{value:"",children:"Select Project"}),c.map((X,Z)=>f.jsx("option",{value:X.projectName,children:X.projectName},Z))]}),f.jsxs("select",{value:V,onChange:X=>I(X.target.value),className:"w-full border p-2 rounded mb-3",children:[f.jsx("option",{value:"High",children:"High"}),f.jsx("option",{value:"Moderate",children:"Moderate"}),f.jsx("option",{value:"Low",children:"Low"})]}),f.jsxs("select",{value:z,onChange:X=>H(X.target.value),className:"w-full border p-2 rounded mb-3",children:[f.jsx("option",{value:"To Do",children:"To Do"}),f.jsx("option",{value:"In Progress",children:"In Progress"}),f.jsx("option",{value:"Completed",children:"Completed"})]}),f.jsxs("div",{className:"flex justify-end gap-4 mt-4",children:[f.jsx("button",{onClick:K,className:"px-4 py-2 bg-gray-400 text-white rounded",children:"Cancel"}),f.jsx("button",{onClick:r?Y:F,className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:r?"Edit Task":"Add Task"})]})]})})},Pv=P.createContext({});function Lv(e){const t=P.useRef(null);return t.current===null&&(t.current=e()),t.current}const Ov=typeof window<"u",oN=Ov?P.useLayoutEffect:P.useEffect,z1=P.createContext(null),Rv=P.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});class pC extends P.Component{getSnapshotBeforeUpdate(t){const r=this.props.childRef.current;if(r&&t.isPresent&&!this.props.isPresent){const a=r.offsetParent,n=a instanceof HTMLElement&&a.offsetWidth||0,s=this.props.sizeRef.current;s.height=r.offsetHeight||0,s.width=r.offsetWidth||0,s.top=r.offsetTop,s.left=r.offsetLeft,s.right=n-s.width-s.left}return null}componentDidUpdate(){}render(){return this.props.children}}function mC({children:e,isPresent:t,anchorX:r}){const a=P.useId(),n=P.useRef(null),s=P.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:o}=P.useContext(Rv);return P.useInsertionEffect(()=>{const{width:c,height:u,top:h,left:p,right:x}=s.current;if(t||!n.current||!c||!u)return;const v=r==="left"?`left: ${p}`:`right: ${x}`;n.current.dataset.motionPopId=a;const g=document.createElement("style");return o&&(g.nonce=o),document.head.appendChild(g),g.sheet&&g.sheet.insertRule(`
          [data-motion-pop-id="${a}"] {
            position: absolute !important;
            width: ${c}px !important;
            height: ${u}px !important;
            ${v}px !important;
            top: ${h}px !important;
          }
        `),()=>{document.head.removeChild(g)}},[t]),f.jsx(pC,{isPresent:t,childRef:n,sizeRef:s,children:P.cloneElement(e,{ref:n})})}const xC=({children:e,initial:t,isPresent:r,onExitComplete:a,custom:n,presenceAffectsLayout:s,mode:o,anchorX:c})=>{const u=Lv(gC),h=P.useId();let p=!0,x=P.useMemo(()=>(p=!1,{id:h,initial:t,isPresent:r,custom:n,onExitComplete:v=>{u.set(v,!0);for(const g of u.values())if(!g)return;a&&a()},register:v=>(u.set(v,!1),()=>u.delete(v))}),[r,u,a]);return s&&p&&(x={...x}),P.useMemo(()=>{u.forEach((v,g)=>u.set(g,!1))},[r]),P.useEffect(()=>{!r&&!u.size&&a&&a()},[r]),o==="popLayout"&&(e=f.jsx(mC,{isPresent:r,anchorX:c,children:e})),f.jsx(z1.Provider,{value:x,children:e})};function gC(){return new Map}function lN(e=!0){const t=P.useContext(z1);if(t===null)return[!0,null];const{isPresent:r,onExitComplete:a,register:n}=t,s=P.useId();P.useEffect(()=>{if(e)return n(s)},[e]);const o=P.useCallback(()=>e&&a&&a(s),[s,a,e]);return!r&&a?[!1,o]:[!0]}const Nm=e=>e.key||"";function bb(e){const t=[];return P.Children.forEach(e,r=>{P.isValidElement(r)&&t.push(r)}),t}const qd=({children:e,custom:t,initial:r=!0,onExitComplete:a,presenceAffectsLayout:n=!0,mode:s="sync",propagate:o=!1,anchorX:c="left"})=>{const[u,h]=lN(o),p=P.useMemo(()=>bb(e),[e]),x=o&&!u?[]:p.map(Nm),v=P.useRef(!0),g=P.useRef(p),w=Lv(()=>new Map),[b,N]=P.useState(p),[_,E]=P.useState(p);oN(()=>{v.current=!1,g.current=p;for(let U=0;U<_.length;U++){const V=Nm(_[U]);x.includes(V)?w.delete(V):w.get(V)!==!0&&w.set(V,!1)}},[_,x.length,x.join("-")]);const j=[];if(p!==b){let U=[...p];for(let V=0;V<_.length;V++){const I=_[V],z=Nm(I);x.includes(z)||(U.splice(V,0,I),j.push(I))}return s==="wait"&&j.length&&(U=j),E(bb(U)),N(p),null}const{forceRender:M}=P.useContext(Pv);return f.jsx(f.Fragment,{children:_.map(U=>{const V=Nm(U),I=o&&!u?!1:p===_||x.includes(V),z=()=>{if(w.has(V))w.set(V,!0);else return;let H=!0;w.forEach(re=>{re||(H=!1)}),H&&(M==null||M(),E(g.current),o&&(h==null||h()),a&&a())};return f.jsx(xC,{isPresent:I,initial:!v.current||r?void 0:!1,custom:t,presenceAffectsLayout:n,mode:s,onExitComplete:I?void 0:z,anchorX:c,children:U},V)})})};function Mv(e,t){e.indexOf(t)===-1&&e.push(t)}function Iv(e,t){const r=e.indexOf(t);r>-1&&e.splice(r,1)}let cN=()=>{};const k2={useManualTiming:!1};function Bv(e){let t;return()=>(t===void 0&&(t=e()),t)}const Eo=e=>e,Gd=(e,t,r)=>{const a=t-e;return a===0?1:(r-e)/a};class Uv{constructor(){this.subscriptions=[]}add(t){return Mv(this.subscriptions,t),()=>Iv(this.subscriptions,t)}notify(t,r,a){const n=this.subscriptions.length;if(n)if(n===1)this.subscriptions[0](t,r,a);else for(let s=0;s<n;s++){const o=this.subscriptions[s];o&&o(t,r,a)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Wl=e=>e*1e3,$l=e=>e/1e3;function uN(e,t){return t?e*(1e3/t):0}const vC=Bv(()=>window.ScrollTimeline!==void 0);class yC{constructor(t){this.stop=()=>this.runAll("stop"),this.animations=t.filter(Boolean)}get finished(){return Promise.all(this.animations.map(t=>t.finished))}getAll(t){return this.animations[0][t]}setAll(t,r){for(let a=0;a<this.animations.length;a++)this.animations[a][t]=r}attachTimeline(t,r){const a=this.animations.map(n=>{if(vC()&&n.attachTimeline)return n.attachTimeline(t);if(typeof r=="function")return r(n)});return()=>{a.forEach((n,s)=>{n&&n(),this.animations[s].stop()})}}get time(){return this.getAll("time")}set time(t){this.setAll("time",t)}get speed(){return this.getAll("speed")}set speed(t){this.setAll("speed",t)}get startTime(){return this.getAll("startTime")}get duration(){let t=0;for(let r=0;r<this.animations.length;r++)t=Math.max(t,this.animations[r].duration);return t}runAll(t){this.animations.forEach(r=>r[t]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class wC extends yC{then(t,r){return this.finished.finally(t).then(()=>{})}}const Sb={value:null},zv=e=>Array.isArray(e)&&typeof e[0]=="number",bC={};function SC(e,t){const r=Bv(e);return()=>bC[t]??r()}const Wd=SC(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),fN=(e,t,r=10)=>{let a="";const n=Math.max(Math.round(t/r),2);for(let s=0;s<n;s++)a+=e(s/(n-1))+", ";return`linear(${a.substring(0,a.length-2)})`},yd=([e,t,r,a])=>`cubic-bezier(${e}, ${t}, ${r}, ${a})`,E2={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:yd([0,.65,.55,1]),circOut:yd([.55,0,1,.45]),backIn:yd([.31,.01,.66,-.59]),backOut:yd([.33,1.53,.69,.99])};function hN(e,t){if(e)return typeof e=="function"&&Wd()?fN(e,t):zv(e)?yd(e):Array.isArray(e)?e.map(r=>hN(r,t)||E2.easeOut):E2[e]}function NC(e,t,r,{delay:a=0,duration:n=300,repeat:s=0,repeatType:o="loop",ease:c="easeInOut",times:u}={},h=void 0){const p={[t]:r};u&&(p.offset=u);const x=hN(c,n);return Array.isArray(x)&&(p.easing=x),e.animate(p,{delay:a,duration:n,easing:Array.isArray(x)?"linear":x,fill:"both",iterations:s+1,direction:o==="reverse"?"alternate":"normal",pseudoElement:h})}function Hv(e){return typeof e=="function"&&"applyToOptions"in e}function Vv(e,t){return(e==null?void 0:e[t])??(e==null?void 0:e.default)??e}const o1=2e4;function qv(e){let t=0;const r=50;let a=e.next(t);for(;!a.done&&t<o1;)t+=r,a=e.next(t);return t>=o1?1/0:t}function AC(e,t=100,r){const a=r({...e,keyframes:[0,t]}),n=Math.min(qv(a),o1);return{type:"keyframes",ease:s=>a.next(n*s).value/t,duration:$l(n)}}function dN(e){return!!(typeof e=="function"&&Wd()||!e||typeof e=="string"&&(e in E2||Wd())||zv(e)||Array.isArray(e)&&e.every(dN))}function Nb(e,t){e.timeline=t,e.onfinish=null}const Am=["read","resolveKeyframes","update","preRender","render","postRender"];function _C(e,t){let r=new Set,a=new Set,n=!1,s=!1;const o=new WeakSet;let c={delta:0,timestamp:0,isProcessing:!1},u=0;function h(x){o.has(x)&&(p.schedule(x),e()),u++,x(c)}const p={schedule:(x,v=!1,g=!1)=>{const b=g&&n?r:a;return v&&o.add(x),b.has(x)||b.add(x),x},cancel:x=>{a.delete(x),o.delete(x)},process:x=>{if(c=x,n){s=!0;return}n=!0,[r,a]=[a,r],r.forEach(h),t&&Sb.value&&Sb.value.frameloop[t].push(u),u=0,r.clear(),n=!1,s&&(s=!1,p.process(x))}};return p}const TC=40;function pN(e,t){let r=!1,a=!0;const n={delta:0,timestamp:0,isProcessing:!1},s=()=>r=!0,o=Am.reduce((_,E)=>(_[E]=_C(s,t?E:void 0),_),{}),{read:c,resolveKeyframes:u,update:h,preRender:p,render:x,postRender:v}=o,g=()=>{const _=performance.now();r=!1,n.delta=a?1e3/60:Math.max(Math.min(_-n.timestamp,TC),1),n.timestamp=_,n.isProcessing=!0,c.process(n),u.process(n),h.process(n),p.process(n),x.process(n),v.process(n),n.isProcessing=!1,r&&t&&(a=!1,e(g))},w=()=>{r=!0,a=!0,n.isProcessing||e(g)};return{schedule:Am.reduce((_,E)=>{const j=o[E];return _[E]=(M,U=!1,V=!1)=>(r||w(),j.schedule(M,U,V)),_},{}),cancel:_=>{for(let E=0;E<Am.length;E++)o[Am[E]].cancel(_)},state:n,steps:o}}const{schedule:Gv}=pN(queueMicrotask,!1),{schedule:Oa,cancel:Ru,state:bs,steps:Dg}=pN(typeof requestAnimationFrame<"u"?requestAnimationFrame:Eo,!0);let Wm;function kC(){Wm=void 0}const Xl={now:()=>(Wm===void 0&&Xl.set(bs.isProcessing||k2.useManualTiming?bs.timestamp:performance.now()),Wm),set:e=>{Wm=e,queueMicrotask(kC)}},rl={x:!1,y:!1};function mN(){return rl.x||rl.y}function EC(e){return e==="x"||e==="y"?rl[e]?null:(rl[e]=!0,()=>{rl[e]=!1}):rl.x||rl.y?null:(rl.x=rl.y=!0,()=>{rl.x=rl.y=!1})}function jC(e,t,r){if(e instanceof EventTarget)return[e];if(typeof e=="string"){let a=document;const n=(r==null?void 0:r[e])??a.querySelectorAll(e);return n?Array.from(n):[]}return Array.from(e)}function xN(e,t){const r=jC(e),a=new AbortController,n={passive:!0,...t,signal:a.signal};return[r,n,()=>a.abort()]}function Ab(e){return!(e.pointerType==="touch"||mN())}function CC(e,t,r={}){const[a,n,s]=xN(e,r),o=c=>{if(!Ab(c))return;const{target:u}=c,h=t(u,c);if(typeof h!="function"||!u)return;const p=x=>{Ab(x)&&(h(x),u.removeEventListener("pointerleave",p))};u.addEventListener("pointerleave",p,n)};return a.forEach(c=>{c.addEventListener("pointerenter",o,n)}),s}const gN=(e,t)=>t?e===t?!0:gN(e,t.parentElement):!1,Wv=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1,DC=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function FC(e){return DC.has(e.tagName)||e.tabIndex!==-1}const wd=new WeakSet;function _b(e){return t=>{t.key==="Enter"&&e(t)}}function Fg(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const PC=(e,t)=>{const r=e.currentTarget;if(!r)return;const a=_b(()=>{if(wd.has(r))return;Fg(r,"down");const n=_b(()=>{Fg(r,"up")}),s=()=>Fg(r,"cancel");r.addEventListener("keyup",n,t),r.addEventListener("blur",s,t)});r.addEventListener("keydown",a,t),r.addEventListener("blur",()=>r.removeEventListener("keydown",a),t)};function Tb(e){return Wv(e)&&!mN()}function LC(e,t,r={}){const[a,n,s]=xN(e,r),o=c=>{const u=c.currentTarget;if(!Tb(c)||wd.has(u))return;wd.add(u);const h=t(u,c),p=(g,w)=>{window.removeEventListener("pointerup",x),window.removeEventListener("pointercancel",v),!(!Tb(g)||!wd.has(u))&&(wd.delete(u),typeof h=="function"&&h(g,{success:w}))},x=g=>{p(g,u===window||u===document||r.useGlobalTarget||gN(u,g.target))},v=g=>{p(g,!1)};window.addEventListener("pointerup",x,n),window.addEventListener("pointercancel",v,n)};return a.forEach(c=>{(r.useGlobalTarget?window:c).addEventListener("pointerdown",o,n),c instanceof HTMLElement&&(c.addEventListener("focus",h=>PC(h,n)),!FC(c)&&!c.hasAttribute("tabindex")&&(c.tabIndex=0))}),s}const kb=30,OC=e=>!isNaN(parseFloat(e));class RC{constructor(t,r={}){this.version="12.7.4",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(a,n=!0)=>{const s=Xl.now();this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(a),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),n&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(t),this.owner=r.owner}setCurrent(t){this.current=t,this.updatedAt=Xl.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=OC(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,r){this.events[t]||(this.events[t]=new Uv);const a=this.events[t].add(r);return t==="change"?()=>{a(),Oa.read(()=>{this.events.change.getSize()||this.stop()})}:a}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,r){this.passiveEffect=t,this.stopPassiveEffect=r}set(t,r=!0){!r||!this.passiveEffect?this.updateAndNotify(t,r):this.passiveEffect(t,this.updateAndNotify)}setWithVelocity(t,r,a){this.set(r),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-a}jump(t,r=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,r&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=Xl.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>kb)return 0;const r=Math.min(this.updatedAt-this.prevUpdatedAt,kb);return uN(parseFloat(this.current)-parseFloat(this.prevFrameValue),r)}start(t){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=t(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function $d(e,t){return new RC(e,t)}const vN=P.createContext({strict:!1}),Eb={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},uh={};for(const e in Eb)uh[e]={isEnabled:t=>Eb[e].some(r=>!!t[r])};function MC(e){for(const t in e)uh[t]={...uh[t],...e[t]}}const IC=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function l1(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||IC.has(e)}let yN=e=>!l1(e);function BC(e){e&&(yN=t=>t.startsWith("on")?!l1(t):e(t))}try{BC(require("@emotion/is-prop-valid").default)}catch{}function UC(e,t,r){const a={};for(const n in e)n==="values"&&typeof e.values=="object"||(yN(n)||r===!0&&l1(n)||!t&&!l1(n)||e.draggable&&n.startsWith("onDrag"))&&(a[n]=e[n]);return a}function zC(e){if(typeof Proxy>"u")return e;const t=new Map,r=(...a)=>e(...a);return new Proxy(r,{get:(a,n)=>n==="create"?e:(t.has(n)||t.set(n,e(n)),t.get(n))})}const H1=P.createContext({});function V1(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}function Xd(e){return typeof e=="string"||Array.isArray(e)}const $v=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],Xv=["initial",...$v];function q1(e){return V1(e.animate)||Xv.some(t=>Xd(e[t]))}function wN(e){return!!(q1(e)||e.variants)}function HC(e,t){if(q1(e)){const{initial:r,animate:a}=e;return{initial:r===!1||Xd(r)?r:void 0,animate:Xd(a)?a:void 0}}return e.inherit!==!1?t:{}}function VC(e){const{initial:t,animate:r}=HC(e,P.useContext(H1));return P.useMemo(()=>({initial:t,animate:r}),[jb(t),jb(r)])}function jb(e){return Array.isArray(e)?e.join(" "):e}const qC=Symbol.for("motionComponentSymbol");function W0(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function GC(e,t,r){return P.useCallback(a=>{a&&e.onMount&&e.onMount(a),t&&(a?t.mount(a):t.unmount()),r&&(typeof r=="function"?r(a):W0(r)&&(r.current=a))},[t])}const Yv=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),WC="framerAppearId",bN="data-"+Yv(WC),SN=P.createContext({});function $C(e,t,r,a,n){var b,N;const{visualElement:s}=P.useContext(H1),o=P.useContext(vN),c=P.useContext(z1),u=P.useContext(Rv).reducedMotion,h=P.useRef(null);a=a||o.renderer,!h.current&&a&&(h.current=a(e,{visualState:t,parent:s,props:r,presenceContext:c,blockInitialAnimation:c?c.initial===!1:!1,reducedMotionConfig:u}));const p=h.current,x=P.useContext(SN);p&&!p.projection&&n&&(p.type==="html"||p.type==="svg")&&XC(h.current,r,n,x);const v=P.useRef(!1);P.useInsertionEffect(()=>{p&&v.current&&p.update(r,c)});const g=r[bN],w=P.useRef(!!g&&!((b=window.MotionHandoffIsComplete)!=null&&b.call(window,g))&&((N=window.MotionHasOptimisedAnimation)==null?void 0:N.call(window,g)));return oN(()=>{p&&(v.current=!0,window.MotionIsMounted=!0,p.updateFeatures(),Gv.render(p.render),w.current&&p.animationState&&p.animationState.animateChanges())}),P.useEffect(()=>{p&&(!w.current&&p.animationState&&p.animationState.animateChanges(),w.current&&(queueMicrotask(()=>{var _;(_=window.MotionHandoffMarkAsComplete)==null||_.call(window,g)}),w.current=!1))}),p}function XC(e,t,r,a){const{layoutId:n,layout:s,drag:o,dragConstraints:c,layoutScroll:u,layoutRoot:h,layoutCrossfade:p}=t;e.projection=new r(e.latestValues,t["data-framer-portal-id"]?void 0:NN(e.parent)),e.projection.setOptions({layoutId:n,layout:s,alwaysMeasureLayout:!!o||c&&W0(c),visualElement:e,animationType:typeof s=="string"?s:"both",initialPromotionConfig:a,crossfade:p,layoutScroll:u,layoutRoot:h})}function NN(e){if(e)return e.options.allowProjection!==!1?e.projection:NN(e.parent)}function YC({preloadedFeatures:e,createVisualElement:t,useRender:r,useVisualState:a,Component:n}){e&&MC(e);function s(c,u){let h;const p={...P.useContext(Rv),...c,layoutId:JC(c)},{isStatic:x}=p,v=VC(c),g=a(c,x);if(!x&&Ov){KC();const w=ZC(p);h=w.MeasureLayout,v.visualElement=$C(n,g,p,t,w.ProjectionNode)}return f.jsxs(H1.Provider,{value:v,children:[h&&v.visualElement?f.jsx(h,{visualElement:v.visualElement,...p}):null,r(n,c,GC(g,v.visualElement,u),g,x,v.visualElement)]})}s.displayName=`motion.${typeof n=="string"?n:`create(${n.displayName??n.name??""})`}`;const o=P.forwardRef(s);return o[qC]=n,o}function JC({layoutId:e}){const t=P.useContext(Pv).id;return t&&e!==void 0?t+"-"+e:e}function KC(e,t){P.useContext(vN).strict}function ZC(e){const{drag:t,layout:r}=uh;if(!t&&!r)return{};const a={...t,...r};return{MeasureLayout:t!=null&&t.isEnabled(e)||r!=null&&r.isEnabled(e)?a.MeasureLayout:void 0,ProjectionNode:a.ProjectionNode}}const AN=e=>t=>typeof t=="string"&&t.startsWith(e),Jv=AN("--"),QC=AN("var(--"),Kv=e=>QC(e)?e7.test(e.split("/*")[0].trim()):!1,e7=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,Yd={};function t7(e){for(const t in e)Yd[t]=e[t],Jv(t)&&(Yd[t].isCSSVariable=!0)}const vh=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Qf=new Set(vh);function _N(e,{layout:t,layoutId:r}){return Qf.has(e)||e.startsWith("origin")||(t||r!==void 0)&&(!!Yd[e]||e==="opacity")}const Js=e=>!!(e&&e.getVelocity),TN=(e,t)=>t&&typeof e=="number"?t.transform(e):e,Bc=(e,t,r)=>r>t?t:r<e?e:r,yh={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},Jd={...yh,transform:e=>Bc(0,1,e)},_m={...yh,default:1},xp=e=>({test:t=>typeof t=="string"&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),ju=xp("deg"),Yl=xp("%"),mr=xp("px"),r7=xp("vh"),a7=xp("vw"),Cb={...Yl,parse:e=>Yl.parse(e)/100,transform:e=>Yl.transform(e*100)},n7={borderWidth:mr,borderTopWidth:mr,borderRightWidth:mr,borderBottomWidth:mr,borderLeftWidth:mr,borderRadius:mr,radius:mr,borderTopLeftRadius:mr,borderTopRightRadius:mr,borderBottomRightRadius:mr,borderBottomLeftRadius:mr,width:mr,maxWidth:mr,height:mr,maxHeight:mr,top:mr,right:mr,bottom:mr,left:mr,padding:mr,paddingTop:mr,paddingRight:mr,paddingBottom:mr,paddingLeft:mr,margin:mr,marginTop:mr,marginRight:mr,marginBottom:mr,marginLeft:mr,backgroundPositionX:mr,backgroundPositionY:mr},s7={rotate:ju,rotateX:ju,rotateY:ju,rotateZ:ju,scale:_m,scaleX:_m,scaleY:_m,scaleZ:_m,skew:ju,skewX:ju,skewY:ju,distance:mr,translateX:mr,translateY:mr,translateZ:mr,x:mr,y:mr,z:mr,perspective:mr,transformPerspective:mr,opacity:Jd,originX:Cb,originY:Cb,originZ:mr},Db={...yh,transform:Math.round},Zv={...n7,...s7,zIndex:Db,size:mr,fillOpacity:Jd,strokeOpacity:Jd,numOctaves:Db},i7={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},o7=vh.length;function l7(e,t,r){let a="",n=!0;for(let s=0;s<o7;s++){const o=vh[s],c=e[o];if(c===void 0)continue;let u=!0;if(typeof c=="number"?u=c===(o.startsWith("scale")?1:0):u=parseFloat(c)===0,!u||r){const h=TN(c,Zv[o]);if(!u){n=!1;const p=i7[o]||o;a+=`${p}(${h}) `}r&&(t[o]=h)}}return a=a.trim(),r?a=r(t,n?"":a):n&&(a="none"),a}function Qv(e,t,r){const{style:a,vars:n,transformOrigin:s}=e;let o=!1,c=!1;for(const u in t){const h=t[u];if(Qf.has(u)){o=!0;continue}else if(Jv(u)){n[u]=h;continue}else{const p=TN(h,Zv[u]);u.startsWith("origin")?(c=!0,s[u]=p):a[u]=p}}if(t.transform||(o||r?a.transform=l7(t,e.transform,r):a.transform&&(a.transform="none")),c){const{originX:u="50%",originY:h="50%",originZ:p=0}=s;a.transformOrigin=`${u} ${h} ${p}`}}const ey=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function kN(e,t,r){for(const a in t)!Js(t[a])&&!_N(a,r)&&(e[a]=t[a])}function c7({transformTemplate:e},t){return P.useMemo(()=>{const r=ey();return Qv(r,t,e),Object.assign({},r.vars,r.style)},[t])}function u7(e,t){const r=e.style||{},a={};return kN(a,r,e),Object.assign(a,c7(e,t)),a}function f7(e,t){const r={},a=u7(e,t);return e.drag&&e.dragListener!==!1&&(r.draggable=!1,a.userSelect=a.WebkitUserSelect=a.WebkitTouchCallout="none",a.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(r.tabIndex=0),r.style=a,r}const h7=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function ty(e){return typeof e!="string"||e.includes("-")?!1:!!(h7.indexOf(e)>-1||/[A-Z]/u.test(e))}const d7={offset:"stroke-dashoffset",array:"stroke-dasharray"},p7={offset:"strokeDashoffset",array:"strokeDasharray"};function m7(e,t,r=1,a=0,n=!0){e.pathLength=1;const s=n?d7:p7;e[s.offset]=mr.transform(-a);const o=mr.transform(t),c=mr.transform(r);e[s.array]=`${o} ${c}`}function Fb(e,t,r){return typeof e=="string"?e:mr.transform(t+r*e)}function x7(e,t,r){const a=Fb(t,e.x,e.width),n=Fb(r,e.y,e.height);return`${a} ${n}`}function ry(e,{attrX:t,attrY:r,attrScale:a,originX:n,originY:s,pathLength:o,pathSpacing:c=1,pathOffset:u=0,...h},p,x){if(Qv(e,h,x),p){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:v,style:g,dimensions:w}=e;v.transform&&(w&&(g.transform=v.transform),delete v.transform),w&&(n!==void 0||s!==void 0||g.transform)&&(g.transformOrigin=x7(w,n!==void 0?n:.5,s!==void 0?s:.5)),t!==void 0&&(v.x=t),r!==void 0&&(v.y=r),a!==void 0&&(v.scale=a),o!==void 0&&m7(v,o,c,u,!1)}const EN=()=>({...ey(),attrs:{}}),ay=e=>typeof e=="string"&&e.toLowerCase()==="svg";function g7(e,t,r,a){const n=P.useMemo(()=>{const s=EN();return ry(s,t,ay(a),e.transformTemplate),{...s.attrs,style:{...s.style}}},[t]);if(e.style){const s={};kN(s,e.style,e),n.style={...s,...n.style}}return n}function v7(e=!1){return(r,a,n,{latestValues:s},o)=>{const u=(ty(r)?g7:f7)(a,s,o,r),h=UC(a,typeof r=="string",e),p=r!==P.Fragment?{...h,...u,ref:n}:{},{children:x}=a,v=P.useMemo(()=>Js(x)?x.get():x,[x]);return P.createElement(r,{...p,children:v})}}function Pb(e){const t=[{},{}];return e==null||e.values.forEach((r,a)=>{t[0][a]=r.get(),t[1][a]=r.getVelocity()}),t}function ny(e,t,r,a){if(typeof t=="function"){const[n,s]=Pb(a);t=t(r!==void 0?r:e.custom,n,s)}if(typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"){const[n,s]=Pb(a);t=t(r!==void 0?r:e.custom,n,s)}return t}const j2=e=>Array.isArray(e),y7=e=>!!(e&&typeof e=="object"&&e.mix&&e.toValue),w7=e=>j2(e)?e[e.length-1]||0:e;function $m(e){const t=Js(e)?e.get():e;return y7(t)?t.toValue():t}function b7({scrapeMotionValuesFromProps:e,createRenderState:t,onUpdate:r},a,n,s){const o={latestValues:S7(a,n,s,e),renderState:t()};return r&&(o.onMount=c=>r({props:a,current:c,...o}),o.onUpdate=c=>r(c)),o}const jN=e=>(t,r)=>{const a=P.useContext(H1),n=P.useContext(z1),s=()=>b7(e,t,a,n);return r?s():Lv(s)};function S7(e,t,r,a){const n={},s=a(e,{});for(const v in s)n[v]=$m(s[v]);let{initial:o,animate:c}=e;const u=q1(e),h=wN(e);t&&h&&!u&&e.inherit!==!1&&(o===void 0&&(o=t.initial),c===void 0&&(c=t.animate));let p=r?r.initial===!1:!1;p=p||o===!1;const x=p?c:o;if(x&&typeof x!="boolean"&&!V1(x)){const v=Array.isArray(x)?x:[x];for(let g=0;g<v.length;g++){const w=ny(e,v[g]);if(w){const{transitionEnd:b,transition:N,..._}=w;for(const E in _){let j=_[E];if(Array.isArray(j)){const M=p?j.length-1:0;j=j[M]}j!==null&&(n[E]=j)}for(const E in b)n[E]=b[E]}}}return n}function sy(e,t,r){var s;const{style:a}=e,n={};for(const o in a)(Js(a[o])||t.style&&Js(t.style[o])||_N(o,e)||((s=r==null?void 0:r.getValue(o))==null?void 0:s.liveStyle)!==void 0)&&(n[o]=a[o]);return n}const N7={useVisualState:jN({scrapeMotionValuesFromProps:sy,createRenderState:ey})};function CN(e,t){try{t.dimensions=typeof e.getBBox=="function"?e.getBBox():e.getBoundingClientRect()}catch{t.dimensions={x:0,y:0,width:0,height:0}}}function DN(e,{style:t,vars:r},a,n){Object.assign(e.style,t,n&&n.getProjectionStyles(a));for(const s in r)e.style.setProperty(s,r[s])}const FN=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function PN(e,t,r,a){DN(e,t,void 0,a);for(const n in t.attrs)e.setAttribute(FN.has(n)?n:Yv(n),t.attrs[n])}function LN(e,t,r){const a=sy(e,t,r);for(const n in e)if(Js(e[n])||Js(t[n])){const s=vh.indexOf(n)!==-1?"attr"+n.charAt(0).toUpperCase()+n.substring(1):n;a[s]=e[n]}return a}const Lb=["x","y","width","height","cx","cy","r"],A7={useVisualState:jN({scrapeMotionValuesFromProps:LN,createRenderState:EN,onUpdate:({props:e,prevProps:t,current:r,renderState:a,latestValues:n})=>{if(!r)return;let s=!!e.drag;if(!s){for(const c in n)if(Qf.has(c)){s=!0;break}}if(!s)return;let o=!t;if(t)for(let c=0;c<Lb.length;c++){const u=Lb[c];e[u]!==t[u]&&(o=!0)}o&&Oa.read(()=>{CN(r,a),Oa.render(()=>{ry(a,n,ay(r.tagName),e.transformTemplate),PN(r,a)})})}})};function _7(e,t){return function(a,{forwardMotionProps:n}={forwardMotionProps:!1}){const o={...ty(a)?A7:N7,preloadedFeatures:e,useRender:v7(n),createVisualElement:t,Component:a};return YC(o)}}function Kd(e,t,r){const a=e.getProps();return ny(a,t,r!==void 0?r:a.custom,e)}const ON=new Set(["width","height","top","left","right","bottom",...vh]);function T7(e,t,r){e.hasValue(t)?e.getValue(t).set(r):e.addValue(t,$d(r))}function k7(e,t){const r=Kd(e,t);let{transitionEnd:a={},transition:n={},...s}=r||{};s={...s,...a};for(const o in s){const c=w7(s[o]);T7(e,o,c)}}function E7(e){return!!(Js(e)&&e.add)}function C2(e,t){const r=e.getValue("willChange");if(E7(r))return r.add(t);if(!r&&k2.WillChange){const a=new k2.WillChange("auto");e.addValue("willChange",a),a.add(t)}}function RN(e){return e.props[bN]}const MN=(e,t,r)=>(((1-3*r+3*t)*e+(3*r-6*t))*e+3*t)*e,j7=1e-7,C7=12;function D7(e,t,r,a,n){let s,o,c=0;do o=t+(r-t)/2,s=MN(o,a,n)-e,s>0?r=o:t=o;while(Math.abs(s)>j7&&++c<C7);return o}function gp(e,t,r,a){if(e===t&&r===a)return Eo;const n=s=>D7(s,0,1,e,r);return s=>s===0||s===1?s:MN(n(s),t,a)}const IN=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,BN=e=>t=>1-e(1-t),UN=gp(.33,1.53,.69,.99),iy=BN(UN),zN=IN(iy),HN=e=>(e*=2)<1?.5*iy(e):.5*(2-Math.pow(2,-10*(e-1))),oy=e=>1-Math.sin(Math.acos(e)),VN=BN(oy),qN=IN(oy),GN=e=>/^0[^.\s]+$/u.test(e);function F7(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||GN(e):!0}const _d=e=>Math.round(e*1e5)/1e5,ly=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function P7(e){return e==null}const L7=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,cy=(e,t)=>r=>!!(typeof r=="string"&&L7.test(r)&&r.startsWith(e)||t&&!P7(r)&&Object.prototype.hasOwnProperty.call(r,t)),WN=(e,t,r)=>a=>{if(typeof a!="string")return a;const[n,s,o,c]=a.match(ly);return{[e]:parseFloat(n),[t]:parseFloat(s),[r]:parseFloat(o),alpha:c!==void 0?parseFloat(c):1}},O7=e=>Bc(0,255,e),Pg={...yh,transform:e=>Math.round(O7(e))},Df={test:cy("rgb","red"),parse:WN("red","green","blue"),transform:({red:e,green:t,blue:r,alpha:a=1})=>"rgba("+Pg.transform(e)+", "+Pg.transform(t)+", "+Pg.transform(r)+", "+_d(Jd.transform(a))+")"};function R7(e){let t="",r="",a="",n="";return e.length>5?(t=e.substring(1,3),r=e.substring(3,5),a=e.substring(5,7),n=e.substring(7,9)):(t=e.substring(1,2),r=e.substring(2,3),a=e.substring(3,4),n=e.substring(4,5),t+=t,r+=r,a+=a,n+=n),{red:parseInt(t,16),green:parseInt(r,16),blue:parseInt(a,16),alpha:n?parseInt(n,16)/255:1}}const D2={test:cy("#"),parse:R7,transform:Df.transform},$0={test:cy("hsl","hue"),parse:WN("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:r,alpha:a=1})=>"hsla("+Math.round(e)+", "+Yl.transform(_d(t))+", "+Yl.transform(_d(r))+", "+_d(Jd.transform(a))+")"},qs={test:e=>Df.test(e)||D2.test(e)||$0.test(e),parse:e=>Df.test(e)?Df.parse(e):$0.test(e)?$0.parse(e):D2.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?Df.transform(e):$0.transform(e)},M7=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function I7(e){var t,r;return isNaN(e)&&typeof e=="string"&&(((t=e.match(ly))==null?void 0:t.length)||0)+(((r=e.match(M7))==null?void 0:r.length)||0)>0}const $N="number",XN="color",B7="var",U7="var(",Ob="${}",z7=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Zd(e){const t=e.toString(),r=[],a={color:[],number:[],var:[]},n=[];let s=0;const c=t.replace(z7,u=>(qs.test(u)?(a.color.push(s),n.push(XN),r.push(qs.parse(u))):u.startsWith(U7)?(a.var.push(s),n.push(B7),r.push(u)):(a.number.push(s),n.push($N),r.push(parseFloat(u))),++s,Ob)).split(Ob);return{values:r,split:c,indexes:a,types:n}}function YN(e){return Zd(e).values}function JN(e){const{split:t,types:r}=Zd(e),a=t.length;return n=>{let s="";for(let o=0;o<a;o++)if(s+=t[o],n[o]!==void 0){const c=r[o];c===$N?s+=_d(n[o]):c===XN?s+=qs.transform(n[o]):s+=n[o]}return s}}const H7=e=>typeof e=="number"?0:e;function V7(e){const t=YN(e);return JN(e)(t.map(H7))}const Mu={test:I7,parse:YN,createTransformer:JN,getAnimatableNone:V7},q7=new Set(["brightness","contrast","saturate","opacity"]);function G7(e){const[t,r]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[a]=r.match(ly)||[];if(!a)return e;const n=r.replace(a,"");let s=q7.has(t)?1:0;return a!==r&&(s*=100),t+"("+s+n+")"}const W7=/\b([a-z-]*)\(.*?\)/gu,F2={...Mu,getAnimatableNone:e=>{const t=e.match(W7);return t?t.map(G7).join(" "):e}},$7={...Zv,color:qs,backgroundColor:qs,outlineColor:qs,fill:qs,stroke:qs,borderColor:qs,borderTopColor:qs,borderRightColor:qs,borderBottomColor:qs,borderLeftColor:qs,filter:F2,WebkitFilter:F2},KN=e=>$7[e];function ZN(e,t){let r=KN(e);return r!==F2&&(r=Mu),r.getAnimatableNone?r.getAnimatableNone(t):void 0}const X7=new Set(["auto","none","0"]);function Y7(e,t,r){let a=0,n;for(;a<e.length&&!n;){const s=e[a];typeof s=="string"&&!X7.has(s)&&Zd(s).values.length&&(n=e[a]),a++}if(n&&r)for(const s of t)e[s]=ZN(r,n)}const Ff=e=>e*180/Math.PI,P2=e=>{const t=Ff(Math.atan2(e[1],e[0]));return L2(t)},J7={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:P2,rotateZ:P2,skewX:e=>Ff(Math.atan(e[1])),skewY:e=>Ff(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},L2=e=>(e=e%360,e<0&&(e+=360),e),Rb=P2,Mb=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),Ib=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),K7={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:Mb,scaleY:Ib,scale:e=>(Mb(e)+Ib(e))/2,rotateX:e=>L2(Ff(Math.atan2(e[6],e[5]))),rotateY:e=>L2(Ff(Math.atan2(-e[2],e[0]))),rotateZ:Rb,rotate:Rb,skewX:e=>Ff(Math.atan(e[4])),skewY:e=>Ff(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function Bb(e){return e.includes("scale")?1:0}function O2(e,t){if(!e||e==="none")return Bb(t);const r=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let a,n;if(r)a=K7,n=r;else{const c=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);a=J7,n=c}if(!n)return Bb(t);const s=a[t],o=n[1].split(",").map(Q7);return typeof s=="function"?s(o):o[s]}const Z7=(e,t)=>{const{transform:r="none"}=getComputedStyle(e);return O2(r,t)};function Q7(e){return parseFloat(e.trim())}const Ub=e=>e===yh||e===mr,eD=new Set(["x","y","z"]),tD=vh.filter(e=>!eD.has(e));function rD(e){const t=[];return tD.forEach(r=>{const a=e.getValue(r);a!==void 0&&(t.push([r,a.get()]),a.set(r.startsWith("scale")?1:0))}),t}const fh={width:({x:e},{paddingLeft:t="0",paddingRight:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),height:({y:e},{paddingTop:t="0",paddingBottom:r="0"})=>e.max-e.min-parseFloat(t)-parseFloat(r),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:(e,{transform:t})=>O2(t,"x"),y:(e,{transform:t})=>O2(t,"y")};fh.translateX=fh.x;fh.translateY=fh.y;const Of=new Set;let R2=!1,M2=!1;function QN(){if(M2){const e=Array.from(Of).filter(a=>a.needsMeasurement),t=new Set(e.map(a=>a.element)),r=new Map;t.forEach(a=>{const n=rD(a);n.length&&(r.set(a,n),a.render())}),e.forEach(a=>a.measureInitialState()),t.forEach(a=>{a.render();const n=r.get(a);n&&n.forEach(([s,o])=>{var c;(c=a.getValue(s))==null||c.set(o)})}),e.forEach(a=>a.measureEndState()),e.forEach(a=>{a.suspendedScrollY!==void 0&&window.scrollTo(0,a.suspendedScrollY)})}M2=!1,R2=!1,Of.forEach(e=>e.complete()),Of.clear()}function eA(){Of.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(M2=!0)})}function aD(){eA(),QN()}class uy{constructor(t,r,a,n,s,o=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...t],this.onComplete=r,this.name=a,this.motionValue=n,this.element=s,this.isAsync=o}scheduleResolve(){this.isScheduled=!0,this.isAsync?(Of.add(this),R2||(R2=!0,Oa.read(eA),Oa.resolveKeyframes(QN))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:r,element:a,motionValue:n}=this;for(let s=0;s<t.length;s++)if(t[s]===null)if(s===0){const o=n==null?void 0:n.get(),c=t[t.length-1];if(o!==void 0)t[0]=o;else if(a&&r){const u=a.readValue(r,c);u!=null&&(t[0]=u)}t[0]===void 0&&(t[0]=c),n&&o===void 0&&n.set(t[0])}else t[s]=t[s-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),Of.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,Of.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const tA=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e),nD=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function sD(e){const t=nD.exec(e);if(!t)return[,];const[,r,a,n]=t;return[`--${r??a}`,n]}function rA(e,t,r=1){const[a,n]=sD(e);if(!a)return;const s=window.getComputedStyle(t).getPropertyValue(a);if(s){const o=s.trim();return tA(o)?parseFloat(o):o}return Kv(n)?rA(n,t,r+1):n}const aA=e=>t=>t.test(e),iD={test:e=>e==="auto",parse:e=>e},nA=[yh,mr,Yl,ju,a7,r7,iD],zb=e=>nA.find(aA(e));class sA extends uy{constructor(t,r,a,n,s){super(t,r,a,n,s,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:r,name:a}=this;if(!r||!r.current)return;super.readKeyframes();for(let u=0;u<t.length;u++){let h=t[u];if(typeof h=="string"&&(h=h.trim(),Kv(h))){const p=rA(h,r.current);p!==void 0&&(t[u]=p),u===t.length-1&&(this.finalKeyframe=h)}}if(this.resolveNoneKeyframes(),!ON.has(a)||t.length!==2)return;const[n,s]=t,o=zb(n),c=zb(s);if(o!==c)if(Ub(o)&&Ub(c))for(let u=0;u<t.length;u++){const h=t[u];typeof h=="string"&&(t[u]=parseFloat(h))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:r}=this,a=[];for(let n=0;n<t.length;n++)F7(t[n])&&a.push(n);a.length&&Y7(t,a,r)}measureInitialState(){const{element:t,unresolvedKeyframes:r,name:a}=this;if(!t||!t.current)return;a==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=fh[a](t.measureViewportBox(),window.getComputedStyle(t.current)),r[0]=this.measuredOrigin;const n=r[r.length-1];n!==void 0&&t.getValue(a,n).jump(n,!1)}measureEndState(){var c;const{element:t,name:r,unresolvedKeyframes:a}=this;if(!t||!t.current)return;const n=t.getValue(r);n&&n.jump(this.measuredOrigin,!1);const s=a.length-1,o=a[s];a[s]=fh[r](t.measureViewportBox(),window.getComputedStyle(t.current)),o!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=o),(c=this.removedTransforms)!=null&&c.length&&this.removedTransforms.forEach(([u,h])=>{t.getValue(u).set(h)}),this.resolveNoneKeyframes()}}const Hb=(e,t)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(Mu.test(e)||e==="0")&&!e.startsWith("url("));function oD(e){const t=e[0];if(e.length===1)return!0;for(let r=0;r<e.length;r++)if(e[r]!==t)return!0}function lD(e,t,r,a){const n=e[0];if(n===null)return!1;if(t==="display"||t==="visibility")return!0;const s=e[e.length-1],o=Hb(n,t),c=Hb(s,t);return!o||!c?!1:oD(e)||(r==="spring"||Hv(r))&&a}const cD=e=>e!==null;function G1(e,{repeat:t,repeatType:r="loop"},a){const n=e.filter(cD),s=t&&r!=="loop"&&t%2===1?0:n.length-1;return!s||a===void 0?n[s]:a}const uD=40;class iA{constructor({autoplay:t=!0,delay:r=0,type:a="keyframes",repeat:n=0,repeatDelay:s=0,repeatType:o="loop",...c}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=Xl.now(),this.options={autoplay:t,delay:r,type:a,repeat:n,repeatDelay:s,repeatType:o,...c},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>uD?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&aD(),this._resolved}onKeyframesResolved(t,r){this.resolvedAt=Xl.now(),this.hasAttemptedResolve=!0;const{name:a,type:n,velocity:s,delay:o,onComplete:c,onUpdate:u,isGenerator:h}=this.options;if(!h&&!lD(t,a,n,s))if(o)this.options.duration=0;else{u&&u(G1(t,this.options,r)),c&&c(),this.resolveFinishedPromise();return}const p=this.initPlayback(t,r);p!==!1&&(this._resolved={keyframes:t,finalKeyframe:r,...p},this.onPostResolved())}onPostResolved(){}then(t,r){return this.currentFinishedPromise.then(t,r)}flatten(){this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear")}updateFinishedPromise(){this.currentFinishedPromise=new Promise(t=>{this.resolveFinishedPromise=t})}}const an=(e,t,r)=>e+(t-e)*r;function Lg(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+(t-e)*6*r:r<1/2?t:r<2/3?e+(t-e)*(2/3-r)*6:e}function fD({hue:e,saturation:t,lightness:r,alpha:a}){e/=360,t/=100,r/=100;let n=0,s=0,o=0;if(!t)n=s=o=r;else{const c=r<.5?r*(1+t):r+t-r*t,u=2*r-c;n=Lg(u,c,e+1/3),s=Lg(u,c,e),o=Lg(u,c,e-1/3)}return{red:Math.round(n*255),green:Math.round(s*255),blue:Math.round(o*255),alpha:a}}function c1(e,t){return r=>r>0?t:e}const Og=(e,t,r)=>{const a=e*e,n=r*(t*t-a)+a;return n<0?0:Math.sqrt(n)},hD=[D2,Df,$0],dD=e=>hD.find(t=>t.test(e));function Vb(e){const t=dD(e);if(!t)return!1;let r=t.parse(e);return t===$0&&(r=fD(r)),r}const qb=(e,t)=>{const r=Vb(e),a=Vb(t);if(!r||!a)return c1(e,t);const n={...r};return s=>(n.red=Og(r.red,a.red,s),n.green=Og(r.green,a.green,s),n.blue=Og(r.blue,a.blue,s),n.alpha=an(r.alpha,a.alpha,s),Df.transform(n))},pD=(e,t)=>r=>t(e(r)),vp=(...e)=>e.reduce(pD),I2=new Set(["none","hidden"]);function mD(e,t){return I2.has(e)?r=>r<=0?e:t:r=>r>=1?t:e}function xD(e,t){return r=>an(e,t,r)}function fy(e){return typeof e=="number"?xD:typeof e=="string"?Kv(e)?c1:qs.test(e)?qb:yD:Array.isArray(e)?oA:typeof e=="object"?qs.test(e)?qb:gD:c1}function oA(e,t){const r=[...e],a=r.length,n=e.map((s,o)=>fy(s)(s,t[o]));return s=>{for(let o=0;o<a;o++)r[o]=n[o](s);return r}}function gD(e,t){const r={...e,...t},a={};for(const n in r)e[n]!==void 0&&t[n]!==void 0&&(a[n]=fy(e[n])(e[n],t[n]));return n=>{for(const s in a)r[s]=a[s](n);return r}}function vD(e,t){const r=[],a={color:0,var:0,number:0};for(let n=0;n<t.values.length;n++){const s=t.types[n],o=e.indexes[s][a[s]],c=e.values[o]??0;r[n]=c,a[s]++}return r}const yD=(e,t)=>{const r=Mu.createTransformer(t),a=Zd(e),n=Zd(t);return a.indexes.var.length===n.indexes.var.length&&a.indexes.color.length===n.indexes.color.length&&a.indexes.number.length>=n.indexes.number.length?I2.has(e)&&!n.values.length||I2.has(t)&&!a.values.length?mD(e,t):vp(oA(vD(a,n),n.values),r):c1(e,t)};function lA(e,t,r){return typeof e=="number"&&typeof t=="number"&&typeof r=="number"?an(e,t,r):fy(e)(e,t)}const wD=5;function cA(e,t,r){const a=Math.max(t-wD,0);return uN(r-e(a),t-a)}const dn={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},Gb=.001;function bD({duration:e=dn.duration,bounce:t=dn.bounce,velocity:r=dn.velocity,mass:a=dn.mass}){let n,s,o=1-t;o=Bc(dn.minDamping,dn.maxDamping,o),e=Bc(dn.minDuration,dn.maxDuration,$l(e)),o<1?(n=h=>{const p=h*o,x=p*e,v=p-r,g=B2(h,o),w=Math.exp(-x);return Gb-v/g*w},s=h=>{const x=h*o*e,v=x*r+r,g=Math.pow(o,2)*Math.pow(h,2)*e,w=Math.exp(-x),b=B2(Math.pow(h,2),o);return(-n(h)+Gb>0?-1:1)*((v-g)*w)/b}):(n=h=>{const p=Math.exp(-h*e),x=(h-r)*e+1;return-.001+p*x},s=h=>{const p=Math.exp(-h*e),x=(r-h)*(e*e);return p*x});const c=5/e,u=ND(n,s,c);if(e=Wl(e),isNaN(u))return{stiffness:dn.stiffness,damping:dn.damping,duration:e};{const h=Math.pow(u,2)*a;return{stiffness:h,damping:o*2*Math.sqrt(a*h),duration:e}}}const SD=12;function ND(e,t,r){let a=r;for(let n=1;n<SD;n++)a=a-e(a)/t(a);return a}function B2(e,t){return e*Math.sqrt(1-t*t)}const AD=["duration","bounce"],_D=["stiffness","damping","mass"];function Wb(e,t){return t.some(r=>e[r]!==void 0)}function TD(e){let t={velocity:dn.velocity,stiffness:dn.stiffness,damping:dn.damping,mass:dn.mass,isResolvedFromDuration:!1,...e};if(!Wb(e,_D)&&Wb(e,AD))if(e.visualDuration){const r=e.visualDuration,a=2*Math.PI/(r*1.2),n=a*a,s=2*Bc(.05,1,1-(e.bounce||0))*Math.sqrt(n);t={...t,mass:dn.mass,stiffness:n,damping:s}}else{const r=bD(e);t={...t,...r,mass:dn.mass},t.isResolvedFromDuration=!0}return t}function u1(e=dn.visualDuration,t=dn.bounce){const r=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:a,restDelta:n}=r;const s=r.keyframes[0],o=r.keyframes[r.keyframes.length-1],c={done:!1,value:s},{stiffness:u,damping:h,mass:p,duration:x,velocity:v,isResolvedFromDuration:g}=TD({...r,velocity:-$l(r.velocity||0)}),w=v||0,b=h/(2*Math.sqrt(u*p)),N=o-s,_=$l(Math.sqrt(u/p)),E=Math.abs(N)<5;a||(a=E?dn.restSpeed.granular:dn.restSpeed.default),n||(n=E?dn.restDelta.granular:dn.restDelta.default);let j;if(b<1){const U=B2(_,b);j=V=>{const I=Math.exp(-b*_*V);return o-I*((w+b*_*N)/U*Math.sin(U*V)+N*Math.cos(U*V))}}else if(b===1)j=U=>o-Math.exp(-_*U)*(N+(w+_*N)*U);else{const U=_*Math.sqrt(b*b-1);j=V=>{const I=Math.exp(-b*_*V),z=Math.min(U*V,300);return o-I*((w+b*_*N)*Math.sinh(z)+U*N*Math.cosh(z))/U}}const M={calculatedDuration:g&&x||null,next:U=>{const V=j(U);if(g)c.done=U>=x;else{let I=0;b<1&&(I=U===0?Wl(w):cA(j,U,V));const z=Math.abs(I)<=a,H=Math.abs(o-V)<=n;c.done=z&&H}return c.value=c.done?o:V,c},toString:()=>{const U=Math.min(qv(M),o1),V=fN(I=>M.next(U*I).value,U,30);return U+"ms "+V},toTransition:()=>{}};return M}u1.applyToOptions=e=>{const t=AC(e,100,u1);return e.ease=Wd()?t.ease:"easeOut",e.duration=Wl(t.duration),e.type="keyframes",e};function $b({keyframes:e,velocity:t=0,power:r=.8,timeConstant:a=325,bounceDamping:n=10,bounceStiffness:s=500,modifyTarget:o,min:c,max:u,restDelta:h=.5,restSpeed:p}){const x=e[0],v={done:!1,value:x},g=z=>c!==void 0&&z<c||u!==void 0&&z>u,w=z=>c===void 0?u:u===void 0||Math.abs(c-z)<Math.abs(u-z)?c:u;let b=r*t;const N=x+b,_=o===void 0?N:o(N);_!==N&&(b=_-x);const E=z=>-b*Math.exp(-z/a),j=z=>_+E(z),M=z=>{const H=E(z),re=j(z);v.done=Math.abs(H)<=h,v.value=v.done?_:re};let U,V;const I=z=>{g(v.value)&&(U=z,V=u1({keyframes:[v.value,w(v.value)],velocity:cA(j,z,v.value),damping:n,stiffness:s,restDelta:h,restSpeed:p}))};return I(0),{calculatedDuration:null,next:z=>{let H=!1;return!V&&U===void 0&&(H=!0,M(z),I(z)),U!==void 0&&z>=U?V.next(z-U):(!H&&M(z),v)}}}const kD=gp(.42,0,1,1),ED=gp(0,0,.58,1),uA=gp(.42,0,.58,1),jD=e=>Array.isArray(e)&&typeof e[0]!="number",CD={linear:Eo,easeIn:kD,easeInOut:uA,easeOut:ED,circIn:oy,circInOut:qN,circOut:VN,backIn:iy,backInOut:zN,backOut:UN,anticipate:HN},Xb=e=>{if(zv(e)){cN(e.length===4);const[t,r,a,n]=e;return gp(t,r,a,n)}else if(typeof e=="string")return CD[e];return e};function DD(e,t,r){const a=[],n=r||lA,s=e.length-1;for(let o=0;o<s;o++){let c=n(e[o],e[o+1]);if(t){const u=Array.isArray(t)?t[o]||Eo:t;c=vp(u,c)}a.push(c)}return a}function FD(e,t,{clamp:r=!0,ease:a,mixer:n}={}){const s=e.length;if(cN(s===t.length),s===1)return()=>t[0];if(s===2&&t[0]===t[1])return()=>t[1];const o=e[0]===e[1];e[0]>e[s-1]&&(e=[...e].reverse(),t=[...t].reverse());const c=DD(t,a,n),u=c.length,h=p=>{if(o&&p<e[0])return t[0];let x=0;if(u>1)for(;x<e.length-2&&!(p<e[x+1]);x++);const v=Gd(e[x],e[x+1],p);return c[x](v)};return r?p=>h(Bc(e[0],e[s-1],p)):h}function PD(e,t){const r=e[e.length-1];for(let a=1;a<=t;a++){const n=Gd(0,t,a);e.push(an(r,1,n))}}function LD(e){const t=[0];return PD(t,e.length-1),t}function OD(e,t){return e.map(r=>r*t)}function RD(e,t){return e.map(()=>t||uA).splice(0,e.length-1)}function f1({duration:e=300,keyframes:t,times:r,ease:a="easeInOut"}){const n=jD(a)?a.map(Xb):Xb(a),s={done:!1,value:t[0]},o=OD(r&&r.length===t.length?r:LD(t),e),c=FD(o,t,{ease:Array.isArray(n)?n:RD(t,n)});return{calculatedDuration:e,next:u=>(s.value=c(u),s.done=u>=e,s)}}const MD=e=>{const t=({timestamp:r})=>e(r);return{start:()=>Oa.update(t,!0),stop:()=>Ru(t),now:()=>bs.isProcessing?bs.timestamp:Xl.now()}},ID={decay:$b,inertia:$b,tween:f1,keyframes:f1,spring:u1},BD=e=>e/100;class hy extends iA{constructor(t){super(t),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:u}=this.options;u&&u()};const{name:r,motionValue:a,element:n,keyframes:s}=this.options,o=(n==null?void 0:n.KeyframeResolver)||uy,c=(u,h)=>this.onKeyframesResolved(u,h);this.resolver=new o(s,c,r,a,n),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(t){const{type:r="keyframes",repeat:a=0,repeatDelay:n=0,repeatType:s,velocity:o=0}=this.options,c=Hv(r)?r:ID[r]||f1;let u,h;c!==f1&&typeof t[0]!="number"&&(u=vp(BD,lA(t[0],t[1])),t=[0,100]);const p=c({...this.options,keyframes:t});s==="mirror"&&(h=c({...this.options,keyframes:[...t].reverse(),velocity:-o})),p.calculatedDuration===null&&(p.calculatedDuration=qv(p));const{calculatedDuration:x}=p,v=x+n,g=v*(a+1)-n;return{generator:p,mirroredGenerator:h,mapPercentToKeyframes:u,calculatedDuration:x,resolvedDuration:v,totalDuration:g}}onPostResolved(){const{autoplay:t=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!t?this.pause():this.state=this.pendingPlayState}tick(t,r=!1){const{resolved:a}=this;if(!a){const{keyframes:z}=this.options;return{done:!0,value:z[z.length-1]}}const{finalKeyframe:n,generator:s,mirroredGenerator:o,mapPercentToKeyframes:c,keyframes:u,calculatedDuration:h,totalDuration:p,resolvedDuration:x}=a;if(this.startTime===null)return s.next(0);const{delay:v,repeat:g,repeatType:w,repeatDelay:b,onUpdate:N}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-p/this.speed,this.startTime)),r?this.currentTime=t:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(t-this.startTime)*this.speed;const _=this.currentTime-v*(this.speed>=0?1:-1),E=this.speed>=0?_<0:_>p;this.currentTime=Math.max(_,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=p);let j=this.currentTime,M=s;if(g){const z=Math.min(this.currentTime,p)/x;let H=Math.floor(z),re=z%1;!re&&z>=1&&(re=1),re===1&&H--,H=Math.min(H,g+1),!!(H%2)&&(w==="reverse"?(re=1-re,b&&(re-=b/x)):w==="mirror"&&(M=o)),j=Bc(0,1,re)*x}const U=E?{done:!1,value:u[0]}:M.next(j);c&&(U.value=c(U.value));let{done:V}=U;!E&&h!==null&&(V=this.speed>=0?this.currentTime>=p:this.currentTime<=0);const I=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&V);return I&&n!==void 0&&(U.value=G1(u,this.options,n)),N&&N(U.value),I&&this.finish(),U}get duration(){const{resolved:t}=this;return t?$l(t.calculatedDuration):0}get time(){return $l(this.currentTime)}set time(t){t=Wl(t),this.currentTime=t,this.holdTime!==null||this.speed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.speed)}get speed(){return this.playbackSpeed}set speed(t){const r=this.playbackSpeed!==t;this.playbackSpeed=t,r&&(this.time=$l(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:t=MD,onPlay:r,startTime:a}=this.options;this.driver||(this.driver=t(s=>this.tick(s))),r&&r();const n=this.driver.now();this.holdTime!==null?this.startTime=n-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=n):this.startTime=a??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=this.currentTime??0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:t}=this.options;t&&t()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}get finished(){return this.currentFinishedPromise}}const UD=new Set(["opacity","clipPath","filter","transform"]),zD=Bv(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),h1=10,HD=2e4;function VD(e){return Hv(e.type)||e.type==="spring"||!dN(e.ease)}function qD(e,t){const r=new hy({...t,keyframes:e,repeat:0,delay:0,isGenerator:!0});let a={done:!1,value:e[0]};const n=[];let s=0;for(;!a.done&&s<HD;)a=r.sample(s),n.push(a.value),s+=h1;return{times:void 0,keyframes:n,duration:s-h1,ease:"linear"}}const fA={anticipate:HN,backInOut:zN,circInOut:qN};function GD(e){return e in fA}class Yb extends iA{constructor(t){super(t);const{name:r,motionValue:a,element:n,keyframes:s}=this.options;this.resolver=new sA(s,(o,c)=>this.onKeyframesResolved(o,c),r,a,n),this.resolver.scheduleResolve()}initPlayback(t,r){let{duration:a=300,times:n,ease:s,type:o,motionValue:c,name:u,startTime:h}=this.options;if(!c.owner||!c.owner.current)return!1;if(typeof s=="string"&&Wd()&&GD(s)&&(s=fA[s]),VD(this.options)){const{onComplete:x,onUpdate:v,motionValue:g,element:w,...b}=this.options,N=qD(t,b);t=N.keyframes,t.length===1&&(t[1]=t[0]),a=N.duration,n=N.times,s=N.ease,o="keyframes"}const p=NC(c.owner.current,u,t,{...this.options,duration:a,times:n,ease:s});return p.startTime=h??this.calcStartTime(),this.pendingTimeline?(Nb(p,this.pendingTimeline),this.pendingTimeline=void 0):p.onfinish=()=>{const{onComplete:x}=this.options;c.set(G1(t,this.options,r)),x&&x(),this.cancel(),this.resolveFinishedPromise()},{animation:p,duration:a,times:n,type:o,ease:s,keyframes:t}}get duration(){const{resolved:t}=this;if(!t)return 0;const{duration:r}=t;return $l(r)}get time(){const{resolved:t}=this;if(!t)return 0;const{animation:r}=t;return $l(r.currentTime||0)}set time(t){const{resolved:r}=this;if(!r)return;const{animation:a}=r;a.currentTime=Wl(t)}get speed(){const{resolved:t}=this;if(!t)return 1;const{animation:r}=t;return r.playbackRate}get finished(){return this.resolved.animation.finished}set speed(t){const{resolved:r}=this;if(!r)return;const{animation:a}=r;a.playbackRate=t}get state(){const{resolved:t}=this;if(!t)return"idle";const{animation:r}=t;return r.playState}get startTime(){const{resolved:t}=this;if(!t)return null;const{animation:r}=t;return r.startTime}attachTimeline(t){if(!this._resolved)this.pendingTimeline=t;else{const{resolved:r}=this;if(!r)return Eo;const{animation:a}=r;Nb(a,t)}return Eo}play(){if(this.isStopped)return;const{resolved:t}=this;if(!t)return;const{animation:r}=t;r.playState==="finished"&&this.updateFinishedPromise(),r.play()}pause(){const{resolved:t}=this;if(!t)return;const{animation:r}=t;r.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:t}=this;if(!t)return;const{animation:r,keyframes:a,duration:n,type:s,ease:o,times:c}=t;if(r.playState==="idle"||r.playState==="finished")return;if(this.time){const{motionValue:h,onUpdate:p,onComplete:x,element:v,...g}=this.options,w=new hy({...g,keyframes:a,duration:n,type:s,ease:o,times:c,isGenerator:!0}),b=Wl(this.time);h.setWithVelocity(w.sample(b-h1).value,w.sample(b).value,h1)}const{onStop:u}=this.options;u&&u(),this.cancel()}complete(){const{resolved:t}=this;t&&t.animation.finish()}cancel(){const{resolved:t}=this;t&&t.animation.cancel()}static supports(t){const{motionValue:r,name:a,repeatDelay:n,repeatType:s,damping:o,type:c}=t;if(!r||!r.owner||!(r.owner.current instanceof HTMLElement))return!1;const{onUpdate:u,transformTemplate:h}=r.owner.getProps();return zD()&&a&&UD.has(a)&&(a!=="transform"||!h)&&!u&&!n&&s!=="mirror"&&o!==0&&c!=="inertia"}}const WD={type:"spring",stiffness:500,damping:25,restSpeed:10},$D=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),XD={type:"keyframes",duration:.8},YD={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},JD=(e,{keyframes:t})=>t.length>2?XD:Qf.has(e)?e.startsWith("scale")?$D(t[1]):WD:YD;function KD({when:e,delay:t,delayChildren:r,staggerChildren:a,staggerDirection:n,repeat:s,repeatType:o,repeatDelay:c,from:u,elapsed:h,...p}){return!!Object.keys(p).length}const dy=(e,t,r,a={},n,s)=>o=>{const c=Vv(a,e)||{},u=c.delay||a.delay||0;let{elapsed:h=0}=a;h=h-Wl(u);let p={keyframes:Array.isArray(r)?r:[null,r],ease:"easeOut",velocity:t.getVelocity(),...c,delay:-h,onUpdate:v=>{t.set(v),c.onUpdate&&c.onUpdate(v)},onComplete:()=>{o(),c.onComplete&&c.onComplete()},name:e,motionValue:t,element:s?void 0:n};KD(c)||(p={...p,...JD(e,p)}),p.duration&&(p.duration=Wl(p.duration)),p.repeatDelay&&(p.repeatDelay=Wl(p.repeatDelay)),p.from!==void 0&&(p.keyframes[0]=p.from);let x=!1;if((p.type===!1||p.duration===0&&!p.repeatDelay)&&(p.duration=0,p.delay===0&&(x=!0)),p.allowFlatten=!c.type&&!c.ease,x&&!s&&t.get()!==void 0){const v=G1(p.keyframes,c);if(v!==void 0)return Oa.update(()=>{p.onUpdate(v),p.onComplete()}),new wC([])}return!s&&Yb.supports(p)?new Yb(p):new hy(p)};function ZD({protectedKeys:e,needsAnimating:t},r){const a=e.hasOwnProperty(r)&&t[r]!==!0;return t[r]=!1,a}function hA(e,t,{delay:r=0,transitionOverride:a,type:n}={}){let{transition:s=e.getDefaultTransition(),transitionEnd:o,...c}=t;a&&(s=a);const u=[],h=n&&e.animationState&&e.animationState.getState()[n];for(const p in c){const x=e.getValue(p,e.latestValues[p]??null),v=c[p];if(v===void 0||h&&ZD(h,p))continue;const g={delay:r,...Vv(s||{},p)};let w=!1;if(window.MotionHandoffAnimation){const N=RN(e);if(N){const _=window.MotionHandoffAnimation(N,p,Oa);_!==null&&(g.startTime=_,w=!0)}}C2(e,p),x.start(dy(p,x,v,e.shouldReduceMotion&&ON.has(p)?{type:!1}:g,e,w));const b=x.animation;b&&u.push(b)}return o&&Promise.all(u).then(()=>{Oa.update(()=>{o&&k7(e,o)})}),u}function U2(e,t,r={}){var u;const a=Kd(e,t,r.type==="exit"?(u=e.presenceContext)==null?void 0:u.custom:void 0);let{transition:n=e.getDefaultTransition()||{}}=a||{};r.transitionOverride&&(n=r.transitionOverride);const s=a?()=>Promise.all(hA(e,a,r)):()=>Promise.resolve(),o=e.variantChildren&&e.variantChildren.size?(h=0)=>{const{delayChildren:p=0,staggerChildren:x,staggerDirection:v}=n;return QD(e,t,p+h,x,v,r)}:()=>Promise.resolve(),{when:c}=n;if(c){const[h,p]=c==="beforeChildren"?[s,o]:[o,s];return h().then(()=>p())}else return Promise.all([s(),o(r.delay)])}function QD(e,t,r=0,a=0,n=1,s){const o=[],c=(e.variantChildren.size-1)*a,u=n===1?(h=0)=>h*a:(h=0)=>c-h*a;return Array.from(e.variantChildren).sort(eF).forEach((h,p)=>{h.notify("AnimationStart",t),o.push(U2(h,t,{...s,delay:r+u(p)}).then(()=>h.notify("AnimationComplete",t)))}),Promise.all(o)}function eF(e,t){return e.sortNodePosition(t)}function tF(e,t,r={}){e.notify("AnimationStart",t);let a;if(Array.isArray(t)){const n=t.map(s=>U2(e,s,r));a=Promise.all(n)}else if(typeof t=="string")a=U2(e,t,r);else{const n=typeof t=="function"?Kd(e,t,r.custom):t;a=Promise.all(hA(e,n,r))}return a.then(()=>{e.notify("AnimationComplete",t)})}function dA(e,t){if(!Array.isArray(t))return!1;const r=t.length;if(r!==e.length)return!1;for(let a=0;a<r;a++)if(t[a]!==e[a])return!1;return!0}const rF=Xv.length;function pA(e){if(!e)return;if(!e.isControllingVariants){const r=e.parent?pA(e.parent)||{}:{};return e.props.initial!==void 0&&(r.initial=e.props.initial),r}const t={};for(let r=0;r<rF;r++){const a=Xv[r],n=e.props[a];(Xd(n)||n===!1)&&(t[a]=n)}return t}const aF=[...$v].reverse(),nF=$v.length;function sF(e){return t=>Promise.all(t.map(({animation:r,options:a})=>tF(e,r,a)))}function iF(e){let t=sF(e),r=Jb(),a=!0;const n=u=>(h,p)=>{var v;const x=Kd(e,p,u==="exit"?(v=e.presenceContext)==null?void 0:v.custom:void 0);if(x){const{transition:g,transitionEnd:w,...b}=x;h={...h,...b,...w}}return h};function s(u){t=u(e)}function o(u){const{props:h}=e,p=pA(e.parent)||{},x=[],v=new Set;let g={},w=1/0;for(let N=0;N<nF;N++){const _=aF[N],E=r[_],j=h[_]!==void 0?h[_]:p[_],M=Xd(j),U=_===u?E.isActive:null;U===!1&&(w=N);let V=j===p[_]&&j!==h[_]&&M;if(V&&a&&e.manuallyAnimateOnMount&&(V=!1),E.protectedKeys={...g},!E.isActive&&U===null||!j&&!E.prevProp||V1(j)||typeof j=="boolean")continue;const I=oF(E.prevProp,j);let z=I||_===u&&E.isActive&&!V&&M||N>w&&M,H=!1;const re=Array.isArray(j)?j:[j];let R=re.reduce(n(_),{});U===!1&&(R={});const{prevResolvedValues:F={}}=E,Y={...F,...R},K=ce=>{z=!0,v.has(ce)&&(H=!0,v.delete(ce)),E.needsAnimating[ce]=!0;const te=e.getValue(ce);te&&(te.liveStyle=!1)};for(const ce in Y){const te=R[ce],Q=F[ce];if(g.hasOwnProperty(ce))continue;let G=!1;j2(te)&&j2(Q)?G=!dA(te,Q):G=te!==Q,G?te!=null?K(ce):v.add(ce):te!==void 0&&v.has(ce)?K(ce):E.protectedKeys[ce]=!0}E.prevProp=j,E.prevResolvedValues=R,E.isActive&&(g={...g,...R}),a&&e.blockInitialAnimation&&(z=!1),z&&(!(V&&I)||H)&&x.push(...re.map(ce=>({animation:ce,options:{type:_}})))}if(v.size){const N={};if(typeof h.initial!="boolean"){const _=Kd(e,Array.isArray(h.initial)?h.initial[0]:h.initial);_&&_.transition&&(N.transition=_.transition)}v.forEach(_=>{const E=e.getBaseTarget(_),j=e.getValue(_);j&&(j.liveStyle=!0),N[_]=E??null}),x.push({animation:N})}let b=!!x.length;return a&&(h.initial===!1||h.initial===h.animate)&&!e.manuallyAnimateOnMount&&(b=!1),a=!1,b?t(x):Promise.resolve()}function c(u,h){var x;if(r[u].isActive===h)return Promise.resolve();(x=e.variantChildren)==null||x.forEach(v=>{var g;return(g=v.animationState)==null?void 0:g.setActive(u,h)}),r[u].isActive=h;const p=o(u);for(const v in r)r[v].protectedKeys={};return p}return{animateChanges:o,setActive:c,setAnimateFunction:s,getState:()=>r,reset:()=>{r=Jb(),a=!0}}}function oF(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!dA(t,e):!1}function Af(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function Jb(){return{animate:Af(!0),whileInView:Af(),whileHover:Af(),whileTap:Af(),whileDrag:Af(),whileFocus:Af(),exit:Af()}}class qu{constructor(t){this.isMounted=!1,this.node=t}update(){}}class lF extends qu{constructor(t){super(t),t.animationState||(t.animationState=iF(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();V1(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:r}=this.node.prevProps||{};t!==r&&this.updateAnimationControlsSubscription()}unmount(){var t;this.node.animationState.reset(),(t=this.unmountControls)==null||t.call(this)}}let cF=0;class uF extends qu{constructor(){super(...arguments),this.id=cF++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:r}=this.node.presenceContext,{isPresent:a}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===a)return;const n=this.node.animationState.setActive("exit",!t);r&&!t&&n.then(()=>{r(this.id)})}mount(){const{register:t,onExitComplete:r}=this.node.presenceContext||{};r&&r(this.id),t&&(this.unmount=t(this.id))}unmount(){}}const fF={animation:{Feature:lF},exit:{Feature:uF}};function Qd(e,t,r,a={passive:!0}){return e.addEventListener(t,r,a),()=>e.removeEventListener(t,r)}function yp(e){return{point:{x:e.pageX,y:e.pageY}}}const hF=e=>t=>Wv(t)&&e(t,yp(t));function Td(e,t,r,a){return Qd(e,t,hF(r),a)}function mA({top:e,left:t,right:r,bottom:a}){return{x:{min:t,max:r},y:{min:e,max:a}}}function dF({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function pF(e,t){if(!t)return e;const r=t({x:e.left,y:e.top}),a=t({x:e.right,y:e.bottom});return{top:r.y,left:r.x,bottom:a.y,right:a.x}}const xA=1e-4,mF=1-xA,xF=1+xA,gA=.01,gF=0-gA,vF=0+gA;function pi(e){return e.max-e.min}function yF(e,t,r){return Math.abs(e-t)<=r}function Kb(e,t,r,a=.5){e.origin=a,e.originPoint=an(t.min,t.max,e.origin),e.scale=pi(r)/pi(t),e.translate=an(r.min,r.max,e.origin)-e.originPoint,(e.scale>=mF&&e.scale<=xF||isNaN(e.scale))&&(e.scale=1),(e.translate>=gF&&e.translate<=vF||isNaN(e.translate))&&(e.translate=0)}function kd(e,t,r,a){Kb(e.x,t.x,r.x,a?a.originX:void 0),Kb(e.y,t.y,r.y,a?a.originY:void 0)}function Zb(e,t,r){e.min=r.min+t.min,e.max=e.min+pi(t)}function wF(e,t,r){Zb(e.x,t.x,r.x),Zb(e.y,t.y,r.y)}function Qb(e,t,r){e.min=t.min-r.min,e.max=e.min+pi(t)}function Ed(e,t,r){Qb(e.x,t.x,r.x),Qb(e.y,t.y,r.y)}const e4=()=>({translate:0,scale:1,origin:0,originPoint:0}),X0=()=>({x:e4(),y:e4()}),t4=()=>({min:0,max:0}),_n=()=>({x:t4(),y:t4()});function Ao(e){return[e("x"),e("y")]}function Rg(e){return e===void 0||e===1}function z2({scale:e,scaleX:t,scaleY:r}){return!Rg(e)||!Rg(t)||!Rg(r)}function Tf(e){return z2(e)||vA(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function vA(e){return r4(e.x)||r4(e.y)}function r4(e){return e&&e!=="0%"}function d1(e,t,r){const a=e-r,n=t*a;return r+n}function a4(e,t,r,a,n){return n!==void 0&&(e=d1(e,n,a)),d1(e,r,a)+t}function H2(e,t=0,r=1,a,n){e.min=a4(e.min,t,r,a,n),e.max=a4(e.max,t,r,a,n)}function yA(e,{x:t,y:r}){H2(e.x,t.translate,t.scale,t.originPoint),H2(e.y,r.translate,r.scale,r.originPoint)}const n4=.999999999999,s4=1.0000000000001;function bF(e,t,r,a=!1){const n=r.length;if(!n)return;t.x=t.y=1;let s,o;for(let c=0;c<n;c++){s=r[c],o=s.projectionDelta;const{visualElement:u}=s.options;u&&u.props.style&&u.props.style.display==="contents"||(a&&s.options.layoutScroll&&s.scroll&&s!==s.root&&J0(e,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),o&&(t.x*=o.x.scale,t.y*=o.y.scale,yA(e,o)),a&&Tf(s.latestValues)&&J0(e,s.latestValues))}t.x<s4&&t.x>n4&&(t.x=1),t.y<s4&&t.y>n4&&(t.y=1)}function Y0(e,t){e.min=e.min+t,e.max=e.max+t}function i4(e,t,r,a,n=.5){const s=an(e.min,e.max,n);H2(e,t,r,s,a)}function J0(e,t){i4(e.x,t.x,t.scaleX,t.scale,t.originX),i4(e.y,t.y,t.scaleY,t.scale,t.originY)}function wA(e,t){return mA(pF(e.getBoundingClientRect(),t))}function SF(e,t,r){const a=wA(e,r),{scroll:n}=t;return n&&(Y0(a.x,n.offset.x),Y0(a.y,n.offset.y)),a}const bA=({current:e})=>e?e.ownerDocument.defaultView:null,o4=(e,t)=>Math.abs(e-t);function NF(e,t){const r=o4(e.x,t.x),a=o4(e.y,t.y);return Math.sqrt(r**2+a**2)}class SA{constructor(t,r,{transformPagePoint:a,contextWindow:n,dragSnapToOrigin:s=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const x=Ig(this.lastMoveEventInfo,this.history),v=this.startEvent!==null,g=NF(x.offset,{x:0,y:0})>=3;if(!v&&!g)return;const{point:w}=x,{timestamp:b}=bs;this.history.push({...w,timestamp:b});const{onStart:N,onMove:_}=this.handlers;v||(N&&N(this.lastMoveEvent,x),this.startEvent=this.lastMoveEvent),_&&_(this.lastMoveEvent,x)},this.handlePointerMove=(x,v)=>{this.lastMoveEvent=x,this.lastMoveEventInfo=Mg(v,this.transformPagePoint),Oa.update(this.updatePoint,!0)},this.handlePointerUp=(x,v)=>{this.end();const{onEnd:g,onSessionEnd:w,resumeAnimation:b}=this.handlers;if(this.dragSnapToOrigin&&b&&b(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const N=Ig(x.type==="pointercancel"?this.lastMoveEventInfo:Mg(v,this.transformPagePoint),this.history);this.startEvent&&g&&g(x,N),w&&w(x,N)},!Wv(t))return;this.dragSnapToOrigin=s,this.handlers=r,this.transformPagePoint=a,this.contextWindow=n||window;const o=yp(t),c=Mg(o,this.transformPagePoint),{point:u}=c,{timestamp:h}=bs;this.history=[{...u,timestamp:h}];const{onSessionStart:p}=r;p&&p(t,Ig(c,this.history)),this.removeListeners=vp(Td(this.contextWindow,"pointermove",this.handlePointerMove),Td(this.contextWindow,"pointerup",this.handlePointerUp),Td(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),Ru(this.updatePoint)}}function Mg(e,t){return t?{point:t(e.point)}:e}function l4(e,t){return{x:e.x-t.x,y:e.y-t.y}}function Ig({point:e},t){return{point:e,delta:l4(e,NA(t)),offset:l4(e,AF(t)),velocity:_F(t,.1)}}function AF(e){return e[0]}function NA(e){return e[e.length-1]}function _F(e,t){if(e.length<2)return{x:0,y:0};let r=e.length-1,a=null;const n=NA(e);for(;r>=0&&(a=e[r],!(n.timestamp-a.timestamp>Wl(t)));)r--;if(!a)return{x:0,y:0};const s=$l(n.timestamp-a.timestamp);if(s===0)return{x:0,y:0};const o={x:(n.x-a.x)/s,y:(n.y-a.y)/s};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function TF(e,{min:t,max:r},a){return t!==void 0&&e<t?e=a?an(t,e,a.min):Math.max(e,t):r!==void 0&&e>r&&(e=a?an(r,e,a.max):Math.min(e,r)),e}function c4(e,t,r){return{min:t!==void 0?e.min+t:void 0,max:r!==void 0?e.max+r-(e.max-e.min):void 0}}function kF(e,{top:t,left:r,bottom:a,right:n}){return{x:c4(e.x,r,n),y:c4(e.y,t,a)}}function u4(e,t){let r=t.min-e.min,a=t.max-e.max;return t.max-t.min<e.max-e.min&&([r,a]=[a,r]),{min:r,max:a}}function EF(e,t){return{x:u4(e.x,t.x),y:u4(e.y,t.y)}}function jF(e,t){let r=.5;const a=pi(e),n=pi(t);return n>a?r=Gd(t.min,t.max-a,e.min):a>n&&(r=Gd(e.min,e.max-n,t.min)),Bc(0,1,r)}function CF(e,t){const r={};return t.min!==void 0&&(r.min=t.min-e.min),t.max!==void 0&&(r.max=t.max-e.min),r}const V2=.35;function DF(e=V2){return e===!1?e=0:e===!0&&(e=V2),{x:f4(e,"left","right"),y:f4(e,"top","bottom")}}function f4(e,t,r){return{min:h4(e,t),max:h4(e,r)}}function h4(e,t){return typeof e=="number"?e:e[t]||0}const FF=new WeakMap;class PF{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=_n(),this.visualElement=t}start(t,{snapToCursor:r=!1}={}){const{presenceContext:a}=this.visualElement;if(a&&a.isPresent===!1)return;const n=p=>{const{dragSnapToOrigin:x}=this.getProps();x?this.pauseAnimation():this.stopAnimation(),r&&this.snapToCursor(yp(p).point)},s=(p,x)=>{const{drag:v,dragPropagation:g,onDragStart:w}=this.getProps();if(v&&!g&&(this.openDragLock&&this.openDragLock(),this.openDragLock=EC(v),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Ao(N=>{let _=this.getAxisMotionValue(N).get()||0;if(Yl.test(_)){const{projection:E}=this.visualElement;if(E&&E.layout){const j=E.layout.layoutBox[N];j&&(_=pi(j)*(parseFloat(_)/100))}}this.originPoint[N]=_}),w&&Oa.postRender(()=>w(p,x)),C2(this.visualElement,"transform");const{animationState:b}=this.visualElement;b&&b.setActive("whileDrag",!0)},o=(p,x)=>{const{dragPropagation:v,dragDirectionLock:g,onDirectionLock:w,onDrag:b}=this.getProps();if(!v&&!this.openDragLock)return;const{offset:N}=x;if(g&&this.currentDirection===null){this.currentDirection=LF(N),this.currentDirection!==null&&w&&w(this.currentDirection);return}this.updateAxis("x",x.point,N),this.updateAxis("y",x.point,N),this.visualElement.render(),b&&b(p,x)},c=(p,x)=>this.stop(p,x),u=()=>Ao(p=>{var x;return this.getAnimationState(p)==="paused"&&((x=this.getAxisMotionValue(p).animation)==null?void 0:x.play())}),{dragSnapToOrigin:h}=this.getProps();this.panSession=new SA(t,{onSessionStart:n,onStart:s,onMove:o,onSessionEnd:c,resumeAnimation:u},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:h,contextWindow:bA(this.visualElement)})}stop(t,r){const a=this.isDragging;if(this.cancel(),!a)return;const{velocity:n}=r;this.startAnimation(n);const{onDragEnd:s}=this.getProps();s&&Oa.postRender(()=>s(t,r))}cancel(){this.isDragging=!1;const{projection:t,animationState:r}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:a}=this.getProps();!a&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),r&&r.setActive("whileDrag",!1)}updateAxis(t,r,a){const{drag:n}=this.getProps();if(!a||!Tm(t,n,this.currentDirection))return;const s=this.getAxisMotionValue(t);let o=this.originPoint[t]+a[t];this.constraints&&this.constraints[t]&&(o=TF(o,this.constraints[t],this.elastic[t])),s.set(o)}resolveConstraints(){var s;const{dragConstraints:t,dragElastic:r}=this.getProps(),a=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(s=this.visualElement.projection)==null?void 0:s.layout,n=this.constraints;t&&W0(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&a?this.constraints=kF(a.layoutBox,t):this.constraints=!1,this.elastic=DF(r),n!==this.constraints&&a&&this.constraints&&!this.hasMutatedConstraints&&Ao(o=>{this.constraints!==!1&&this.getAxisMotionValue(o)&&(this.constraints[o]=CF(a.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:r}=this.getProps();if(!t||!W0(t))return!1;const a=t.current,{projection:n}=this.visualElement;if(!n||!n.layout)return!1;const s=SF(a,n.root,this.visualElement.getTransformPagePoint());let o=EF(n.layout.layoutBox,s);if(r){const c=r(dF(o));this.hasMutatedConstraints=!!c,c&&(o=mA(c))}return o}startAnimation(t){const{drag:r,dragMomentum:a,dragElastic:n,dragTransition:s,dragSnapToOrigin:o,onDragTransitionEnd:c}=this.getProps(),u=this.constraints||{},h=Ao(p=>{if(!Tm(p,r,this.currentDirection))return;let x=u&&u[p]||{};o&&(x={min:0,max:0});const v=n?200:1e6,g=n?40:1e7,w={type:"inertia",velocity:a?t[p]:0,bounceStiffness:v,bounceDamping:g,timeConstant:750,restDelta:1,restSpeed:10,...s,...x};return this.startAxisValueAnimation(p,w)});return Promise.all(h).then(c)}startAxisValueAnimation(t,r){const a=this.getAxisMotionValue(t);return C2(this.visualElement,t),a.start(dy(t,a,0,r,this.visualElement,!1))}stopAnimation(){Ao(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){Ao(t=>{var r;return(r=this.getAxisMotionValue(t).animation)==null?void 0:r.pause()})}getAnimationState(t){var r;return(r=this.getAxisMotionValue(t).animation)==null?void 0:r.state}getAxisMotionValue(t){const r=`_drag${t.toUpperCase()}`,a=this.visualElement.getProps(),n=a[r];return n||this.visualElement.getValue(t,(a.initial?a.initial[t]:void 0)||0)}snapToCursor(t){Ao(r=>{const{drag:a}=this.getProps();if(!Tm(r,a,this.currentDirection))return;const{projection:n}=this.visualElement,s=this.getAxisMotionValue(r);if(n&&n.layout){const{min:o,max:c}=n.layout.layoutBox[r];s.set(t[r]-an(o,c,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:r}=this.getProps(),{projection:a}=this.visualElement;if(!W0(r)||!a||!this.constraints)return;this.stopAnimation();const n={x:0,y:0};Ao(o=>{const c=this.getAxisMotionValue(o);if(c&&this.constraints!==!1){const u=c.get();n[o]=jF({min:u,max:u},this.constraints[o])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",a.root&&a.root.updateScroll(),a.updateLayout(),this.resolveConstraints(),Ao(o=>{if(!Tm(o,t,null))return;const c=this.getAxisMotionValue(o),{min:u,max:h}=this.constraints[o];c.set(an(u,h,n[o]))})}addListeners(){if(!this.visualElement.current)return;FF.set(this.visualElement,this);const t=this.visualElement.current,r=Td(t,"pointerdown",u=>{const{drag:h,dragListener:p=!0}=this.getProps();h&&p&&this.start(u)}),a=()=>{const{dragConstraints:u}=this.getProps();W0(u)&&u.current&&(this.constraints=this.resolveRefConstraints())},{projection:n}=this.visualElement,s=n.addEventListener("measure",a);n&&!n.layout&&(n.root&&n.root.updateScroll(),n.updateLayout()),Oa.read(a);const o=Qd(window,"resize",()=>this.scalePositionWithinConstraints()),c=n.addEventListener("didUpdate",({delta:u,hasLayoutChanged:h})=>{this.isDragging&&h&&(Ao(p=>{const x=this.getAxisMotionValue(p);x&&(this.originPoint[p]+=u[p].translate,x.set(x.get()+u[p].translate))}),this.visualElement.render())});return()=>{o(),r(),s(),c&&c()}}getProps(){const t=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:a=!1,dragPropagation:n=!1,dragConstraints:s=!1,dragElastic:o=V2,dragMomentum:c=!0}=t;return{...t,drag:r,dragDirectionLock:a,dragPropagation:n,dragConstraints:s,dragElastic:o,dragMomentum:c}}}function Tm(e,t,r){return(t===!0||t===e)&&(r===null||r===e)}function LF(e,t=10){let r=null;return Math.abs(e.y)>t?r="y":Math.abs(e.x)>t&&(r="x"),r}class OF extends qu{constructor(t){super(t),this.removeGroupControls=Eo,this.removeListeners=Eo,this.controls=new PF(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Eo}unmount(){this.removeGroupControls(),this.removeListeners()}}const d4=e=>(t,r)=>{e&&Oa.postRender(()=>e(t,r))};class RF extends qu{constructor(){super(...arguments),this.removePointerDownListener=Eo}onPointerDown(t){this.session=new SA(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:bA(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:r,onPan:a,onPanEnd:n}=this.node.getProps();return{onSessionStart:d4(t),onStart:d4(r),onMove:a,onEnd:(s,o)=>{delete this.session,n&&Oa.postRender(()=>n(s,o))}}}mount(){this.removePointerDownListener=Td(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const Xm={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function p4(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const hd={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(mr.test(e))e=parseFloat(e);else return e;const r=p4(e,t.target.x),a=p4(e,t.target.y);return`${r}% ${a}%`}},MF={correct:(e,{treeScale:t,projectionDelta:r})=>{const a=e,n=Mu.parse(e);if(n.length>5)return a;const s=Mu.createTransformer(e),o=typeof n[0]!="number"?1:0,c=r.x.scale*t.x,u=r.y.scale*t.y;n[0+o]/=c,n[1+o]/=u;const h=an(c,u,.5);return typeof n[2+o]=="number"&&(n[2+o]/=h),typeof n[3+o]=="number"&&(n[3+o]/=h),s(n)}};class IF extends P.Component{componentDidMount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:a,layoutId:n}=this.props,{projection:s}=t;t7(BF),s&&(r.group&&r.group.add(s),a&&a.register&&n&&a.register(s),s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,onExitComplete:()=>this.safeToRemove()})),Xm.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:r,visualElement:a,drag:n,isPresent:s}=this.props,o=a.projection;return o&&(o.isPresent=s,n||t.layoutDependency!==r||r===void 0||t.isPresent!==s?o.willUpdate():this.safeToRemove(),t.isPresent!==s&&(s?o.promote():o.relegate()||Oa.postRender(()=>{const c=o.getStack();(!c||!c.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),Gv.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:r,switchLayoutGroup:a}=this.props,{projection:n}=t;n&&(n.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(n),a&&a.deregister&&a.deregister(n))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function AA(e){const[t,r]=lN(),a=P.useContext(Pv);return f.jsx(IF,{...e,layoutGroup:a,switchLayoutGroup:P.useContext(SN),isPresent:t,safeToRemove:r})}const BF={borderRadius:{...hd,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:hd,borderTopRightRadius:hd,borderBottomLeftRadius:hd,borderBottomRightRadius:hd,boxShadow:MF};function UF(e,t,r){const a=Js(e)?e:$d(e);return a.start(dy("",a,t,r)),a.animation}function zF(e){return e instanceof SVGElement&&e.tagName!=="svg"}const HF=(e,t)=>e.depth-t.depth;class VF{constructor(){this.children=[],this.isDirty=!1}add(t){Mv(this.children,t),this.isDirty=!0}remove(t){Iv(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(HF),this.isDirty=!1,this.children.forEach(t)}}function qF(e,t){const r=Xl.now(),a=({timestamp:n})=>{const s=n-r;s>=t&&(Ru(a),e(s-t))};return Oa.read(a,!0),()=>Ru(a)}const _A=["TopLeft","TopRight","BottomLeft","BottomRight"],GF=_A.length,m4=e=>typeof e=="string"?parseFloat(e):e,x4=e=>typeof e=="number"||mr.test(e);function WF(e,t,r,a,n,s){n?(e.opacity=an(0,r.opacity??1,$F(a)),e.opacityExit=an(t.opacity??1,0,XF(a))):s&&(e.opacity=an(t.opacity??1,r.opacity??1,a));for(let o=0;o<GF;o++){const c=`border${_A[o]}Radius`;let u=g4(t,c),h=g4(r,c);if(u===void 0&&h===void 0)continue;u||(u=0),h||(h=0),u===0||h===0||x4(u)===x4(h)?(e[c]=Math.max(an(m4(u),m4(h),a),0),(Yl.test(h)||Yl.test(u))&&(e[c]+="%")):e[c]=h}(t.rotate||r.rotate)&&(e.rotate=an(t.rotate||0,r.rotate||0,a))}function g4(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const $F=TA(0,.5,VN),XF=TA(.5,.95,Eo);function TA(e,t,r){return a=>a<e?0:a>t?1:r(Gd(e,t,a))}function v4(e,t){e.min=t.min,e.max=t.max}function yo(e,t){v4(e.x,t.x),v4(e.y,t.y)}function y4(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function w4(e,t,r,a,n){return e-=t,e=d1(e,1/r,a),n!==void 0&&(e=d1(e,1/n,a)),e}function YF(e,t=0,r=1,a=.5,n,s=e,o=e){if(Yl.test(t)&&(t=parseFloat(t),t=an(o.min,o.max,t/100)-o.min),typeof t!="number")return;let c=an(s.min,s.max,a);e===s&&(c-=t),e.min=w4(e.min,t,r,c,n),e.max=w4(e.max,t,r,c,n)}function b4(e,t,[r,a,n],s,o){YF(e,t[r],t[a],t[n],t.scale,s,o)}const JF=["x","scaleX","originX"],KF=["y","scaleY","originY"];function S4(e,t,r,a){b4(e.x,t,JF,r?r.x:void 0,a?a.x:void 0),b4(e.y,t,KF,r?r.y:void 0,a?a.y:void 0)}function N4(e){return e.translate===0&&e.scale===1}function kA(e){return N4(e.x)&&N4(e.y)}function A4(e,t){return e.min===t.min&&e.max===t.max}function ZF(e,t){return A4(e.x,t.x)&&A4(e.y,t.y)}function _4(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function EA(e,t){return _4(e.x,t.x)&&_4(e.y,t.y)}function T4(e){return pi(e.x)/pi(e.y)}function k4(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class QF{constructor(){this.members=[]}add(t){Mv(this.members,t),t.scheduleRender()}remove(t){if(Iv(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(t){const r=this.members.findIndex(n=>t===n);if(r===0)return!1;let a;for(let n=r;n>=0;n--){const s=this.members[n];if(s.isPresent!==!1){a=s;break}}return a?(this.promote(a),!0):!1}promote(t,r){const a=this.lead;if(t!==a&&(this.prevLead=a,this.lead=t,t.show(),a)){a.instance&&a.scheduleRender(),t.scheduleRender(),t.resumeFrom=a,r&&(t.resumeFrom.preserveOpacity=!0),a.snapshot&&(t.snapshot=a.snapshot,t.snapshot.latestValues=a.animationValues||a.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:n}=t.options;n===!1&&a.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:r,resumingFrom:a}=t;r.onExitComplete&&r.onExitComplete(),a&&a.options.onExitComplete&&a.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function eP(e,t,r){let a="";const n=e.x.translate/t.x,s=e.y.translate/t.y,o=(r==null?void 0:r.z)||0;if((n||s||o)&&(a=`translate3d(${n}px, ${s}px, ${o}px) `),(t.x!==1||t.y!==1)&&(a+=`scale(${1/t.x}, ${1/t.y}) `),r){const{transformPerspective:h,rotate:p,rotateX:x,rotateY:v,skewX:g,skewY:w}=r;h&&(a=`perspective(${h}px) ${a}`),p&&(a+=`rotate(${p}deg) `),x&&(a+=`rotateX(${x}deg) `),v&&(a+=`rotateY(${v}deg) `),g&&(a+=`skewX(${g}deg) `),w&&(a+=`skewY(${w}deg) `)}const c=e.x.scale*t.x,u=e.y.scale*t.y;return(c!==1||u!==1)&&(a+=`scale(${c}, ${u})`),a||"none"}const Bg=["","X","Y","Z"],tP={visibility:"hidden"},E4=1e3;let rP=0;function Ug(e,t,r,a){const{latestValues:n}=t;n[e]&&(r[e]=n[e],t.setStaticValue(e,0),a&&(a[e]=0))}function jA(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const r=RN(t);if(window.MotionHasOptimisedAnimation(r,"transform")){const{layout:n,layoutId:s}=e.options;window.MotionCancelOptimisedAnimation(r,"transform",Oa,!(n||s))}const{parent:a}=e;a&&!a.hasCheckedOptimisedAppear&&jA(a)}function CA({attachResizeListener:e,defaultParent:t,measureScroll:r,checkIsScrollRoot:a,resetTransform:n}){return class{constructor(o={},c=t==null?void 0:t()){this.id=rP++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(sP),this.nodes.forEach(uP),this.nodes.forEach(fP),this.nodes.forEach(iP)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=c?c.root||c:this,this.path=c?[...c.path,c]:[],this.parent=c,this.depth=c?c.depth+1:0;for(let u=0;u<this.path.length;u++)this.path[u].shouldResetTransform=!0;this.root===this&&(this.nodes=new VF)}addEventListener(o,c){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new Uv),this.eventHandlers.get(o).add(c)}notifyListeners(o,...c){const u=this.eventHandlers.get(o);u&&u.notify(...c)}hasListeners(o){return this.eventHandlers.has(o)}mount(o,c=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=zF(o),this.instance=o;const{layoutId:u,layout:h,visualElement:p}=this.options;if(p&&!p.current&&p.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),c&&(h||u)&&(this.isLayoutDirty=!0),e){let x;const v=()=>this.root.updateBlockedByResize=!1;e(o,()=>{this.root.updateBlockedByResize=!0,x&&x(),x=qF(v,250),Xm.hasAnimatedSinceResize&&(Xm.hasAnimatedSinceResize=!1,this.nodes.forEach(C4))})}u&&this.root.registerSharedNode(u,this),this.options.animate!==!1&&p&&(u||h)&&this.addEventListener("didUpdate",({delta:x,hasLayoutChanged:v,hasRelativeLayoutChanged:g,layout:w})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const b=this.options.transition||p.getDefaultTransition()||xP,{onLayoutAnimationStart:N,onLayoutAnimationComplete:_}=p.getProps(),E=!this.targetLayout||!EA(this.targetLayout,w),j=!v&&g;if(this.options.layoutRoot||this.resumeFrom||j||v&&(E||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(x,j);const M={...Vv(b,"layout"),onPlay:N,onComplete:_};(p.shouldReduceMotion||this.options.layoutRoot)&&(M.delay=0,M.type=!1),this.startAnimation(M)}else v||C4(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=w})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Ru(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(hP),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&jA(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let p=0;p<this.path.length;p++){const x=this.path[p];x.shouldResetTransform=!0,x.updateScroll("snapshot"),x.options.layoutRoot&&x.willUpdate(!1)}const{layoutId:c,layout:u}=this.options;if(c===void 0&&!u)return;const h=this.getTransformTemplate();this.prevTransformTemplateValue=h?h(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(j4);return}this.isUpdating||this.nodes.forEach(lP),this.isUpdating=!1,this.nodes.forEach(cP),this.nodes.forEach(aP),this.nodes.forEach(nP),this.clearAllSnapshots();const c=Xl.now();bs.delta=Bc(0,1e3/60,c-bs.timestamp),bs.timestamp=c,bs.isProcessing=!0,Dg.update.process(bs),Dg.preRender.process(bs),Dg.render.process(bs),bs.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,Gv.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(oP),this.sharedNodes.forEach(dP)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Oa.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Oa.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!pi(this.snapshot.measuredBox.x)&&!pi(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let u=0;u<this.path.length;u++)this.path[u].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=_n(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:c}=this.options;c&&c.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let c=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(c=!1),c){const u=a(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:u,offset:r(this.instance),wasRoot:this.scroll?this.scroll.isRoot:u}}}resetTransform(){if(!n)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,c=this.projectionDelta&&!kA(this.projectionDelta),u=this.getTransformTemplate(),h=u?u(this.latestValues,""):void 0,p=h!==this.prevTransformTemplateValue;o&&(c||Tf(this.latestValues)||p)&&(n(this.instance,h),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const c=this.measurePageBox();let u=this.removeElementScroll(c);return o&&(u=this.removeTransform(u)),gP(u),{animationId:this.root.animationId,measuredBox:c,layoutBox:u,latestValues:{},source:this.id}}measurePageBox(){var h;const{visualElement:o}=this.options;if(!o)return _n();const c=o.measureViewportBox();if(!(((h=this.scroll)==null?void 0:h.wasRoot)||this.path.some(vP))){const{scroll:p}=this.root;p&&(Y0(c.x,p.offset.x),Y0(c.y,p.offset.y))}return c}removeElementScroll(o){var u;const c=_n();if(yo(c,o),(u=this.scroll)!=null&&u.wasRoot)return c;for(let h=0;h<this.path.length;h++){const p=this.path[h],{scroll:x,options:v}=p;p!==this.root&&x&&v.layoutScroll&&(x.wasRoot&&yo(c,o),Y0(c.x,x.offset.x),Y0(c.y,x.offset.y))}return c}applyTransform(o,c=!1){const u=_n();yo(u,o);for(let h=0;h<this.path.length;h++){const p=this.path[h];!c&&p.options.layoutScroll&&p.scroll&&p!==p.root&&J0(u,{x:-p.scroll.offset.x,y:-p.scroll.offset.y}),Tf(p.latestValues)&&J0(u,p.latestValues)}return Tf(this.latestValues)&&J0(u,this.latestValues),u}removeTransform(o){const c=_n();yo(c,o);for(let u=0;u<this.path.length;u++){const h=this.path[u];if(!h.instance||!Tf(h.latestValues))continue;z2(h.latestValues)&&h.updateSnapshot();const p=_n(),x=h.measurePageBox();yo(p,x),S4(c,h.latestValues,h.snapshot?h.snapshot.layoutBox:void 0,p)}return Tf(this.latestValues)&&S4(c,this.latestValues),c}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==bs.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var v;const c=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=c.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=c.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=c.isSharedProjectionDirty);const u=!!this.resumingFrom||this!==c;if(!(o||u&&this.isSharedProjectionDirty||this.isProjectionDirty||(v=this.parent)!=null&&v.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:p,layoutId:x}=this.options;if(!(!this.layout||!(p||x))){if(this.resolvedRelativeTargetAt=bs.timestamp,!this.targetDelta&&!this.relativeTarget){const g=this.getClosestProjectingParent();g&&g.layout&&this.animationProgress!==1?(this.relativeParent=g,this.forceRelativeParentToResolveTarget(),this.relativeTarget=_n(),this.relativeTargetOrigin=_n(),Ed(this.relativeTargetOrigin,this.layout.layoutBox,g.layout.layoutBox),yo(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=_n(),this.targetWithTransforms=_n()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),wF(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):yo(this.target,this.layout.layoutBox),yA(this.target,this.targetDelta)):yo(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const g=this.getClosestProjectingParent();g&&!!g.resumingFrom==!!this.resumingFrom&&!g.options.layoutScroll&&g.target&&this.animationProgress!==1?(this.relativeParent=g,this.forceRelativeParentToResolveTarget(),this.relativeTarget=_n(),this.relativeTargetOrigin=_n(),Ed(this.relativeTargetOrigin,this.target,g.target),yo(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||z2(this.parent.latestValues)||vA(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var w;const o=this.getLead(),c=!!this.resumingFrom||this!==o;let u=!0;if((this.isProjectionDirty||(w=this.parent)!=null&&w.isProjectionDirty)&&(u=!1),c&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(u=!1),this.resolvedRelativeTargetAt===bs.timestamp&&(u=!1),u)return;const{layout:h,layoutId:p}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(h||p))return;yo(this.layoutCorrected,this.layout.layoutBox);const x=this.treeScale.x,v=this.treeScale.y;bF(this.layoutCorrected,this.treeScale,this.path,c),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox,o.targetWithTransforms=_n());const{target:g}=o;if(!g){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(y4(this.prevProjectionDelta.x,this.projectionDelta.x),y4(this.prevProjectionDelta.y,this.projectionDelta.y)),kd(this.projectionDelta,this.layoutCorrected,g,this.latestValues),(this.treeScale.x!==x||this.treeScale.y!==v||!k4(this.projectionDelta.x,this.prevProjectionDelta.x)||!k4(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",g))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){var c;if((c=this.options.visualElement)==null||c.scheduleRender(),o){const u=this.getStack();u&&u.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=X0(),this.projectionDelta=X0(),this.projectionDeltaWithTransform=X0()}setAnimationOrigin(o,c=!1){const u=this.snapshot,h=u?u.latestValues:{},p={...this.latestValues},x=X0();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!c;const v=_n(),g=u?u.source:void 0,w=this.layout?this.layout.source:void 0,b=g!==w,N=this.getStack(),_=!N||N.members.length<=1,E=!!(b&&!_&&this.options.crossfade===!0&&!this.path.some(mP));this.animationProgress=0;let j;this.mixTargetDelta=M=>{const U=M/1e3;D4(x.x,o.x,U),D4(x.y,o.y,U),this.setTargetDelta(x),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Ed(v,this.layout.layoutBox,this.relativeParent.layout.layoutBox),pP(this.relativeTarget,this.relativeTargetOrigin,v,U),j&&ZF(this.relativeTarget,j)&&(this.isProjectionDirty=!1),j||(j=_n()),yo(j,this.relativeTarget)),b&&(this.animationValues=p,WF(p,h,this.latestValues,U,E,_)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=U},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Ru(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Oa.update(()=>{Xm.hasAnimatedSinceResize=!0,this.currentAnimation=UF(0,E4,{...o,onUpdate:c=>{this.mixTargetDelta(c),o.onUpdate&&o.onUpdate(c)},onStop:()=>{},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(E4),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:c,target:u,layout:h,latestValues:p}=o;if(!(!c||!u||!h)){if(this!==o&&this.layout&&h&&DA(this.options.animationType,this.layout.layoutBox,h.layoutBox)){u=this.target||_n();const x=pi(this.layout.layoutBox.x);u.x.min=o.target.x.min,u.x.max=u.x.min+x;const v=pi(this.layout.layoutBox.y);u.y.min=o.target.y.min,u.y.max=u.y.min+v}yo(c,u),J0(c,p),kd(this.projectionDeltaWithTransform,this.layoutCorrected,c,p)}}registerSharedNode(o,c){this.sharedNodes.has(o)||this.sharedNodes.set(o,new QF),this.sharedNodes.get(o).add(c);const h=c.options.initialPromotionConfig;c.promote({transition:h?h.transition:void 0,preserveFollowOpacity:h&&h.shouldPreserveFollowOpacity?h.shouldPreserveFollowOpacity(c):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var c;const{layoutId:o}=this.options;return o?((c=this.getStack())==null?void 0:c.lead)||this:this}getPrevLead(){var c;const{layoutId:o}=this.options;return o?(c=this.getStack())==null?void 0:c.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:c,preserveFollowOpacity:u}={}){const h=this.getStack();h&&h.promote(this,u),o&&(this.projectionDelta=void 0,this.needsReset=!0),c&&this.setOptions({transition:c})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let c=!1;const{latestValues:u}=o;if((u.z||u.rotate||u.rotateX||u.rotateY||u.rotateZ||u.skewX||u.skewY)&&(c=!0),!c)return;const h={};u.z&&Ug("z",o,h,this.animationValues);for(let p=0;p<Bg.length;p++)Ug(`rotate${Bg[p]}`,o,h,this.animationValues),Ug(`skew${Bg[p]}`,o,h,this.animationValues);o.render();for(const p in h)o.setStaticValue(p,h[p]),this.animationValues&&(this.animationValues[p]=h[p]);o.scheduleRender()}getProjectionStyles(o){if(!this.instance||this.isSVG)return;if(!this.isVisible)return tP;const c={visibility:""},u=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,c.opacity="",c.pointerEvents=$m(o==null?void 0:o.pointerEvents)||"",c.transform=u?u(this.latestValues,""):"none",c;const h=this.getLead();if(!this.projectionDelta||!this.layout||!h.target){const g={};return this.options.layoutId&&(g.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,g.pointerEvents=$m(o==null?void 0:o.pointerEvents)||""),this.hasProjected&&!Tf(this.latestValues)&&(g.transform=u?u({},""):"none",this.hasProjected=!1),g}const p=h.animationValues||h.latestValues;this.applyTransformsToTarget(),c.transform=eP(this.projectionDeltaWithTransform,this.treeScale,p),u&&(c.transform=u(p,c.transform));const{x,y:v}=this.projectionDelta;c.transformOrigin=`${x.origin*100}% ${v.origin*100}% 0`,h.animationValues?c.opacity=h===this?p.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:p.opacityExit:c.opacity=h===this?p.opacity!==void 0?p.opacity:"":p.opacityExit!==void 0?p.opacityExit:0;for(const g in Yd){if(p[g]===void 0)continue;const{correct:w,applyTo:b,isCSSVariable:N}=Yd[g],_=c.transform==="none"?p[g]:w(p[g],h);if(b){const E=b.length;for(let j=0;j<E;j++)c[b[j]]=_}else N?this.options.visualElement.renderState.vars[g]=_:c[g]=_}return this.options.layoutId&&(c.pointerEvents=h===this?$m(o==null?void 0:o.pointerEvents)||"":"none"),c}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var c;return(c=o.currentAnimation)==null?void 0:c.stop()}),this.root.nodes.forEach(j4),this.root.sharedNodes.clear()}}}function aP(e){e.updateLayout()}function nP(e){var r;const t=((r=e.resumeFrom)==null?void 0:r.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&t&&e.hasListeners("didUpdate")){const{layoutBox:a,measuredBox:n}=e.layout,{animationType:s}=e.options,o=t.source!==e.layout.source;s==="size"?Ao(x=>{const v=o?t.measuredBox[x]:t.layoutBox[x],g=pi(v);v.min=a[x].min,v.max=v.min+g}):DA(s,t.layoutBox,a)&&Ao(x=>{const v=o?t.measuredBox[x]:t.layoutBox[x],g=pi(a[x]);v.max=v.min+g,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[x].max=e.relativeTarget[x].min+g)});const c=X0();kd(c,a,t.layoutBox);const u=X0();o?kd(u,e.applyTransform(n,!0),t.measuredBox):kd(u,a,t.layoutBox);const h=!kA(c);let p=!1;if(!e.resumeFrom){const x=e.getClosestProjectingParent();if(x&&!x.resumeFrom){const{snapshot:v,layout:g}=x;if(v&&g){const w=_n();Ed(w,t.layoutBox,v.layoutBox);const b=_n();Ed(b,a,g.layoutBox),EA(w,b)||(p=!0),x.options.layoutRoot&&(e.relativeTarget=b,e.relativeTargetOrigin=w,e.relativeParent=x)}}}e.notifyListeners("didUpdate",{layout:a,snapshot:t,delta:u,layoutDelta:c,hasLayoutChanged:h,hasRelativeLayoutChanged:p})}else if(e.isLead()){const{onExitComplete:a}=e.options;a&&a()}e.options.transition=void 0}function sP(e){e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function iP(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function oP(e){e.clearSnapshot()}function j4(e){e.clearMeasurements()}function lP(e){e.isLayoutDirty=!1}function cP(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function C4(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function uP(e){e.resolveTargetDelta()}function fP(e){e.calcProjection()}function hP(e){e.resetSkewAndRotation()}function dP(e){e.removeLeadSnapshot()}function D4(e,t,r){e.translate=an(t.translate,0,r),e.scale=an(t.scale,1,r),e.origin=t.origin,e.originPoint=t.originPoint}function F4(e,t,r,a){e.min=an(t.min,r.min,a),e.max=an(t.max,r.max,a)}function pP(e,t,r,a){F4(e.x,t.x,r.x,a),F4(e.y,t.y,r.y,a)}function mP(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const xP={duration:.45,ease:[.4,0,.1,1]},P4=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),L4=P4("applewebkit/")&&!P4("chrome/")?Math.round:Eo;function O4(e){e.min=L4(e.min),e.max=L4(e.max)}function gP(e){O4(e.x),O4(e.y)}function DA(e,t,r){return e==="position"||e==="preserve-aspect"&&!yF(T4(t),T4(r),.2)}function vP(e){var t;return e!==e.root&&((t=e.scroll)==null?void 0:t.wasRoot)}const yP=CA({attachResizeListener:(e,t)=>Qd(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),zg={current:void 0},FA=CA({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!zg.current){const e=new yP({});e.mount(window),e.setOptions({layoutScroll:!0}),zg.current=e}return zg.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),wP={pan:{Feature:RF},drag:{Feature:OF,ProjectionNode:FA,MeasureLayout:AA}};function R4(e,t,r){const{props:a}=e;e.animationState&&a.whileHover&&e.animationState.setActive("whileHover",r==="Start");const n="onHover"+r,s=a[n];s&&Oa.postRender(()=>s(t,yp(t)))}class bP extends qu{mount(){const{current:t}=this.node;t&&(this.unmount=CC(t,(r,a)=>(R4(this.node,a,"Start"),n=>R4(this.node,n,"End"))))}unmount(){}}class SP extends qu{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=vp(Qd(this.node.current,"focus",()=>this.onFocus()),Qd(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function M4(e,t,r){const{props:a}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&a.whileTap&&e.animationState.setActive("whileTap",r==="Start");const n="onTap"+(r==="End"?"":r),s=a[n];s&&Oa.postRender(()=>s(t,yp(t)))}class NP extends qu{mount(){const{current:t}=this.node;t&&(this.unmount=LC(t,(r,a)=>(M4(this.node,a,"Start"),(n,{success:s})=>M4(this.node,n,s?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const q2=new WeakMap,Hg=new WeakMap,AP=e=>{const t=q2.get(e.target);t&&t(e)},_P=e=>{e.forEach(AP)};function TP({root:e,...t}){const r=e||document;Hg.has(r)||Hg.set(r,{});const a=Hg.get(r),n=JSON.stringify(t);return a[n]||(a[n]=new IntersectionObserver(_P,{root:e,...t})),a[n]}function kP(e,t,r){const a=TP(t);return q2.set(e,r),a.observe(e),()=>{q2.delete(e),a.unobserve(e)}}const EP={some:0,all:1};class jP extends qu{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:r,margin:a,amount:n="some",once:s}=t,o={root:r?r.current:void 0,rootMargin:a,threshold:typeof n=="number"?n:EP[n]},c=u=>{const{isIntersecting:h}=u;if(this.isInView===h||(this.isInView=h,s&&!h&&this.hasEnteredView))return;h&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",h);const{onViewportEnter:p,onViewportLeave:x}=this.node.getProps(),v=h?p:x;v&&v(u)};return kP(this.node.current,o,c)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:r}=this.node;["amount","margin","root"].some(CP(t,r))&&this.startObserver()}unmount(){}}function CP({viewport:e={}},{viewport:t={}}={}){return r=>e[r]!==t[r]}const DP={inView:{Feature:jP},tap:{Feature:NP},focus:{Feature:SP},hover:{Feature:bP}},FP={layout:{ProjectionNode:FA,MeasureLayout:AA}},G2={current:null},PA={current:!1};function PP(){if(PA.current=!0,!!Ov)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>G2.current=e.matches;e.addListener(t),t()}else G2.current=!1}const LP=[...nA,qs,Mu],OP=e=>LP.find(aA(e)),RP=new WeakMap;function MP(e,t,r){for(const a in t){const n=t[a],s=r[a];if(Js(n))e.addValue(a,n);else if(Js(s))e.addValue(a,$d(n,{owner:e}));else if(s!==n)if(e.hasValue(a)){const o=e.getValue(a);o.liveStyle===!0?o.jump(n):o.hasAnimated||o.set(n)}else{const o=e.getStaticValue(a);e.addValue(a,$d(o!==void 0?o:n,{owner:e}))}}for(const a in r)t[a]===void 0&&e.removeValue(a);return t}const I4=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class IP{scrapeMotionValuesFromProps(t,r,a){return{}}constructor({parent:t,props:r,presenceContext:a,reducedMotionConfig:n,blockInitialAnimation:s,visualState:o},c={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=uy,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const g=Xl.now();this.renderScheduledAt<g&&(this.renderScheduledAt=g,Oa.render(this.render,!1,!0))};const{latestValues:u,renderState:h,onUpdate:p}=o;this.onUpdate=p,this.latestValues=u,this.baseTarget={...u},this.initialValues=r.initial?{...u}:{},this.renderState=h,this.parent=t,this.props=r,this.presenceContext=a,this.depth=t?t.depth+1:0,this.reducedMotionConfig=n,this.options=c,this.blockInitialAnimation=!!s,this.isControllingVariants=q1(r),this.isVariantNode=wN(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:x,...v}=this.scrapeMotionValuesFromProps(r,{},this);for(const g in v){const w=v[g];u[g]!==void 0&&Js(w)&&w.set(u[g],!1)}}mount(t){this.current=t,RP.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((r,a)=>this.bindToMotionValue(a,r)),PA.current||PP(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:G2.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),Ru(this.notifyUpdate),Ru(this.render),this.valueSubscriptions.forEach(t=>t()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const r=this.features[t];r&&(r.unmount(),r.isMounted=!1)}this.current=null}bindToMotionValue(t,r){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const a=Qf.has(t);a&&this.onBindTransform&&this.onBindTransform();const n=r.on("change",c=>{this.latestValues[t]=c,this.props.onUpdate&&Oa.preRender(this.notifyUpdate),a&&this.projection&&(this.projection.isTransformDirty=!0)}),s=r.on("renderRequest",this.scheduleRender);let o;window.MotionCheckAppearSync&&(o=window.MotionCheckAppearSync(this,t,r)),this.valueSubscriptions.set(t,()=>{n(),s(),o&&o(),r.owner&&r.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in uh){const r=uh[t];if(!r)continue;const{isEnabled:a,Feature:n}=r;if(!this.features[t]&&n&&a(this.props)&&(this.features[t]=new n(this)),this.features[t]){const s=this.features[t];s.isMounted?s.update():(s.mount(),s.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):_n()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,r){this.latestValues[t]=r}update(t,r){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let a=0;a<I4.length;a++){const n=I4[a];this.propEventSubscriptions[n]&&(this.propEventSubscriptions[n](),delete this.propEventSubscriptions[n]);const s="on"+n,o=t[s];o&&(this.propEventSubscriptions[n]=this.on(n,o))}this.prevMotionValues=MP(this,this.scrapeMotionValuesFromProps(t,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(t),()=>r.variantChildren.delete(t)}addValue(t,r){const a=this.values.get(t);r!==a&&(a&&this.removeValue(t),this.bindToMotionValue(t,r),this.values.set(t,r),this.latestValues[t]=r.get())}removeValue(t){this.values.delete(t);const r=this.valueSubscriptions.get(t);r&&(r(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,r){if(this.props.values&&this.props.values[t])return this.props.values[t];let a=this.values.get(t);return a===void 0&&r!==void 0&&(a=$d(r===null?void 0:r,{owner:this}),this.addValue(t,a)),a}readValue(t,r){let a=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:this.getBaseTargetFromProps(this.props,t)??this.readValueFromInstance(this.current,t,this.options);return a!=null&&(typeof a=="string"&&(tA(a)||GN(a))?a=parseFloat(a):!OP(a)&&Mu.test(r)&&(a=ZN(t,r)),this.setBaseTarget(t,Js(a)?a.get():a)),Js(a)?a.get():a}setBaseTarget(t,r){this.baseTarget[t]=r}getBaseTarget(t){var s;const{initial:r}=this.props;let a;if(typeof r=="string"||typeof r=="object"){const o=ny(this.props,r,(s=this.presenceContext)==null?void 0:s.custom);o&&(a=o[t])}if(r&&a!==void 0)return a;const n=this.getBaseTargetFromProps(this.props,t);return n!==void 0&&!Js(n)?n:this.initialValues[t]!==void 0&&a===void 0?void 0:this.baseTarget[t]}on(t,r){return this.events[t]||(this.events[t]=new Uv),this.events[t].add(r)}notify(t,...r){this.events[t]&&this.events[t].notify(...r)}}class LA extends IP{constructor(){super(...arguments),this.KeyframeResolver=sA}sortInstanceNodePosition(t,r){return t.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(t,r){return t.style?t.style[r]:void 0}removeValueFromRenderState(t,{vars:r,style:a}){delete r[t],delete a[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;Js(t)&&(this.childSubscription=t.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}}function BP(e){return window.getComputedStyle(e)}class UP extends LA{constructor(){super(...arguments),this.type="html",this.renderInstance=DN}readValueFromInstance(t,r){if(Qf.has(r))return Z7(t,r);{const a=BP(t),n=(Jv(r)?a.getPropertyValue(r):a[r])||0;return typeof n=="string"?n.trim():n}}measureInstanceViewportBox(t,{transformPagePoint:r}){return wA(t,r)}build(t,r,a){Qv(t,r,a.transformTemplate)}scrapeMotionValuesFromProps(t,r,a){return sy(t,r,a)}}class zP extends LA{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=_n,this.updateDimensions=()=>{this.current&&!this.renderState.dimensions&&CN(this.current,this.renderState)}}getBaseTargetFromProps(t,r){return t[r]}readValueFromInstance(t,r){if(Qf.has(r)){const a=KN(r);return a&&a.default||0}return r=FN.has(r)?r:Yv(r),t.getAttribute(r)}scrapeMotionValuesFromProps(t,r,a){return LN(t,r,a)}onBindTransform(){this.current&&!this.renderState.dimensions&&Oa.postRender(this.updateDimensions)}build(t,r,a){ry(t,r,this.isSVGTag,a.transformTemplate)}renderInstance(t,r,a,n){PN(t,r,a,n)}mount(t){this.isSVGTag=ay(t.tagName),super.mount(t)}}const HP=(e,t)=>ty(e)?new zP(t):new UP(t,{allowProjection:e!==P.Fragment}),VP=_7({...fF,...DP,...wP,...FP},HP),ko=zC(VP),qP=({addPayment:e,setAddPayment:t,interiorArray:r,salesAssociateArray:a,setNavState:n,projectData:s,status:o,setStatus:c,tasks:u,tailorsArray:h,setTailorsArray:p,goodsArray:x,setGoodsArray:v,projectDate:g,setPRojectDate:w,projects:b})=>{const N=s.totalAmount+s.totalTax-s.paid,_=wa();ur(L=>L.data.taskDialogOpen);const E=ua(),[j,M]=P.useState(!1),[U,V]=P.useState(!1),[I,z]=P.useState(null),H=()=>{_(Ad(!0)),E("/tasks")},[re,R]=P.useState(0),[F,Y]=P.useState(0),[K,X]=P.useState(0),[Z,ce]=P.useState(0),[te,Q]=P.useState(0),[G,ye]=P.useState(0),[D,O]=P.useState(0);return P.useEffect(()=>{let L=0,q=0,oe=0,be=0,ve=0,ue=0,fe=0;x.forEach(Ee=>{switch(Ee.status){case"Pending":L++;break;case"Ordered":q++;break;case"Received":oe++;break;case"In Stock":be++;break}}),h.forEach(Ee=>{switch(Ee.status){case"Pending":ve++;break;case"Ordered":ue++;break;case"Received":fe++;break}}),R(L),Y(q),X(oe),ce(be),Q(ve),ye(ue),O(fe)},[x,h]),f.jsxs("div",{className:"flex flex-col gap-4 p-4 sm:p-6",children:[f.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4",children:[f.jsxs("p",{className:"text-lg sm:text-xl font-semibold",children:["Project Name: ",s.projectName]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("label",{className:"text-sm sm:text-base",children:"Delivery Date:"}),f.jsx("input",{className:"border border-gray-300 rounded-lg px-3 py-2 text-sm sm:text-base focus:ring-2 focus:ring-blue-400",type:"date",value:g,onChange:L=>w(L.target.value)})]})]}),f.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[f.jsxs("div",{className:"flex flex-col border rounded-lg p-4 w-full lg:w-1/3",children:[f.jsx("p",{className:"text-base sm:text-lg font-medium mb-2",children:"Client Information"}),f.jsxs("div",{className:"flex flex-col gap-2 text-sm sm:text-base",children:[f.jsxs("div",{className:"flex justify-between",children:[f.jsx("p",{className:"text-gray-500",children:"Name"}),f.jsx("p",{className:"max-w-[50%] break-words",children:s.customerLink[0]})]}),f.jsxs("div",{className:"flex justify-between",children:[f.jsx("p",{className:"text-gray-500",children:"Phone"}),f.jsx("p",{className:"max-w-[50%] break-words",children:s.customerLink[1]})]}),f.jsxs("div",{className:"flex justify-between",children:[f.jsx("p",{className:"text-gray-500",children:"Alternate Phone"}),f.jsx("p",{className:"max-w-[50%] break-words",children:s.customerLink[4]})]}),f.jsxs("div",{className:"flex justify-between",children:[f.jsx("p",{className:"text-gray-500",children:"Email"}),f.jsx("p",{className:"max-w-[50%] break-words",children:s.customerLink[2]})]}),f.jsxs("div",{className:"flex justify-between",children:[f.jsx("p",{className:"text-gray-500",children:"Address"}),f.jsx("p",{className:"max-w-[50%] break-words",children:s.customerLink[3]})]}),f.jsxs("div",{className:"flex justify-between",children:[f.jsx("p",{className:"text-gray-500",children:"Additional Requests"}),f.jsx("p",{className:"max-w-[50%] break-words",children:s.additionalRequests})]})]})]}),f.jsxs("div",{className:"flex flex-col w-full lg:w-1/3 p-4 border rounded-lg",children:[f.jsx("p",{className:"text-base sm:text-lg font-medium mb-2",children:"Current Status"}),f.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-2 mb-4",children:[f.jsx("p",{className:"text-sm sm:text-base text-gray-500",children:"Delivery & Installation"}),f.jsxs("select",{value:o,onChange:L=>c(L.target.value),className:"border border-gray-300 px-4 py-2 rounded-md text-sm sm:text-base focus:ring-2 focus:ring-blue-400",children:[f.jsx("option",{value:"Unsent",children:"Unsent"}),f.jsx("option",{value:"Pending",children:"Pending"}),f.jsx("option",{value:"Approved",children:"Approved"}),f.jsx("option",{value:"Delivered",children:"Delivered"}),f.jsx("option",{value:"Rejected",children:"Rejected"})]})]}),f.jsxs("div",{className:"flex flex-col gap-4",children:[f.jsxs("div",{className:"flex flex-col gap-2",children:[f.jsx("p",{className:"text-sm sm:text-base font-semibold",children:"Goods Ordered"}),f.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between gap-2",children:[f.jsxs("div",{className:"flex flex-wrap gap-2",children:[f.jsxs("p",{className:"text-xs sm:text-sm rounded-xl text-yellow-500 font-semibold bg-yellow-100 py-1 px-2",children:["Pending-",re]}),f.jsxs("p",{className:"text-xs sm:text-sm rounded-xl text-sky-600 font-semibold bg-sky-100 py-1 px-2",children:["Ordered-",F]}),f.jsxs("p",{className:"text-xs sm:text-sm rounded-xl text-green-600 font-semibold bg-green-100 py-1 px-2",children:["Received-",K]}),f.jsxs("p",{className:"text-xs sm:text-sm rounded-xl text-green-600 font-semibold bg-green-100 py-1 px-2",children:["In Stock-",Z]})]}),f.jsx("button",{onClick:()=>n("Goods"),className:"text-sky-600 border border-sky-600 bg-white rounded-lg px-3 py-1 text-sm sm:text-base hover:bg-sky-50",children:"View"})]})]}),f.jsxs("div",{className:"flex flex-col gap-2",children:[f.jsx("p",{className:"text-sm sm:text-base font-semibold",children:"Goods Sent to Tailor"}),f.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between gap-2",children:[f.jsxs("div",{className:"flex flex-wrap gap-2",children:[f.jsxs("p",{className:"text-xs sm:text-sm rounded-xl text-yellow-500 font-semibold bg-yellow-100 py-1 px-2",children:["Pending-",te]}),f.jsxs("p",{className:"text-xs sm:text-sm rounded-xl text-sky-600 font-semibold bg-sky-100 py-1 px-2",children:["Ordered-",G]}),f.jsxs("p",{className:"text-xs sm:text-sm rounded-xl text-green-600 font-semibold bg-green-100 py-1 px-2",children:["Received-",D]})]}),f.jsx("button",{onClick:()=>n("Tailors"),className:"text-sky-600 border border-sky-600 bg-white rounded-lg px-3 py-1 text-sm sm:text-base hover:bg-sky-50",children:"View"})]})]})]})]}),f.jsxs("div",{className:"flex flex-col w-full lg:w-1/3 p-4 rounded-lg border",children:[f.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center mb-4",children:[f.jsx("p",{className:"text-base sm:text-lg font-medium",children:"Payments"}),f.jsxs("div",{className:"flex flex-row gap-2 mt-2 sm:mt-0",children:[f.jsx("button",{onClick:()=>t(!0),className:"text-white bg-sky-600 rounded-lg px-3 py-1 text-sm sm:text-base hover:bg-sky-700",children:"Add"}),f.jsx("button",{onClick:()=>E("/paymentsPage"),className:"text-white bg-sky-600 rounded-lg px-3 py-1 text-sm sm:text-base hover:bg-sky-700",children:"View"})]})]}),f.jsxs("div",{className:"flex flex-col gap-2",children:[f.jsxs("div",{className:"flex flex-row justify-between items-center border rounded-lg p-2",children:[f.jsx("div",{className:"w-1 bg-gray-500 h-4"}),f.jsx("p",{className:"text-sm sm:text-base",children:"Total Payment"}),f.jsx("p",{className:"text-sm sm:text-base",children:(s.totalAmount+s.totalTax).toFixed(2)})]}),f.jsxs("div",{className:"flex flex-row justify-between items-center border rounded-lg p-2",children:[f.jsx("div",{className:"w-1 bg-green-500 h-4"}),f.jsx("p",{className:"text-sm sm:text-base",children:"Payment Received"}),f.jsx("p",{className:"text-sm sm:text-base",children:s.paid})]}),f.jsxs("div",{className:"flex flex-row justify-between items-center border rounded-lg p-2",children:[f.jsx("div",{className:"w-1 bg-yellow-500 h-4"}),f.jsx("p",{className:"text-sm sm:text-base",children:"Due"}),f.jsx("p",{className:"text-sm sm:text-base",children:N.toFixed(2)})]})]})]})]}),f.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[f.jsxs("div",{className:"flex flex-col w-full lg:w-1/3 border rounded-lg p-4",children:[f.jsxs("div",{className:"flex flex-row justify-between items-center mb-4",children:[f.jsx("p",{className:"text-base sm:text-lg font-medium",children:"Tailor Information"}),f.jsx("button",{onClick:()=>n("Tailors"),className:"text-white bg-sky-600 rounded-lg px-3 py-1 text-sm sm:text-base hover:bg-sky-700",children:"Assign"})]}),f.jsx("div",{className:"flex flex-col gap-2 max-h-48 overflow-y-auto",children:h&&h.map((L,q)=>f.jsxs("div",{className:"flex flex-col border rounded-lg p-2",children:[f.jsx("p",{className:"text-sm sm:text-base text-sky-600 font-semibold",children:L.tailorData[0]}),f.jsx("p",{className:"text-sm sm:text-base",children:L.tailorData[1]})]},q))})]}),f.jsx("div",{className:"flex flex-col w-full lg:w-1/3 gap-4",children:[{title:"Interior Information",data:r},{title:"Sales Associate Information",data:a}].map((L,q)=>f.jsxs("div",{className:"flex flex-col p-4 border rounded-lg",children:[f.jsxs("div",{className:"flex flex-row justify-between items-center mb-2",children:[f.jsx("p",{className:"text-base sm:text-lg font-medium",children:L.title}),f.jsx("button",{onClick:()=>n("Customer & Project Details"),className:"text-white bg-sky-600 rounded-lg px-3 py-1 text-sm sm:text-base hover:bg-sky-700",children:"View"})]}),f.jsxs("div",{className:"flex flex-row justify-between",children:[f.jsx("p",{className:"text-sm sm:text-base max-w-[50%] break-words",children:L.data[0]}),f.jsx("p",{className:"text-sm sm:text-base max-w-[50%] break-words",children:L.data[2]})]})]},q))}),f.jsxs("div",{className:"flex flex-col p-4 border rounded-lg w-full lg:w-1/3",children:[f.jsxs("div",{className:"flex flex-row justify-between items-center mb-4",children:[f.jsx("p",{className:"text-base sm:text-lg font-medium",children:"Tasks"}),f.jsx("button",{onClick:H,className:"text-white bg-sky-600 rounded-lg px-3 py-1 text-sm sm:text-base hover:bg-sky-700",children:"Create Task"})]}),f.jsx("div",{className:"flex flex-col gap-2 max-h-48 overflow-y-auto",children:u&&u.filter(L=>L[5]===s.projectName).map((L,q)=>f.jsxs("div",{className:"border rounded-lg p-2 flex flex-col gap-2",children:[f.jsxs("div",{className:"flex flex-row justify-between gap-2",children:[f.jsx("p",{className:`text-xs sm:text-sm text-white rounded-lg px-2 py-1 ${L[6]==="High"?"bg-red-500":L[6]==="Low"?"bg-green-500":L[6]==="Moderate"?"bg-yellow-500":""}`,children:L[6]}),f.jsx("p",{className:`text-xs sm:text-sm text-white rounded-lg px-2 py-1 ${L[7]==="To Do"?"bg-red-500":L[7]==="Completed"?"bg-green-500":L[7]==="In Progress"?"bg-yellow-500":""}`,children:L[7]})]}),f.jsx("p",{className:"text-sm sm:text-base font-semibold",children:L[0]}),f.jsxs("p",{className:"text-xs sm:text-sm",children:["Created At: ",L[3]]}),f.jsxs("p",{className:"text-xs sm:text-sm",children:["Description: ",L[1]]}),f.jsx("button",{onClick:()=>{z(L),M(!0)},className:"border px-3 py-1 w-24 text-white bg-sky-600 rounded-lg text-sm hover:bg-sky-700",children:"Edit Task"})]},q))})]})]}),f.jsx(qd,{children:j&&f.jsxs(f.Fragment,{children:[f.jsx(ko.div,{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-40",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>_(Ad(!1))}),f.jsx(ko.div,{className:"fixed inset-0 z-50 flex items-center justify-center p-4",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.3},children:f.jsx("div",{className:"w-full max-w-md",children:f.jsx(Vd,{onClose:()=>M(!1),isEditing:I,setediting:z,name:"NA",setrefresh:V,projectData:b,setTaskDialogOpen:Ad,taskDialogOpen:j,setProjectFlag:ch})})})]})})]})};var OA={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},B4=Pu.createContext&&Pu.createContext(OA),GP=["attr","size","title"];function WP(e,t){if(e==null)return{};var r=$P(e,t),a,n;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)a=s[n],!(t.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}function $P(e,t){if(e==null)return{};var r={};for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){if(t.indexOf(a)>=0)continue;r[a]=e[a]}return r}function p1(){return p1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},p1.apply(this,arguments)}function U4(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function m1(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?U4(Object(r),!0).forEach(function(a){XP(e,a,r[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):U4(Object(r)).forEach(function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))})}return e}function XP(e,t,r){return t=YP(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function YP(e){var t=JP(e,"string");return typeof t=="symbol"?t:t+""}function JP(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var a=r.call(e,t);if(typeof a!="object")return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function RA(e){return e&&e.map((t,r)=>Pu.createElement(t.tag,m1({key:r},t.attr),RA(t.child)))}function py(e){return t=>Pu.createElement(KP,p1({attr:m1({},e.attr)},t),RA(e.child))}function KP(e){var t=r=>{var{attr:a,size:n,title:s}=e,o=WP(e,GP),c=n||r.size||"1em",u;return r.className&&(u=r.className),e.className&&(u=(u?u+" ":"")+e.className),Pu.createElement("svg",p1({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},r.attr,a,o,{className:u,style:m1(m1({color:e.color||r.color},r.style),e.style),height:c,width:c,xmlns:"http://www.w3.org/2000/svg"}),s&&Pu.createElement("title",null,s),e.children)};return B4!==void 0?Pu.createElement(B4.Consumer,null,r=>t(r)):t(OA)}function ZP(e){return py({attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M402.6 83.2l90.2 90.2c3.8 3.8 3.8 10 0 13.8L274.4 405.6l-92.8 10.3c-12.4 1.4-22.9-9.1-21.5-21.5l10.3-92.8L388.8 83.2c3.8-3.8 10-3.8 13.8 0zm162-22.9l-48.8-48.8c-15.2-15.2-39.9-15.2-55.2 0l-35.4 35.4c-3.8 3.8-3.8 10 0 13.8l90.2 90.2c3.8 3.8 10 3.8 13.8 0l35.4-35.4c15.2-15.3 15.2-40 0-55.2zM384 346.2V448H64V128h229.8c3.2 0 6.2-1.3 8.5-3.5l40-40c7.6-7.6 2.2-20.5-8.5-20.5H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V306.2c0-10.7-12.9-16-20.5-8.5l-40 40c-2.2 2.3-3.5 5.3-3.5 8.5z"},child:[]}]})(e)}function qf(e){return py({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M416 208H272V64c0-17.67-14.33-32-32-32h-32c-17.67 0-32 14.33-32 32v144H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h144v144c0 17.67 14.33 32 32 32h32c17.67 0 32-14.33 32-32V304h144c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z"},child:[]}]})(e)}function Uc(e){return py({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16zM53.2 467a48 48 0 0 0 47.9 45h245.8a48 48 0 0 0 47.9-45L416 128H32z"},child:[]}]})(e)}const QP=({customers:e,selectedCustomer:t,setSelectedCustomer:r,projectData:a,setCustomers:n})=>{P.useEffect(()=>{console.log(t)},[t]);async function s(){try{const M=await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/getcustomerdata",{credentials:"include"});if(!M.ok)throw new Error(`HTTP error! Status: ${M.status}`);const U=await M.json();return Array.isArray(U.body)?U.body:[]}catch(M){return console.error("Error fetching customer data:",M),[]}}const[o,c]=P.useState(!1),[u,h]=P.useState(""),[p,x]=P.useState(""),[v,g]=P.useState(""),[w,b]=P.useState(""),[N,_]=P.useState(""),E=wa();ur(M=>M.data.customers);async function j(){const M=p;let U;if(U=new Date().toISOString().slice(0,16),(await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/sendcustomerdata",{method:"POST",headers:{"content-type":"application/json"},credentials:"include",body:JSON.stringify({name:u,phonenumber:M,email:N,address:v,alternatenumber:w,addedDate:U})})).status===200){const H=await s();E(Lc(H)),n(H),localStorage.setItem("customerData",JSON.stringify({data:H,time:Date.now()})),h(""),g(""),x(""),_(""),b(""),alert("Customer added successfully")}else alert("Error in adding customer");c(!1)}return f.jsxs("div",{className:"flex flex-col gap-4 p-4 sm:p-6 rounded-xl shadow-xl w-full border-gray-200 border-2 mt-4",children:[f.jsx("p",{className:"text-lg sm:text-xl font-semibold",children:"Customer Details"}),f.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between gap-4",children:[f.jsxs("div",{className:"flex flex-col w-full sm:w-1/2",children:[f.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-3 mb-2",children:[f.jsx("p",{className:"text-sm sm:text-base",children:"Select Customer"}),f.jsxs("button",{className:"flex items-center px-3 py-1 border border-blue-400 text-blue-500 font-semibold rounded-lg hover:bg-blue-50 transition-colors",onClick:()=>c(!0),children:[f.jsx(qf,{className:"mr-2 text-blue-600"})," Add Customer"]})]}),f.jsxs("select",{className:"border border-gray-300 p-2 rounded w-full text-sm sm:text-base opacity-80 focus:opacity-100 focus:ring-2 focus:ring-blue-400",value:t?JSON.stringify(t):"",onChange:M=>{M.target.value===""?r(null):r(JSON.parse(M.target.value))},children:[f.jsx("option",{value:"",children:"Select Customer"}),Array.isArray(e)&&e.map((M,U)=>f.jsx("option",{value:JSON.stringify(M),children:M[0]},U))]})]}),a.customerLink&&t&&f.jsxs("div",{className:"flex flex-col w-full sm:w-1/2",children:[f.jsx("p",{className:"text-sm sm:text-base",children:"Email (optional)"}),f.jsx("input",{type:"text",className:"border border-gray-300 p-2 rounded w-full text-sm sm:text-base bg-gray-100",value:t[2]||"",readOnly:!0})]})]}),a.customerLink&&t&&f.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between gap-4",children:[f.jsxs("div",{className:"flex flex-col w-full sm:w-1/2",children:[f.jsx("p",{className:"text-sm sm:text-base",children:"Phone Number"}),f.jsx("input",{type:"text",className:"border border-gray-300 p-2 rounded w-full text-sm sm:text-base bg-gray-100",value:t[1]||"",readOnly:!0})]}),f.jsxs("div",{className:"flex flex-col w-full sm:w-1/2",children:[f.jsx("p",{className:"text-sm sm:text-base",children:"Alternate Phone Number (optional)"}),f.jsx("input",{type:"text",className:"border border-gray-300 p-2 rounded w-full text-sm sm:text-base bg-gray-100",value:t[4]||"",readOnly:!0})]})]}),o&&f.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:f.jsxs("div",{className:"bg-white p-4 sm:p-6 rounded-xl shadow-xl w-full max-w-xs sm:max-w-md",children:[f.jsx("h2",{className:"text-lg sm:text-xl font-bold mb-4",children:"Add Customer"}),f.jsx("input",{className:"border border-gray-300 p-2 rounded w-full mb-3 text-sm sm:text-base focus:ring-2 focus:ring-blue-400",placeholder:"Name",value:u,onChange:M=>h(M.target.value)}),f.jsx("input",{className:"border border-gray-300 p-2 rounded w-full mb-3 text-sm sm:text-base focus:ring-2 focus:ring-blue-400",placeholder:"Email",value:N,onChange:M=>_(M.target.value)}),f.jsx("input",{className:"border border-gray-300 p-2 rounded w-full mb-3 text-sm sm:text-base focus:ring-2 focus:ring-blue-400",placeholder:"Mobile Number",value:p,onChange:M=>x(M.target.value)}),f.jsx("input",{className:"border border-gray-300 p-2 rounded w-full mb-3 text-sm sm:text-base focus:ring-2 focus:ring-blue-400",placeholder:"Address",value:v,onChange:M=>g(M.target.value)}),f.jsx("input",{className:"border border-gray-300 p-2 rounded w-full mb-3 text-sm sm:text-base focus:ring-2 focus:ring-blue-400",placeholder:"Alternate Number",value:w,onChange:M=>b(M.target.value)}),f.jsxs("div",{className:"flex justify-end gap-2",children:[f.jsx("button",{className:"px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors text-sm sm:text-base",onClick:()=>c(!1),children:"Cancel"}),f.jsx("button",{className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors text-sm sm:text-base",onClick:j,children:"Save"})]})]})})]})},eL=({selectedCustomer:e,interior:t,salesdata:r,interiorArray:a,setInteriorArray:n,salesAssociateArray:s,setSalesAssociateArray:o,projectName:c,setProjectName:u,projectReference:h,setProjectReference:p,user:x,setUser:v,projectDate:g,setProjectDate:w,setAdditionalRequests:b,additionalRequests:N,projectData:_,setsalesdata:E})=>{async function j(){try{const fe=await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/getinteriordata",{credentials:"include"});if(!fe.ok)throw new Error(`HTTP error! Status: ${fe.status}`);return(await fe.json()).body||[]}catch(fe){return console.error("Error fetching interiors:",fe),[]}}async function M(){try{const fe=await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/getsalesassociatedata",{credentials:"include"});if(!fe.ok)throw new Error(`HTTP error! Status: ${fe.status}`);const Ee=await fe.json();return Array.isArray(Ee.body)?Ee.body:[]}catch(fe){return console.error("Error fetching sales associates:",fe),[]}}const[U,V]=P.useState(!1),[I,z]=P.useState(!1),H=wa(),[re,R]=P.useState([]),[F,Y]=P.useState(""),[K,X]=P.useState(""),[Z,ce]=P.useState(""),[te,Q]=P.useState(""),[G,ye]=P.useState(""),[D,O]=P.useState(""),[L,q]=P.useState(""),[oe,be]=P.useState(""),ve=async()=>{if((await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/sendinteriordata",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({name:F,email:K,phonenumber:Z,address:te})})).status===200){const J=await j();H(Lf(J)),R(J),localStorage.setItem("interiorData",JSON.stringify({data:J,time:Date.now()})),Y(""),X(""),ce(""),Q(""),V(!1),alert("Interior added successfully")}else alert("Error saving interior")},ue=async()=>{if((await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/sendsalesassociatedata",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({name:G,email:D,phonenumber:L,address:oe})})).status===200){const J=await M();H(Vf(J)),E(J),localStorage.setItem("salesAssociateData",JSON.stringify({data:J,time:Date.now()})),ye(""),O(""),q(""),be(""),z(!1),alert("Sales Associate added successfully")}else alert("Error saving sales associate")};return f.jsxs("div",{className:"flex flex-col gap-4 p-4 sm:p-6 rounded-xl shadow-xl w-full border-gray-200 border-2 mt-4",children:[f.jsx("p",{className:"text-lg sm:text-xl font-semibold",children:"Project Details"}),f.jsxs("div",{className:"flex flex-col sm:flex-row w-full gap-4",children:[f.jsxs("div",{className:"flex flex-col w-full sm:w-1/2",children:[f.jsx("p",{className:"text-sm sm:text-base",children:"Reference (optional)"}),f.jsx("input",{type:"text",className:"border border-gray-300 p-2 rounded w-full text-sm sm:text-base focus:ring-2 focus:ring-blue-400",value:h,onChange:fe=>p(fe.target.value)})]}),f.jsxs("div",{className:"flex flex-col w-full sm:w-1/2",children:[f.jsx("p",{className:"text-sm sm:text-base",children:"Project Name (type a unique name)"}),f.jsx("input",{type:"text",className:"border border-gray-300 p-2 rounded w-full text-sm sm:text-base focus:ring-2 focus:ring-blue-400",value:c,onChange:fe=>u(fe.target.value)})]})]}),_.customerLink&&f.jsxs("div",{className:"flex flex-col w-full",children:[f.jsx("p",{className:"text-sm sm:text-base",children:"Address"}),f.jsx("input",{type:"text",className:"border border-gray-300 p-2 rounded w-full text-sm sm:text-base bg-gray-100",value:e[3]||"",readOnly:!0})]}),_.additionalRequests&&f.jsxs("div",{className:"flex flex-col w-full",children:[f.jsx("p",{className:"text-sm sm:text-base",children:"Any Additional Requests (optional)"}),f.jsx("input",{type:"text",value:N,onChange:fe=>b(fe.target.value),className:"border border-gray-300 p-2 rounded w-full text-sm sm:text-base focus:ring-2 focus:ring-blue-400"})]}),f.jsxs("div",{className:"flex flex-col sm:flex-row w-full gap-4",children:[f.jsxs("div",{className:"flex flex-col w-full sm:w-1/2",children:[f.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-3 mb-2",children:[f.jsx("p",{className:"text-sm sm:text-base",children:"Select Interior"}),f.jsxs("button",{className:"flex items-center px-3 py-1 border border-blue-400 text-blue-500 font-semibold rounded-lg hover:bg-blue-50 transition-colors",onClick:()=>V(!0),children:[f.jsx(qf,{className:"mr-2 text-blue-600"})," Add Interior"]})]}),f.jsxs("select",{className:"border border-gray-300 p-2 rounded w-full text-sm sm:text-base opacity-80 focus:opacity-100 focus:ring-2 focus:ring-blue-400",value:a?JSON.stringify(a):"",onChange:fe=>n(fe.target.value?JSON.parse(fe.target.value):[]),children:[f.jsx("option",{value:"",children:"Select Interior Name (optional)"}),t.map((fe,Ee)=>f.jsx("option",{value:JSON.stringify(fe),children:fe[0]},Ee))]})]}),f.jsxs("div",{className:"flex flex-col w-full sm:w-1/2",children:[f.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-3 mb-2",children:[f.jsx("p",{className:"text-sm sm:text-base",children:"Select Sales Associate"}),f.jsxs("button",{className:"flex items-center px-3 py-1 border border-blue-400 text-blue-500 font-semibold rounded-lg hover:bg-blue-50 transition-colors",onClick:()=>z(!0),children:[f.jsx(qf,{className:"mr-2 text-blue-600"})," Add Sales Associate"]})]}),f.jsxs("select",{className:"border border-gray-300 p-2 rounded w-full text-sm sm:text-base opacity-80 focus:opacity-100 focus:ring-2 focus:ring-blue-400",value:s?JSON.stringify(s):"",onChange:fe=>o(fe.target.value?JSON.parse(fe.target.value):[]),children:[f.jsx("option",{value:"",children:"Select Sales Associate (optional)"}),r.map((fe,Ee)=>f.jsx("option",{value:JSON.stringify(fe),children:fe[0]},Ee))]})]})]}),f.jsxs("div",{className:"flex flex-col sm:flex-row w-full gap-4",children:[f.jsxs("div",{className:"flex flex-col w-full sm:w-1/2",children:[f.jsx("p",{className:"text-sm sm:text-base",children:"Select User"}),f.jsx("input",{type:"text",className:"border border-gray-300 p-2 rounded w-full text-sm sm:text-base focus:ring-2 focus:ring-blue-400",value:x,onChange:fe=>v(fe.target.value)})]}),f.jsxs("div",{className:"flex flex-col w-full sm:w-1/2",children:[f.jsx("p",{className:"text-sm sm:text-base",children:"Project Deadline"}),f.jsx("input",{type:"date",className:"border border-gray-300 p-2 rounded w-full text-sm sm:text-base focus:ring-2 focus:ring-blue-400",value:g,onChange:fe=>w(fe.target.value)})]})]}),U&&f.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:f.jsxs("div",{className:"bg-white p-4 sm:p-6 rounded-xl shadow-xl w-full max-w-xs sm:max-w-md",children:[f.jsx("h2",{className:"text-lg sm:text-xl font-bold mb-4",children:"Add Interior"}),f.jsx("input",{className:"border border-gray-300 p-2 rounded w-full mb-3 text-sm sm:text-base focus:ring-2 focus:ring-blue-400",placeholder:"Name",value:F,onChange:fe=>Y(fe.target.value)}),f.jsx("input",{className:"border border-gray-300 p-2 rounded w-full mb-3 text-sm sm:text-base focus:ring-2 focus:ring-blue-400",placeholder:"Email",value:K,onChange:fe=>X(fe.target.value)}),f.jsx("input",{className:"border border-gray-300 p-2 rounded w-full mb-3 text-sm sm:text-base focus:ring-2 focus:ring-blue-400",placeholder:"Phone Number",value:Z,onChange:fe=>ce(fe.target.value)}),f.jsx("input",{className:"border border-gray-300 p-2 rounded w-full mb-3 text-sm sm:text-base focus:ring-2 focus:ring-blue-400",placeholder:"Address",value:te,onChange:fe=>Q(fe.target.value)}),f.jsxs("div",{className:"flex justify-end gap-2",children:[f.jsx("button",{className:"px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors text-sm sm:text-base",onClick:()=>V(!1),children:"Cancel"}),f.jsx("button",{className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors text-sm sm:text-base",onClick:ve,children:"Save"})]})]})}),I&&f.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",children:f.jsxs("div",{className:"bg-white p-4 sm:p-6 rounded-xl shadow-xl w-full max-w-xs sm:max-w-md",children:[f.jsx("h2",{className:"text-lg sm:text-xl font-bold mb-4",children:"Add Sales Associate"}),f.jsx("input",{className:"border border-gray-300 p-2 rounded w-full mb-3 text-sm sm:text-base focus:ring-2 focus:ring-blue-400",placeholder:"Name",value:G,onChange:fe=>ye(fe.target.value)}),f.jsx("input",{className:"border border-gray-300 p-2 rounded w-full mb-3 text-sm sm:text-base focus:ring-2 focus:ring-blue-400",placeholder:"Email",value:D,onChange:fe=>O(fe.target.value)}),f.jsx("input",{className:"border border-gray-300 p-2 rounded w-full mb-3 text-sm sm:text-base focus:ring-2 focus:ring-blue-400",placeholder:"Phone Number",value:L,onChange:fe=>q(fe.target.value)}),f.jsx("input",{className:"border border-gray-300 p-2 rounded w-full mb-3 text-sm sm:text-base focus:ring-2 focus:ring-blue-400",placeholder:"Address",value:oe,onChange:fe=>be(fe.target.value)}),f.jsxs("div",{className:"flex justify-end gap-2",children:[f.jsx("button",{className:"px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors text-sm sm:text-base",onClick:()=>z(!1),children:"Cancel"}),f.jsx("button",{className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors text-sm sm:text-base",onClick:ue,children:"Save"})]})]})})]})},Vg=({options:e,value:t,onChange:r,placeholder:a,name:n})=>{const[s,o]=P.useState(!1),[c,u]=P.useState(""),[h,p]=P.useState(e),x=P.useRef(null);P.useEffect(()=>{p(e.filter(g=>g[0].toLowerCase().includes(c.toLowerCase())))},[c,e]),P.useEffect(()=>{const g=w=>{x.current&&!x.current.contains(w.target)&&(o(!1),u(""))};return document.addEventListener("mousedown",g),()=>{document.removeEventListener("mousedown",g)}},[]);const v=g=>{r({target:{value:g[0]}}),o(!1),u("")};return f.jsxs("div",{className:"relative w-full",ref:x,children:[f.jsx("input",{type:"text",value:c||t,onChange:g=>u(g.target.value),onFocus:()=>o(!0),placeholder:a,className:"border p-2 sm:p-3 rounded w-full text-sm sm:text-base focus:ring-2 focus:ring-blue-400"}),s&&f.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border rounded-lg shadow-lg max-h-60 overflow-y-auto",children:h.length>0?h.map((g,w)=>f.jsx("div",{className:"p-2 hover:bg-gray-100 cursor-pointer",onClick:()=>v(g),children:g[0]},w)):f.jsx("div",{className:"p-2 text-gray-500",children:"No results found"})})]})},MA=({selections:e,availableAreas:t,availableProductGroups:r,availableCompanies:a,catalogueData:n,designNo:s,handleAddArea:o,handleRemoveArea:c,handleAreaChange:u,handleAddNewGroup:h,handleProductGroupChange:p,handleCompanyChange:x,handleCatalogueChange:v,handleDesignNoChange:g,handleReferenceChange:w,handleGroupDelete:b,projectData:N,setAvailableAreas:_,singleItems:E})=>{const j=wa(),[M,U]=P.useState([]);P.useEffect(()=>{const Ee=[...r,...E];U(Ee)},[r,E]);const V=async()=>{try{const Ee=await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/getCompany",{credentials:"include"});if(!Ee.ok)throw new Error(`HTTP error! Status: ${Ee.status}`);const J=await Ee.json();return Array.isArray(J.body)?J.body:[]}catch(Ee){return console.error("Error fetching company data:",Ee),[]}},I=async()=>{try{const Ee=await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/getDesign",{credentials:"include"});if(!Ee.ok)throw new Error(`HTTP error! Status: ${Ee.status}`);const J=await Ee.json();return Array.isArray(J.body)?J.body:[]}catch(Ee){return console.error("Error fetching brand data:",Ee),[]}},z=ur(Ee=>Ee.data.companyData);ur(Ee=>Ee.data.designData);const H=3600*1e3;((Ee,J,Pe)=>{P.useEffect(()=>{const st=async(ke,de,rt)=>{const Ue=localStorage.getItem(ke),Xe=Date.now();if(Ue){const{data:ot,time:ut}=JSON.parse(Ue);if(Xe-ut<H){Ee(rt(ot));return}}try{const ot=await de();Ee(rt(ot)),localStorage.setItem(ke,JSON.stringify({data:ot,time:Xe}))}catch(ot){console.error(`Failed to fetch ${ke}:`,ot)}};st("companyData",V,J),st("designData",I,Pe)},[Ee])})(j,wb,hC);const[R,F]=P.useState(!1),[Y,K]=P.useState(!1),[X,Z]=P.useState(!1);async function ce(){try{const Ee=await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/getcatalogues",{credentials:"include"});if(!Ee.ok)throw new Error(`HTTP error! Status: ${Ee.status}`);const J=await Ee.json();return Array.isArray(J.body)?J.body:[]}catch(Ee){return console.error("Error fetching catalogues:",Ee),[]}}const te=async Ee=>{if((await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/addArea",{method:"POST",credentials:"include",headers:{"content-type":"application/json"},body:JSON.stringify({name:Ee})})).status===200){const Pe=[...t];Pe.push([Ee]),_(Pe),alert("Area Added")}else alert("Error")},[Q,G]=P.useState(""),[ye,D]=P.useState(""),[O,L]=P.useState(""),[q,oe]=P.useState(""),be=async()=>{if((await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/addcatalogue",{method:"POST",credentials:"include",headers:{"content-type":"application/json"},body:JSON.stringify({catalogueName:Q,description:ye})})).status===200){const J=await ce();j(Fv(J)),localStorage.setItem("catalogueData",JSON.stringify({data:J,time:Date.now()})),G(""),D(""),K(!1),alert("Catalogue Added")}else alert("Error")},ve=async()=>{if((await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/sendCompany",{method:"POST",credentials:"include",headers:{"content-type":"application/json"},body:JSON.stringify({companyName:O,date:new Date})})).status===200){const Pe=await V();j(wb(Pe)),localStorage.setItem("companyData",JSON.stringify({data:Pe,time:Date.now()})),F(!1),alert("Company Added")}else alert("Error")},[ue,fe]=P.useState("");return f.jsxs("div",{className:"flex flex-col bg-white p-4 sm:p-6 rounded-lg shadow-lg",children:[f.jsx("p",{className:"text-lg sm:text-xl font-semibold",children:"Material Selection"}),f.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 sm:gap-5",children:[f.jsxs("div",{className:"w-full sm:w-1/4",children:[f.jsx("p",{className:"text-sm sm:text-base",children:"Area"}),e.map((Ee,J)=>{const Pe=Ee.area||"";return f.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-2 mb-4",children:[f.jsx("div",{className:"flex flex-col gap-2 w-full",children:f.jsxs("select",{className:"border border-black opacity-50 p-2 sm:p-3 rounded-lg w-full text-sm sm:text-base focus:ring-2 focus:ring-blue-400",value:Pe,onChange:st=>{if(st.target.value==="__add_new__"){const ke=prompt("Enter new Area name:");ke&&ke.trim()!==""&&(te(ke.trim()),u(J,ke.trim()))}else u(J,st.target.value)},children:[f.jsx("option",{value:"",children:"Select Area"}),f.jsx("option",{value:"__add_new__",children:"➕ Add New Space"}),t.map(st=>f.jsx("option",{value:st,children:st[0]},st))]})}),f.jsx("button",{className:"text-red-500 hover:text-red-700 mt-2 sm:mt-0",onClick:()=>c(J),children:f.jsx(Uc,{size:18})})]},J)}),f.jsxs("button",{className:"flex flex-row gap-2 !rounded-md bg-sky-50 hover:bg-sky-100 items-center px-2 py-1 text-sm sm:text-base",onClick:o,children:[f.jsx(qf,{className:"text-sky-500"}),"Add Area"]})]}),f.jsxs("div",{className:"w-full sm:w-3/4",children:[f.jsx("div",{className:"flex flex-row items-center justify-between",children:f.jsx("p",{className:"text-sm sm:text-base",children:"Select Product Groups"})}),e.map((Ee,J)=>f.jsxs("div",{className:"mb-4 border p-3 rounded-lg shadow-sm bg-gray-50",children:[f.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center",children:[f.jsx("p",{className:"text-base sm:text-lg font-medium",children:Ee.area}),f.jsx("button",{className:"mt-2 sm:mt-0 !rounded-md px-3 py-2 text-sm sm:text-base text-white bg-sky-600 hover:bg-sky-700",onClick:()=>h(J),children:"Add New Group"})]}),Ee.area?Ee.areacollection.map((Pe,st)=>f.jsx("div",{className:"mt-3 border p-3 rounded-lg shadow-sm bg-gray-50",children:f.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-3 sm:gap-4",children:[f.jsxs("div",{className:"flex flex-col w-full sm:w-1/5",children:[f.jsx("p",{className:"text-sm sm:text-base",children:"Product Group / Items"}),f.jsx(Vg,{options:M,value:Pe.productGroup,onChange:ke=>p(J,st,ke.target.value),placeholder:"Select Product Group",name:"productGroup"})]}),f.jsxs("div",{children:[f.jsxs("div",{className:"flex flex-row gap-3",children:[f.jsx("p",{className:"",children:"Company"}),f.jsx("button",{className:"mb-3",onClick:()=>F(!0),children:f.jsx("span",{className:"mr-2 flex justify-center w-6 h-6 border-2 border-blue-500 rounded-full text-lg leading-none text-blue-600",children:"+"})})]}),f.jsx(Vg,{options:z,value:Pe.company,onChange:ke=>x(J,st,ke.target.value),placeholder:"Select Company",name:"company"})]}),f.jsxs("div",{children:[f.jsxs("div",{className:"flex flex-row gap-3",children:[f.jsx("p",{className:"",children:"Catalogue"}),f.jsx("button",{className:"mb-3",onClick:()=>K(!0),children:f.jsx("span",{className:"mr-2 flex justify-center w-6 h-6 border-2 border-blue-500 rounded-full text-lg leading-none text-blue-600",children:"+"})})]}),f.jsx(Vg,{options:n,value:Pe.catalogue,onChange:ke=>v(J,st,ke.target.value),placeholder:"Select Catalogue",name:"catalogue"})]}),f.jsxs("div",{children:[f.jsx("div",{className:"flex flex-row gap-3",children:f.jsx("p",{className:"",children:"Design No."})}),f.jsx("input",{type:"text",placeholder:"Design No",value:ue,onChange:ke=>{g(J,st,ke.target.value),fe(ke.target.value)},className:"border rounded-lg pl-2 py-2 w-24"})]}),f.jsxs("div",{className:"flex flex-col w-full sm:w-1/5",children:[f.jsx("p",{className:"text-sm sm:text-base",children:"Reference/Notes"}),f.jsx("input",{type:"text",value:Pe.reference,placeholder:"Enter reference...",onChange:ke=>w(J,st,ke.target.value),className:"border p-2 sm:p-3 rounded w-full text-sm sm:text-base"})]}),f.jsxs("div",{className:"flex flex-col w-full sm:w-auto",children:[f.jsx("p",{className:"text-sm sm:text-base sm:block hidden",children:"Delete"}),f.jsx("button",{onClick:ke=>b(J,st),className:"text-red-600 hover:text-red-800 p-1",children:f.jsx(Uc,{size:16})})]})]})},st)):f.jsx("div",{})]},J))]})]}),R&&f.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center backdrop-blur-sm bg-black/50",children:f.jsxs("div",{className:"w-[300px] p-6 rounded-xl shadow-xl text-center bg-white",children:[f.jsx("p",{className:"text-[1.3vw]",children:"Add Company"}),f.jsx("input",{type:"text",value:O,onChange:Ee=>L(Ee.target.value),className:"w-full rounded-lg border p-2 pl-2 mb-3"}),f.jsxs("div",{className:"w-full flex flex-row justify-between",children:[f.jsx("button",{style:{borderRadius:"6px"},onClick:ve,className:"px-2 py-1 text-white bg-sky-600 hover:bg-sky-700",children:"Add"}),f.jsx("button",{onClick:()=>F(!1),className:"px-3 py-1 bg-red-500 text-white rounded hover:bg-red-600",children:"Close"})]})]})}),Y&&f.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center backdrop-blur-sm bg-black/50",children:f.jsxs("div",{className:"w-[300px] p-6 rounded-xl shadow-xl text-center bg-white",children:[f.jsx("p",{className:"text-[1.3vw]",children:"Add Catalogue"}),f.jsx("input",{type:"text",value:Q,onChange:Ee=>G(Ee.target.value),className:"w-full rounded-lg border p-2 pl-2 mb-3",placeholder:"Name"}),f.jsx("input",{type:"text",value:ye,onChange:Ee=>D(Ee.target.value),className:"w-full rounded-lg border p-2 pl-2 mb-3",placeholder:"Description"}),f.jsxs("div",{className:"w-full flex flex-row justify-between",children:[f.jsx("button",{onClick:be,style:{borderRadius:"6px"},className:"px-2 py-1 text-white bg-sky-600 hover:bg-sky-700",children:"Add"}),f.jsx("button",{onClick:()=>K(!1),className:"px-3 py-1 bg-red-500 text-white rounded hover:bg-red-600",children:"Close"})]})]})}),X&&f.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center backdrop-blur-sm bg-black/50",children:f.jsxs("div",{className:"w-[300px] p-6 rounded-xl shadow-xl text-center bg-white",children:[f.jsx("p",{className:"text-[1.3vw]",children:"Add Design No"}),f.jsx("input",{type:"text",value:q,onChange:Ee=>oe(Ee.target.value),className:"w-full rounded-lg border p-2 pl-2 mb-3"}),f.jsxs("div",{className:"w-full flex flex-row justify-between",children:[f.jsx("button",{style:{borderRadius:"6px"},onClick:addDesign,className:"px-2 py-1 text-white bg-sky-600 hover:bg-sky-700",children:"Add"}),f.jsx("button",{onClick:()=>Z(!1),className:"px-3 py-1 bg-red-500 text-white rounded hover:bg-red-600",children:"Close"})]})]})})]})},IA=({selections:e,units:t,handleRemoveArea:r,handleReferenceChange:a,handleunitchange:n,handlewidthchange:s,handleheightchange:o,handlequantitychange:c,setSelections:u,handleGroupDelete:h})=>f.jsxs("div",{className:"rounded-lg border shadow-2xl w-full flex flex-col p-4 sm:p-6",children:[f.jsx("p",{className:"text-lg sm:text-xl font-semibold",children:"Measurements"}),f.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 sm:gap-4",children:[f.jsxs("div",{className:"flex flex-col border rounded-lg w-full sm:w-1/4",children:[f.jsx("p",{className:"pl-4 pt-2 text-sm sm:text-base",children:"Area"}),e.map((p,x)=>f.jsxs("div",{className:"flex items-center pl-4 py-2",children:[f.jsx("p",{className:"text-sm sm:text-base",children:p.area}),f.jsx("button",{className:`${p.area==""?"hidden":""} ml-2 text-red-500 hover:text-red-700`,onClick:()=>r(x),children:f.jsx(Uc,{})})]},x))]}),f.jsxs("div",{className:"w-full sm:w-3/4 flex flex-col border rounded-lg",children:[f.jsxs("div",{className:"flex flex-col sm:flex-row p-2 gap-3 items-start sm:items-center",children:[f.jsx("p",{className:"text-sm sm:text-base mt-2",children:"Default Unit"}),f.jsx("div",{className:"flex items-center gap-2 w-full sm:w-auto",children:f.jsx("select",{className:"border border-gray-300 p-2 rounded-lg w-full text-sm sm:text-base focus:ring-2 focus:ring-blue-400",value:"",children:t.map(p=>f.jsx("option",{value:p,children:p},p))})})]}),f.jsx("div",{className:"flex flex-col p-3 gap-4 w-full",children:e.map((p,x)=>f.jsxs("div",{className:"flex flex-col gap-2 w-full",children:[f.jsx("p",{className:"text-base sm:text-lg font-medium",children:p.area}),f.jsx("div",{className:"flex flex-col gap-4 w-full",children:p.areacollection.map((v,g)=>f.jsxs("div",{className:"flex flex-col sm:flex-row p-3 border rounded-lg md:gap-3 sm:gap-4 w-full justify-between",children:[f.jsxs("div",{className:"flex flex-row w-full sm:gap-4 md:gap-2",children:[f.jsxs("div",{className:"flex flex-col gap-2 w-full sm:w-1/5",children:[f.jsx("p",{className:"text-sm sm:text-base",children:"Product Group"}),f.jsx("input",{type:"text",className:"w-full rounded-lg border px-2 py-2 text-sm sm:text-base",value:v.productGroup[0]})]}),f.jsxs("div",{className:"flex flex-col gap-2 w-full sm:w-1/5",children:[f.jsx("p",{className:"text-sm sm:text-base",children:"Reference"}),f.jsx("input",{type:"text",onChange:w=>a(x,g,w.target.value),className:"w-full rounded-lg border px-2 py-2 text-sm sm:text-base",value:v.reference})]}),f.jsxs("div",{className:"flex flex-col gap-2 w-full sm:w-1/5",children:[f.jsx("p",{className:"text-sm sm:text-base",children:"Measurement"}),f.jsx("select",{onChange:w=>n(x,g,w.target.value),className:"border border-gray-300 p-2 rounded-lg w-full text-sm sm:text-base focus:ring-2 focus:ring-blue-400",value:v.measurement.unit==null?"":v.measurement.unit,children:t.map(w=>f.jsx("option",{value:w,children:w},w))})]}),f.jsxs("div",{className:"flex flex-col gap-2 w-full sm:w-1/6",children:[f.jsx("p",{className:"text-sm sm:text-base",children:"Width"}),f.jsx("input",{onChange:w=>s(x,g,w.target.value),type:"number",className:"w-full rounded-lg border px-2 py-2 text-sm sm:text-base",value:v.measurement.width})]}),f.jsxs("div",{className:"flex flex-col gap-2 w-full sm:w-1/6",children:[f.jsx("p",{className:"text-sm sm:text-base",children:"Height"}),f.jsx("input",{onChange:w=>o(x,g,w.target.value),type:"number",className:"w-full rounded-lg border px-2 py-2 text-sm sm:text-base",value:v.measurement.height})]}),f.jsxs("div",{className:"flex flex-col gap-2 w-full sm:w-1/6",children:[f.jsx("p",{className:"text-sm sm:text-base",children:"Quantity"}),f.jsx("input",{type:"number",onChange:w=>c(x,g,w.target.value),className:"w-full rounded-lg border px-2 py-2 text-sm sm:text-base",value:v.measurement.quantity})]})]}),f.jsx("div",{className:"flex flex-col gap-2 sm:w-1/6"})]},g))})]},x))})]})]})]}),tL=({addPayment:e,setAddPayment:t,Amount:r,Tax:a,Received:n,Discount:s,paymentData:o,deletePayment:c,setNavState:u,setEditPayments:h,setPaymentDate:p,setPaymentMode:x,setPayment:v,setPaymentRemarks:g,projectData:w})=>{const b=N=>{v(N[2]),p(N[3]),x(N[4]),g(N[5]),h(N),t(!0)};return f.jsxs("div",{className:`${e?"hidden":""} flex flex-col gap-3 mt-3 w-full`,children:[f.jsx("p",{className:"text-[1.3vw] font-semibold",children:"Payments"}),f.jsxs("div",{className:"flex flex-row w-full justify-between gap-3",children:[f.jsxs("div",{className:"border rounded-lg w-1/4 p-3",children:[f.jsx("p",{className:"text-[1.3vw] text-gray-500",children:"Total Amount"}),f.jsx("p",{className:"text-[1.3vw]",children:(r+a).toFixed(2)})]}),f.jsxs("div",{className:"border rounded-lg w-1/4 p-3",children:[f.jsx("p",{className:"text-[1.3vw] text-gray-500",children:"Payment Received"}),f.jsx("p",{className:"text-[1.3vw]",children:n})]}),f.jsxs("div",{className:"border rounded-lg w-1/4 p-3",children:[f.jsx("p",{className:"text-[1.3vw] text-gray-500",children:"Payment Due"}),f.jsx("p",{className:"text-[1.3vw]",children:(r+a-n-s).toFixed(2)})]}),f.jsxs("div",{className:"border rounded-lg w-1/4 p-3",children:[f.jsx("p",{className:"text-[1.3vw] text-gray-500",children:"Discount"}),f.jsx("p",{className:"text-[1.3vw]",children:s})]})]}),f.jsxs("div",{className:"flex flex-col w-full",children:[f.jsxs("div",{className:"flex flex-row justify-between",children:[f.jsx("p",{className:"text-[1.2vw] font-semibold",children:"Received Payments"}),f.jsx("button",{onClick:()=>t(!0),style:{borderRadius:"8px"},className:"shadow-xl hover:bg-sky-700 bg-sky-600 text-white px-2 h-8",children:"Add Payment"})]}),f.jsxs("table",{className:"w-full border border-gray-300",children:[f.jsx("thead",{children:f.jsxs("tr",{className:"bg-gray-100",children:[f.jsx("th",{className:"text-left p-2",children:"Amount Received"}),f.jsx("th",{className:"text-left p-2",children:"Received Date"}),f.jsx("th",{className:"text-left p-2",children:"Payment Mode"}),f.jsx("th",{className:"text-left p-2",children:"Remarks"}),f.jsx("th",{className:"text-left p-2",children:"Options"})]})}),f.jsx("tbody",{children:o==null?void 0:o.filter(N=>N[1]===w.projectName).map((N,_)=>f.jsxs("tr",{className:"border-t",children:[f.jsx("td",{className:"p-2",children:N[1]}),f.jsx("td",{className:"p-2",children:N[2]}),f.jsx("td",{className:"p-2",children:N[3]}),f.jsx("td",{className:"p-2",children:N[4]}),f.jsxs("td",{className:"flex flex-row gap-2 items-center mt-2",children:[f.jsx("button",{children:f.jsx(R1,{size:18,onClick:()=>b(N)})}),f.jsx("button",{onClick:()=>c(N[1],N[2],N[3],N[4]),children:f.jsx(Uc,{className:"text-red-500"})})]})]},_))})]})]}),f.jsxs("div",{className:"flex flex-row justify-between",children:[f.jsx("button",{onClick:()=>u("Tailors"),style:{borderRadius:"8px"},className:"rounded-lg border px-2 h-8 bg-white",children:"Back"}),f.jsx("button",{onClick:()=>u("Tasks"),style:{borderRadius:"8px"},className:"rounded-lg text-white border px-2 h-8 bg-sky-600",children:"Next"})]})]})},rL=({updateTailorRate:e,updateTailorRemark:t,updateTailorStatus:r,updateTailorData:a,tailors:n,selections:s,setNavState:o,statusArray:c,tailorsArray:u,setTailorsArray:h})=>f.jsxs("div",{className:"flex flex-col w-full justify-between gap-3 mt-3",children:[f.jsx("p",{className:"text-[1.3vw] font-semibold",children:"Tailors"}),f.jsxs("table",{className:"w-full",children:[f.jsx("thead",{children:f.jsxs("tr",{className:"text-center",children:[f.jsx("td",{className:"",children:"Sr.No."}),f.jsx("td",{className:"",children:"Product"}),f.jsx("td",{className:"",children:"Reference"}),f.jsx("td",{className:"",children:"Room"}),f.jsx("td",{className:"",children:"Width"}),f.jsx("td",{className:"",children:"Height"}),f.jsx("td",{className:"",children:"Parts/Sq.Ft"}),f.jsx("td",{className:"",children:"Rate"}),f.jsx("td",{className:"",children:"Tailor"}),f.jsx("td",{className:"",children:"Status"}),f.jsx("td",{className:"",children:"Remark"})]})}),f.jsx("tbody",{children:u!=null&&u.map((p,x)=>{var w,b,N;if(!p.item||p.item[2]!=="Tailoring")return null;const v=s[p.mainindex],g=v==null?void 0:v.areacollection[p.groupIndex];return f.jsxs("tr",{className:"text-center",children:[f.jsx("td",{children:x+1}),f.jsx("td",{children:p.item[0]}),f.jsx("td",{children:(g==null?void 0:g.reference)||"-"}),f.jsx("td",{children:(v==null?void 0:v.area)||"-"}),f.jsx("td",{children:(w=g==null?void 0:g.measurement)==null?void 0:w.width}),f.jsx("td",{children:(b=g==null?void 0:g.measurement)==null?void 0:b.height}),f.jsx("td",{children:(N=g==null?void 0:g.measurement)==null?void 0:N.quantity}),f.jsx("td",{children:f.jsx("input",{type:"text",className:"border rounded-lg pl-2 h-8 w-[6vw]",value:p.rate,onChange:_=>e(x,_.target.value)})}),f.jsx("td",{children:f.jsxs("select",{className:"border px-2 py-1 rounded mr-2",value:p.tailorData,onChange:_=>a(x,_.target.value),children:[f.jsx("option",{value:"",children:"Choose Tailor"}),n.map((_,E)=>f.jsx("option",{value:_,children:_[0]},E))]})}),f.jsx("td",{children:f.jsxs("select",{className:"border px-2 py-1 rounded mr-2",value:p.status,onChange:_=>r(x,_.target.value),children:[f.jsx("option",{value:"",children:"Pending"}),c.map((_,E)=>f.jsx("option",{value:_,children:_},E))]})}),f.jsx("td",{className:"py-3",children:f.jsx("input",{className:"border rounded-lg pl-2 h-8 w-[8vw]",type:"text",value:p.remark,onChange:_=>t(x,_.target.value)})})]},x)})})]}),f.jsxs("div",{className:"flex flex-row justify-between mt-4",children:[f.jsx("button",{onClick:()=>o("Goods"),className:"rounded-lg border px-4 py-2 bg-white",children:"Back"}),f.jsx("button",{onClick:()=>o("Payments"),className:"rounded-lg text-white border px-4 py-2 bg-sky-600",children:"Next"})]})]}),BA=({grandTotal:e,setGrandTotal:t,projectData:r,index:a,goBack:n,projects:s,Tax:o,setTax:c,Amount:u,setAmount:h,Discount:p,setDiscount:x})=>{const[v,g]=P.useState("Unsent"),[w,b]=P.useState("Overview"),[N,_]=P.useState("approved"),E=wa(),j=ur(Ae=>Ae.data.customers),M=ur(Ae=>Ae.data.interiors),U=ur(Ae=>Ae.data.salesAssociates),V=ur(Ae=>Ae.data.products),I=ur(Ae=>Ae.data.items),z=ur(Ae=>Ae.data.paymentData),H=ur(Ae=>Ae.data.tailors),re=ur(Ae=>Ae.data.catalogs),R=ur(Ae=>Ae.data.tasks);let F=["D Decor","Asian Paints","ZAMAN"];const Y=["514","98","123"],[K,X]=P.useState([]),[Z,ce]=P.useState(null),[te,Q]=P.useState([]),[G,ye]=P.useState([]),[D,O]=P.useState([]),[L,q]=P.useState([]),[oe,be]=P.useState([]),[ve,ue]=P.useState([]),[fe,Ee]=P.useState(void 0),[J,Pe]=P.useState([]),st=["Inches (in)","Centimeter (cm)","Meters (m)","Feet (ft)"],[ke,de]=P.useState([]),[rt,Ue]=P.useState([]),[Xe,ot]=P.useState([]),[ut,vt]=P.useState(""),[At,ct]=P.useState(""),[ze,pt]=P.useState(""),[Ot,It]=P.useState(""),[Lt,Ct]=P.useState(""),[wt,hr]=P.useState(""),zt=async()=>(await(await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/gettasks")).json()).body,Yt=async()=>{try{const Ae=await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/getcustomerdata",{credentials:"include"});if(!Ae.ok)throw new Error(`HTTP error! Status: ${Ae.status}`);const He=await Ae.json();return Array.isArray(He.body)?He.body:[]}catch(Ae){return console.error("Error fetching customer data:",Ae),[]}};async function Sr(){try{const Ae=await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/getcatalogues",{credentials:"include"});if(!Ae.ok)throw new Error(`HTTP error! Status: ${Ae.status}`);const He=await Ae.json();return Array.isArray(He.body)?He.body:[]}catch(Ae){return console.error("Error fetching catalogues:",Ae),[]}}async function Mr(){try{const Ae=await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/getinteriordata",{credentials:"include"});if(!Ae.ok)throw new Error(`HTTP error! Status: ${Ae.status}`);return(await Ae.json()).body}catch(Ae){return console.error("Error fetching interiors:",Ae),[]}}async function fa(){try{const Ae=await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/getsalesassociatedata",{credentials:"include"});if(!Ae.ok)throw new Error(`HTTP error! Status: ${Ae.status}`);const He=await Ae.json();return Array.isArray(He.body)?He.body:[]}catch(Ae){return console.error("Error fetching sales associates:",Ae),[]}}async function Ir(){try{const Ae=await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/getallproductgroup",{credentials:"include"});if(!Ae.ok)throw new Error(`HTTP error! Status: ${Ae.status}`);const He=await Ae.json();return Array.isArray(He.body)?He.body:[]}catch(Ae){return console.error("Error fetching product groups:",Ae),[]}}P.useEffect(()=>{const Ae=JSON.parse(JSON.stringify(r.allData||[])),He=JSON.parse(JSON.stringify(r.additionalItems||[]));de(Ae),ue(He),ce(r.customerLink),pt(r.createdBy),It(r.projectDate),Ct(r.additionalRequests),Ue(r.interiorArray),ot(r.salesAssociateArray),ct(r.projectReference),hr(r.projectAddres),Object.isFrozen(ve)&&console.log("frozen")},[r]),(()=>{const Ae=P.useCallback(async(He,tt,nt,Pt,Jt="")=>{try{let Wt=!0;if(Jt){const $t=localStorage.getItem(Jt);if($t){const{data:Xt,time:lr}=JSON.parse($t);Date.now()-lr<36e5?(E(tt(Xt)),nt&&nt(Xt),Wt=!1):localStorage.removeItem(Jt)}}if(Wt||Pt.length===0){const $t=await He();E(tt($t)),nt&&nt($t),Jt&&localStorage.setItem(Jt,JSON.stringify({data:$t,time:Date.now()}))}}catch(Dt){console.error(`Error fetching ${Jt||"data"}:`,Dt)}},[E]);P.useEffect(()=>{Ae(Mr,Lf,O,M,"interiorData"),Ae(async()=>(await(await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/getsingleproducts",{credentials:"include"})).json()).body||[],jc,Q,I,"itemsData"),Ae(fa,Vf,q,U,"salesAssociateData"),Ae(Ir,Cf,be,V,"productsData"),Ae(Sr,Fv,null,re,"catalogueData"),Ae(Yt,Lc,X,j,"customerData")},[Ae,M.length,I.length,U.length,V.length,re.length,j.length])})();const na=(Ae,He)=>{const tt=[...ke];tt[Ae]&&(tt[Ae].area=He),de(tt)},Ja=(Ae,He,tt)=>{const nt=[...ke];nt[Ae].areacollection||(nt[Ae].areacollection=[]),nt[Ae].areacollection[He]||(nt[Ae].areacollection[He]={productGroup:null,items:[],catalogue:[],company:null,designNo:null,reference:null,measurement:{unit:"Centimeter (cm)",width:void 0,height:void 0,quantity:void 0},totalAmount:[],totalTax:[],quantities:[]});const Pt=tt.split(",");nt[Ae].areacollection[He].productGroup=Pt;const Jt=Pt;if(!Array.isArray(Jt)||Jt.length<2)return;console.log(Jt);let Dt=Jt.length>2?Jt.slice(1,-1):null,Wt=null;console.log(Dt),Dt!=null?Wt=Dt.map(Er=>I.find(Ga=>Ga[0]===Er)).filter(Er=>Array.isArray(Er)):Wt=[tt],console.log(Wt),Wt.length==0&&(Wt=[tt.split(",")]),console.log(Wt),nt[Ae].areacollection[He].items=Wt,de(nt);const $t=Ht.filter(Er=>!(Er.mainindex===Ae&&Er.groupIndex===He)),Xt=Wt.map(Er=>({mainindex:Ae,groupIndex:He,pg:Pt,date:"",status:"Pending",orderID:"",remark:"NA",item:Er}));Ft([...$t,...Xt]);const lr=ir.filter(Er=>!(Er.mainindex===Ae&&Er.groupIndex===He)),la=Wt.filter(Er=>Er[7]==!0).map((Er,Ga)=>({mainindex:Ae,groupIndex:He,pg:Pt,rate:0,tailorData:[""],status:"Pending",remark:"NA",item:Er}));Gt([...lr,...la])},Dn=(Ae,He,tt)=>{const nt=[...ke];nt[Ae].areacollection||(nt[Ae].areacollection=[]),nt[Ae].areacollection[He]||(nt[Ae].areacollection[He]={productGroup:null,items:[""],catalogue:[],company:null,designNo:null,reference:null,measurement:{unit:"Centimeter (cm)",width:void 0,height:void 0,quantity:void 0},additionalItems:[],totalAmount:[],totalTax:[]}),nt[Ae].areacollection[He].catalogue=tt.split(",").map(Pt=>Pt.trim()).filter(Pt=>Pt),de(nt),console.log(nt[Ae].areacollection[He].catalogue)},Br=(Ae,He,tt)=>{const nt=[...ke];nt[Ae].areacollection||(nt[Ae].areacollection=[]),nt[Ae].areacollection[He]||(nt[Ae].areacollection[He]={productGroup:null,items:[""],catalogue:null,company:null,designNo:null,reference:null,measurement:{unit:"Centimeter (cm)",width:void 0,height:void 0,quantity:void 0},additionalItems:[],totalAmount:[],totalTax:[]}),nt[Ae].areacollection[He].company=tt,de(nt)},sr=(Ae,He,tt)=>{const nt=[...ke];nt[Ae].areacollection||(nt[Ae].areacollection=[]),nt[Ae].areacollection[He]||(nt[Ae].areacollection[He]={productGroup:null,items:[""],catalogue:null,company:null,designNo:null,reference:null,measurement:{unit:"Centimeter (cm)",width:void 0,height:void 0,quantity:void 0},additionalItems:[],totalAmount:[],totalTax:[]}),nt[Ae].areacollection[He].designNo=tt,de(nt),console.log(nt)},kr=(Ae,He,tt)=>{const nt=[...ke];nt[Ae].areacollection||(nt[Ae].areacollection=[]),nt[Ae].areacollection[He]||(nt[Ae].areacollection[He]={productGroup:null,items:[""],catalogue:null,company:null,designNo:null,reference:null,measurement:{unit:"Centimeter (cm)",width:void 0,height:void 0,quantity:void 0},additionalItems:[],totalAmount:[],totalTax:[]}),nt[Ae].areacollection[He].reference=tt,de(nt)},As=(Ae,He="")=>{var Xt;const tt=[...ke];(Xt=tt[Ae])!=null&&Xt.areacollection||(tt[Ae].areacollection=[]);const nt=tt[Ae].areacollection.length,Pt=He?He.split(","):[],Dt=(Pt.length>2?Pt.slice(1,-2):[]).map(lr=>I.find(la=>la[0]===lr)).filter(lr=>Array.isArray(lr));tt[Ae].areacollection.push({productGroup:Pt,company:"",catalogue:[],designNo:"",reference:"",measurement:{unit:"Centimeter (cm)",width:void 0,height:void 0,quantity:void 0},items:Dt,additionalItems:[],totalAmount:[],totalTax:[]}),de(tt);const Wt=Dt.map(lr=>({mainindex:Ae,groupIndex:nt,pg:Pt,date:"",status:"Pending",orderID:"",remark:"NA",item:lr})),$t=Dt.filter(lr=>lr[2]==="Tailoring").map(lr=>({mainindex:Ae,groupIndex:nt,pg:Pt,rate:0,tailorData:[""],status:"Pending",remark:"NA",item:lr}));Ft(lr=>[...lr,...Wt]),Gt(lr=>[...lr,...$t])},ka=(Ae,He)=>{const tt=[...ke];tt[Ae].areacollection[He]&&tt[Ae].areacollection.splice(He,1),de(tt),Ft(nt=>nt.filter(Pt=>!(Pt.mainindex===Ae&&Pt.groupIndex===He))),Gt(nt=>nt.filter(Pt=>!(Pt.mainindex===Ae&&Pt.groupIndex===He))),console.log(Ht),console.log(ir)},Ea=()=>{de([...ke,{area:"",areacollection:[]}])},gn=Ae=>{const He=[...ke],tt=He[Ae];let nt=0;tt.areacollection.forEach(Wt=>{nt+=Wt.items.length});let Pt=0;for(let Wt=0;Wt<Ae;Wt++)ke[Wt].areacollection.forEach($t=>{Pt+=$t.items.length});const Jt=[...Ht],Dt=[...ir];Jt.splice(Pt,nt),Dt.splice(Pt,nt),Ft(Jt),Gt(Dt),de(He.filter((Wt,$t)=>$t!==Ae))},Qt=(Ae,He,tt)=>{const nt=[...ke];nt[Ae].areacollection[He].measurement.width=tt,de(nt)},Un=(Ae,He,tt)=>{const nt=[...ke];nt[Ae].areacollection[He].measurement.height=tt,de(nt)},[Vr,qa]=P.useState("cash"),qr=(Ae,He)=>{const tt=Ae.flatMap($t=>$t.areacollection.flatMap(Xt=>Xt.totalTax||[])),nt=Ae.flatMap($t=>$t.areacollection.flatMap(Xt=>Xt.totalAmount||[])),Pt=He.map($t=>parseFloat($t.taxAmount.toString())||0),Jt=He.map($t=>parseFloat($t.totalAmount.toString())||0),Dt=parseFloat([...tt,...Pt].reduce(($t,Xt)=>$t+Xt,0).toFixed(2)),Wt=parseFloat([...nt,...Jt].reduce(($t,Xt)=>$t+Xt,0).toFixed(2));return{totalTax:Dt,totalAmount:Wt}},ha=(Ae,He,tt)=>{const nt=[...ke],Pt=nt[Ae].areacollection[He];Pt.measurement.quantity=tt;const Jt=Vr==="cash"?`${discount}`:`${discount}%`,Dt=typeof Jt=="string"&&Jt.toString().includes("%"),Wt=parseFloat(Jt.toString().replace("%",""))||0;if(Pt.items!==void 0){Pt.totalTax||(Pt.totalTax=[]),Pt.totalAmount||(Pt.totalAmount=[]);let lr=0;Pt.items.forEach((Ga,vn)=>{var yn;const es=parseFloat((yn=Pt.quantities)==null?void 0:yn[vn])||0,Pn=parseFloat(Ga[4])||0;lr+=tt*es*Pn});const la=Dt?Wt:lr>0?Wt/lr*100:0,Er=Pt.items.map((Ga,vn)=>{var Fo;const es=parseFloat((Fo=Pt.quantities)==null?void 0:Fo[vn])||0,Pn=parseFloat(Ga[4])||0,yn=parseFloat(Ga[5])||0,js=tt*es*Pn,ts=js*la/100,Hn=js-ts,Cs=parseFloat((Hn*yn/100).toFixed(2)),Ds=parseFloat((Hn+Cs).toFixed(2));return Pt.totalTax[vn]=Cs,Pt.totalAmount[vn]=Ds,[...Ga.slice(0,6),Cs,Ds]});Pt.items=Er}de(nt);const{totalTax:$t,totalAmount:Xt}=qr(nt,ve);c($t),h(Xt),t(parseFloat((Xt+$t).toFixed(2)))},ne=(Ae,He,tt)=>{const nt=[...ke];nt[Ae].areacollection[He].measurement.unit=tt,de(nt)},[Ne,pe]=P.useState({}),[ge,Se]=P.useState(0),[_e,Ye]=P.useState(0),lt=async(Ae,He,tt,nt,Pt,Jt,Dt,Wt)=>{const $t=[...ke],Xt=$t[tt].areacollection[nt],lr=parseFloat(Pt)||0,la=parseFloat(He)||0;Xt.quantities||(Xt.quantities=[]),Xt.quantities[Wt]=He;const Er=Jt*lr*la;let Ga=0;if(Vr==="percent")Ga=p;else if(Vr==="cash"){const Ds=Er;Ga=Ds>0?p/Ds*100:0}const vn=Er*Ga/100,es=Er-vn,Pn=parseFloat((es*Dt/100).toFixed(2)),yn=parseFloat((es+Pn).toFixed(2));Xt.totalTax||(Xt.totalTax=[]),Xt.totalAmount||(Xt.totalAmount=[]),Xt.totalTax[Wt]=Pn,Xt.totalAmount[Wt]=yn,de($t);const{totalTax:js,totalAmount:ts}=qr($t,ve);c(js),h(ts);let Hn=0;Vr==="percent"?Hn=ts*p/100:Vr==="cash"&&(Hn=p);const Cs=parseFloat((ts+js-Hn).toFixed(2));t(Cs)},We=(Ae,He)=>{const tt=[...ve],nt=tt[Ae],Pt=parseFloat(He)||0;nt.quantity=Pt;const Jt=Pt*nt.rate;let Dt=0;if(Vr==="percent")Dt=p;else if(Vr==="cash"){const es=Jt;Dt=es>0?p/es*100:0}const Wt=Jt*Dt/100,$t=Jt-Wt,Xt=parseFloat(($t*nt.tax/100).toFixed(2)),lr=parseFloat(($t+Xt).toFixed(2));nt.netRate=parseFloat($t.toFixed(2)),nt.taxAmount=Xt,nt.totalAmount=lr,setAdditionalItems(tt);const{totalTax:la,totalAmount:Er}=qr(ke,tt);c(la),h(Er);let Ga=0;Vr==="percent"?Ga=Er*discount/100:Vr==="cash"&&(Ga=discount);const vn=parseFloat((Er+la-Ga).toFixed(2));t(vn)},$e=()=>{ue(Ae=>[...Ae,{name:"",quantity:0,rate:0,netRate:0,tax:0,taxAmount:0,totalAmount:0,remark:""}])},Qe=Ae=>{const He=[...ve];He.splice(Ae,1),setAdditionalItems(He);const{totalTax:tt,totalAmount:nt}=qr(ke,He);c(tt),h(nt);let Pt=0;Vr==="percent"?Pt=parseFloat((nt*discount/100).toFixed(2)):Vr==="cash"&&(Pt=discount);const Jt=parseFloat((nt+tt-Pt).toFixed(2));t(Jt)},[St,jt]=P.useState(0),[Ut,ie]=P.useState(0),Ce=(Ae,He)=>{const tt=[...ve];tt[Ae].name=He,ue(tt)},Oe=(Ae,He)=>{const tt=[...ve],nt=tt[Ae];nt.rate=parseFloat(He)||0;const Pt=nt.quantity*nt.rate,Jt=tt.reduce((la,Er)=>la+Er.quantity*Er.rate,0);let Dt=0;Vr==="percent"?Dt=discount:Vr==="cash"&&Jt>0&&(Dt=discount/Jt*100);const Wt=Pt*Dt/100,$t=Pt-Wt;nt.netRate=parseFloat($t.toFixed(2)),nt.taxAmount=parseFloat(($t*nt.tax/100).toFixed(2)),nt.totalAmount=parseFloat((nt.netRate+nt.taxAmount).toFixed(2)),tt[Ae]=nt,setAdditionalItems(tt);const{totalTax:Xt,totalAmount:lr}=qr(ke,tt);c(Xt),h(lr),t(parseFloat((Xt+lr).toFixed(2)))},Ve=(Ae,He)=>{const tt=[...ve],nt=tt[Ae];nt.tax=parseFloat(He)||0;const Pt=nt.quantity*nt.rate,Jt=tt.reduce((la,Er)=>la+Er.quantity*Er.rate,0);let Dt=0;Vr==="percent"?Dt=discount:Vr==="cash"&&Jt>0&&(Dt=discount/Jt*100);const Wt=Pt*Dt/100,$t=Pt-Wt;nt.netRate=parseFloat($t.toFixed(2)),nt.taxAmount=parseFloat(($t*nt.tax/100).toFixed(2)),nt.totalAmount=parseFloat((nt.netRate+nt.taxAmount).toFixed(2)),tt[Ae]=nt,setAdditionalItems(tt);const{totalTax:Xt,totalAmount:lr}=qr(ke,tt);c(Xt),h(lr),t(parseFloat((Xt+lr).toFixed(2)))},kt=(Ae,He)=>{const tt=[...ve];tt[Ae].remark=He,ue(tt)},[Ht,Ft]=P.useState([]),[ir,Gt]=P.useState([]);P.useEffect(()=>{const Ae=He=>JSON.parse(JSON.stringify(He));ue(Ae(r.additionalItems)),Ft(Ae(r.goodsArray)),Gt(Ae(r.tailorsArray)),console.log(r.goodsArray)},[r]);const[yr,Pr]=P.useState(null),[er,rr]=P.useState(null),Ur=(Ae,He)=>{let tt=[...Ht];tt[Ae].date=He,Ft(tt)},ja=(Ae,He)=>{let tt=[...Ht];tt[Ae].status=He,Ft(tt)},zn=(Ae,He)=>{let tt=[...Ht];tt[Ae].orderID=He,Ft(tt)},ei=(Ae,He)=>{let tt=[...Ht];tt[Ae].remark=He,Ft(tt)},[ti,Ka]=P.useState(0),[Aa,da]=P.useState(""),[ca,Kn]=P.useState(""),[ri,_s]=P.useState(""),[Ts,ai]=P.useState(!1),xl=async()=>(await(await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/getPayments")).json()).message,ks=async()=>(await(await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/gettailors")).json()).body;P.useRef(!1);const[vi,fs]=P.useState(!1);P.useEffect(()=>{let Ae=!0;return vi||(async()=>{try{const[tt,nt]=await Promise.all([xl(),ks()]);if(tt&&Ae){E(Kl(tt));const Pt=tt.reduce((Jt,Dt)=>{const[Wt,$t,Xt]=Dt;if($t===r.projectName){const lr=parseFloat(Xt);return Jt+(isNaN(lr)?0:lr)}return Jt},0);Ye(Pt)}nt&&Ae&&E(i1(nt)),Ae&&fs(!0)}catch(tt){console.error("❌ Failed to fetch payment or tailor data:",tt)}})(),()=>{Ae=!1}},[vi,E,r.projectName]),P.useEffect(()=>{async function Ae(){try{const He=localStorage.getItem("areasData"),tt=3600*1e3;if(He){const{data:Jt,time:Dt}=JSON.parse(He);if(Date.now()-Dt<tt){Pe(Jt);return}else localStorage.removeItem("areasData")}const Pt=await(await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/getAreas")).json();Pe(Pt.body),localStorage.setItem("areasData",JSON.stringify({data:Pt.body,time:Date.now()}))}catch(He){console.error("Error fetching areas:",He)}}J.length===0&&Ae()},[J.length]);const ao=async()=>{const Ae=typeof editProjects<"u",He=Ae?"https://sheeladecor.netlify.app/.netlify/functions/server/updateProjects":"https://sheeladecor.netlify.app/.netlify/functions/server/addPayment",tt=Ae?{customerName:r.customerLink[0],Name:r.projectName,Received:ti,ReceivedDate:Aa,PaymentMode:ca,Remarks:ri}:{customerName:r.customerLink[0],Name:r.projectName,Received:ti,ReceivedDate:Aa,PaymentMode:ca,Remarks:ri};try{(await fetch(He,{credentials:"include",method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(tt)})).status===200?(alert(Ae?"Payment updated":"Payment added"),ai(!1),Ka(0),da(""),Kn(""),_s(""),fs(Pt=>!Pt)):alert("Error")}catch(nt){console.error("Fetch error:",nt),alert("Network or server error")}},Zn=async(Ae,He,tt,nt)=>{(await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/deletePayment",{credentials:"include",method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({Name:r.projectName,Received:Ae,ReceivedDate:He,PaymentMode:tt,Remarks:nt})})).status==200?(alert("Deleted"),fs(!vi)):alert("Error")},[Qn,Fi]=P.useState("All Tasks"),no=["Pending","Ordered","Received","In Stock"],[on,tc]=P.useState([]);P.useEffect(()=>{const Ae=R.filter(He=>He[5]===r.projectName).filter(He=>Qn==="All Tasks"?!0:He[7]===Qn);tc(Ae)},[r]);const[ni,nr]=P.useState(!1),[$c,gl]=P.useState(null),[si,so]=P.useState("");P.useEffect(()=>{async function Ae(){const He=await zt();E(sl(He)),fs(!0)}vi||Ae()},[E,ni,vi]);const vl=async Ae=>{await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/deletetask",{method:"POST",headers:{"content-type":"application/json"},credentials:"include",body:JSON.stringify({title:Ae})}),fs(!1)},yi=["123123","!23123","!2312331"],Es=["asdasd","asasda"],rc=(Ae,He)=>{const tt=He.split(",").map(Pt=>Pt.trim()),nt=[...ir];nt[Ae].tailorData=tt,console.log(nt[Ae]),Gt(nt)},yl=(Ae,He)=>{const tt=[...ir];tt[Ae].rate=He,Gt(tt)},Xc=(Ae,He)=>{const tt=[...ir];tt[Ae].status=He,Gt(tt)},io=(Ae,He)=>{const tt=[...ir];tt[Ae].remark=He,Gt(tt)},wi=()=>{fe&&(Ka(0),da(""),Kn(""),_s("NA")),ai(!1)},Pi=(Ae,He)=>{x(Ae),qa(He);const tt=[...ke],nt=[...ve];tt.forEach($t=>{$t.areacollection.forEach(Xt=>{var vn,es;const lr=Xt.measurement.quantity||0;Xt.totalTax||(Xt.totalTax=[]),Xt.totalAmount||(Xt.totalAmount=[]);let la=0;(vn=Xt.items)==null||vn.forEach((Pn,yn)=>{var Hn;const js=parseFloat((Hn=Xt.quantities)==null?void 0:Hn[yn])||0,ts=parseFloat(Pn[4])||0;la+=lr*js*ts});const Ga=He==="percent"?Ae:la>0?Ae/la*100:0;Xt.items=(es=Xt.items)==null?void 0:es.map((Pn,yn)=>{var Po;const js=parseFloat((Po=Xt.quantities)==null?void 0:Po[yn])||0,ts=parseFloat(Pn[4])||0,Hn=parseFloat(Pn[5])||0,Cs=lr*js*ts,Ds=Cs*Ga/100,Fo=Cs-Ds,oo=parseFloat((Fo*Hn/100).toFixed(2)),lo=parseFloat((Fo+oo).toFixed(2));return Xt.totalTax[yn]=oo,Xt.totalAmount[yn]=lo,[...Pn.slice(0,6),oo,lo]})})});const Pt=nt.reduce(($t,Xt)=>$t+Xt.quantity*Xt.rate,0),Jt=He==="percent"?Ae:Pt>0?Ae/Pt*100:0;nt.forEach($t=>{const Xt=$t.quantity*$t.rate,lr=Xt*Jt/100,la=Xt-lr;$t.netRate=parseFloat(la.toFixed(2)),$t.taxAmount=parseFloat((la*$t.tax/100).toFixed(2)),$t.totalAmount=parseFloat(($t.netRate+$t.taxAmount).toFixed(2))}),de(tt),ue(nt);const{totalTax:Dt,totalAmount:Wt}=qr(tt,nt);c(Dt),h(Wt),t(parseFloat((Dt+Wt).toFixed(2)))},Fn=async()=>{const Ae=await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/getprojectdata",{credentials:"include"});if(!Ae.ok)throw new Error(`HTTP error! Status: ${Ae.status}`);const He=await Ae.json();if(!He.body||!Array.isArray(He.body))throw new Error("Invalid data format: Expected an array in data.body");const tt=(Dt,Wt)=>{try{return typeof Dt=="string"?JSON.parse(Dt):Dt||Wt}catch($t){return console.warn("Invalid JSON:",Dt,$t),Wt}},nt=Dt=>JSON.parse(JSON.stringify(Dt)),Pt=Dt=>{if(Array.isArray(Dt))return Dt;if(typeof Dt!="string")return[];try{const Wt=JSON.parse(Dt);return Array.isArray(Wt)?Wt:[]}catch{try{return Dt.replace(/^\[|\]$/g,"").split(",").map($t=>$t.trim().replace(/^"+|"+$/g,""))}catch{return[]}}};return He.body.map(Dt=>({projectName:Dt[0],customerLink:tt(Dt[1],[]),projectReference:Dt[2]||"",status:Dt[3]||"",totalAmount:parseFloat(Dt[4])||0,totalTax:parseFloat(Dt[5])||0,paid:parseFloat(Dt[6])||0,discount:parseFloat(Dt[7])||0,createdBy:Dt[8]||"",allData:nt(tt(Dt[9],[])),projectDate:Dt[10]||"",additionalRequests:tt(Dt[11],[]),interiorArray:Pt(Dt[12]),salesAssociateArray:Pt(Dt[13]),additionalItems:nt(tt(Dt[14],[])),goodsArray:nt(tt(Dt[15],[])),tailorsArray:nt(tt(Dt[16],[])),projectAddress:Dt[17],date:Dt[18],grandTotal:Dt[19]}))},hs=async()=>{try{const Ae=await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/updateprojectdata",{method:"POST",credentials:"include",headers:{"content-type":"application/json"},body:JSON.stringify({projectName:r.projectName,customerLink:JSON.stringify(Z),projectReference:At,status:N,totalAmount:u,totalTax:o,paid:ge,discount:p,createdBy:ze,allData:JSON.stringify(ke),projectDate:Ot,additionalRequests:Lt,interiorArray:JSON.stringify(rt),salesAssociateArray:JSON.stringify(Xe),additionalItems:JSON.stringify(ve),goodsArray:JSON.stringify(Ht),tailorsArray:JSON.stringify(ir),projectAddress:JSON.stringify(wt),grandTotal:e})});if(Ae.status===200){alert("Project Added");const He=await Fn();E(La(He)),localStorage.setItem("projectData",JSON.stringify({data:He,time:Date.now()}))}else{const He=await Ae.text();console.error("Error response:",He),alert("Error: Failed to add project")}}catch(Ae){console.error("Fetch error:",Ae),alert("Error: Network issue or server not responding")}};return f.jsx("div",{className:"p-6",children:f.jsxs("div",{className:"flex flex-col",children:[f.jsxs("div",{className:"flex flex-row justify-between items-center",children:[f.jsx("p",{className:"text-[1.4vw] font-semibold",children:"Order Overview"}),f.jsx("button",{onClick:n,className:"mb-4 px-3 py-1 text-white bg-red-500 rounded",children:"← Back"})]}),f.jsxs("div",{className:"flex flex-row w-[65vw] justify-between mb-3 bg-sky-50 px-2 py-2 rounded-lg",children:[f.jsx("button",{className:`text-[1vw] ${w=="Overview"?"text-sky-700 font-semibold":""}`,onClick:()=>b("Overview"),children:"Overview"}),f.jsx("button",{className:`text-[1vw] ${w=="Customer & Project Details"?"text-sky-700  font-semibold":""}`,onClick:()=>b("Customer & Project Details"),children:"Customer & Project Details"}),f.jsx("button",{className:`text-[1vw] ${w=="Material Selection"?"text-sky-700  font-semibold":""}`,onClick:()=>b("Material Selection"),children:"Material Selection"}),f.jsx("button",{className:`text-[1vw] ${w=="Measurement"?"text-sky-700  font-semibold":""}`,onClick:()=>b("Measurement"),children:"Measurement"}),f.jsx("button",{className:`text-[1vw] ${w=="Quotation"?"text-sky-700  font-semibold":""}`,onClick:()=>b("Quotation"),children:"Quotation"}),f.jsx("button",{className:`text-[1vw] ${w=="Goods"?"text-sky-700  font-semibold":""}`,onClick:()=>b("Goods"),children:"Goods"}),f.jsx("button",{className:`text-[1vw] ${w=="Tailors"?"text-sky-700  font-semibold":""}`,onClick:()=>b("Tailors"),children:"Tailors"}),f.jsx("button",{className:`text-[1vw] ${w=="Payments"?"text-sky-700  font-semibold":""}`,onClick:()=>b("Payments"),children:"Payments"}),f.jsx("button",{className:`text-[1vw] ${w=="Tasks"?"text-sky-700  font-semibold":""}`,onClick:()=>b("Tasks"),children:"Tasks"})]}),w=="Overview"&&f.jsxs("div",{className:"flex flex-col justify-between",children:[f.jsx(qP,{projectData:r,status:v,setStatus:g,tasks:R,setNavState:b,tailorsArray:ir,setTailorsArray:Gt,goodsArray:Ht,setGoodsArray:Ft,projectDate:Ot,setPRojectDate:It,interiorArray:rt,salesAssociateArray:Xe,projects:s,setAddPayment:ai,addPayment:Ts}),f.jsxs("div",{className:"flex flex-row justify-between mt-3",children:[f.jsx("button",{onClick:()=>b("Tasks"),style:{borderRadius:"8px"},className:"rounded-lg border px-2 h-8 bg-white",children:"Back"}),f.jsx("button",{onClick:()=>b("Customer & Project Details"),style:{borderRadius:"8px"},className:"rounded-lg text-white border px-2 h-8 bg-sky-600",children:"Next"})]})]}),w=="Customer & Project Details"&&f.jsxs("div",{className:"flex flex-col gap-3",children:[f.jsx(QP,{customers:K,selectedCustomer:Z,setSelectedCustomer:ce,projectData:r,setcustomers:X}),f.jsx(eL,{selectedCustomer:Z,interior:D,salesdata:L,interiorArray:rt,setInteriorArray:Ue,salesAssociateArray:Xe,setSalesAssociateArray:ot,projectName:ut,setProjectName:vt,projectReference:At,setProjectReference:ct,user:ze,setUser:pt,projectDate:Ot,setProjectDate:It,setAdditionalRequests:Ct,additionalRequests:Lt,projectData:r,setSalesData:q}),f.jsxs("div",{className:"flex flex-row justify-between",children:[f.jsx("button",{onClick:()=>b("Overview"),style:{borderRadius:"8px"},className:"rounded-lg border px-2 h-8 bg-white",children:"Back"}),f.jsx("button",{onClick:()=>b("Material Selection"),style:{borderRadius:"8px"},className:"rounded-lg text-white border px-2 h-8 bg-sky-600",children:"Next"})]})]}),w=="Material Selection"&&f.jsxs("div",{className:"flex flex-col gap-3",children:[f.jsx(MA,{selections:ke,availableAreas:J,availableProductGroups:oe,availableCompanies:F,catalogueData:re,designNo:Y,handleAddArea:Ea,handleRemoveArea:gn,handleAreaChange:na,handleAddNewGroup:As,handleProductGroupChange:Ja,handleCompanyChange:Br,handleCatalogueChange:Dn,handleDesignNoChange:sr,handleReferenceChange:kr,handleGroupDelete:ka,projectData:r,setAvailableAreas:Pe,singleItems:te}),f.jsxs("div",{className:"flex flex-row justify-between",children:[f.jsx("button",{onClick:()=>b("Customer & Project Details"),style:{borderRadius:"8px"},className:"rounded-lg border px-2 h-8 bg-white",children:"Back"}),f.jsx("button",{onClick:()=>b("Measurement"),style:{borderRadius:"8px"},className:"rounded-lg text-white border px-2 h-8 bg-sky-600",children:"Next"})]})]}),w=="Measurement"&&f.jsxs("div",{className:"flex flex-col gap-3",children:[f.jsx(IA,{selections:ke,units:st,handleRemoveArea:gn,handleReferenceChange:kr,handleunitchange:ne,handlewidthchange:Qt,handleheightchange:Un,handlequantitychange:ha}),f.jsxs("div",{className:"flex flex-row justify-between",children:[f.jsx("button",{onClick:()=>b("Material Selection"),style:{borderRadius:"8px"},className:"rounded-lg border px-2 h-8 bg-white",children:"Back"}),f.jsx("button",{onClick:()=>b("Quotation"),style:{borderRadius:"8px"},className:"rounded-lg text-white border px-2 h-8 bg-sky-600",children:"Next"})]})]}),w=="Quotation"&&f.jsxs("div",{className:"flex flex-col gap-3",children:[f.jsxs("div",{className:"flex flex-col p-6 border rounded-lg w-full shadow-2xl",children:[f.jsx("p",{className:"text-[1.1vw]",children:"Quotation"}),f.jsx("div",{className:"flex flex-col gap-3 w-full",children:ke.map((Ae,He)=>f.jsxs("div",{className:"w-full",children:[f.jsx("p",{className:"text-[1.1vw] font-semibold mb-2",children:Ae.area}),f.jsxs("table",{className:"w-full border-collapse mb-6 text-[0.95vw]",children:[f.jsx("thead",{children:f.jsxs("tr",{className:"flex justify-between w-full bg-gray-100 p-2 border-b font-semibold",children:[f.jsx("td",{className:"w-[10%]",children:"Sr. No."}),f.jsx("td",{className:"w-[45%]",children:"Product Name"}),f.jsx("td",{className:"w-[45%]",children:"Size"}),f.jsx("td",{className:"w-[20%]",children:"MRP"}),f.jsx("td",{className:"w-[20%]",children:"Quantity"}),f.jsx("td",{className:"w-[20%]",children:"Subtotal"}),f.jsx("td",{className:"w-[20%]",children:"Tax Rate (%)"}),f.jsx("td",{className:"w-[20%]",children:"Tax Amount"}),f.jsx("td",{className:"w-[20%]",children:"Total"})]})}),f.jsx("tbody",{children:Ae.areacollection&&Ae.areacollection.length>0?Ae.areacollection.map((tt,nt)=>Array.isArray(tt.items)?tt.items.map((Pt,Jt)=>{var $t,Xt;const Dt=`${He}-${nt}-${Jt}`,Wt=(($t=tt.quantities)==null?void 0:$t[Jt])||0;return f.jsxs("tr",{className:"flex flex-col sm:flex-row justify-between w-full border-b p-2 sm:p-4",children:[f.jsx("td",{className:"w-full sm:w-[10%] text-xs sm:text-sm",children:Jt+1}),f.jsx("td",{className:"w-full sm:w-[45%] text-xs sm:text-sm",children:Pt[0]+" * "+tt.measurement.quantity}),f.jsx("td",{className:"w-full sm:w-[45%] text-xs sm:text-sm",children:tt.measurement.width+" x "+tt.measurement.height+" "+tt.measurement.unit}),f.jsx("td",{className:"w-full sm:w-[20%] text-xs sm:text-sm",children:(Pt[4]*parseFloat(tt.measurement.quantity)).toFixed(2)}),f.jsx("td",{className:"w-full sm:w-[20%]",children:f.jsxs("div",{className:"flex flex-col",children:[f.jsx("input",{type:"text",value:((Xt=tt.quantities)==null?void 0:Xt[Jt])||"",onChange:lr=>lt(Dt,lr.target.value,He,nt,tt.measurement.quantity,Pt[4],Pt[5],Jt),className:"border w-full sm:w-2/5 px-2 py-1 rounded text-xs sm:text-sm"}),f.jsx("p",{className:"text-[10px] sm:text-xs text-gray-600",children:Pt[3]})]})}),f.jsx("td",{className:"w-full sm:w-[20%] text-xs sm:text-sm",children:(Pt[4]*parseFloat(tt.measurement.quantity)*Wt).toFixed(2)}),f.jsx("td",{className:"w-full sm:w-[20%] text-xs sm:text-sm",children:Pt[5]}),f.jsx("td",{className:"w-full sm:w-[20%] text-xs sm:text-sm",children:tt.totalTax[Jt]?tt.totalTax[Jt].toFixed(2):"0.00"}),f.jsx("td",{className:"w-full sm:w-[20%] text-xs sm:text-sm",children:tt.totalAmount[Jt]?tt.totalAmount[Jt].toFixed(2):"0.00"})]},Dt)}):f.jsx("tr",{children:f.jsxs("td",{colSpan:9,className:"text-center text-red-500 text-sm py-2",children:["No items found for collection ",nt+1]})},`error-${nt}`)):f.jsx("tr",{children:f.jsx("td",{colSpan:9,className:"text-center py-2 text-gray-500 text-sm sm:text-base",children:"No product data available."})})})]})]},He))}),f.jsxs("div",{className:"border p-6 rounded-lg w-full flex flex-col",children:[f.jsx("p",{className:"text-[1.1vw] font-semibold",children:"Miscellaneous"}),f.jsxs("div",{className:"flex w-full flex-col",children:[f.jsx("div",{className:"flex flex-row justify-between items-center mt-4",children:f.jsxs("button",{className:"flex flex-row gap-2 rounded-xl bg-sky-50 hover:bg-sky-100 items-center px-2 py-1",onClick:$e,children:[f.jsx(qf,{className:"text-sky-500 mt-1"}),"Add Item"]})}),f.jsxs("table",{className:"mt-3 w-full",children:[f.jsx("thead",{children:f.jsxs("tr",{className:"ml-3 flex text-[1.1vw] w-full justify-between",children:[f.jsx("td",{className:"w-[3vw]",children:"SR"}),f.jsx("td",{className:"w-[6vw]",children:"Item Name"}),f.jsx("td",{className:"w-[6vw]",children:"Quantity"}),f.jsx("td",{className:"w-[6vw]",children:"Rate"}),f.jsx("td",{className:"w-[6vw]",children:"Net Rate"}),f.jsx("td",{className:"w-[6vw]",children:"Tax (%)"}),f.jsx("td",{className:"w-[6vw]",children:"Tax Amount"}),f.jsx("td",{className:"w-[6vw]",children:"Total Amount"}),f.jsx("td",{className:"w-[6vw]",children:"Remark"}),f.jsx("td",{className:"w-[6vw]",children:"Actions"})]})}),f.jsx("tbody",{className:"flex flex-col w-full",children:ve.map((Ae,He)=>f.jsxs("tr",{className:"w-full flex flex-row justify-between mt-2",children:[f.jsx("td",{className:"text-center w-[3vw]",children:He+1}),f.jsx("td",{children:f.jsx("input",{onChange:tt=>Ce(He,tt.target.value),className:"pl-2 w-[6vw] border rounded-lg",value:Ae.name||"",type:"text"})}),f.jsx("td",{children:f.jsx("input",{onChange:tt=>We(He,tt.target.value),className:"pl-2 w-[6vw] border rounded-lg",value:Ae.quantity||"",type:"text"})}),f.jsx("td",{children:f.jsx("input",{onChange:tt=>Oe(He,tt.target.value),className:"pl-2 w-[6vw] border rounded-lg",value:Ae.rate||"",type:"text"})}),f.jsx("td",{className:"w-[6vw] text-center",children:Ae.netRate}),f.jsx("td",{children:f.jsx("input",{onChange:tt=>Ve(He,tt.target.value),className:"pl-2 w-[6vw] border rounded-lg",value:Ae.tax||"",type:"text"})}),f.jsx("td",{className:"w-[6vw] text-center",children:Ae.taxAmount||0}),f.jsx("td",{className:"w-[6vw] text-center",children:Ae.totalAmount||0}),f.jsx("td",{children:f.jsx("input",{onChange:tt=>kt(He,tt.target.value),className:"pl-2 w-[6vw] border rounded-lg",value:Ae.remark||"",type:"text"})}),f.jsx("td",{className:"w-[6vw] text-center",children:f.jsx("button",{onClick:()=>Qe(He),children:f.jsx(Uc,{className:"text-red-500 hover:text-red-600"})})})]},He))})]})]})]})]}),f.jsxs("div",{className:"flex flex-row gap-3 justify-between w-full",children:[f.jsxs("div",{className:"flex flex-col gap-2 w-1/2 rounded mt-3 p-6 shadow-xl border",children:[f.jsxs("div",{className:"flex flex-row justify-between",children:[f.jsxs("select",{className:"border p-2 rounded w-1/2 h-16",value:"",children:[f.jsx("option",{value:"",children:"Bank Details"}),yi.map((Ae,He)=>f.jsx("option",{value:Ae,children:Ae},He))]}),f.jsx("button",{children:f.jsx(qf,{size:18,className:"text-sky-600 hover:text-sky-800"})})]}),f.jsx("textarea",{placeholder:"Description",className:"w-full rounded-lg border py-2 pl-2"}),f.jsxs("select",{className:"border p-2 rounded w-1/2 h-16",value:"",children:[f.jsx("option",{value:"",children:"Terms & Conditions"}),Es.map((Ae,He)=>f.jsx("option",{value:Ae,children:Ae},He))]}),f.jsx("textarea",{placeholder:"Description",className:"w-full rounded-lg border py-2 pl-2"})]}),f.jsxs("div",{className:"shadow-xl p-6 flex flex-col gap-2 border w-1/2 rounded-lg",children:[f.jsx("p",{className:"text-[1.2vw]",children:"Summary"}),f.jsxs("div",{className:"flex flex-row justify-between w-full",children:[f.jsx("p",{className:"text-[1.1vw]",children:"Sub Total"}),f.jsx("p",{className:"text-[1.1vw]",children:u})]}),f.jsxs("div",{className:"flex flex-row justify-between w-full",children:[f.jsx("p",{className:"text-[1.1vw]",children:"Total Tax Amount"}),f.jsx("p",{className:"text-[1.1vw]",children:o})]}),f.jsxs("div",{className:"flex flex-row justify-between w-full",children:[f.jsx("p",{className:"text-[1.1vw]",children:"Total Amount"}),f.jsx("p",{className:"text-[1.1vw]",children:parseFloat((u+o).toFixed(2))})]}),f.jsx("div",{className:"border border-gray-400"}),f.jsxs("div",{className:"flex justify-between mt-1 w-full",children:[f.jsx("p",{className:"text-[1.1vw]",children:"Discount"}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsxs("select",{onChange:Ae=>qa(Ae.target.value),className:"border border-gray-300 rounded-md px-2 py-1 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[f.jsx("option",{value:"cash",children:"₹"}),f.jsx("option",{value:"percent",children:"%"})]}),f.jsx("input",{className:"w-24 border border-gray-300 rounded-md px-3 py-1 text-sm text-right focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:p,onChange:Ae=>{Pi(Ae.target.value,Vr)},type:"number",min:"0"})]})]}),f.jsx("div",{className:"border border-gray-400"}),f.jsxs("div",{className:"flex w-full flex-row items-center justify-between",children:[f.jsx("p",{className:"text-[1.1vw]",children:"Grand Total"}),f.jsx("p",{className:"text-[1.1vw]",children:e})]}),f.jsx("button",{onClick:hs,style:{borderRadius:"10px"},className:"rounded-lg bg-sky-700 hover:bg-sky-800 text-white p-[6px]",children:"Edit Project & Generate Quote"})]})]}),f.jsxs("div",{className:"flex flex-row justify-between",children:[f.jsx("button",{onClick:()=>b("Measurement"),style:{borderRadius:"8px"},className:"rounded-lg border px-2 h-8 bg-white",children:"Back"}),f.jsx("button",{onClick:()=>b("Goods"),style:{borderRadius:"8px"},className:"rounded-lg text-white border px-2 h-8 bg-sky-600",children:"Next"})]})]}),w=="Goods"&&f.jsxs("div",{className:"flex flex-col w-full gap-3 mt-3",children:[f.jsxs("div",{className:"w-full",children:[f.jsx("p",{className:"text-[1.3vw] font-semibold",children:"Goods"}),f.jsxs("table",{className:"w-full table-auto ",children:[f.jsxs("tr",{className:"bg-gray-100 text-center",children:[f.jsx("th",{children:"Sr.No."}),f.jsx("th",{children:"Area"}),f.jsx("th",{children:"Product Group"}),f.jsx("th",{children:"Company"}),f.jsx("th",{children:"Catalogue"}),f.jsx("th",{children:"Design No"}),f.jsx("th",{children:"Date"}),f.jsx("th",{children:"Status"}),f.jsx("th",{children:"Order ID"}),f.jsx("th",{children:"Remark"})]}),f.jsx("tbody",{children:Ht!=null&&Ht.map((Ae,He)=>{var Pt,Jt,Dt;const tt=ke[Ae.mainindex],nt=(Pt=tt==null?void 0:tt.areacollection)==null?void 0:Pt[Ae.groupIndex];return f.jsxs("tr",{className:"text-center rounded-md",children:[f.jsx("td",{children:He+1}),f.jsx("td",{children:(tt==null?void 0:tt.area)||""}),f.jsx("td",{children:((Jt=Ae==null?void 0:Ae.item)==null?void 0:Jt[0])||""}),f.jsx("td",{children:(nt==null?void 0:nt.company)||""}),f.jsx("td",{children:((Dt=nt==null?void 0:nt.catalogue)==null?void 0:Dt[0])||""}),f.jsx("td",{children:(nt==null?void 0:nt.designNo)||""}),f.jsx("td",{children:f.jsx("input",{type:"date",className:"border pl-2 rounded-lg w-[8vw] px-1 py-1 text-center mt-2",value:(Ae==null?void 0:Ae.date)||"",onChange:Wt=>Ur(He,Wt.target.value)})}),f.jsx("td",{children:f.jsxs("select",{className:"border px-2 py-1 mt-2 rounded w-full",value:(Ae==null?void 0:Ae.status)||"",onChange:Wt=>ja(He,Wt.target.value),children:[f.jsx("option",{value:"",children:"Pending"}),no.map((Wt,$t)=>f.jsx("option",{value:Wt,children:Wt},$t))]})}),f.jsx("td",{children:f.jsx("input",{type:"text",className:"border pl-2 rounded-lg w-[5vw] px-1 py-1 text-center mt-2",value:(Ae==null?void 0:Ae.orderID)||"",onChange:Wt=>zn(He,Wt.target.value)})}),f.jsx("td",{children:f.jsx("input",{type:"text",className:"border pl-2 rounded-lg w-[8vw] px-1 py-1 text-center mt-2",value:(Ae==null?void 0:Ae.remark)||"",onChange:Wt=>ei(He,Wt.target.value)})})]},He)})})]})]}),f.jsxs("div",{className:"flex flex-row justify-between",children:[f.jsx("button",{onClick:()=>b("Quotation"),style:{borderRadius:"8px"},className:"rounded-lg border px-2 h-8 bg-white",children:"Back"}),f.jsx("button",{onClick:()=>b("Tailors"),style:{borderRadius:"8px"},className:"rounded-lg text-white border px-2 h-8 bg-sky-600",children:"Next"})]})]}),w==="Tailors"&&f.jsx(rL,{updateTailorRate:yl,updateTailorRemark:io,updateTailorData:rc,updateTailorStatus:Xc,tailors:H,statusArray:no,selections:ke,setNavState:b,tailorsArray:ir,setTailorsArray:Gt}),w=="Payments"&&f.jsx(tL,{addPayment:Ts,setAddPayment:ai,Amount:u,Tax:o,Received:_e,Discount:p,paymentData:z,deletePayment:Zn,setNavState:b,setEditPayments:Ee,setPayment:Ka,setPaymentDate:da,setPaymentRemarks:_s,setPaymentMode:Kn,projectData:r}),Ts&&f.jsxs("div",{className:"flex flex-col z-50 justify-between gap-3 w-[50vw] border rounded-xl p-3",children:[f.jsxs("div",{className:"flex flex-col",children:[f.jsxs("div",{className:"flex flex-row gap-1",children:[f.jsx("p",{className:"text-[1.1vw]",children:"Amount Received"}),f.jsx("p",{className:"text-red-500",children:"*"})]}),f.jsx("input",{type:"text",value:ti,className:"border-1 rounded-lg pl-2 h-8",onChange:Ae=>Ka(Ae.target.value==""?0:parseFloat(Ae.target.value))})]}),f.jsxs("div",{className:"flex flex-col",children:[f.jsxs("div",{className:"flex flex-row gap-1",children:[f.jsx("p",{className:"text-[1.1vw]",children:"Payment Date"}),f.jsx("p",{className:"text-red-500",children:"*"})]}),f.jsx("input",{type:"date",value:Aa,className:"border-1 rounded-lg pl-2 h-8 pr-2",onChange:Ae=>da(Ae.target.value)})]}),f.jsxs("div",{className:"flex flex-col",children:[f.jsxs("div",{className:"flex flex-row gap-1",children:[f.jsx("p",{className:"text-[1.1vw]",children:"Payment Mode"}),f.jsx("p",{className:"text-red-500",children:"*"})]}),f.jsx("input",{type:"text",value:ca,className:"border-1 rounded-lg pl-2 h-8",onChange:Ae=>Kn(Ae.target.value)})]}),f.jsxs("div",{className:"flex flex-col",children:[f.jsxs("div",{className:"flex flex-row gap-1",children:[f.jsx("p",{className:"text-[1.1vw]",children:"Remarks"}),f.jsx("p",{className:"text-red-500",children:"*"})]}),f.jsx("input",{type:"text",value:ri,className:"border-1 rounded-lg pl-2 h-8",onChange:Ae=>_s(Ae.target.value)})]}),f.jsxs("div",{className:"flex flex-row justify-end gap-3",children:[f.jsx("button",{onClick:()=>{fe!=null&&Ee(void 0),wi()},style:{borderRadius:"8px"},className:"border-2 border-sky-700 text-sky-600 bg-white px-2 h-8",children:"Close"}),f.jsx("button",{onClick:()=>ao(),style:{borderRadius:"8px"},className:`${fe==null?"":"hidden"} text-white bg-sky-600 hover:bg-sky-700 px-2 h-8`,children:"Add Payment"}),f.jsx("button",{onClick:()=>ao(),style:{borderRadius:"8px"},className:`${fe!=null?"":"hidden"} text-white bg-sky-600 hover:bg-sky-700 px-2 h-8`,children:"Edit Payment"})]})]}),w=="Tasks"&&f.jsxs("div",{className:"flex flex-col w-full justify-between gap-3 mt-3 p-3",children:[f.jsxs("div",{className:"flex flex-row w-full justify-between items-center",children:[f.jsx("p",{className:"text-[1.4vw] font-semibold",children:"Tasks"}),f.jsx("button",{onClick:()=>nr(!0),style:{borderRadius:"8px"},className:"bg-sky-600 text-white hover:bg-sky-700 px-2 h-8",children:"Add Task"})]}),f.jsxs("div",{className:"flex flex-row gap-5",children:[f.jsxs("div",{className:"flex flex-col gap-3",children:[f.jsx("button",{onClick:()=>Fi("All Tasks"),className:" text-[1.1vw] text-gray-600 font-semibold",children:"All Tasks"}),f.jsx("div",{className:`${Qn!="All Tasks"?"bg-white":"bg-sky-500"} w-full h-[2px] rounded-full`})]}),f.jsxs("div",{className:"flex flex-col gap-3",children:[f.jsx("button",{onClick:()=>Fi("To Do"),className:"text-[1.1vw] text-gray-600 font-semibold",children:"To Do"}),f.jsx("div",{className:`${Qn!="To Do"?"bg-white":"bg-sky-500"} w-full h-[2px] rounded-full`})]}),f.jsxs("div",{className:"flex flex-col gap-3",children:[f.jsx("button",{onClick:()=>Fi("In Progress"),className:"text-[1.1vw] text-gray-600 font-semibold",children:"In Progress"}),f.jsx("div",{className:`${Qn!="In Progress"?"bg-white":"bg-sky-500"} w-full h-[2px] rounded-full`})]}),f.jsxs("div",{className:"flex flex-col gap-3",children:[f.jsx("button",{onClick:()=>Fi("Completed"),className:"text-[1.1vw] text-gray-600 font-semibold",children:"Completed"}),f.jsx("div",{className:`${Qn!="Completed"?"bg-white":"bg-sky-500"} w-full h-[2px] rounded-full`})]})]}),f.jsxs("table",{className:"w-full p-3",children:[f.jsx("thead",{children:f.jsxs("tr",{children:[f.jsx("td",{children:"Sr.No."}),f.jsx("td",{children:"Task Name"}),f.jsx("td",{children:"Priority"}),f.jsx("td",{children:"Project"}),f.jsx("td",{children:"Assignee"}),f.jsx("td",{children:"Due Date"}),f.jsx("td",{children:"Status"}),f.jsx("td",{children:"Created At"}),f.jsx("td",{children:"Actions"})]})}),f.jsx("tbody",{className:"overflow-y-scroll",children:on.map((Ae,He)=>f.jsxs("tr",{className:"max-h-fit border-b border-gray-200 py-3",children:[f.jsx("td",{className:"py-2",children:He+1}),f.jsx("td",{className:"py-2",children:Ae[0]}),f.jsx("td",{className:`py-2 font-semibold ${Ae[6]=="Low"?"text-green-600":""} ${Ae[6]=="Moderate"?"text-yellow-600":""} ${Ae[6]=="High"?"text-red-500":""}`,children:Ae[6]}),f.jsx("td",{className:"py-2",children:Ae[5]}),f.jsx("td",{className:"py-2",children:Ae[4]}),f.jsx("td",{className:"py-2",children:Ae[2]}),f.jsx("td",{className:`py-2 font-semibold ${Ae[7]=="Completed"?"text-green-600":""} ${Ae[7]=="In Progress"?"text-yellow-600":""} ${Ae[7]=="To Do"?"text-red-500":""}`,children:Ae[7]}),f.jsx("td",{className:"py-2",children:Ae[3]}),f.jsxs("td",{className:"flex flex-row gap-2 items-center py-2",children:[f.jsx("button",{onClick:()=>{so(Ae[0]),gl(Ae),nr(!0)},children:f.jsx(R1,{size:18})}),f.jsx("button",{onClick:()=>vl(Ae[0]),children:f.jsx(Uc,{size:18,className:"text-red-500"})})]})]},He))})]}),f.jsxs("div",{className:"flex flex-row justify-between",children:[f.jsx("button",{onClick:()=>b("Payments"),style:{borderRadius:"8px"},className:"rounded-lg border px-2 h-8 bg-white",children:"Back"}),f.jsx("button",{onClick:()=>b("Overview"),style:{borderRadius:"8px"},className:"rounded-lg text-white border px-2 h-8 bg-sky-600",children:"Next"})]})]}),f.jsx(qd,{children:ni&&f.jsxs(f.Fragment,{children:[f.jsx(ko.div,{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-40",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>nr(!1)}),f.jsx(ko.div,{className:"fixed inset-0 z-50 flex items-center justify-center",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.3},children:f.jsx(Vd,{onClose:()=>nr(!1),isEditing:$c,setediting:gl,name:si,projectData:s,setTaskDialogOpen:nr,taskDialogOpen:ni,setProjectFlag:ch,setAdded:fs})})]})})]})})},z4=async()=>{const t=await(await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/gettasks")).json();return t.body?t.body:[]},dd=async()=>{const t=await(await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/getInquiry")).json();return t.body?t.body:[]},aL=()=>{const[e,t]=P.useState(!1),[r,a]=P.useState(!1),[n,s]=P.useState(!1),[o,c]=P.useState(null),[u,h]=P.useState({project:"",comments:"",inquiryDate:"",followUpDate:"",customer:""}),p=async()=>{const Ue=u.project,Xe=u.comments,ot=u.inquiryDate,ut=u.followUpDate,vt=u.customer;if((await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/sendInquiry",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({projectName:Ue,comment:Xe,inquiryDate:ot,projectDate:ut,status:"New Inquiry",customer:vt})})).status===200){alert("Inquiry Added");const ct=await dd();x(fd(ct)),a(!1)}else alert("Error in adding inquiry")},x=wa(),v=ur(Ue=>Ue.data.tasks),[g,w]=P.useState([]),b=ur(Ue=>Ue.data.projects);ur(Ue=>Ue.data.paymentData),ur(Ue=>Ue.data.projects);const N=ur(Ue=>Ue.data.inquiry),[_,E]=P.useState(0),[j,M]=P.useState(0),[U,V]=P.useState(0),I=ua(),[z,H]=P.useState(null),[re,R]=P.useState(!1),[F,Y]=P.useState([]),[K,X]=P.useState(0),[Z,ce]=P.useState(0),[te,Q]=P.useState([]),[G,ye]=P.useState(!0),D=async Ue=>{try{if((await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/deletetask",{method:"POST",headers:{"content-type":"application/json"},credentials:"include",body:JSON.stringify({title:Ue})})).status===200){alert("Task deleted");const ut=(await z4()).sort((vt,At)=>new Date(vt[2]).getTime()-new Date(At[2]).getTime());x(sl(ut)),localStorage.setItem("taskData",JSON.stringify({data:ut,time:Date.now()})),Q(null),ye(vt=>!vt)}else alert("Error deleting task");t(!1)}catch(Xe){console.error("Error deleting task:",Xe),alert("Something went wrong while deleting the task.")}};P.useEffect(()=>{N.length==0&&(async()=>{try{const Xe=await dd();x(fd(Xe))}catch(Xe){console.error("Fetch failed:",Xe)}})()},[N,x]),P.useEffect(()=>{}),P.useEffect(()=>{let Ue=!0;return(async()=>{var ot;try{const ut=localStorage.getItem("taskData"),vt=Date.now();if(ut&&!G){const pt=JSON.parse(ut);if(vt-pt.time<5*60*1e3&&((ot=pt.data)==null?void 0:ot.length)>0){if(Ue){const It=pt.data.filter(Lt=>Lt[7]!=="Completed");x(sl(pt.data)),w(It)}return}}const At=await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/gettasks",{credentials:"include"});if(!At.ok)throw new Error(`HTTP error! Status: ${At.status}`);const ct=await At.json(),ze=Array.isArray(ct.body)?ct.body:[];if(Ue){const pt=ze.filter(Ot=>Ot[7]!=="Completed");x(sl(ze)),w(pt),localStorage.setItem("taskData",JSON.stringify({data:ze,time:vt}))}}catch(ut){console.error("Error fetching tasks:",ut)}})(),()=>{Ue=!1}},[x,G]);const O=async()=>{try{const Ue=await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/getprojectdata",{credentials:"include"});if(!Ue.ok)throw new Error(`HTTP error! Status: ${Ue.status}`);const Xe=await Ue.json();if(!Array.isArray(Xe.body))throw new Error("Invalid data format: Expected an array in data.body");const ot=(ct,ze)=>{if(ct==null||ct==="")return ze;if(typeof ct!="string")return ct||ze;try{return JSON.parse(ct)}catch(pt){return console.warn("Invalid JSON:",ct,pt),ze}},ut=ct=>{try{return JSON.parse(JSON.stringify(ct))}catch{return[]}},vt=ct=>{if(Array.isArray(ct))return ct;if(typeof ct!="string"||ct==="")return[];try{const ze=JSON.parse(ct);return Array.isArray(ze)?ze:[]}catch{try{return ct.replace(/^\[|\]$/g,"").split(",").map(pt=>pt.trim().replace(/^"+|"+$/g,"")).filter(pt=>pt)}catch{return[]}}};return Xe.body.map((ct,ze)=>{try{return{projectName:ct[0]||"",customerLink:ot(ct[1],[]),projectReference:ct[2]||"",status:ct[3]||"",totalAmount:parseFloat(ct[4])||0,totalTax:parseFloat(ct[5])||0,paid:parseFloat(ct[6])||0,discount:parseFloat(ct[7])||0,createdBy:ct[8]||"",allData:ut(ot(ct[9],[])),projectDate:ct[10]||"",additionalRequests:ot(ct[11],[]),interiorArray:vt(ct[12]),salesAssociateArray:vt(ct[13]),additionalItems:ut(ot(ct[14],[])),goodsArray:ut(ot(ct[15],[])),tailorsArray:ut(ot(ct[16],[])),projectAddress:ct[17]||"",date:ct[18]||""}}catch(pt){return console.error(`Error processing project row ${ze}:`,ct,pt),null}}).filter(ct=>ct!==null)}catch(Ue){return console.error("Error fetching project data:",Ue),[]}},L=async()=>{try{const Ue=await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/getPayments");if(!Ue.ok)throw new Error(`HTTP error! Status: ${Ue.status}`);const Xe=await Ue.json();return Array.isArray(Xe.message)?Xe.message:[]}catch(Ue){return console.error("Error fetching payment data:",Ue),[]}},[q,oe]=P.useState(0);P.useEffect(()=>{(async()=>{var Xe;try{const ot=await O(),ut=Array.isArray(ot)?ot:[];x(La(ut));let vt=0,At=0,ct=0;ut.forEach(Lt=>{vt+=parseFloat(Lt.totalTax)||0,At+=parseFloat(Lt.totalAmount)||0,ct+=parseFloat(Lt.discount)||0}),X(At+vt),ce(ct);const ze=new Set(ut.map(Lt=>Lt.projectName)),pt=localStorage.getItem("paymentData"),Ot=Date.now();if(pt){const Lt=JSON.parse(pt);if(Ot-Lt.time<3e5&&((Xe=Lt.data)!=null&&Xe.length)){x(Kl(Lt.data));const wt=Lt.data.reduce((hr,zt)=>{const Yt=zt[1],Sr=parseFloat(zt[2]);return ze.has(Yt)?hr+(isNaN(Sr)?0:Sr):hr},0);oe(wt);return}}const It=await L();if(It){x(Kl(It)),localStorage.setItem("paymentData",JSON.stringify({data:It,time:Ot}));const Lt=It.reduce((Ct,wt)=>{const hr=wt[1],zt=parseFloat(wt[2]);return ze.has(hr)?Ct+(isNaN(zt)?0:zt):Ct},0);oe(Lt)}}catch(ot){console.error("Error fetching data:",ot)}})()},[x]);const[be,ve]=P.useState(!1),ue=async(Ue,Xe)=>{try{if((await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/updatetask",{method:"POST",headers:{"content-type":"application/json"},credentials:"include",body:JSON.stringify({title:Xe,status:Ue})})).status===200){alert("Task marked as completed");const vt=(await z4()).sort((At,ct)=>new Date(At[2]).getTime()-new Date(ct[2]).getTime());x(sl(vt)),localStorage.setItem("taskData",JSON.stringify({data:vt,time:Date.now()}))}else alert("Error updating task");t(!1),ye(ut=>!ut)}catch(ot){console.error("Error marking task as completed:",ot),alert("Something went wrong while updating the task.")}},[fe,Ee]=P.useState(null),[J,Pe]=P.useState(!1);P.useEffect(()=>{(async()=>{var Xe,ot;try{const ut=localStorage.getItem("projectData"),vt=Date.now(),At=5*60*1e3;if(ut){const ze=JSON.parse(ut);if(((Xe=ze==null?void 0:ze.data)==null?void 0:Xe.length)>0&&vt-ze.time<At){x(La(ze.data));return}}const ct=await O();Array.isArray(ct)?(x(La(ct)),localStorage.setItem("projectData",JSON.stringify({data:ct,time:vt}))):console.warn("Fetched project data is not an array:",ct)}catch(ut){console.error("Failed to fetch projects:",ut);const vt=localStorage.getItem("projectData");if(vt){const At=JSON.parse(vt);((ot=At==null?void 0:At.data)==null?void 0:ot.length)>0&&x(La(At.data))}}})()},[x]);const st=Ue=>{const Xe=Ue[5],ot=b.findIndex(ut=>ut.projectName===Xe);if(H(ot),ot!==-1){const ut=b[ot];Y(ut),M(ut.totalTax||0),E(ut.totalAmount||0),V(ut.discount||0),t(!1),R(!0)}else console.warn("No matching project found for:",Xe)},ke=async Ue=>{if((await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/deleteInquiry",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({projectName:Ue})})).status===200){const ot=await dd();x(fd(ot)),alert("Inquiry Deleted"),s(!1)}else alert("Error")},de=async(Ue,Xe)=>{if((await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/updateInquiry",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({projectName:Ue,status:Xe})})).status===200){const ut=await dd();x(fd(ut)),alert("Status changed"),s(!1),I("/add-project")}else alert("Error")},rt=async(Ue,Xe)=>{if((await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/updateInquiry",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({projectName:Ue,status:Xe})})).status===200){const ut=await dd();x(fd(ut)),alert("Status changed"),s(!1),Xe=="Convert to Project"&&I("/add-project")}else alert("Error")};return f.jsxs("div",{className:"p-6 md:mt-0 mt-20 bg-gray-100 min-h-screen",children:[f.jsxs("div",{className:`grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-2 ${re?"hidden":""}`,children:[f.jsx("div",{className:"flex",onClick:()=>I("/projects"),children:f.jsx(bm,{title:"Orders",value:b.length,color:"bg-blue-500",className:"w-full max-w-sm"})}),f.jsx(bm,{title:"Total Value",value:Math.round(K-Z),color:"bg-purple-500",isCurrency:!0}),f.jsx("div",{className:"flex",onClick:()=>I("/paymentsPage"),children:f.jsx(bm,{title:"Payment Received",value:Math.round(q),color:"bg-green-500",isCurrency:!0})}),f.jsx("div",{className:"flex",onClick:()=>I("/duePage"),children:f.jsx(bm,{title:"Payment Due",value:Math.round(K-q-Z),color:"bg-red-500",isCurrency:!0})})]}),f.jsxs("div",{className:`${re?"hidden":""} grid grid-cols-1 lg:grid-cols-3 gap-2 mt-2`,children:[f.jsxs("div",{className:"bg-white flex flex-wrap flex-col shadow-md rounded-xl p-6",children:[f.jsx("p",{className:"md:text-[1.7vw] font-semibold mb-4 text-gray-800",children:" Project Deadlines"}),f.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-1 md:grid-cols-2 gap-4",children:b&&b.map((Ue,Xe)=>f.jsx("div",{onClick:()=>{Y(Ue),H(Xe),M(Ue.totalTax),E(Ue.totalAmount),V(Ue.discount),R(!0)},children:f.jsx(ij,{setFlag:R,setTax:M,setProjectDiscount:V,setAmount:E,setSendProject:Y,index:Xe,setIndex:H,project:Ue,projectName:Ue.projectName,date:Ue.projectDate})},Xe))})]}),f.jsxs("div",{className:"bg-white shadow-md rounded-xl p-3 col-span-2",children:[f.jsxs("div",{className:"flex flex-row w-full justify-between items-center mb-4",children:[f.jsx(xi,{to:"/tasks",className:"!no-underline",children:f.jsx("p",{className:"md:text-[1.7vw] font-semibold text-gray-800",children:"Tasks"})}),f.jsx("button",{onClick:()=>ve(!0),style:{borderRadius:"6px"},className:"mb-2 bg-sky-600 text-white hover:bg-sky-700 px-2 md:text-[1.7vw] py-1",children:"Add Task"})]}),f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-1 overflow-y-auto max-h-[90vh] pr-2",children:g&&g.map((Ue,Xe)=>f.jsx("div",{onClick:()=>{Q(Ue),t(!0)},children:f.jsx(oj,{taskData:Ue})},Xe))})]})]}),f.jsxs(qd,{children:[be&&f.jsxs(f.Fragment,{children:[f.jsx(ko.div,{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-40",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>ve(!1)}),f.jsx(ko.div,{className:"fixed inset-0 z-50 flex items-center justify-center",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.3},children:f.jsx(Vd,{onClose:()=>ve(!1),projectData:b,setTaskDialogOpen:ve,taskDialogOpen:be,setProjectFlag:ch,dashboard:!0,setediting:Ee,setrefresh:ye,refresh:G})})]}),r&&f.jsxs(f.Fragment,{children:[f.jsx(ko.div,{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-40",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>a(!1)}),f.jsx(ko.div,{className:"fixed inset-0 z-50 flex items-center justify-center",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.3},children:f.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 w-full max-w-md relative border border-gray-200",children:[f.jsx("button",{onClick:()=>a(!1),className:"absolute top-3 right-3 text-gray-500 hover:text-gray-700 transition-colors",children:"✕"}),f.jsx("h2",{className:"text-xl font-bold mb-4 text-gray-800",children:"Add Inquiry"}),f.jsxs("form",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Project"}),f.jsx("input",{type:"text",value:u.project,onChange:Ue=>h({...u,project:Ue.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 text-sm",placeholder:"Enter project name",required:!0})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Customer Name"}),f.jsx("input",{type:"text",value:u.customer,onChange:Ue=>h({...u,customer:Ue.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 text-sm",placeholder:"Enter customer name",required:!0})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Comments"}),f.jsx("textarea",{value:u.comments,onChange:Ue=>h({...u,comments:Ue.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 text-sm",placeholder:"Enter comments",rows:4})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Inquiry Date"}),f.jsx("input",{type:"date",value:u.inquiryDate,onChange:Ue=>h({...u,inquiryDate:Ue.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 text-sm",required:!0})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Follow-Up Date"}),f.jsx("input",{type:"date",value:u.followUpDate,onChange:Ue=>h({...u,followUpDate:Ue.target.value}),className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 text-sm",required:!0})]}),f.jsxs("div",{className:"flex justify-end gap-3",children:[f.jsx("button",{type:"button",onClick:()=>a(!1),className:"bg-gray-200 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-300 transition-colors",children:"Cancel"}),f.jsx("button",{type:"submit",className:"bg-sky-600 text-white px-4 py-2 rounded-lg hover:bg-sky-700 transition-colors",onClick:Ue=>{Ue.preventDefault(),p()},children:"Submit"})]})]})]})})]}),n&&o&&f.jsx("div",{className:"fixed inset-0 backdrop-blur-sm bg-black/50 bg-opacity-50 flex items-center justify-center z-50",children:f.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 w-full max-w-md relative border border-gray-200",children:[f.jsx("button",{onClick:()=>s(!1),className:"absolute top-3 right-3 text-gray-500 hover:text-gray-700 transition-colors",children:"✕"}),f.jsxs("h2",{className:"text-xl font-bold mb-2 text-gray-800",children:[" ",o[0]]}),f.jsxs("div",{className:"space-y-3 p-3 text-gray-700 text-sm",children:[f.jsxs("p",{className:"flex justify-between",children:[f.jsx("strong",{children:"Status:"}),f.jsx("span",{className:`inline-block px-2 py-1 rounded text-white ${o[4]=="approved"?"bg-green-500":o[4]==="New Inquiry"?"bg-blue-500":o[4]==="In Progress"?"bg-yellow-500":o[4]==="Convert to Project"?"bg-purple-500":o[4]=="Not Intrested"?"bg-red-500":"bg-black"}`,children:o[4]})]}),f.jsx("hr",{}),f.jsxs("p",{className:"flex justify-between",children:[f.jsx("strong",{children:"Customer:"})," ",o[5]]}),f.jsx("hr",{}),f.jsxs("p",{className:"flex justify-between",children:[f.jsx("strong",{children:"Comments:"})," ",o[1]]}),f.jsx("hr",{}),f.jsxs("p",{className:"flex justify-between",children:[f.jsx("strong",{children:"Inquiry Date:"})," ",o[2]]}),f.jsx("hr",{}),f.jsxs("p",{className:"flex justify-between",children:[f.jsx("strong",{children:"Follow-Up Date:"})," ",o[3]]}),f.jsx("hr",{})]}),f.jsxs("div",{className:"flex justify-between mt-6",children:[f.jsx("button",{onClick:()=>ke(o[0]),className:"bg-white border !border-red-500 text-red-500 px-4 py-2 !rounded-lg hover:!bg-red-500 hover:!text-white transition-colors",children:"Delete"}),f.jsxs("button",{onClick:()=>de(o[0],"Convert to Project"),className:`${o[4]=="Convert to Project"?"hidden":""} flex items-center bg-gray-200 text-gray-700 px-4 py-2 !rounded-lg hover:bg-gray-300 transition-colors`,children:[f.jsx("span",{className:"mr-2",children:"✔"})," Mark As Approved"]})]})]})})]}),f.jsxs("div",{className:`bg-white shadow-md rounded-xl p-6 mt-2 ${re?"hidden":""}`,children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:" Inquiries"}),f.jsx("button",{style:{borderRadius:"6px"},className:"mb-2 bg-sky-600 text-white hover:bg-sky-700 px-2 md:text-[1.7vw] py-1",onClick:()=>a(!0),children:"Add Inquiry"})]}),f.jsx("div",{className:"flex flex-wrap gap-6 overflow-x-auto pb-4",children:N.map((Ue,Xe)=>f.jsx("div",{children:f.jsx(lj,{project:Ue[0],comments:Ue[1],inquiryDate:Ue[2],followUpDate:Ue[3],status:Ue[4],customer:Ue[5],handlestatuschange:rt,onCardClick:()=>{c(Ue),s(!0)}})},Xe))})]}),e&&te&&f.jsx("div",{className:"fixed inset-0 backdrop-blur-sm bg-black/50 bg-opacity-50 flex items-center justify-center z-50",children:f.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 w-full max-w-md relative border border-gray-200",children:[f.jsx("button",{onClick:()=>t(!1),className:"absolute top-3 right-3 text-gray-500 hover:text-gray-700 transition-colors",children:"✕"}),f.jsxs("h2",{className:"text-xl font-bold mb-2 text-gray-800",children:["📝 ",te[0]]}),f.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["By ",te[4]]}),f.jsxs("div",{className:"space-y-3 p-3 text-gray-700 text-sm",children:[f.jsxs("p",{className:"flex justify-between",children:[f.jsx("strong",{children:"Priority :"})," ",f.jsx("span",{className:`inline-block px-2 py-1 rounded text-white ${te[6].toLowerCase()==="high"?"bg-red-500":te[6].toLowerCase()==="moderate"?"bg-yellow-500":"bg-green-500"}`,children:te[6]})]}),f.jsx("hr",{}),f.jsxs("p",{className:"flex justify-between",children:[f.jsx("strong",{children:"Status :"})," ",f.jsx("span",{className:`inline-block px-2 py-1 rounded text-white ${te[7].toLowerCase()==="completed"?"bg-green-500":"bg-gray-500"}`,children:te[7]})]}),f.jsx("hr",{}),f.jsxs("p",{onClick:()=>st(te),className:"flex justify-between",children:[f.jsx("strong",{children:"Project :"})," ",f.jsx("span",{className:"text-blue-600",children:te[5]})]}),f.jsx("hr",{}),f.jsxs("p",{className:"flex justify-between",children:[f.jsx("strong",{children:"Assignee :"})," ",te[4]]}),f.jsx("hr",{}),f.jsxs("p",{className:"flex justify-between",children:[f.jsx("strong",{children:"Assigned by :"})," ",te[4]]}),f.jsx("hr",{}),f.jsxs("p",{className:"flex justify-between",children:[f.jsx("strong",{children:"Due date & time :"})," ",te[2],", ",te[3]]}),f.jsx("hr",{})]}),f.jsxs("div",{className:"flex justify-between mt-6",children:[f.jsx("button",{onClick:()=>D(te[0]),className:"bg-white border !border-red-500 text-red-500 px-4 py-2 !rounded-lg hover:!bg-red-500 hover:!text-white transition-colors",children:"Delete"}),f.jsxs("button",{onClick:()=>ue("Completed",te[0]),className:"flex items-center bg-gray-200 text-gray-700 px-4 py-2 !rounded-lg hover:bg-gray-300 transition-colors",children:[f.jsx("span",{className:"mr-2",children:"✔"})," Mark As Completed"]})]})]})}),re&&f.jsx(BA,{projectData:F,index:z,goBack:()=>{R(!1),x(ch(!1))},tasks:v,projects:b,Tax:j,setTax:M,Amount:_,setAmount:E,Discount:U,setDiscount:V})]})},nL="modulepreload",sL=function(e){return"/"+e},H4={},W2=function(t,r,a){let n=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),c=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));n=Promise.allSettled(r.map(u=>{if(u=sL(u),u in H4)return;H4[u]=!0;const h=u.endsWith(".css"),p=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${p}`))return;const x=document.createElement("link");if(x.rel=h?"stylesheet":nL,h||(x.as="script"),x.crossOrigin="",x.href=u,c&&x.setAttribute("nonce",c),document.head.appendChild(x),h)return new Promise((v,g)=>{x.addEventListener("load",v),x.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${u}`)))})}))}function s(o){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=o,window.dispatchEvent(c),!c.defaultPrevented)throw o}return n.then(o=>{for(const c of o||[])c.status==="rejected"&&s(c.reason);return t().catch(s)})};function va(e){"@babel/helpers - typeof";return va=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},va(e)}var Xs=Uint8Array,Qi=Uint16Array,my=Int32Array,W1=new Xs([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),$1=new Xs([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),$2=new Xs([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),UA=function(e,t){for(var r=new Qi(31),a=0;a<31;++a)r[a]=t+=1<<e[a-1];for(var n=new my(r[30]),a=1;a<30;++a)for(var s=r[a];s<r[a+1];++s)n[s]=s-r[a]<<5|a;return{b:r,r:n}},zA=UA(W1,2),HA=zA.b,X2=zA.r;HA[28]=258,X2[258]=28;var VA=UA($1,0),iL=VA.b,V4=VA.r,Y2=new Qi(32768);for(var za=0;za<32768;++za){var Tu=(za&43690)>>1|(za&21845)<<1;Tu=(Tu&52428)>>2|(Tu&13107)<<2,Tu=(Tu&61680)>>4|(Tu&3855)<<4,Y2[za]=((Tu&65280)>>8|(Tu&255)<<8)>>1}var Jl=function(e,t,r){for(var a=e.length,n=0,s=new Qi(t);n<a;++n)e[n]&&++s[e[n]-1];var o=new Qi(t);for(n=1;n<t;++n)o[n]=o[n-1]+s[n-1]<<1;var c;if(r){c=new Qi(1<<t);var u=15-t;for(n=0;n<a;++n)if(e[n])for(var h=n<<4|e[n],p=t-e[n],x=o[e[n]-1]++<<p,v=x|(1<<p)-1;x<=v;++x)c[Y2[x]>>u]=h}else for(c=new Qi(a),n=0;n<a;++n)e[n]&&(c[n]=Y2[o[e[n]-1]++]>>15-e[n]);return c},Iu=new Xs(288);for(var za=0;za<144;++za)Iu[za]=8;for(var za=144;za<256;++za)Iu[za]=9;for(var za=256;za<280;++za)Iu[za]=7;for(var za=280;za<288;++za)Iu[za]=8;var ep=new Xs(32);for(var za=0;za<32;++za)ep[za]=5;var oL=Jl(Iu,9,0),lL=Jl(Iu,9,1),cL=Jl(ep,5,0),uL=Jl(ep,5,1),qg=function(e){for(var t=e[0],r=1;r<e.length;++r)e[r]>t&&(t=e[r]);return t},Qo=function(e,t,r){var a=t/8|0;return(e[a]|e[a+1]<<8)>>(t&7)&r},Gg=function(e,t){var r=t/8|0;return(e[r]|e[r+1]<<8|e[r+2]<<16)>>(t&7)},xy=function(e){return(e+7)/8|0},qA=function(e,t,r){return(r==null||r>e.length)&&(r=e.length),new Xs(e.subarray(t,r))},fL=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],al=function(e,t,r){var a=new Error(t||fL[e]);if(a.code=e,Error.captureStackTrace&&Error.captureStackTrace(a,al),!r)throw a;return a},hL=function(e,t,r,a){var n=e.length,s=0;if(!n||t.f&&!t.l)return r||new Xs(0);var o=!r,c=o||t.i!=2,u=t.i;o&&(r=new Xs(n*3));var h=function(Ee){var J=r.length;if(Ee>J){var Pe=new Xs(Math.max(J*2,Ee));Pe.set(r),r=Pe}},p=t.f||0,x=t.p||0,v=t.b||0,g=t.l,w=t.d,b=t.m,N=t.n,_=n*8;do{if(!g){p=Qo(e,x,1);var E=Qo(e,x+1,3);if(x+=3,E)if(E==1)g=lL,w=uL,b=9,N=5;else if(E==2){var V=Qo(e,x,31)+257,I=Qo(e,x+10,15)+4,z=V+Qo(e,x+5,31)+1;x+=14;for(var H=new Xs(z),re=new Xs(19),R=0;R<I;++R)re[$2[R]]=Qo(e,x+R*3,7);x+=I*3;for(var F=qg(re),Y=(1<<F)-1,K=Jl(re,F,1),R=0;R<z;){var X=K[Qo(e,x,Y)];x+=X&15;var j=X>>4;if(j<16)H[R++]=j;else{var Z=0,ce=0;for(j==16?(ce=3+Qo(e,x,3),x+=2,Z=H[R-1]):j==17?(ce=3+Qo(e,x,7),x+=3):j==18&&(ce=11+Qo(e,x,127),x+=7);ce--;)H[R++]=Z}}var te=H.subarray(0,V),Q=H.subarray(V);b=qg(te),N=qg(Q),g=Jl(te,b,1),w=Jl(Q,N,1)}else al(1);else{var j=xy(x)+4,M=e[j-4]|e[j-3]<<8,U=j+M;if(U>n){u&&al(0);break}c&&h(v+M),r.set(e.subarray(j,U),v),t.b=v+=M,t.p=x=U*8,t.f=p;continue}if(x>_){u&&al(0);break}}c&&h(v+131072);for(var G=(1<<b)-1,ye=(1<<N)-1,D=x;;D=x){var Z=g[Gg(e,x)&G],O=Z>>4;if(x+=Z&15,x>_){u&&al(0);break}if(Z||al(2),O<256)r[v++]=O;else if(O==256){D=x,g=null;break}else{var L=O-254;if(O>264){var R=O-257,q=W1[R];L=Qo(e,x,(1<<q)-1)+HA[R],x+=q}var oe=w[Gg(e,x)&ye],be=oe>>4;oe||al(3),x+=oe&15;var Q=iL[be];if(be>3){var q=$1[be];Q+=Gg(e,x)&(1<<q)-1,x+=q}if(x>_){u&&al(0);break}c&&h(v+131072);var ve=v+L;if(v<Q){var ue=s-Q,fe=Math.min(Q,ve);for(ue+v<0&&al(3);v<fe;++v)r[v]=a[ue+v]}for(;v<ve;++v)r[v]=r[v-Q]}}t.l=g,t.p=D,t.b=v,t.f=p,g&&(p=1,t.m=b,t.d=w,t.n=N)}while(!p);return v!=r.length&&o?qA(r,0,v):r.subarray(0,v)},Ec=function(e,t,r){r<<=t&7;var a=t/8|0;e[a]|=r,e[a+1]|=r>>8},pd=function(e,t,r){r<<=t&7;var a=t/8|0;e[a]|=r,e[a+1]|=r>>8,e[a+2]|=r>>16},Wg=function(e,t){for(var r=[],a=0;a<e.length;++a)e[a]&&r.push({s:a,f:e[a]});var n=r.length,s=r.slice();if(!n)return{t:WA,l:0};if(n==1){var o=new Xs(r[0].s+1);return o[r[0].s]=1,{t:o,l:1}}r.sort(function(U,V){return U.f-V.f}),r.push({s:-1,f:25001});var c=r[0],u=r[1],h=0,p=1,x=2;for(r[0]={s:-1,f:c.f+u.f,l:c,r:u};p!=n-1;)c=r[r[h].f<r[x].f?h++:x++],u=r[h!=p&&r[h].f<r[x].f?h++:x++],r[p++]={s:-1,f:c.f+u.f,l:c,r:u};for(var v=s[0].s,a=1;a<n;++a)s[a].s>v&&(v=s[a].s);var g=new Qi(v+1),w=J2(r[p-1],g,0);if(w>t){var a=0,b=0,N=w-t,_=1<<N;for(s.sort(function(V,I){return g[I.s]-g[V.s]||V.f-I.f});a<n;++a){var E=s[a].s;if(g[E]>t)b+=_-(1<<w-g[E]),g[E]=t;else break}for(b>>=N;b>0;){var j=s[a].s;g[j]<t?b-=1<<t-g[j]++-1:++a}for(;a>=0&&b;--a){var M=s[a].s;g[M]==t&&(--g[M],++b)}w=t}return{t:new Xs(g),l:w}},J2=function(e,t,r){return e.s==-1?Math.max(J2(e.l,t,r+1),J2(e.r,t,r+1)):t[e.s]=r},q4=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new Qi(++t),a=0,n=e[0],s=1,o=function(u){r[a++]=u},c=1;c<=t;++c)if(e[c]==n&&c!=t)++s;else{if(!n&&s>2){for(;s>138;s-=138)o(32754);s>2&&(o(s>10?s-11<<5|28690:s-3<<5|12305),s=0)}else if(s>3){for(o(n),--s;s>6;s-=6)o(8304);s>2&&(o(s-3<<5|8208),s=0)}for(;s--;)o(n);s=1,n=e[c]}return{c:r.subarray(0,a),n:t}},md=function(e,t){for(var r=0,a=0;a<t.length;++a)r+=e[a]*t[a];return r},GA=function(e,t,r){var a=r.length,n=xy(t+2);e[n]=a&255,e[n+1]=a>>8,e[n+2]=e[n]^255,e[n+3]=e[n+1]^255;for(var s=0;s<a;++s)e[n+s+4]=r[s];return(n+4+a)*8},G4=function(e,t,r,a,n,s,o,c,u,h,p){Ec(t,p++,r),++n[256];for(var x=Wg(n,15),v=x.t,g=x.l,w=Wg(s,15),b=w.t,N=w.l,_=q4(v),E=_.c,j=_.n,M=q4(b),U=M.c,V=M.n,I=new Qi(19),z=0;z<E.length;++z)++I[E[z]&31];for(var z=0;z<U.length;++z)++I[U[z]&31];for(var H=Wg(I,7),re=H.t,R=H.l,F=19;F>4&&!re[$2[F-1]];--F);var Y=h+5<<3,K=md(n,Iu)+md(s,ep)+o,X=md(n,v)+md(s,b)+o+14+3*F+md(I,re)+2*I[16]+3*I[17]+7*I[18];if(u>=0&&Y<=K&&Y<=X)return GA(t,p,e.subarray(u,u+h));var Z,ce,te,Q;if(Ec(t,p,1+(X<K)),p+=2,X<K){Z=Jl(v,g,0),ce=v,te=Jl(b,N,0),Q=b;var G=Jl(re,R,0);Ec(t,p,j-257),Ec(t,p+5,V-1),Ec(t,p+10,F-4),p+=14;for(var z=0;z<F;++z)Ec(t,p+3*z,re[$2[z]]);p+=3*F;for(var ye=[E,U],D=0;D<2;++D)for(var O=ye[D],z=0;z<O.length;++z){var L=O[z]&31;Ec(t,p,G[L]),p+=re[L],L>15&&(Ec(t,p,O[z]>>5&127),p+=O[z]>>12)}}else Z=oL,ce=Iu,te=cL,Q=ep;for(var z=0;z<c;++z){var q=a[z];if(q>255){var L=q>>18&31;pd(t,p,Z[L+257]),p+=ce[L+257],L>7&&(Ec(t,p,q>>23&31),p+=W1[L]);var oe=q&31;pd(t,p,te[oe]),p+=Q[oe],oe>3&&(pd(t,p,q>>5&8191),p+=$1[oe])}else pd(t,p,Z[q]),p+=ce[q]}return pd(t,p,Z[256]),p+ce[256]},dL=new my([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),WA=new Xs(0),pL=function(e,t,r,a,n,s){var o=s.z||e.length,c=new Xs(a+o+5*(1+Math.ceil(o/7e3))+n),u=c.subarray(a,c.length-n),h=s.l,p=(s.r||0)&7;if(t){p&&(u[0]=s.r>>3);for(var x=dL[t-1],v=x>>13,g=x&8191,w=(1<<r)-1,b=s.p||new Qi(32768),N=s.h||new Qi(w+1),_=Math.ceil(r/3),E=2*_,j=function(st){return(e[st]^e[st+1]<<_^e[st+2]<<E)&w},M=new my(25e3),U=new Qi(288),V=new Qi(32),I=0,z=0,H=s.i||0,re=0,R=s.w||0,F=0;H+2<o;++H){var Y=j(H),K=H&32767,X=N[Y];if(b[K]=X,N[Y]=K,R<=H){var Z=o-H;if((I>7e3||re>24576)&&(Z>423||!h)){p=G4(e,u,0,M,U,V,z,re,F,H-F,p),re=I=z=0,F=H;for(var ce=0;ce<286;++ce)U[ce]=0;for(var ce=0;ce<30;++ce)V[ce]=0}var te=2,Q=0,G=g,ye=K-X&32767;if(Z>2&&Y==j(H-ye))for(var D=Math.min(v,Z)-1,O=Math.min(32767,H),L=Math.min(258,Z);ye<=O&&--G&&K!=X;){if(e[H+te]==e[H+te-ye]){for(var q=0;q<L&&e[H+q]==e[H+q-ye];++q);if(q>te){if(te=q,Q=ye,q>D)break;for(var oe=Math.min(ye,q-2),be=0,ce=0;ce<oe;++ce){var ve=H-ye+ce&32767,ue=b[ve],fe=ve-ue&32767;fe>be&&(be=fe,X=ve)}}}K=X,X=b[K],ye+=K-X&32767}if(Q){M[re++]=268435456|X2[te]<<18|V4[Q];var Ee=X2[te]&31,J=V4[Q]&31;z+=W1[Ee]+$1[J],++U[257+Ee],++V[J],R=H+te,++I}else M[re++]=e[H],++U[e[H]]}}for(H=Math.max(H,R);H<o;++H)M[re++]=e[H],++U[e[H]];p=G4(e,u,h,M,U,V,z,re,F,H-F,p),h||(s.r=p&7|u[p/8|0]<<3,p-=7,s.h=N,s.p=b,s.i=H,s.w=R)}else{for(var H=s.w||0;H<o+h;H+=65535){var Pe=H+65535;Pe>=o&&(u[p/8|0]=h,Pe=o),p=GA(u,p+1,e.subarray(H,Pe))}s.i=o}return qA(c,0,a+xy(p)+n)},$A=function(){var e=1,t=0;return{p:function(r){for(var a=e,n=t,s=r.length|0,o=0;o!=s;){for(var c=Math.min(o+2655,s);o<c;++o)n+=a+=r[o];a=(a&65535)+15*(a>>16),n=(n&65535)+15*(n>>16)}e=a,t=n},d:function(){return e%=65521,t%=65521,(e&255)<<24|(e&65280)<<8|(t&255)<<8|t>>8}}},mL=function(e,t,r,a,n){if(!n&&(n={l:1},t.dictionary)){var s=t.dictionary.subarray(-32768),o=new Xs(s.length+e.length);o.set(s),o.set(e,s.length),e=o,n.w=s.length}return pL(e,t.level==null?6:t.level,t.mem==null?n.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+t.mem,r,a,n)},XA=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8},xL=function(e,t){var r=t.level,a=r==0?0:r<6?1:r==9?3:2;if(e[0]=120,e[1]=a<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var n=$A();n.p(t.dictionary),XA(e,2,n.d())}},gL=function(e,t){return((e[0]&15)!=8||e[0]>>4>7||(e[0]<<8|e[1])%31)&&al(6,"invalid zlib data"),(e[1]>>5&1)==1&&al(6,"invalid zlib data: "+(e[1]&32?"need":"unexpected")+" dictionary"),(e[1]>>3&4)+2};function K2(e,t){t||(t={});var r=$A();r.p(e);var a=mL(e,t,t.dictionary?6:2,4);return xL(a,t),XA(a,a.length-4,r.d()),a}function vL(e,t){return hL(e.subarray(gL(e),-4),{i:2},t,t)}var yL=typeof TextDecoder<"u"&&new TextDecoder,wL=0;try{yL.decode(WA,{stream:!0}),wL=1}catch{}var gr=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function $g(){gr.console&&typeof gr.console.log=="function"&&gr.console.log.apply(gr.console,arguments)}var Ta={log:$g,warn:function(e){gr.console&&(typeof gr.console.warn=="function"?gr.console.warn.apply(gr.console,arguments):$g.call(null,arguments))},error:function(e){gr.console&&(typeof gr.console.error=="function"?gr.console.error.apply(gr.console,arguments):$g(e))}};function Xg(e,t,r){var a=new XMLHttpRequest;a.open("GET",e),a.responseType="blob",a.onload=function(){kf(a.response,t,r)},a.onerror=function(){Ta.error("could not download file")},a.send()}function W4(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function km(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var jd,Z2,kf=gr.saveAs||((typeof window>"u"?"undefined":va(window))!=="object"||window!==gr?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(e,t,r){var a=gr.URL||gr.webkitURL,n=document.createElement("a");t=t||e.name||"download",n.download=t,n.rel="noopener",typeof e=="string"?(n.href=e,n.origin!==location.origin?W4(n.href)?Xg(e,t,r):km(n,n.target="_blank"):km(n)):(n.href=a.createObjectURL(e),setTimeout(function(){a.revokeObjectURL(n.href)},4e4),setTimeout(function(){km(n)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,r){if(t=t||e.name||"download",typeof e=="string")if(W4(e))Xg(e,t,r);else{var a=document.createElement("a");a.href=e,a.target="_blank",setTimeout(function(){km(a)})}else navigator.msSaveOrOpenBlob(function(n,s){return s===void 0?s={autoBom:!1}:va(s)!=="object"&&(Ta.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(n.type)?new Blob(["\uFEFF",n],{type:n.type}):n}(e,r),t)}:function(e,t,r,a){if((a=a||open("","_blank"))&&(a.document.title=a.document.body.innerText="downloading..."),typeof e=="string")return Xg(e,t,r);var n=e.type==="application/octet-stream",s=/constructor/i.test(gr.HTMLElement)||gr.safari,o=/CriOS\/[\d]+/.test(navigator.userAgent);if((o||n&&s)&&(typeof FileReader>"u"?"undefined":va(FileReader))==="object"){var c=new FileReader;c.onloadend=function(){var p=c.result;p=o?p:p.replace(/^data:[^;]*;/,"data:attachment/file;"),a?a.location.href=p:location=p,a=null},c.readAsDataURL(e)}else{var u=gr.URL||gr.webkitURL,h=u.createObjectURL(e);a?a.location=h:location.href=h,a=null,setTimeout(function(){u.revokeObjectURL(h)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function YA(e){var t;e=e||"",this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(c){return[parseInt(c[1]),parseInt(c[2]),parseInt(c[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(c){return[parseInt(c[1],16),parseInt(c[2],16),parseInt(c[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(c){return[parseInt(c[1]+c[1],16),parseInt(c[2]+c[2],16),parseInt(c[3]+c[3],16)]}}],a=0;a<r.length;a++){var n=r[a].re,s=r[a].process,o=n.exec(e);o&&(t=s(o),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var c=this.r.toString(16),u=this.g.toString(16),h=this.b.toString(16);return c.length==1&&(c="0"+c),u.length==1&&(u="0"+u),h.length==1&&(h="0"+h),"#"+c+u+h}}/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function Yg(e,t){var r=e[0],a=e[1],n=e[2],s=e[3];r=Bs(r,a,n,s,t[0],7,-680876936),s=Bs(s,r,a,n,t[1],12,-389564586),n=Bs(n,s,r,a,t[2],17,606105819),a=Bs(a,n,s,r,t[3],22,-1044525330),r=Bs(r,a,n,s,t[4],7,-176418897),s=Bs(s,r,a,n,t[5],12,1200080426),n=Bs(n,s,r,a,t[6],17,-1473231341),a=Bs(a,n,s,r,t[7],22,-45705983),r=Bs(r,a,n,s,t[8],7,1770035416),s=Bs(s,r,a,n,t[9],12,-1958414417),n=Bs(n,s,r,a,t[10],17,-42063),a=Bs(a,n,s,r,t[11],22,-1990404162),r=Bs(r,a,n,s,t[12],7,1804603682),s=Bs(s,r,a,n,t[13],12,-40341101),n=Bs(n,s,r,a,t[14],17,-1502002290),r=Us(r,a=Bs(a,n,s,r,t[15],22,1236535329),n,s,t[1],5,-165796510),s=Us(s,r,a,n,t[6],9,-1069501632),n=Us(n,s,r,a,t[11],14,643717713),a=Us(a,n,s,r,t[0],20,-373897302),r=Us(r,a,n,s,t[5],5,-701558691),s=Us(s,r,a,n,t[10],9,38016083),n=Us(n,s,r,a,t[15],14,-660478335),a=Us(a,n,s,r,t[4],20,-405537848),r=Us(r,a,n,s,t[9],5,568446438),s=Us(s,r,a,n,t[14],9,-1019803690),n=Us(n,s,r,a,t[3],14,-187363961),a=Us(a,n,s,r,t[8],20,1163531501),r=Us(r,a,n,s,t[13],5,-1444681467),s=Us(s,r,a,n,t[2],9,-51403784),n=Us(n,s,r,a,t[7],14,1735328473),r=zs(r,a=Us(a,n,s,r,t[12],20,-1926607734),n,s,t[5],4,-378558),s=zs(s,r,a,n,t[8],11,-2022574463),n=zs(n,s,r,a,t[11],16,1839030562),a=zs(a,n,s,r,t[14],23,-35309556),r=zs(r,a,n,s,t[1],4,-1530992060),s=zs(s,r,a,n,t[4],11,1272893353),n=zs(n,s,r,a,t[7],16,-155497632),a=zs(a,n,s,r,t[10],23,-1094730640),r=zs(r,a,n,s,t[13],4,681279174),s=zs(s,r,a,n,t[0],11,-358537222),n=zs(n,s,r,a,t[3],16,-722521979),a=zs(a,n,s,r,t[6],23,76029189),r=zs(r,a,n,s,t[9],4,-640364487),s=zs(s,r,a,n,t[12],11,-421815835),n=zs(n,s,r,a,t[15],16,530742520),r=Hs(r,a=zs(a,n,s,r,t[2],23,-995338651),n,s,t[0],6,-198630844),s=Hs(s,r,a,n,t[7],10,1126891415),n=Hs(n,s,r,a,t[14],15,-1416354905),a=Hs(a,n,s,r,t[5],21,-57434055),r=Hs(r,a,n,s,t[12],6,1700485571),s=Hs(s,r,a,n,t[3],10,-1894986606),n=Hs(n,s,r,a,t[10],15,-1051523),a=Hs(a,n,s,r,t[1],21,-2054922799),r=Hs(r,a,n,s,t[8],6,1873313359),s=Hs(s,r,a,n,t[15],10,-30611744),n=Hs(n,s,r,a,t[6],15,-1560198380),a=Hs(a,n,s,r,t[13],21,1309151649),r=Hs(r,a,n,s,t[4],6,-145523070),s=Hs(s,r,a,n,t[11],10,-1120210379),n=Hs(n,s,r,a,t[2],15,718787259),a=Hs(a,n,s,r,t[9],21,-343485551),e[0]=Cu(r,e[0]),e[1]=Cu(a,e[1]),e[2]=Cu(n,e[2]),e[3]=Cu(s,e[3])}function X1(e,t,r,a,n,s){return t=Cu(Cu(t,e),Cu(a,s)),Cu(t<<n|t>>>32-n,r)}function Bs(e,t,r,a,n,s,o){return X1(t&r|~t&a,e,t,n,s,o)}function Us(e,t,r,a,n,s,o){return X1(t&a|r&~a,e,t,n,s,o)}function zs(e,t,r,a,n,s,o){return X1(t^r^a,e,t,n,s,o)}function Hs(e,t,r,a,n,s,o){return X1(r^(t|~a),e,t,n,s,o)}function JA(e){var t,r=e.length,a=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)Yg(a,bL(e.substring(t-64,t)));e=e.substring(t-64);var n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)n[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(n[t>>2]|=128<<(t%4<<3),t>55)for(Yg(a,n),t=0;t<16;t++)n[t]=0;return n[14]=8*r,Yg(a,n),a}function bL(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return r}jd=gr.atob.bind(gr),Z2=gr.btoa.bind(gr);var $4="0123456789abcdef".split("");function SL(e){for(var t="",r=0;r<4;r++)t+=$4[e>>8*r+4&15]+$4[e>>8*r&15];return t}function NL(e){return String.fromCharCode((255&e)>>0,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function Q2(e){return JA(e).map(NL).join("")}var AL=function(e){for(var t=0;t<e.length;t++)e[t]=SL(e[t]);return e.join("")}(JA("hello"))!="5d41402abc4b2a76b9719d911017c592";function Cu(e,t){if(AL){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}return e+t&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function ev(e,t){var r,a,n,s;if(e!==r){for(var o=(n=e,s=1+(256/e.length>>0),new Array(s+1).join(n)),c=[],u=0;u<256;u++)c[u]=u;var h=0;for(u=0;u<256;u++){var p=c[u];h=(h+p+o.charCodeAt(u))%256,c[u]=c[h],c[h]=p}r=e,a=c}else c=a;var x=t.length,v=0,g=0,w="";for(u=0;u<x;u++)g=(g+(p=c[v=(v+1)%256]))%256,c[v]=c[g],c[g]=p,o=c[(c[v]+c[g])%256],w+=String.fromCharCode(t.charCodeAt(u)^o);return w}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var X4={print:4,modify:8,copy:16,"annot-forms":32};function V0(e,t,r,a){this.v=1,this.r=2;var n=192;e.forEach(function(c){if(X4.perm!==void 0)throw new Error("Invalid permission: "+c);n+=X4[c]}),this.padding="(¿N^NuAd\0NVÿú\b..\0¶Ðh>/\f©þdSiz";var s=(t+this.padding).substr(0,32),o=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(s,o),this.P=-(1+(255^n)),this.encryptionKey=Q2(s+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(a)).substr(0,5),this.U=ev(this.encryptionKey,this.padding)}function q0(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",r=e.length,a=0;a<r;a++){var n=e.charCodeAt(a);n<33||n===35||n===37||n===40||n===41||n===47||n===60||n===62||n===91||n===93||n===123||n===125||n>126?t+="#"+("0"+n.toString(16)).slice(-2):t+=e[a]}return t}function Y4(e){if(va(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(r,a,n){if(n=n||!1,typeof r!="string"||typeof a!="function"||typeof n!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(r)||(t[r]={});var s=Math.random().toString(35);return t[r][s]=[a,!!n],s},this.unsubscribe=function(r){for(var a in t)if(t[a][r])return delete t[a][r],Object.keys(t[a]).length===0&&delete t[a],!0;return!1},this.publish=function(r){if(t.hasOwnProperty(r)){var a=Array.prototype.slice.call(arguments,1),n=[];for(var s in t[r]){var o=t[r][s];try{o[0].apply(e,a)}catch(c){gr.console&&Ta.error("jsPDF PubSub Error",c.message,c)}o[1]&&n.push(s)}n.length&&n.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function x1(e){if(!(this instanceof x1))return new x1(e);var t="opacity,stroke-opacity".split(",");for(var r in e)e.hasOwnProperty(r)&&t.indexOf(r)>=0&&(this[r]=e[r]);this.id="",this.objectNumber=-1}function KA(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function Ef(e,t,r,a,n){if(!(this instanceof Ef))return new Ef(e,t,r,a,n);this.type=e==="axial"?2:3,this.coords=t,this.colors=r,KA.call(this,a,n)}function K0(e,t,r,a,n){if(!(this instanceof K0))return new K0(e,t,r,a,n);this.boundingBox=e,this.xStep=t,this.yStep=r,this.stream="",this.cloneIndex=0,KA.call(this,a,n)}function dr(e){var t,r=typeof arguments[0]=="string"?arguments[0]:"p",a=arguments[1],n=arguments[2],s=arguments[3],o=[],c=1,u=16,h="S",p=null;va(e=e||{})==="object"&&(r=e.orientation,a=e.unit||a,n=e.format||n,s=e.compress||e.compressPdf||s,(p=e.encryption||null)!==null&&(p.userPassword=p.userPassword||"",p.ownerPassword=p.ownerPassword||"",p.userPermissions=p.userPermissions||[]),c=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(t=e.precision),e.floatPrecision!==void 0&&(u=e.floatPrecision),h=e.defaultPathOperation||"S"),o=e.filters||(s===!0?["FlateEncode"]:o),a=a||"mm",r=(""+(r||"P")).toLowerCase();var x=e.putOnlyUsedFonts||!1,v={},g={internal:{},__private__:{}};g.__private__.PubSub=Y4;var w="1.3",b=g.__private__.getPdfVersion=function(){return w};g.__private__.setPdfVersion=function(k){w=k};var N={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};g.__private__.getPageFormats=function(){return N};var _=g.__private__.getPageFormat=function(k){return N[k]};n=n||"a4";var E={COMPAT:"compat",ADVANCED:"advanced"},j=E.COMPAT;function M(){this.saveGraphicsState(),de(new Qt(wt,0,0,-wt,0,wl()*wt).toString()+" cm"),this.setFontSize(this.getFontSize()/wt),h="n",j=E.ADVANCED}function U(){this.restoreGraphicsState(),h="S",j=E.COMPAT}var V=g.__private__.combineFontStyleAndFontWeight=function(k,ae){if(k=="bold"&&ae=="normal"||k=="bold"&&ae==400||k=="normal"&&ae=="italic"||k=="bold"&&ae=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return ae&&(k=ae==400||ae==="normal"?k==="italic"?"italic":"normal":ae!=700&&ae!=="bold"||k!=="normal"?(ae==700?"bold":ae)+""+k:"bold"),k};g.advancedAPI=function(k){var ae=j===E.COMPAT;return ae&&M.call(this),typeof k!="function"||(k(this),ae&&U.call(this)),this},g.compatAPI=function(k){var ae=j===E.ADVANCED;return ae&&U.call(this),typeof k!="function"||(k(this),ae&&M.call(this)),this},g.isAdvancedAPI=function(){return j===E.ADVANCED};var I,z=function(k){if(j!==E.ADVANCED)throw new Error(k+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},H=g.roundToPrecision=g.__private__.roundToPrecision=function(k,ae){var Te=t||ae;if(isNaN(k)||isNaN(Te))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return k.toFixed(Te).replace(/0+$/,"")};I=g.hpf=g.__private__.hpf=typeof u=="number"?function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.hpf");return H(k,u)}:u==="smart"?function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.hpf");return H(k,k>-1&&k<1?16:5)}:function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.hpf");return H(k,16)};var re=g.f2=g.__private__.f2=function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.f2");return H(k,2)},R=g.__private__.f3=function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.f3");return H(k,3)},F=g.scale=g.__private__.scale=function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.scale");return j===E.COMPAT?k*wt:j===E.ADVANCED?k:void 0},Y=function(k){return j===E.COMPAT?wl()-k:j===E.ADVANCED?k:void 0},K=function(k){return F(Y(k))};g.__private__.setPrecision=g.setPrecision=function(k){typeof parseInt(k,10)=="number"&&(t=parseInt(k,10))};var X,Z="00000000000000000000000000000000",ce=g.__private__.getFileId=function(){return Z},te=g.__private__.setFileId=function(k){return Z=k!==void 0&&/^[a-fA-F0-9]{32}$/.test(k)?k.toUpperCase():Z.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),p!==null&&(on=new V0(p.userPermissions,p.userPassword,p.ownerPassword,Z)),Z};g.setFileId=function(k){return te(k),this},g.getFileId=function(){return ce()};var Q=g.__private__.convertDateToPDFDate=function(k){var ae=k.getTimezoneOffset(),Te=ae<0?"+":"-",Fe=Math.floor(Math.abs(ae/60)),qe=Math.abs(ae%60),ft=[Te,L(Fe),"'",L(qe),"'"].join("");return["D:",k.getFullYear(),L(k.getMonth()+1),L(k.getDate()),L(k.getHours()),L(k.getMinutes()),L(k.getSeconds()),ft].join("")},G=g.__private__.convertPDFDateToDate=function(k){var ae=parseInt(k.substr(2,4),10),Te=parseInt(k.substr(6,2),10)-1,Fe=parseInt(k.substr(8,2),10),qe=parseInt(k.substr(10,2),10),ft=parseInt(k.substr(12,2),10),_t=parseInt(k.substr(14,2),10);return new Date(ae,Te,Fe,qe,ft,_t,0)},ye=g.__private__.setCreationDate=function(k){var ae;if(k===void 0&&(k=new Date),k instanceof Date)ae=Q(k);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(k))throw new Error("Invalid argument passed to jsPDF.setCreationDate");ae=k}return X=ae},D=g.__private__.getCreationDate=function(k){var ae=X;return k==="jsDate"&&(ae=G(X)),ae};g.setCreationDate=function(k){return ye(k),this},g.getCreationDate=function(k){return D(k)};var O,L=g.__private__.padd2=function(k){return("0"+parseInt(k)).slice(-2)},q=g.__private__.padd2Hex=function(k){return("00"+(k=k.toString())).substr(k.length)},oe=0,be=[],ve=[],ue=0,fe=[],Ee=[],J=!1,Pe=ve,st=function(){oe=0,ue=0,ve=[],be=[],fe=[],pe=ha(),ge=ha()};g.__private__.setCustomOutputDestination=function(k){J=!0,Pe=k};var ke=function(k){J||(Pe=k)};g.__private__.resetCustomOutputDestination=function(){J=!1,Pe=ve};var de=g.__private__.out=function(k){return k=k.toString(),ue+=k.length+1,Pe.push(k),Pe},rt=g.__private__.write=function(k){return de(arguments.length===1?k.toString():Array.prototype.join.call(arguments," "))},Ue=g.__private__.getArrayBuffer=function(k){for(var ae=k.length,Te=new ArrayBuffer(ae),Fe=new Uint8Array(Te);ae--;)Fe[ae]=k.charCodeAt(ae);return Te},Xe=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];g.__private__.getStandardFonts=function(){return Xe};var ot=e.fontSize||16;g.__private__.setFontSize=g.setFontSize=function(k){return ot=j===E.ADVANCED?k/wt:k,this};var ut,vt=g.__private__.getFontSize=g.getFontSize=function(){return j===E.COMPAT?ot:ot*wt},At=e.R2L||!1;g.__private__.setR2L=g.setR2L=function(k){return At=k,this},g.__private__.getR2L=g.getR2L=function(){return At};var ct,ze=g.__private__.setZoomMode=function(k){var ae=[void 0,null,"fullwidth","fullheight","fullpage","original"];if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(k))ut=k;else if(isNaN(k)){if(ae.indexOf(k)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+k+'" is not recognized.');ut=k}else ut=parseInt(k,10)};g.__private__.getZoomMode=function(){return ut};var pt,Ot=g.__private__.setPageMode=function(k){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(k)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+k+'" is not recognized.');ct=k};g.__private__.getPageMode=function(){return ct};var It=g.__private__.setLayoutMode=function(k){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(k)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+k+'" is not recognized.');pt=k};g.__private__.getLayoutMode=function(){return pt},g.__private__.setDisplayMode=g.setDisplayMode=function(k,ae,Te){return ze(k),It(ae),Ot(Te),this};var Lt={title:"",subject:"",author:"",keywords:"",creator:""};g.__private__.getDocumentProperty=function(k){if(Object.keys(Lt).indexOf(k)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Lt[k]},g.__private__.getDocumentProperties=function(){return Lt},g.__private__.setDocumentProperties=g.setProperties=g.setDocumentProperties=function(k){for(var ae in Lt)Lt.hasOwnProperty(ae)&&k[ae]&&(Lt[ae]=k[ae]);return this},g.__private__.setDocumentProperty=function(k,ae){if(Object.keys(Lt).indexOf(k)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Lt[k]=ae};var Ct,wt,hr,zt,Yt,Sr={},Mr={},fa=[],Ir={},gi={},na={},Ja={},Dn=null,Br=0,sr=[],kr=new Y4(g),As=e.hotfixes||[],ka={},Ea={},gn=[],Qt=function k(ae,Te,Fe,qe,ft,_t){if(!(this instanceof k))return new k(ae,Te,Fe,qe,ft,_t);isNaN(ae)&&(ae=1),isNaN(Te)&&(Te=0),isNaN(Fe)&&(Fe=0),isNaN(qe)&&(qe=1),isNaN(ft)&&(ft=0),isNaN(_t)&&(_t=0),this._matrix=[ae,Te,Fe,qe,ft,_t]};Object.defineProperty(Qt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(k){this._matrix[0]=k}}),Object.defineProperty(Qt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(k){this._matrix[1]=k}}),Object.defineProperty(Qt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(k){this._matrix[2]=k}}),Object.defineProperty(Qt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(k){this._matrix[3]=k}}),Object.defineProperty(Qt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(k){this._matrix[4]=k}}),Object.defineProperty(Qt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(k){this._matrix[5]=k}}),Object.defineProperty(Qt.prototype,"a",{get:function(){return this._matrix[0]},set:function(k){this._matrix[0]=k}}),Object.defineProperty(Qt.prototype,"b",{get:function(){return this._matrix[1]},set:function(k){this._matrix[1]=k}}),Object.defineProperty(Qt.prototype,"c",{get:function(){return this._matrix[2]},set:function(k){this._matrix[2]=k}}),Object.defineProperty(Qt.prototype,"d",{get:function(){return this._matrix[3]},set:function(k){this._matrix[3]=k}}),Object.defineProperty(Qt.prototype,"e",{get:function(){return this._matrix[4]},set:function(k){this._matrix[4]=k}}),Object.defineProperty(Qt.prototype,"f",{get:function(){return this._matrix[5]},set:function(k){this._matrix[5]=k}}),Object.defineProperty(Qt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Qt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Qt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Qt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Qt.prototype.join=function(k){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(I).join(k)},Qt.prototype.multiply=function(k){var ae=k.sx*this.sx+k.shy*this.shx,Te=k.sx*this.shy+k.shy*this.sy,Fe=k.shx*this.sx+k.sy*this.shx,qe=k.shx*this.shy+k.sy*this.sy,ft=k.tx*this.sx+k.ty*this.shx+this.tx,_t=k.tx*this.shy+k.ty*this.sy+this.ty;return new Qt(ae,Te,Fe,qe,ft,_t)},Qt.prototype.decompose=function(){var k=this.sx,ae=this.shy,Te=this.shx,Fe=this.sy,qe=this.tx,ft=this.ty,_t=Math.sqrt(k*k+ae*ae),qt=(k/=_t)*Te+(ae/=_t)*Fe;Te-=k*qt,Fe-=ae*qt;var tr=Math.sqrt(Te*Te+Fe*Fe);return qt/=tr,k*(Fe/=tr)<ae*(Te/=tr)&&(k=-k,ae=-ae,qt=-qt,_t=-_t),{scale:new Qt(_t,0,0,tr,0,0),translate:new Qt(1,0,0,1,qe,ft),rotate:new Qt(k,ae,-ae,k,0,0),skew:new Qt(1,0,qt,1,0,0)}},Qt.prototype.toString=function(k){return this.join(" ")},Qt.prototype.inversed=function(){var k=this.sx,ae=this.shy,Te=this.shx,Fe=this.sy,qe=this.tx,ft=this.ty,_t=1/(k*Fe-ae*Te),qt=Fe*_t,tr=-ae*_t,Ar=-Te*_t,br=k*_t;return new Qt(qt,tr,Ar,br,-qt*qe-Ar*ft,-tr*qe-br*ft)},Qt.prototype.applyToPoint=function(k){var ae=k.x*this.sx+k.y*this.shx+this.tx,Te=k.x*this.shy+k.y*this.sy+this.ty;return new ts(ae,Te)},Qt.prototype.applyToRectangle=function(k){var ae=this.applyToPoint(k),Te=this.applyToPoint(new ts(k.x+k.w,k.y+k.h));return new Hn(ae.x,ae.y,Te.x-ae.x,Te.y-ae.y)},Qt.prototype.clone=function(){var k=this.sx,ae=this.shy,Te=this.shx,Fe=this.sy,qe=this.tx,ft=this.ty;return new Qt(k,ae,Te,Fe,qe,ft)},g.Matrix=Qt;var Un=g.matrixMult=function(k,ae){return ae.multiply(k)},Vr=new Qt(1,0,0,1,0,0);g.unitMatrix=g.identityMatrix=Vr;var qa=function(k,ae){if(!gi[k]){var Te=(ae instanceof Ef?"Sh":"P")+(Object.keys(Ir).length+1).toString(10);ae.id=Te,gi[k]=Te,Ir[Te]=ae,kr.publish("addPattern",ae)}};g.ShadingPattern=Ef,g.TilingPattern=K0,g.addShadingPattern=function(k,ae){return z("addShadingPattern()"),qa(k,ae),this},g.beginTilingPattern=function(k){z("beginTilingPattern()"),Ds(k.boundingBox[0],k.boundingBox[1],k.boundingBox[2]-k.boundingBox[0],k.boundingBox[3]-k.boundingBox[1],k.matrix)},g.endTilingPattern=function(k,ae){z("endTilingPattern()"),ae.stream=Ee[O].join(`
`),qa(k,ae),kr.publish("endTilingPattern",ae),gn.pop().restore()};var qr=g.__private__.newObject=function(){var k=ha();return ne(k,!0),k},ha=g.__private__.newObjectDeferred=function(){return oe++,be[oe]=function(){return ue},oe},ne=function(k,ae){return ae=typeof ae=="boolean"&&ae,be[k]=ue,ae&&de(k+" 0 obj"),k},Ne=g.__private__.newAdditionalObject=function(){var k={objId:ha(),content:""};return fe.push(k),k},pe=ha(),ge=ha(),Se=g.__private__.decodeColorString=function(k){var ae=k.split(" ");if(ae.length!==2||ae[1]!=="g"&&ae[1]!=="G")ae.length===5&&(ae[4]==="k"||ae[4]==="K")&&(ae=[(1-ae[0])*(1-ae[3]),(1-ae[1])*(1-ae[3]),(1-ae[2])*(1-ae[3]),"r"]);else{var Te=parseFloat(ae[0]);ae=[Te,Te,Te,"r"]}for(var Fe="#",qe=0;qe<3;qe++)Fe+=("0"+Math.floor(255*parseFloat(ae[qe])).toString(16)).slice(-2);return Fe},_e=g.__private__.encodeColorString=function(k){var ae;typeof k=="string"&&(k={ch1:k});var Te=k.ch1,Fe=k.ch2,qe=k.ch3,ft=k.ch4,_t=k.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof Te=="string"&&Te.charAt(0)!=="#"){var qt=new YA(Te);if(qt.ok)Te=qt.toHex();else if(!/^\d*\.?\d*$/.test(Te))throw new Error('Invalid color "'+Te+'" passed to jsPDF.encodeColorString.')}if(typeof Te=="string"&&/^#[0-9A-Fa-f]{3}$/.test(Te)&&(Te="#"+Te[1]+Te[1]+Te[2]+Te[2]+Te[3]+Te[3]),typeof Te=="string"&&/^#[0-9A-Fa-f]{6}$/.test(Te)){var tr=parseInt(Te.substr(1),16);Te=tr>>16&255,Fe=tr>>8&255,qe=255&tr}if(Fe===void 0||ft===void 0&&Te===Fe&&Fe===qe)if(typeof Te=="string")ae=Te+" "+_t[0];else switch(k.precision){case 2:ae=re(Te/255)+" "+_t[0];break;case 3:default:ae=R(Te/255)+" "+_t[0]}else if(ft===void 0||va(ft)==="object"){if(ft&&!isNaN(ft.a)&&ft.a===0)return ae=["1.","1.","1.",_t[1]].join(" ");if(typeof Te=="string")ae=[Te,Fe,qe,_t[1]].join(" ");else switch(k.precision){case 2:ae=[re(Te/255),re(Fe/255),re(qe/255),_t[1]].join(" ");break;default:case 3:ae=[R(Te/255),R(Fe/255),R(qe/255),_t[1]].join(" ")}}else if(typeof Te=="string")ae=[Te,Fe,qe,ft,_t[2]].join(" ");else switch(k.precision){case 2:ae=[re(Te),re(Fe),re(qe),re(ft),_t[2]].join(" ");break;case 3:default:ae=[R(Te),R(Fe),R(qe),R(ft),_t[2]].join(" ")}return ae},Ye=g.__private__.getFilters=function(){return o},lt=g.__private__.putStream=function(k){var ae=(k=k||{}).data||"",Te=k.filters||Ye(),Fe=k.alreadyAppliedFilters||[],qe=k.addLength1||!1,ft=ae.length,_t=k.objectId,qt=function(Qa){return Qa};if(p!==null&&_t===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");p!==null&&(qt=on.encryptor(_t,0));var tr={};Te===!0&&(Te=["FlateEncode"]);var Ar=k.additionalKeyValues||[],br=(tr=dr.API.processDataByFilters!==void 0?dr.API.processDataByFilters(ae,Te):{data:ae,reverseChain:[]}).reverseChain+(Array.isArray(Fe)?Fe.join(" "):Fe.toString());if(tr.data.length!==0&&(Ar.push({key:"Length",value:tr.data.length}),qe===!0&&Ar.push({key:"Length1",value:ft})),br.length!=0)if(br.split("/").length-1==1)Ar.push({key:"Filter",value:br});else{Ar.push({key:"Filter",value:"["+br+"]"});for(var Gr=0;Gr<Ar.length;Gr+=1)if(Ar[Gr].key==="DecodeParms"){for(var Ca=[],Ra=0;Ra<tr.reverseChain.split("/").length-1;Ra+=1)Ca.push("null");Ca.push(Ar[Gr].value),Ar[Gr].value="["+Ca.join(" ")+"]"}}de("<<");for(var Za=0;Za<Ar.length;Za++)de("/"+Ar[Za].key+" "+Ar[Za].value);de(">>"),tr.data.length!==0&&(de("stream"),de(qt(tr.data)),de("endstream"))},We=g.__private__.putPage=function(k){var ae=k.number,Te=k.data,Fe=k.objId,qe=k.contentsObjId;ne(Fe,!0),de("<</Type /Page"),de("/Parent "+k.rootDictionaryObjId+" 0 R"),de("/Resources "+k.resourceDictionaryObjId+" 0 R"),de("/MediaBox ["+parseFloat(I(k.mediaBox.bottomLeftX))+" "+parseFloat(I(k.mediaBox.bottomLeftY))+" "+I(k.mediaBox.topRightX)+" "+I(k.mediaBox.topRightY)+"]"),k.cropBox!==null&&de("/CropBox ["+I(k.cropBox.bottomLeftX)+" "+I(k.cropBox.bottomLeftY)+" "+I(k.cropBox.topRightX)+" "+I(k.cropBox.topRightY)+"]"),k.bleedBox!==null&&de("/BleedBox ["+I(k.bleedBox.bottomLeftX)+" "+I(k.bleedBox.bottomLeftY)+" "+I(k.bleedBox.topRightX)+" "+I(k.bleedBox.topRightY)+"]"),k.trimBox!==null&&de("/TrimBox ["+I(k.trimBox.bottomLeftX)+" "+I(k.trimBox.bottomLeftY)+" "+I(k.trimBox.topRightX)+" "+I(k.trimBox.topRightY)+"]"),k.artBox!==null&&de("/ArtBox ["+I(k.artBox.bottomLeftX)+" "+I(k.artBox.bottomLeftY)+" "+I(k.artBox.topRightX)+" "+I(k.artBox.topRightY)+"]"),typeof k.userUnit=="number"&&k.userUnit!==1&&de("/UserUnit "+k.userUnit),kr.publish("putPage",{objId:Fe,pageContext:sr[ae],pageNumber:ae,page:Te}),de("/Contents "+qe+" 0 R"),de(">>"),de("endobj");var ft=Te.join(`
`);return j===E.ADVANCED&&(ft+=`
Q`),ne(qe,!0),lt({data:ft,filters:Ye(),objectId:qe}),de("endobj"),Fe},$e=g.__private__.putPages=function(){var k,ae,Te=[];for(k=1;k<=Br;k++)sr[k].objId=ha(),sr[k].contentsObjId=ha();for(k=1;k<=Br;k++)Te.push(We({number:k,data:Ee[k],objId:sr[k].objId,contentsObjId:sr[k].contentsObjId,mediaBox:sr[k].mediaBox,cropBox:sr[k].cropBox,bleedBox:sr[k].bleedBox,trimBox:sr[k].trimBox,artBox:sr[k].artBox,userUnit:sr[k].userUnit,rootDictionaryObjId:pe,resourceDictionaryObjId:ge}));ne(pe,!0),de("<</Type /Pages");var Fe="/Kids [";for(ae=0;ae<Br;ae++)Fe+=Te[ae]+" 0 R ";de(Fe+"]"),de("/Count "+Br),de(">>"),de("endobj"),kr.publish("postPutPages")},Qe=function(k){kr.publish("putFont",{font:k,out:de,newObject:qr,putStream:lt}),k.isAlreadyPutted!==!0&&(k.objectNumber=qr(),de("<<"),de("/Type /Font"),de("/BaseFont /"+q0(k.postScriptName)),de("/Subtype /Type1"),typeof k.encoding=="string"&&de("/Encoding /"+k.encoding),de("/FirstChar 32"),de("/LastChar 255"),de(">>"),de("endobj"))},St=function(){for(var k in Sr)Sr.hasOwnProperty(k)&&(x===!1||x===!0&&v.hasOwnProperty(k))&&Qe(Sr[k])},jt=function(k){k.objectNumber=qr();var ae=[];ae.push({key:"Type",value:"/XObject"}),ae.push({key:"Subtype",value:"/Form"}),ae.push({key:"BBox",value:"["+[I(k.x),I(k.y),I(k.x+k.width),I(k.y+k.height)].join(" ")+"]"}),ae.push({key:"Matrix",value:"["+k.matrix.toString()+"]"});var Te=k.pages[1].join(`
`);lt({data:Te,additionalKeyValues:ae,objectId:k.objectNumber}),de("endobj")},Ut=function(){for(var k in ka)ka.hasOwnProperty(k)&&jt(ka[k])},ie=function(k,ae){var Te,Fe=[],qe=1/(ae-1);for(Te=0;Te<1;Te+=qe)Fe.push(Te);if(Fe.push(1),k[0].offset!=0){var ft={offset:0,color:k[0].color};k.unshift(ft)}if(k[k.length-1].offset!=1){var _t={offset:1,color:k[k.length-1].color};k.push(_t)}for(var qt="",tr=0,Ar=0;Ar<Fe.length;Ar++){for(Te=Fe[Ar];Te>k[tr+1].offset;)tr++;var br=k[tr].offset,Gr=(Te-br)/(k[tr+1].offset-br),Ca=k[tr].color,Ra=k[tr+1].color;qt+=q(Math.round((1-Gr)*Ca[0]+Gr*Ra[0]).toString(16))+q(Math.round((1-Gr)*Ca[1]+Gr*Ra[1]).toString(16))+q(Math.round((1-Gr)*Ca[2]+Gr*Ra[2]).toString(16))}return qt.trim()},Ce=function(k,ae){ae||(ae=21);var Te=qr(),Fe=ie(k.colors,ae),qe=[];qe.push({key:"FunctionType",value:"0"}),qe.push({key:"Domain",value:"[0.0 1.0]"}),qe.push({key:"Size",value:"["+ae+"]"}),qe.push({key:"BitsPerSample",value:"8"}),qe.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),qe.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),lt({data:Fe,additionalKeyValues:qe,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:Te}),de("endobj"),k.objectNumber=qr(),de("<< /ShadingType "+k.type),de("/ColorSpace /DeviceRGB");var ft="/Coords ["+I(parseFloat(k.coords[0]))+" "+I(parseFloat(k.coords[1]))+" ";k.type===2?ft+=I(parseFloat(k.coords[2]))+" "+I(parseFloat(k.coords[3])):ft+=I(parseFloat(k.coords[2]))+" "+I(parseFloat(k.coords[3]))+" "+I(parseFloat(k.coords[4]))+" "+I(parseFloat(k.coords[5])),de(ft+="]"),k.matrix&&de("/Matrix ["+k.matrix.toString()+"]"),de("/Function "+Te+" 0 R"),de("/Extend [true true]"),de(">>"),de("endobj")},Oe=function(k,ae){var Te=ha(),Fe=qr();ae.push({resourcesOid:Te,objectOid:Fe}),k.objectNumber=Fe;var qe=[];qe.push({key:"Type",value:"/Pattern"}),qe.push({key:"PatternType",value:"1"}),qe.push({key:"PaintType",value:"1"}),qe.push({key:"TilingType",value:"1"}),qe.push({key:"BBox",value:"["+k.boundingBox.map(I).join(" ")+"]"}),qe.push({key:"XStep",value:I(k.xStep)}),qe.push({key:"YStep",value:I(k.yStep)}),qe.push({key:"Resources",value:Te+" 0 R"}),k.matrix&&qe.push({key:"Matrix",value:"["+k.matrix.toString()+"]"}),lt({data:k.stream,additionalKeyValues:qe,objectId:k.objectNumber}),de("endobj")},Ve=function(k){var ae;for(ae in Ir)Ir.hasOwnProperty(ae)&&(Ir[ae]instanceof Ef?Ce(Ir[ae]):Ir[ae]instanceof K0&&Oe(Ir[ae],k))},kt=function(k){for(var ae in k.objectNumber=qr(),de("<<"),k)switch(ae){case"opacity":de("/ca "+re(k[ae]));break;case"stroke-opacity":de("/CA "+re(k[ae]))}de(">>"),de("endobj")},Ht=function(){var k;for(k in na)na.hasOwnProperty(k)&&kt(na[k])},Ft=function(){for(var k in de("/XObject <<"),ka)ka.hasOwnProperty(k)&&ka[k].objectNumber>=0&&de("/"+k+" "+ka[k].objectNumber+" 0 R");kr.publish("putXobjectDict"),de(">>")},ir=function(){on.oid=qr(),de("<<"),de("/Filter /Standard"),de("/V "+on.v),de("/R "+on.r),de("/U <"+on.toHexString(on.U)+">"),de("/O <"+on.toHexString(on.O)+">"),de("/P "+on.P),de(">>"),de("endobj")},Gt=function(){for(var k in de("/Font <<"),Sr)Sr.hasOwnProperty(k)&&(x===!1||x===!0&&v.hasOwnProperty(k))&&de("/"+k+" "+Sr[k].objectNumber+" 0 R");de(">>")},yr=function(){if(Object.keys(Ir).length>0){for(var k in de("/Shading <<"),Ir)Ir.hasOwnProperty(k)&&Ir[k]instanceof Ef&&Ir[k].objectNumber>=0&&de("/"+k+" "+Ir[k].objectNumber+" 0 R");kr.publish("putShadingPatternDict"),de(">>")}},Pr=function(k){if(Object.keys(Ir).length>0){for(var ae in de("/Pattern <<"),Ir)Ir.hasOwnProperty(ae)&&Ir[ae]instanceof g.TilingPattern&&Ir[ae].objectNumber>=0&&Ir[ae].objectNumber<k&&de("/"+ae+" "+Ir[ae].objectNumber+" 0 R");kr.publish("putTilingPatternDict"),de(">>")}},er=function(){if(Object.keys(na).length>0){var k;for(k in de("/ExtGState <<"),na)na.hasOwnProperty(k)&&na[k].objectNumber>=0&&de("/"+k+" "+na[k].objectNumber+" 0 R");kr.publish("putGStateDict"),de(">>")}},rr=function(k){ne(k.resourcesOid,!0),de("<<"),de("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),Gt(),yr(),Pr(k.objectOid),er(),Ft(),de(">>"),de("endobj")},Ur=function(){var k=[];St(),Ht(),Ut(),Ve(k),kr.publish("putResources"),k.forEach(rr),rr({resourcesOid:ge,objectOid:Number.MAX_SAFE_INTEGER}),kr.publish("postPutResources")},ja=function(){kr.publish("putAdditionalObjects");for(var k=0;k<fe.length;k++){var ae=fe[k];ne(ae.objId,!0),de(ae.content),de("endobj")}kr.publish("postPutAdditionalObjects")},zn=function(k){Mr[k.fontName]=Mr[k.fontName]||{},Mr[k.fontName][k.fontStyle]=k.id},ei=function(k,ae,Te,Fe,qe){var ft={id:"F"+(Object.keys(Sr).length+1).toString(10),postScriptName:k,fontName:ae,fontStyle:Te,encoding:Fe,isStandardFont:qe||!1,metadata:{}};return kr.publish("addFont",{font:ft,instance:this}),Sr[ft.id]=ft,zn(ft),ft.id},ti=function(k){for(var ae=0,Te=Xe.length;ae<Te;ae++){var Fe=ei.call(this,k[ae][0],k[ae][1],k[ae][2],Xe[ae][3],!0);x===!1&&(v[Fe]=!0);var qe=k[ae][0].split("-");zn({id:Fe,fontName:qe[0],fontStyle:qe[1]||""})}kr.publish("addFonts",{fonts:Sr,dictionary:Mr})},Ka=function(k){return k.foo=function(){try{return k.apply(this,arguments)}catch(Fe){var ae=Fe.stack||"";~ae.indexOf(" at ")&&(ae=ae.split(" at ")[1]);var Te="Error in function "+ae.split(`
`)[0].split("<")[0]+": "+Fe.message;if(!gr.console)throw new Error(Te);gr.console.error(Te,Fe),gr.alert&&alert(Te)}},k.foo.bar=k,k.foo},Aa=function(k,ae){var Te,Fe,qe,ft,_t,qt,tr,Ar,br;if(qe=(ae=ae||{}).sourceEncoding||"Unicode",_t=ae.outputEncoding,(ae.autoencode||_t)&&Sr[Ct].metadata&&Sr[Ct].metadata[qe]&&Sr[Ct].metadata[qe].encoding&&(ft=Sr[Ct].metadata[qe].encoding,!_t&&Sr[Ct].encoding&&(_t=Sr[Ct].encoding),!_t&&ft.codePages&&(_t=ft.codePages[0]),typeof _t=="string"&&(_t=ft[_t]),_t)){for(tr=!1,qt=[],Te=0,Fe=k.length;Te<Fe;Te++)(Ar=_t[k.charCodeAt(Te)])?qt.push(String.fromCharCode(Ar)):qt.push(k[Te]),qt[Te].charCodeAt(0)>>8&&(tr=!0);k=qt.join("")}for(Te=k.length;tr===void 0&&Te!==0;)k.charCodeAt(Te-1)>>8&&(tr=!0),Te--;if(!tr)return k;for(qt=ae.noBOM?[]:[254,255],Te=0,Fe=k.length;Te<Fe;Te++){if((br=(Ar=k.charCodeAt(Te))>>8)>>8)throw new Error("Character at position "+Te+" of string '"+k+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");qt.push(br),qt.push(Ar-(br<<8))}return String.fromCharCode.apply(void 0,qt)},da=g.__private__.pdfEscape=g.pdfEscape=function(k,ae){return Aa(k,ae).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},ca=g.__private__.beginPage=function(k){Ee[++Br]=[],sr[Br]={objId:0,contentsObjId:0,userUnit:Number(c),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(k[0]),topRightY:Number(k[1])}},_s(Br),ke(Ee[O])},Kn=function(k,ae){var Te,Fe,qe;switch(r=ae||r,typeof k=="string"&&(Te=_(k.toLowerCase()),Array.isArray(Te)&&(Fe=Te[0],qe=Te[1])),Array.isArray(k)&&(Fe=k[0]*wt,qe=k[1]*wt),isNaN(Fe)&&(Fe=n[0],qe=n[1]),(Fe>14400||qe>14400)&&(Ta.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),Fe=Math.min(14400,Fe),qe=Math.min(14400,qe)),n=[Fe,qe],r.substr(0,1)){case"l":qe>Fe&&(n=[qe,Fe]);break;case"p":Fe>qe&&(n=[qe,Fe])}ca(n),tt(Ae),de(lr),Pn!==0&&de(Pn+" J"),yn!==0&&de(yn+" j"),kr.publish("addPage",{pageNumber:Br})},ri=function(k){k>0&&k<=Br&&(Ee.splice(k,1),sr.splice(k,1),Br--,O>Br&&(O=Br),this.setPage(O))},_s=function(k){k>0&&k<=Br&&(O=k)},Ts=g.__private__.getNumberOfPages=g.getNumberOfPages=function(){return Ee.length-1},ai=function(k,ae,Te){var Fe,qe=void 0;return Te=Te||{},k=k!==void 0?k:Sr[Ct].fontName,ae=ae!==void 0?ae:Sr[Ct].fontStyle,Fe=k.toLowerCase(),Mr[Fe]!==void 0&&Mr[Fe][ae]!==void 0?qe=Mr[Fe][ae]:Mr[k]!==void 0&&Mr[k][ae]!==void 0?qe=Mr[k][ae]:Te.disableWarning===!1&&Ta.warn("Unable to look up font label for font '"+k+"', '"+ae+"'. Refer to getFontList() for available fonts."),qe||Te.noFallback||(qe=Mr.times[ae])==null&&(qe=Mr.times.normal),qe},xl=g.__private__.putInfo=function(){var k=qr(),ae=function(Fe){return Fe};for(var Te in p!==null&&(ae=on.encryptor(k,0)),de("<<"),de("/Producer ("+da(ae("jsPDF "+dr.version))+")"),Lt)Lt.hasOwnProperty(Te)&&Lt[Te]&&de("/"+Te.substr(0,1).toUpperCase()+Te.substr(1)+" ("+da(ae(Lt[Te]))+")");de("/CreationDate ("+da(ae(X))+")"),de(">>"),de("endobj")},ks=g.__private__.putCatalog=function(k){var ae=(k=k||{}).rootDictionaryObjId||pe;switch(qr(),de("<<"),de("/Type /Catalog"),de("/Pages "+ae+" 0 R"),ut||(ut="fullwidth"),ut){case"fullwidth":de("/OpenAction [3 0 R /FitH null]");break;case"fullheight":de("/OpenAction [3 0 R /FitV null]");break;case"fullpage":de("/OpenAction [3 0 R /Fit]");break;case"original":de("/OpenAction [3 0 R /XYZ null null 1]");break;default:var Te=""+ut;Te.substr(Te.length-1)==="%"&&(ut=parseInt(ut)/100),typeof ut=="number"&&de("/OpenAction [3 0 R /XYZ null null "+re(ut)+"]")}switch(pt||(pt="continuous"),pt){case"continuous":de("/PageLayout /OneColumn");break;case"single":de("/PageLayout /SinglePage");break;case"two":case"twoleft":de("/PageLayout /TwoColumnLeft");break;case"tworight":de("/PageLayout /TwoColumnRight")}ct&&de("/PageMode /"+ct),kr.publish("putCatalog"),de(">>"),de("endobj")},vi=g.__private__.putTrailer=function(){de("trailer"),de("<<"),de("/Size "+(oe+1)),de("/Root "+oe+" 0 R"),de("/Info "+(oe-1)+" 0 R"),p!==null&&de("/Encrypt "+on.oid+" 0 R"),de("/ID [ <"+Z+"> <"+Z+"> ]"),de(">>")},fs=g.__private__.putHeader=function(){de("%PDF-"+w),de("%ºß¬à")},ao=g.__private__.putXRef=function(){var k="0000000000";de("xref"),de("0 "+(oe+1)),de("0000000000 65535 f ");for(var ae=1;ae<=oe;ae++)typeof be[ae]=="function"?de((k+be[ae]()).slice(-10)+" 00000 n "):be[ae]!==void 0?de((k+be[ae]).slice(-10)+" 00000 n "):de("0000000000 00000 n ")},Zn=g.__private__.buildDocument=function(){st(),ke(ve),kr.publish("buildDocument"),fs(),$e(),ja(),Ur(),p!==null&&ir(),xl(),ks();var k=ue;return ao(),vi(),de("startxref"),de(""+k),de("%%EOF"),ke(Ee[O]),ve.join(`
`)},Qn=g.__private__.getBlob=function(k){return new Blob([Ue(k)],{type:"application/pdf"})},Fi=g.output=g.__private__.output=Ka(function(k,ae){switch(typeof(ae=ae||{})=="string"?ae={filename:ae}:ae.filename=ae.filename||"generated.pdf",k){case void 0:return Zn();case"save":g.save(ae.filename);break;case"arraybuffer":return Ue(Zn());case"blob":return Qn(Zn());case"bloburi":case"bloburl":if(gr.URL!==void 0&&typeof gr.URL.createObjectURL=="function")return gr.URL&&gr.URL.createObjectURL(Qn(Zn()))||void 0;Ta.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var Te="",Fe=Zn();try{Te=Z2(Fe)}catch{Te=Z2(unescape(encodeURIComponent(Fe)))}return"data:application/pdf;filename="+ae.filename+";base64,"+Te;case"pdfobjectnewwindow":if(Object.prototype.toString.call(gr)==="[object Window]"){var qe="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",ft=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';ae.pdfObjectUrl&&(qe=ae.pdfObjectUrl,ft="");var _t='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+qe+'"'+ft+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(ae)+");<\/script></body></html>",qt=gr.open();return qt!==null&&qt.document.write(_t),qt}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(gr)==="[object Window]"){var tr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(ae.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+ae.filename+'" width="500px" height="400px" /></body></html>',Ar=gr.open();if(Ar!==null){Ar.document.write(tr);var br=this;Ar.document.documentElement.querySelector("#pdfViewer").onload=function(){Ar.document.title=ae.filename,Ar.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(br.output("bloburl"))}}return Ar}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(gr)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Gr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",ae)+'"></iframe></body></html>',Ca=gr.open();if(Ca!==null&&(Ca.document.write(Gr),Ca.document.title=ae.filename),Ca||typeof safari>"u")return Ca;break;case"datauri":case"dataurl":return gr.document.location.href=this.output("datauristring",ae);default:return null}}),no=function(k){return Array.isArray(As)===!0&&As.indexOf(k)>-1};switch(a){case"pt":wt=1;break;case"mm":wt=72/25.4;break;case"cm":wt=72/2.54;break;case"in":wt=72;break;case"px":wt=no("px_scaling")==1?.75:96/72;break;case"pc":case"em":wt=12;break;case"ex":wt=6;break;default:if(typeof a!="number")throw new Error("Invalid unit: "+a);wt=a}var on=null;ye(),te();var tc=function(k){return p!==null?on.encryptor(k,0):function(ae){return ae}},ni=g.__private__.getPageInfo=g.getPageInfo=function(k){if(isNaN(k)||k%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:sr[k].objId,pageNumber:k,pageContext:sr[k]}},nr=g.__private__.getPageInfoByObjId=function(k){if(isNaN(k)||k%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var ae in sr)if(sr[ae].objId===k)break;return ni(ae)},$c=g.__private__.getCurrentPageInfo=g.getCurrentPageInfo=function(){return{objId:sr[O].objId,pageNumber:O,pageContext:sr[O]}};g.addPage=function(){return Kn.apply(this,arguments),this},g.setPage=function(){return _s.apply(this,arguments),ke.call(this,Ee[O]),this},g.insertPage=function(k){return this.addPage(),this.movePage(O,k),this},g.movePage=function(k,ae){var Te,Fe;if(k>ae){Te=Ee[k],Fe=sr[k];for(var qe=k;qe>ae;qe--)Ee[qe]=Ee[qe-1],sr[qe]=sr[qe-1];Ee[ae]=Te,sr[ae]=Fe,this.setPage(ae)}else if(k<ae){Te=Ee[k],Fe=sr[k];for(var ft=k;ft<ae;ft++)Ee[ft]=Ee[ft+1],sr[ft]=sr[ft+1];Ee[ae]=Te,sr[ae]=Fe,this.setPage(ae)}return this},g.deletePage=function(){return ri.apply(this,arguments),this},g.__private__.text=g.text=function(k,ae,Te,Fe,qe){var ft,_t,qt,tr,Ar,br,Gr,Ca,Ra,Za=(Fe=Fe||{}).scope||this;if(typeof k=="number"&&typeof ae=="number"&&(typeof Te=="string"||Array.isArray(Te))){var Qa=Te;Te=ae,ae=k,k=Qa}if(arguments[3]instanceof Qt?(z("The transform parameter of text() with a Matrix value"),Ra=qe):(qt=arguments[4],tr=arguments[5],va(Gr=arguments[3])==="object"&&Gr!==null||(typeof qt=="string"&&(tr=qt,qt=null),typeof Gr=="string"&&(tr=Gr,Gr=null),typeof Gr=="number"&&(qt=Gr,Gr=null),Fe={flags:Gr,angle:qt,align:tr})),isNaN(ae)||isNaN(Te)||k==null)throw new Error("Invalid arguments passed to jsPDF.text");if(k.length===0)return Za;var Ln="",Li=!1,ii=typeof Fe.lineHeightFactor=="number"?Fe.lineHeightFactor:hs,Oi=Za.internal.scaleFactor;function Yu(Lr){return Lr=Lr.split("	").join(Array(Fe.TabLen||9).join(" ")),da(Lr,Gr)}function Lo(Lr){for(var ea,Ia=Lr.concat(),$a=[],Si=Ia.length;Si--;)typeof(ea=Ia.shift())=="string"?$a.push(ea):Array.isArray(Lr)&&(ea.length===1||ea[1]===void 0&&ea[2]===void 0)?$a.push(ea[0]):$a.push([ea[0],ea[1],ea[2]]);return $a}function Oo(Lr,ea){var Ia;if(typeof Lr=="string")Ia=ea(Lr)[0];else if(Array.isArray(Lr)){for(var $a,Si,lc=Lr.concat(),ci=[],Qu=lc.length;Qu--;)typeof($a=lc.shift())=="string"?ci.push(ea($a)[0]):Array.isArray($a)&&typeof $a[0]=="string"&&(Si=ea($a[0],$a[1],$a[2]),ci.push([Si[0],Si[1],Si[2]]));Ia=ci}return Ia}var Yc=!1,bl=!0;if(typeof k=="string")Yc=!0;else if(Array.isArray(k)){var Jc=k.concat();_t=[];for(var ac,wn=Jc.length;wn--;)(typeof(ac=Jc.shift())!="string"||Array.isArray(ac)&&typeof ac[0]!="string")&&(bl=!1);Yc=bl}if(Yc===!1)throw new Error('Type of text must be string or Array. "'+k+'" is not recognized.');typeof k=="string"&&(k=k.match(/[\r?\n]/)?k.split(/\r\n|\r|\n/g):[k]);var Sl=ot/Za.internal.scaleFactor,nc=Sl*(ii-1);switch(Fe.baseline){case"bottom":Te-=nc;break;case"top":Te+=Sl-nc;break;case"hanging":Te+=Sl-2*nc;break;case"middle":Te+=Sl/2-nc}if((br=Fe.maxWidth||0)>0&&(typeof k=="string"?k=Za.splitTextToSize(k,br):Object.prototype.toString.call(k)==="[object Array]"&&(k=k.reduce(function(Lr,ea){return Lr.concat(Za.splitTextToSize(ea,br))},[]))),ft={text:k,x:ae,y:Te,options:Fe,mutex:{pdfEscape:da,activeFontKey:Ct,fonts:Sr,activeFontSize:ot}},kr.publish("preProcessText",ft),k=ft.text,qt=(Fe=ft.options).angle,!(Ra instanceof Qt)&&qt&&typeof qt=="number"){qt*=Math.PI/180,Fe.rotationDirection===0&&(qt=-qt),j===E.ADVANCED&&(qt=-qt);var sc=Math.cos(qt),Kc=Math.sin(qt);Ra=new Qt(sc,Kc,-Kc,sc,0,0)}else qt&&qt instanceof Qt&&(Ra=qt);j!==E.ADVANCED||Ra||(Ra=Vr),(Ar=Fe.charSpace||vn)!==void 0&&(Ln+=I(F(Ar))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Ca=Fe.horizontalScale)!==void 0&&(Ln+=I(100*Ca)+` Tz
`),Fe.lang;var Fs=-1,Ah=Fe.renderingMode!==void 0?Fe.renderingMode:Fe.stroke,Ju=Za.internal.getCurrentPageInfo().pageContext;switch(Ah){case 0:case!1:case"fill":Fs=0;break;case 1:case!0:case"stroke":Fs=1;break;case 2:case"fillThenStroke":Fs=2;break;case 3:case"invisible":Fs=3;break;case 4:case"fillAndAddForClipping":Fs=4;break;case 5:case"strokeAndAddPathForClipping":Fs=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Fs=6;break;case 7:case"addToPathForClipping":Fs=7}var o0=Ju.usedRenderingMode!==void 0?Ju.usedRenderingMode:-1;Fs!==-1?Ln+=Fs+` Tr
`:o0!==-1&&(Ln+=`0 Tr
`),Fs!==-1&&(Ju.usedRenderingMode=Fs),tr=Fe.align||"left";var bi,On=ot*ii,Nl=Za.internal.pageSize.getWidth(),Ku=Sr[Ct];Ar=Fe.charSpace||vn,br=Fe.maxWidth||0,Gr=Object.assign({autoencode:!0,noBOM:!0},Fe.flags);var Ro=[],Al=function(Lr){return Za.getStringUnitWidth(Lr,{font:Ku,charSpace:Ar,fontSize:ot,doKerning:!1})*ot/Oi};if(Object.prototype.toString.call(k)==="[object Array]"){var ds;_t=Lo(k),tr!=="left"&&(bi=_t.map(Al));var Vn,_l=0;if(tr==="right"){ae-=bi[0],k=[],wn=_t.length;for(var Mo=0;Mo<wn;Mo++)Mo===0?(Vn=Dt(ae),ds=Wt(Te)):(Vn=F(_l-bi[Mo]),ds=-On),k.push([_t[Mo],Vn,ds]),_l=bi[Mo]}else if(tr==="center"){ae-=bi[0]/2,k=[],wn=_t.length;for(var Ps=0;Ps<wn;Ps++)Ps===0?(Vn=Dt(ae),ds=Wt(Te)):(Vn=F((_l-bi[Ps])/2),ds=-On),k.push([_t[Ps],Vn,ds]),_l=bi[Ps]}else if(tr==="left"){k=[],wn=_t.length;for(var Tl=0;Tl<wn;Tl++)k.push(_t[Tl])}else if(tr==="justify"&&Ku.encoding==="Identity-H"){k=[],wn=_t.length,br=br!==0?br:Nl;for(var oi=0,Ma=0;Ma<wn;Ma++)if(ds=Ma===0?Wt(Te):-On,Vn=Ma===0?Dt(ae):oi,Ma<wn-1){var Zc=F((br-bi[Ma])/(_t[Ma].split(" ").length-1)),en=_t[Ma].split(" ");k.push([en[0]+" ",Vn,ds]),oi=0;for(var qn=1;qn<en.length;qn++){var kl=(Al(en[qn-1]+" "+en[qn])-Al(en[qn]))*Oi+Zc;qn==en.length-1?k.push([en[qn],kl,0]):k.push([en[qn]+" ",kl,0]),oi-=kl}}else k.push([_t[Ma],Vn,ds]);k.push(["",oi,0])}else{if(tr!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(k=[],wn=_t.length,br=br!==0?br:Nl,Ma=0;Ma<wn;Ma++)ds=Ma===0?Wt(Te):-On,Vn=Ma===0?Dt(ae):0,Ma<wn-1?Ro.push(I(F((br-bi[Ma])/(_t[Ma].split(" ").length-1)))):Ro.push(0),k.push([_t[Ma],Vn,ds])}}var Zu=typeof Fe.R2L=="boolean"?Fe.R2L:At;Zu===!0&&(k=Oo(k,function(Lr,ea,Ia){return[Lr.split("").reverse().join(""),ea,Ia]})),ft={text:k,x:ae,y:Te,options:Fe,mutex:{pdfEscape:da,activeFontKey:Ct,fonts:Sr,activeFontSize:ot}},kr.publish("postProcessText",ft),k=ft.text,Li=ft.mutex.isHex||!1;var Ri=Sr[Ct].encoding;Ri!=="WinAnsiEncoding"&&Ri!=="StandardEncoding"||(k=Oo(k,function(Lr,ea,Ia){return[Yu(Lr),ea,Ia]})),_t=Lo(k),k=[];for(var El,jl,Io,ic=0,Qc=1,oc=Array.isArray(_t[0])?Qc:ic,Bo="",eu=function(Lr,ea,Ia){var $a="";return Ia instanceof Qt?(Ia=typeof Fe.angle=="number"?Un(Ia,new Qt(1,0,0,1,Lr,ea)):Un(new Qt(1,0,0,1,Lr,ea),Ia),j===E.ADVANCED&&(Ia=Un(new Qt(1,0,0,-1,0,0),Ia)),$a=Ia.join(" ")+` Tm
`):$a=I(Lr)+" "+I(ea)+` Td
`,$a},li=0;li<_t.length;li++){switch(Bo="",oc){case Qc:Io=(Li?"<":"(")+_t[li][0]+(Li?">":")"),El=parseFloat(_t[li][1]),jl=parseFloat(_t[li][2]);break;case ic:Io=(Li?"<":"(")+_t[li]+(Li?">":")"),El=Dt(ae),jl=Wt(Te)}Ro!==void 0&&Ro[li]!==void 0&&(Bo=Ro[li]+` Tw
`),li===0?k.push(Bo+eu(El,jl,Ra)+Io):oc===ic?k.push(Bo+Io):oc===Qc&&k.push(Bo+eu(El,jl,Ra)+Io)}k=oc===ic?k.join(` Tj
T* `):k.join(` Tj
`),k+=` Tj
`;var Wa=`BT
/`;return Wa+=Ct+" "+ot+` Tf
`,Wa+=I(ot*ii)+` TL
`,Wa+=Er+`
`,Wa+=Ln,Wa+=k,de(Wa+="ET"),v[Ct]=!0,Za};var gl=g.__private__.clip=g.clip=function(k){return de(k==="evenodd"?"W*":"W"),this};g.clipEvenOdd=function(){return gl("evenodd")},g.__private__.discardPath=g.discardPath=function(){return de("n"),this};var si=g.__private__.isValidStyle=function(k){var ae=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(k)!==-1&&(ae=!0),ae};g.__private__.setDefaultPathOperation=g.setDefaultPathOperation=function(k){return si(k)&&(h=k),this};var so=g.__private__.getStyle=g.getStyle=function(k){var ae=h;switch(k){case"D":case"S":ae="S";break;case"F":ae="f";break;case"FD":case"DF":ae="B";break;case"f":case"f*":case"B":case"B*":ae=k}return ae},vl=g.close=function(){return de("h"),this};g.stroke=function(){return de("S"),this},g.fill=function(k){return yi("f",k),this},g.fillEvenOdd=function(k){return yi("f*",k),this},g.fillStroke=function(k){return yi("B",k),this},g.fillStrokeEvenOdd=function(k){return yi("B*",k),this};var yi=function(k,ae){va(ae)==="object"?yl(ae,k):de(k)},Es=function(k){k===null||j===E.ADVANCED&&k===void 0||(k=so(k),de(k))};function rc(k,ae,Te,Fe,qe){var ft=new K0(ae||this.boundingBox,Te||this.xStep,Fe||this.yStep,this.gState,qe||this.matrix);ft.stream=this.stream;var _t=k+"$$"+this.cloneIndex+++"$$";return qa(_t,ft),ft}var yl=function(k,ae){var Te=gi[k.key],Fe=Ir[Te];if(Fe instanceof Ef)de("q"),de(Xc(ae)),Fe.gState&&g.setGState(Fe.gState),de(k.matrix.toString()+" cm"),de("/"+Te+" sh"),de("Q");else if(Fe instanceof K0){var qe=new Qt(1,0,0,-1,0,wl());k.matrix&&(qe=qe.multiply(k.matrix||Vr),Te=rc.call(Fe,k.key,k.boundingBox,k.xStep,k.yStep,qe).id),de("q"),de("/Pattern cs"),de("/"+Te+" scn"),Fe.gState&&g.setGState(Fe.gState),de(ae),de("Q")}},Xc=function(k){switch(k){case"f":case"F":return"W n";case"f*":return"W* n";case"B":return"W S";case"B*":return"W* S";case"S":return"W S";case"n":return"W n"}},io=g.moveTo=function(k,ae){return de(I(F(k))+" "+I(K(ae))+" m"),this},wi=g.lineTo=function(k,ae){return de(I(F(k))+" "+I(K(ae))+" l"),this},Pi=g.curveTo=function(k,ae,Te,Fe,qe,ft){return de([I(F(k)),I(K(ae)),I(F(Te)),I(K(Fe)),I(F(qe)),I(K(ft)),"c"].join(" ")),this};g.__private__.line=g.line=function(k,ae,Te,Fe,qe){if(isNaN(k)||isNaN(ae)||isNaN(Te)||isNaN(Fe)||!si(qe))throw new Error("Invalid arguments passed to jsPDF.line");return j===E.COMPAT?this.lines([[Te-k,Fe-ae]],k,ae,[1,1],qe||"S"):this.lines([[Te-k,Fe-ae]],k,ae,[1,1]).stroke()},g.__private__.lines=g.lines=function(k,ae,Te,Fe,qe,ft){var _t,qt,tr,Ar,br,Gr,Ca,Ra,Za,Qa,Ln,Li;if(typeof k=="number"&&(Li=Te,Te=ae,ae=k,k=Li),Fe=Fe||[1,1],ft=ft||!1,isNaN(ae)||isNaN(Te)||!Array.isArray(k)||!Array.isArray(Fe)||!si(qe)||typeof ft!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(io(ae,Te),_t=Fe[0],qt=Fe[1],Ar=k.length,Qa=ae,Ln=Te,tr=0;tr<Ar;tr++)(br=k[tr]).length===2?(Qa=br[0]*_t+Qa,Ln=br[1]*qt+Ln,wi(Qa,Ln)):(Gr=br[0]*_t+Qa,Ca=br[1]*qt+Ln,Ra=br[2]*_t+Qa,Za=br[3]*qt+Ln,Qa=br[4]*_t+Qa,Ln=br[5]*qt+Ln,Pi(Gr,Ca,Ra,Za,Qa,Ln));return ft&&vl(),Es(qe),this},g.path=function(k){for(var ae=0;ae<k.length;ae++){var Te=k[ae],Fe=Te.c;switch(Te.op){case"m":io(Fe[0],Fe[1]);break;case"l":wi(Fe[0],Fe[1]);break;case"c":Pi.apply(this,Fe);break;case"h":vl()}}return this},g.__private__.rect=g.rect=function(k,ae,Te,Fe,qe){if(isNaN(k)||isNaN(ae)||isNaN(Te)||isNaN(Fe)||!si(qe))throw new Error("Invalid arguments passed to jsPDF.rect");return j===E.COMPAT&&(Fe=-Fe),de([I(F(k)),I(K(ae)),I(F(Te)),I(F(Fe)),"re"].join(" ")),Es(qe),this},g.__private__.triangle=g.triangle=function(k,ae,Te,Fe,qe,ft,_t){if(isNaN(k)||isNaN(ae)||isNaN(Te)||isNaN(Fe)||isNaN(qe)||isNaN(ft)||!si(_t))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[Te-k,Fe-ae],[qe-Te,ft-Fe],[k-qe,ae-ft]],k,ae,[1,1],_t,!0),this},g.__private__.roundedRect=g.roundedRect=function(k,ae,Te,Fe,qe,ft,_t){if(isNaN(k)||isNaN(ae)||isNaN(Te)||isNaN(Fe)||isNaN(qe)||isNaN(ft)||!si(_t))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var qt=4/3*(Math.SQRT2-1);return qe=Math.min(qe,.5*Te),ft=Math.min(ft,.5*Fe),this.lines([[Te-2*qe,0],[qe*qt,0,qe,ft-ft*qt,qe,ft],[0,Fe-2*ft],[0,ft*qt,-qe*qt,ft,-qe,ft],[2*qe-Te,0],[-qe*qt,0,-qe,-ft*qt,-qe,-ft],[0,2*ft-Fe],[0,-ft*qt,qe*qt,-ft,qe,-ft]],k+qe,ae,[1,1],_t,!0),this},g.__private__.ellipse=g.ellipse=function(k,ae,Te,Fe,qe){if(isNaN(k)||isNaN(ae)||isNaN(Te)||isNaN(Fe)||!si(qe))throw new Error("Invalid arguments passed to jsPDF.ellipse");var ft=4/3*(Math.SQRT2-1)*Te,_t=4/3*(Math.SQRT2-1)*Fe;return io(k+Te,ae),Pi(k+Te,ae-_t,k+ft,ae-Fe,k,ae-Fe),Pi(k-ft,ae-Fe,k-Te,ae-_t,k-Te,ae),Pi(k-Te,ae+_t,k-ft,ae+Fe,k,ae+Fe),Pi(k+ft,ae+Fe,k+Te,ae+_t,k+Te,ae),Es(qe),this},g.__private__.circle=g.circle=function(k,ae,Te,Fe){if(isNaN(k)||isNaN(ae)||isNaN(Te)||!si(Fe))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(k,ae,Te,Te,Fe)},g.setFont=function(k,ae,Te){return Te&&(ae=V(ae,Te)),Ct=ai(k,ae,{disableWarning:!1}),this};var Fn=g.__private__.getFont=g.getFont=function(){return Sr[ai.apply(g,arguments)]};g.__private__.getFontList=g.getFontList=function(){var k,ae,Te={};for(k in Mr)if(Mr.hasOwnProperty(k))for(ae in Te[k]=[],Mr[k])Mr[k].hasOwnProperty(ae)&&Te[k].push(ae);return Te},g.addFont=function(k,ae,Te,Fe,qe){var ft=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&ft.indexOf(arguments[3])!==-1?qe=arguments[3]:arguments[3]&&ft.indexOf(arguments[3])==-1&&(Te=V(Te,Fe)),qe=qe||"Identity-H",ei.call(this,k,ae,Te,qe)};var hs,Ae=e.lineWidth||.200025,He=g.__private__.getLineWidth=g.getLineWidth=function(){return Ae},tt=g.__private__.setLineWidth=g.setLineWidth=function(k){return Ae=k,de(I(F(k))+" w"),this};g.__private__.setLineDash=dr.API.setLineDash=dr.API.setLineDashPattern=function(k,ae){if(k=k||[],ae=ae||0,isNaN(ae)||!Array.isArray(k))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return k=k.map(function(Te){return I(F(Te))}).join(" "),ae=I(F(ae)),de("["+k+"] "+ae+" d"),this};var nt=g.__private__.getLineHeight=g.getLineHeight=function(){return ot*hs};g.__private__.getLineHeight=g.getLineHeight=function(){return ot*hs};var Pt=g.__private__.setLineHeightFactor=g.setLineHeightFactor=function(k){return typeof(k=k||1.15)=="number"&&(hs=k),this},Jt=g.__private__.getLineHeightFactor=g.getLineHeightFactor=function(){return hs};Pt(e.lineHeight);var Dt=g.__private__.getHorizontalCoordinate=function(k){return F(k)},Wt=g.__private__.getVerticalCoordinate=function(k){return j===E.ADVANCED?k:sr[O].mediaBox.topRightY-sr[O].mediaBox.bottomLeftY-F(k)},$t=g.__private__.getHorizontalCoordinateString=g.getHorizontalCoordinateString=function(k){return I(Dt(k))},Xt=g.__private__.getVerticalCoordinateString=g.getVerticalCoordinateString=function(k){return I(Wt(k))},lr=e.strokeColor||"0 G";g.__private__.getStrokeColor=g.getDrawColor=function(){return Se(lr)},g.__private__.setStrokeColor=g.setDrawColor=function(k,ae,Te,Fe){return lr=_e({ch1:k,ch2:ae,ch3:Te,ch4:Fe,pdfColorType:"draw",precision:2}),de(lr),this};var la=e.fillColor||"0 g";g.__private__.getFillColor=g.getFillColor=function(){return Se(la)},g.__private__.setFillColor=g.setFillColor=function(k,ae,Te,Fe){return la=_e({ch1:k,ch2:ae,ch3:Te,ch4:Fe,pdfColorType:"fill",precision:2}),de(la),this};var Er=e.textColor||"0 g",Ga=g.__private__.getTextColor=g.getTextColor=function(){return Se(Er)};g.__private__.setTextColor=g.setTextColor=function(k,ae,Te,Fe){return Er=_e({ch1:k,ch2:ae,ch3:Te,ch4:Fe,pdfColorType:"text",precision:3}),this};var vn=e.charSpace,es=g.__private__.getCharSpace=g.getCharSpace=function(){return parseFloat(vn||0)};g.__private__.setCharSpace=g.setCharSpace=function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return vn=k,this};var Pn=0;g.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},g.__private__.setLineCap=g.setLineCap=function(k){var ae=g.CapJoinStyles[k];if(ae===void 0)throw new Error("Line cap style of '"+k+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Pn=ae,de(ae+" J"),this};var yn=0;g.__private__.setLineJoin=g.setLineJoin=function(k){var ae=g.CapJoinStyles[k];if(ae===void 0)throw new Error("Line join style of '"+k+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return yn=ae,de(ae+" j"),this},g.__private__.setLineMiterLimit=g.__private__.setMiterLimit=g.setLineMiterLimit=g.setMiterLimit=function(k){if(k=k||0,isNaN(k))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return de(I(F(k))+" M"),this},g.GState=x1,g.setGState=function(k){(k=typeof k=="string"?na[Ja[k]]:js(null,k)).equals(Dn)||(de("/"+k.id+" gs"),Dn=k)};var js=function(k,ae){if(!k||!Ja[k]){var Te=!1;for(var Fe in na)if(na.hasOwnProperty(Fe)&&na[Fe].equals(ae)){Te=!0;break}if(Te)ae=na[Fe];else{var qe="GS"+(Object.keys(na).length+1).toString(10);na[qe]=ae,ae.id=qe}return k&&(Ja[k]=ae.id),kr.publish("addGState",ae),ae}};g.addGState=function(k,ae){return js(k,ae),this},g.saveGraphicsState=function(){return de("q"),fa.push({key:Ct,size:ot,color:Er}),this},g.restoreGraphicsState=function(){de("Q");var k=fa.pop();return Ct=k.key,ot=k.size,Er=k.color,Dn=null,this},g.setCurrentTransformationMatrix=function(k){return de(k.toString()+" cm"),this},g.comment=function(k){return de("#"+k),this};var ts=function(k,ae){var Te=k||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return Te},set:function(ft){isNaN(ft)||(Te=parseFloat(ft))}});var Fe=ae||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Fe},set:function(ft){isNaN(ft)||(Fe=parseFloat(ft))}});var qe="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return qe},set:function(ft){qe=ft.toString()}}),this},Hn=function(k,ae,Te,Fe){ts.call(this,k,ae),this.type="rect";var qe=Te||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return qe},set:function(_t){isNaN(_t)||(qe=parseFloat(_t))}});var ft=Fe||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return ft},set:function(_t){isNaN(_t)||(ft=parseFloat(_t))}}),this},Cs=function(){this.page=Br,this.currentPage=O,this.pages=Ee.slice(0),this.pagesContext=sr.slice(0),this.x=hr,this.y=zt,this.matrix=Yt,this.width=lo(O),this.height=wl(O),this.outputDestination=Pe,this.id="",this.objectNumber=-1};Cs.prototype.restore=function(){Br=this.page,O=this.currentPage,sr=this.pagesContext,Ee=this.pages,hr=this.x,zt=this.y,Yt=this.matrix,Po(O,this.width),Xu(O,this.height),Pe=this.outputDestination};var Ds=function(k,ae,Te,Fe,qe){gn.push(new Cs),Br=O=0,Ee=[],hr=k,zt=ae,Yt=qe,ca([Te,Fe])},Fo=function(k){if(Ea[k])gn.pop().restore();else{var ae=new Cs,Te="Xo"+(Object.keys(ka).length+1).toString(10);ae.id=Te,Ea[k]=Te,ka[Te]=ae,kr.publish("addFormObject",ae),gn.pop().restore()}};for(var oo in g.beginFormObject=function(k,ae,Te,Fe,qe){return Ds(k,ae,Te,Fe,qe),this},g.endFormObject=function(k){return Fo(k),this},g.doFormObject=function(k,ae){var Te=ka[Ea[k]];return de("q"),de(ae.toString()+" cm"),de("/"+Te.id+" Do"),de("Q"),this},g.getFormObject=function(k){var ae=ka[Ea[k]];return{x:ae.x,y:ae.y,width:ae.width,height:ae.height,matrix:ae.matrix}},g.save=function(k,ae){return k=k||"generated.pdf",(ae=ae||{}).returnPromise=ae.returnPromise||!1,ae.returnPromise===!1?(kf(Qn(Zn()),k),typeof kf.unload=="function"&&gr.setTimeout&&setTimeout(kf.unload,911),this):new Promise(function(Te,Fe){try{var qe=kf(Qn(Zn()),k);typeof kf.unload=="function"&&gr.setTimeout&&setTimeout(kf.unload,911),Te(qe)}catch(ft){Fe(ft.message)}})},dr.API)dr.API.hasOwnProperty(oo)&&(oo==="events"&&dr.API.events.length?function(k,ae){var Te,Fe,qe;for(qe=ae.length-1;qe!==-1;qe--)Te=ae[qe][0],Fe=ae[qe][1],k.subscribe.apply(k,[Te].concat(typeof Fe=="function"?[Fe]:Fe))}(kr,dr.API.events):g[oo]=dr.API[oo]);var lo=g.getPageWidth=function(k){return(sr[k=k||O].mediaBox.topRightX-sr[k].mediaBox.bottomLeftX)/wt},Po=g.setPageWidth=function(k,ae){sr[k].mediaBox.topRightX=ae*wt+sr[k].mediaBox.bottomLeftX},wl=g.getPageHeight=function(k){return(sr[k=k||O].mediaBox.topRightY-sr[k].mediaBox.bottomLeftY)/wt},Xu=g.setPageHeight=function(k,ae){sr[k].mediaBox.topRightY=ae*wt+sr[k].mediaBox.bottomLeftY};return g.internal={pdfEscape:da,getStyle:so,getFont:Fn,getFontSize:vt,getCharSpace:es,getTextColor:Ga,getLineHeight:nt,getLineHeightFactor:Jt,getLineWidth:He,write:rt,getHorizontalCoordinate:Dt,getVerticalCoordinate:Wt,getCoordinateString:$t,getVerticalCoordinateString:Xt,collections:{},newObject:qr,newAdditionalObject:Ne,newObjectDeferred:ha,newObjectDeferredBegin:ne,getFilters:Ye,putStream:lt,events:kr,scaleFactor:wt,pageSize:{getWidth:function(){return lo(O)},setWidth:function(k){Po(O,k)},getHeight:function(){return wl(O)},setHeight:function(k){Xu(O,k)}},encryptionOptions:p,encryption:on,getEncryptor:tc,output:Fi,getNumberOfPages:Ts,pages:Ee,out:de,f2:re,f3:R,getPageInfo:ni,getPageInfoByObjId:nr,getCurrentPageInfo:$c,getPDFVersion:b,Point:ts,Rectangle:Hn,Matrix:Qt,hasHotfix:no},Object.defineProperty(g.internal.pageSize,"width",{get:function(){return lo(O)},set:function(k){Po(O,k)},enumerable:!0,configurable:!0}),Object.defineProperty(g.internal.pageSize,"height",{get:function(){return wl(O)},set:function(k){Xu(O,k)},enumerable:!0,configurable:!0}),ti.call(g,Xe),Ct="F1",Kn(n,r),kr.publish("initialized"),g}V0.prototype.lsbFirstWord=function(e){return String.fromCharCode(e>>0&255,e>>8&255,e>>16&255,e>>24&255)},V0.prototype.toHexString=function(e){return e.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},V0.prototype.hexToBytes=function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(String.fromCharCode(parseInt(e.substr(r,2),16)));return t.join("")},V0.prototype.processOwnerPassword=function(e,t){return ev(Q2(t).substr(0,5),e)},V0.prototype.encryptor=function(e,t){var r=Q2(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(a){return ev(r,a)}},x1.prototype.equals=function(e){var t,r="id,objectNumber,equals";if(!e||va(e)!==va(this))return!1;var a=0;for(t in this)if(!(r.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!e.hasOwnProperty(t)||this[t]!==e[t])return!1;a++}for(t in e)e.hasOwnProperty(t)&&r.indexOf(t)<0&&a--;return a===0},dr.API={events:[]},dr.version="3.0.1";var hn=dr.API,gy=1,e0=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},I0=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Tr=function(e){return e.toFixed(2)},ku=function(e){return e.toFixed(5)};hn.__acroform__={};var Di=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},J4=function(e){return e*gy},zl=function(e){var t=new QA,r=Zt.internal.getHeight(e)||0,a=Zt.internal.getWidth(e)||0;return t.BBox=[0,0,Number(Tr(a)),Number(Tr(r))],t},_L=hn.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|=1<<t},TL=hn.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&=~(1<<t)},kL=hn.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return(e&1<<t)==0?0:1},Tn=hn.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return kL(e,t-1)},kn=hn.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return _L(e,t-1)},En=hn.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return TL(e,t-1)},EL=hn.__acroform__.calculateCoordinates=function(e,t){var r=t.internal.getHorizontalCoordinate,a=t.internal.getVerticalCoordinate,n=e[0],s=e[1],o=e[2],c=e[3],u={};return u.lowerLeft_X=r(n)||0,u.lowerLeft_Y=a(s+c)||0,u.upperRight_X=r(n+o)||0,u.upperRight_Y=a(s)||0,[Number(Tr(u.lowerLeft_X)),Number(Tr(u.lowerLeft_Y)),Number(Tr(u.upperRight_X)),Number(Tr(u.upperRight_Y))]},jL=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],r=e._V||e.DV,a=tv(e,r),n=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+n+" "+Tr(a.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(a.text),t.push("ET"),t.push("Q"),t.push("EMC");var s=zl(e);return s.scope=e.scope,s.stream=t.join(`
`),s}},tv=function(e,t){var r=e.fontSize===0?e.maxFontSize:e.fontSize,a={text:"",fontSize:""},n=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");n=e.multiline?n.map(function(R){return R.split(`
`)}):n.map(function(R){return[R]});var s=r,o=Zt.internal.getHeight(e)||0;o=o<0?-o:o;var c=Zt.internal.getWidth(e)||0;c=c<0?-c:c;var u=function(R,F,Y){if(R+1<n.length){var K=F+" "+n[R+1][0];return Em(K,e,Y).width<=c-4}return!1};s++;e:for(;s>0;){t="",s--;var h,p,x=Em("3",e,s).height,v=e.multiline?o-s:(o-x)/2,g=v+=2,w=0,b=0,N=0;if(s<=0){t=`(...) Tj
`,t+="% Width of Text: "+Em(t,e,s=12).width+", FieldWidth:"+c+`
`;break}for(var _="",E=0,j=0;j<n.length;j++)if(n.hasOwnProperty(j)){var M=!1;if(n[j].length!==1&&N!==n[j].length-1){if((x+2)*(E+2)+2>o)continue e;_+=n[j][N],M=!0,b=j,j--}else{_=(_+=n[j][N]+" ").substr(_.length-1)==" "?_.substr(0,_.length-1):_;var U=parseInt(j),V=u(U,_,s),I=j>=n.length-1;if(V&&!I){_+=" ",N=0;continue}if(V||I){if(I)b=U;else if(e.multiline&&(x+2)*(E+2)+2>o)continue e}else{if(!e.multiline||(x+2)*(E+2)+2>o)continue e;b=U}}for(var z="",H=w;H<=b;H++){var re=n[H];if(e.multiline){if(H===b){z+=re[N]+" ",N=(N+1)%re.length;continue}if(H===w){z+=re[re.length-1]+" ";continue}}z+=re[0]+" "}switch(z=z.substr(z.length-1)==" "?z.substr(0,z.length-1):z,p=Em(z,e,s).width,e.textAlign){case"right":h=c-p-2;break;case"center":h=(c-p)/2;break;case"left":default:h=2}t+=Tr(h)+" "+Tr(g)+` Td
`,t+="("+e0(z)+`) Tj
`,t+=-Tr(h)+` 0 Td
`,g=-(s+2),p=0,w=M?b:b+1,E++,_=""}break}return a.text=t,a.fontSize=s,a},Em=function(e,t,r){var a=t.scope.internal.getFont(t.fontName,t.fontStyle),n=t.scope.getStringUnitWidth(e,{font:a,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:t.scope.getStringUnitWidth("3",{font:a,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:n}},CL={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},DL=function(e,t){var r={type:"reference",object:e};t.internal.getPageInfo(e.page).pageContext.annotations.find(function(a){return a.type===r.type&&a.object===r.object})===void 0&&t.internal.getPageInfo(e.page).pageContext.annotations.push(r)},FL=function(e,t){for(var r in e)if(e.hasOwnProperty(r)){var a=r,n=e[r];t.internal.newObjectDeferredBegin(n.objId,!0),va(n)==="object"&&typeof n.putStream=="function"&&n.putStream(),delete e[a]}},PL=function(e,t){if(t.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(pl.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(CL)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");gy=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new e_,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(e)}),e.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var a=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var n in a)if(a.hasOwnProperty(n)){var s=a[n];s.objId=void 0,s.hasAnnotation&&DL(s,r)}})(e)}),e.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)}),e.internal.events.subscribe("postPutPages",function(r){(function(a,n){var s=!a;for(var o in a||(n.internal.newObjectDeferredBegin(n.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),n.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),a=a||n.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(a.hasOwnProperty(o)){var c=a[o],u=[],h=c.Rect;if(c.Rect&&(c.Rect=EL(c.Rect,n)),n.internal.newObjectDeferredBegin(c.objId,!0),c.DA=Zt.createDefaultAppearanceStream(c),va(c)==="object"&&typeof c.getKeyValueListForStream=="function"&&(u=c.getKeyValueListForStream()),c.Rect=h,c.hasAppearanceStream&&!c.appearanceStreamContent){var p=jL(c);u.push({key:"AP",value:"<</N "+p+">>"}),n.internal.acroformPlugin.xForms.push(p)}if(c.appearanceStreamContent){var x="";for(var v in c.appearanceStreamContent)if(c.appearanceStreamContent.hasOwnProperty(v)){var g=c.appearanceStreamContent[v];if(x+="/"+v+" ",x+="<<",Object.keys(g).length>=1||Array.isArray(g)){for(var o in g)if(g.hasOwnProperty(o)){var w=g[o];typeof w=="function"&&(w=w.call(n,c)),x+="/"+o+" "+w+" ",n.internal.acroformPlugin.xForms.indexOf(w)>=0||n.internal.acroformPlugin.xForms.push(w)}}else typeof(w=g)=="function"&&(w=w.call(n,c)),x+="/"+o+" "+w,n.internal.acroformPlugin.xForms.indexOf(w)>=0||n.internal.acroformPlugin.xForms.push(w);x+=">>"}u.push({key:"AP",value:`<<
`+x+">>"})}n.internal.putStream({additionalKeyValues:u,objectId:c.objId}),n.internal.out("endobj")}s&&FL(n.internal.acroformPlugin.xForms,n)})(r,e)}),e.internal.acroformPlugin.isInitialized=!0}},ZA=hn.__acroform__.arrayToPdfArray=function(e,t,r){var a=function(o){return o};if(Array.isArray(e)){for(var n="[",s=0;s<e.length;s++)switch(s!==0&&(n+=" "),va(e[s])){case"boolean":case"number":case"object":n+=e[s].toString();break;case"string":e[s].substr(0,1)!=="/"?(t!==void 0&&r&&(a=r.internal.getEncryptor(t)),n+="("+e0(a(e[s].toString()))+")"):n+=e[s].toString()}return n+="]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},Jg=function(e,t,r){var a=function(n){return n};return t!==void 0&&r&&(a=r.internal.getEncryptor(t)),(e=e||"").toString(),e="("+e0(a(e))+")"},ql=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};ql.prototype.toString=function(){return this.objId+" 0 R"},ql.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},ql.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter(function(s){return s!="content"&&s!="appearanceStreamContent"&&s!="scope"&&s!="objId"&&s.substring(0,1)!="_"});for(var r in t)if(Object.getOwnPropertyDescriptor(this,t[r]).configurable===!1){var a=t[r],n=this[a];n&&(Array.isArray(n)?e.push({key:a,value:ZA(n,this.objId,this.scope)}):n instanceof ql?(n.scope=this.scope,e.push({key:a,value:n.objId+" 0 R"})):typeof n!="function"&&e.push({key:a,value:n}))}return e};var QA=function(){ql.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){e=r.trim()},get:function(){return e||null}})};Di(QA,ql);var e_=function(){ql.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var r=function(a){return a};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+e0(r(e))+")"}},set:function(r){e=r}})};Di(e_,ql);var pl=function e(){ql.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(_){if(isNaN(_))throw new Error('Invalid value "'+_+'" for attribute F supplied.');t=_}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Tn(t,3)},set:function(_){_?this.F=kn(t,3):this.F=En(t,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(_){if(isNaN(_))throw new Error('Invalid value "'+_+'" for attribute Ff supplied.');r=_}});var a=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(a.length!==0)return a},set:function(_){a=_!==void 0?_:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[0])?0:a[0]},set:function(_){a[0]=_}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[1])?0:a[1]},set:function(_){a[1]=_}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[2])?0:a[2]},set:function(_){a[2]=_}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!a||isNaN(a[3])?0:a[3]},set:function(_){a[3]=_}});var n="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return n},set:function(_){switch(_){case"/Btn":case"/Tx":case"/Ch":case"/Sig":n=_;break;default:throw new Error('Invalid value "'+_+'" for attribute FT supplied.')}}});var s=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!s||s.length<1){if(this instanceof g1)return;s="FieldObject"+e.FieldNum++}var _=function(E){return E};return this.scope&&(_=this.scope.internal.getEncryptor(this.objId)),"("+e0(_(s))+")"},set:function(_){s=_.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return s},set:function(_){s=_}});var o="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return o},set:function(_){o=_}});var c="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return c},set:function(_){c=_}});var u=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return u},set:function(_){u=_}});var h=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return h===void 0?50/gy:h},set:function(_){h=_}});var p="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return p},set:function(_){p=_}});var x="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!x||this instanceof g1||this instanceof Rf))return Jg(x,this.objId,this.scope)},set:function(_){_=_.toString(),x=_}});var v=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(v)return this instanceof ls?v:Jg(v,this.objId,this.scope)},set:function(_){_=_.toString(),v=this instanceof ls?_:_.substr(0,1)==="("?I0(_.substr(1,_.length-2)):I0(_)}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof ls?I0(v.substr(1,v.length-1)):v},set:function(_){_=_.toString(),v=this instanceof ls?"/"+_:_}});var g=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(g)return g},set:function(_){this.V=_}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(g)return this instanceof ls?g:Jg(g,this.objId,this.scope)},set:function(_){_=_.toString(),g=this instanceof ls?_:_.substr(0,1)==="("?I0(_.substr(1,_.length-2)):I0(_)}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof ls?I0(g.substr(1,g.length-1)):g},set:function(_){_=_.toString(),g=this instanceof ls?"/"+_:_}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var w,b=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return b},set:function(_){_=!!_,b=_}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(w)return w},set:function(_){w=_}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Tn(this.Ff,1)},set:function(_){_?this.Ff=kn(this.Ff,1):this.Ff=En(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Tn(this.Ff,2)},set:function(_){_?this.Ff=kn(this.Ff,2):this.Ff=En(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Tn(this.Ff,3)},set:function(_){_?this.Ff=kn(this.Ff,3):this.Ff=En(this.Ff,3)}});var N=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(N!==null)return N},set:function(_){if([0,1,2].indexOf(_)===-1)throw new Error('Invalid value "'+_+'" for attribute Q supplied.');N=_}}),Object.defineProperty(this,"textAlign",{get:function(){var _;switch(N){case 0:default:_="left";break;case 1:_="center";break;case 2:_="right"}return _},configurable:!0,enumerable:!0,set:function(_){switch(_){case"right":case 2:N=2;break;case"center":case 1:N=1;break;case"left":case 0:default:N=0}}})};Di(pl,ql);var Q0=function(){pl.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(r){e=r}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return ZA(t,this.objId,this.scope)},set:function(r){var a,n;n=[],typeof(a=r)=="string"&&(n=function(s,o,c){c||(c=1);for(var u,h=[];u=o.exec(s);)h.push(u[c]);return h}(a,/\((.*?)\)/g)),t=n}}),this.getOptions=function(){return t},this.setOptions=function(r){t=r,this.sort&&t.sort()},this.addOption=function(r){r=(r=r||"").toString(),t.push(r),this.sort&&t.sort()},this.removeOption=function(r,a){for(a=a||!1,r=(r=r||"").toString();t.indexOf(r)!==-1&&(t.splice(t.indexOf(r),1),a!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Tn(this.Ff,18)},set:function(r){r?this.Ff=kn(this.Ff,18):this.Ff=En(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Tn(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=kn(this.Ff,19):this.Ff=En(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Tn(this.Ff,20)},set:function(r){r?(this.Ff=kn(this.Ff,20),t.sort()):this.Ff=En(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Tn(this.Ff,22)},set:function(r){r?this.Ff=kn(this.Ff,22):this.Ff=En(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Tn(this.Ff,23)},set:function(r){r?this.Ff=kn(this.Ff,23):this.Ff=En(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Tn(this.Ff,27)},set:function(r){r?this.Ff=kn(this.Ff,27):this.Ff=En(this.Ff,27)}}),this.hasAppearanceStream=!1};Di(Q0,pl);var eh=function(){Q0.call(this),this.fontName="helvetica",this.combo=!1};Di(eh,Q0);var th=function(){eh.call(this),this.combo=!0};Di(th,eh);var Ym=function(){th.call(this),this.edit=!0};Di(Ym,th);var ls=function(){pl.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Tn(this.Ff,15)},set:function(r){r?this.Ff=kn(this.Ff,15):this.Ff=En(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Tn(this.Ff,16)},set:function(r){r?this.Ff=kn(this.Ff,16):this.Ff=En(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Tn(this.Ff,17)},set:function(r){r?this.Ff=kn(this.Ff,17):this.Ff=En(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Tn(this.Ff,26)},set:function(r){r?this.Ff=kn(this.Ff,26):this.Ff=En(this.Ff,26)}});var e,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(s){return s};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var a,n=[];for(a in n.push("<<"),t)n.push("/"+a+" ("+e0(r(t[a]))+")");return n.push(">>"),n.join(`
`)}},set:function(r){va(r)==="object"&&(t=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(r){typeof r=="string"&&(t.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(r){e="/"+r}})};Di(ls,pl);var Jm=function(){ls.call(this),this.pushButton=!0};Di(Jm,ls);var rh=function(){ls.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t!==void 0?t:[]}})};Di(rh,ls);var g1=function(){var e,t;pl.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(n){e=n}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(n){t=n}});var r,a={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var n=function(c){return c};this.scope&&(n=this.scope.internal.getEncryptor(this.objId));var s,o=[];for(s in o.push("<<"),a)o.push("/"+s+" ("+e0(n(a[s]))+")");return o.push(">>"),o.join(`
`)},set:function(n){va(n)==="object"&&(a=n)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return a.CA||""},set:function(n){typeof n=="string"&&(a.CA=n)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(n){r=n}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(n){r="/"+n}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Zt.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Di(g1,pl),rh.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var r=this.Kids[t];r.appearanceStreamContent=e.createAppearanceStream(r.optionName),r.caption=e.getCA()}},rh.prototype.createOption=function(e){var t=new g1;return t.Parent=this,t.optionName=e,this.Kids.push(t),LL.call(this.scope,t),t};var Km=function(){ls.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Zt.CheckBox.createAppearanceStream()};Di(Km,ls);var Rf=function(){pl.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Tn(this.Ff,13)},set:function(t){t?this.Ff=kn(this.Ff,13):this.Ff=En(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Tn(this.Ff,21)},set:function(t){t?this.Ff=kn(this.Ff,21):this.Ff=En(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Tn(this.Ff,23)},set:function(t){t?this.Ff=kn(this.Ff,23):this.Ff=En(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Tn(this.Ff,24)},set:function(t){t?this.Ff=kn(this.Ff,24):this.Ff=En(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Tn(this.Ff,25)},set:function(t){t?this.Ff=kn(this.Ff,25):this.Ff=En(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Tn(this.Ff,26)},set:function(t){t?this.Ff=kn(this.Ff,26):this.Ff=En(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Di(Rf,pl);var Zm=function(){Rf.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Tn(this.Ff,14)},set:function(e){e?this.Ff=kn(this.Ff,14):this.Ff=En(this.Ff,14)}}),this.password=!0};Di(Zm,Rf);var Zt={CheckBox:{createAppearanceStream:function(){return{N:{On:Zt.CheckBox.YesNormal},D:{On:Zt.CheckBox.YesPushDown,Off:Zt.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=zl(e);t.scope=e.scope;var r=[],a=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color),s=tv(e,e.caption);return r.push("0.749023 g"),r.push("0 0 "+Tr(Zt.internal.getWidth(e))+" "+Tr(Zt.internal.getHeight(e))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+a+" "+Tr(s.fontSize)+" Tf "+n),r.push("BT"),r.push(s.text),r.push("ET"),r.push("Q"),r.push("EMC"),t.stream=r.join(`
`),t},YesNormal:function(e){var t=zl(e);t.scope=e.scope;var r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,a=e.scope.__private__.encodeColorString(e.color),n=[],s=Zt.internal.getHeight(e),o=Zt.internal.getWidth(e),c=tv(e,e.caption);return n.push("1 g"),n.push("0 0 "+Tr(o)+" "+Tr(s)+" re"),n.push("f"),n.push("q"),n.push("0 0 1 rg"),n.push("0 0 "+Tr(o-1)+" "+Tr(s-1)+" re"),n.push("W"),n.push("n"),n.push("0 g"),n.push("BT"),n.push("/"+r+" "+Tr(c.fontSize)+" Tf "+a),n.push(c.text),n.push("ET"),n.push("Q"),t.stream=n.join(`
`),t},OffPushDown:function(e){var t=zl(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Tr(Zt.internal.getWidth(e))+" "+Tr(Zt.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:Zt.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=Zt.RadioButton.Circle.YesNormal,t.D[e]=Zt.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=zl(e);t.scope=e.scope;var r=[],a=Zt.internal.getWidth(e)<=Zt.internal.getHeight(e)?Zt.internal.getWidth(e)/4:Zt.internal.getHeight(e)/4;a=Number((.9*a).toFixed(5));var n=Zt.internal.Bezier_C,s=Number((a*n).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+ku(Zt.internal.getWidth(e)/2)+" "+ku(Zt.internal.getHeight(e)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+s+" "+s+" "+a+" 0 "+a+" c"),r.push("-"+s+" "+a+" -"+a+" "+s+" -"+a+" 0 c"),r.push("-"+a+" -"+s+" -"+s+" -"+a+" 0 -"+a+" c"),r.push(s+" -"+a+" "+a+" -"+s+" "+a+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=zl(e);t.scope=e.scope;var r=[],a=Zt.internal.getWidth(e)<=Zt.internal.getHeight(e)?Zt.internal.getWidth(e)/4:Zt.internal.getHeight(e)/4;a=Number((.9*a).toFixed(5));var n=Number((2*a).toFixed(5)),s=Number((n*Zt.internal.Bezier_C).toFixed(5)),o=Number((a*Zt.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+ku(Zt.internal.getWidth(e)/2)+" "+ku(Zt.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),r.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),r.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),r.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+ku(Zt.internal.getWidth(e)/2)+" "+ku(Zt.internal.getHeight(e)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+o+" "+o+" "+a+" 0 "+a+" c"),r.push("-"+o+" "+a+" -"+a+" "+o+" -"+a+" 0 c"),r.push("-"+a+" -"+o+" -"+o+" -"+a+" 0 -"+a+" c"),r.push(o+" -"+a+" "+a+" -"+o+" "+a+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},OffPushDown:function(e){var t=zl(e);t.scope=e.scope;var r=[],a=Zt.internal.getWidth(e)<=Zt.internal.getHeight(e)?Zt.internal.getWidth(e)/4:Zt.internal.getHeight(e)/4;a=Number((.9*a).toFixed(5));var n=Number((2*a).toFixed(5)),s=Number((n*Zt.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+ku(Zt.internal.getWidth(e)/2)+" "+ku(Zt.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),r.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),r.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),r.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:Zt.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=Zt.RadioButton.Cross.YesNormal,t.D[e]=Zt.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=zl(e);t.scope=e.scope;var r=[],a=Zt.internal.calculateCross(e);return r.push("q"),r.push("1 1 "+Tr(Zt.internal.getWidth(e)-2)+" "+Tr(Zt.internal.getHeight(e)-2)+" re"),r.push("W"),r.push("n"),r.push(Tr(a.x1.x)+" "+Tr(a.x1.y)+" m"),r.push(Tr(a.x2.x)+" "+Tr(a.x2.y)+" l"),r.push(Tr(a.x4.x)+" "+Tr(a.x4.y)+" m"),r.push(Tr(a.x3.x)+" "+Tr(a.x3.y)+" l"),r.push("s"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=zl(e);t.scope=e.scope;var r=Zt.internal.calculateCross(e),a=[];return a.push("0.749023 g"),a.push("0 0 "+Tr(Zt.internal.getWidth(e))+" "+Tr(Zt.internal.getHeight(e))+" re"),a.push("f"),a.push("q"),a.push("1 1 "+Tr(Zt.internal.getWidth(e)-2)+" "+Tr(Zt.internal.getHeight(e)-2)+" re"),a.push("W"),a.push("n"),a.push(Tr(r.x1.x)+" "+Tr(r.x1.y)+" m"),a.push(Tr(r.x2.x)+" "+Tr(r.x2.y)+" l"),a.push(Tr(r.x4.x)+" "+Tr(r.x4.y)+" m"),a.push(Tr(r.x3.x)+" "+Tr(r.x3.y)+" l"),a.push("s"),a.push("Q"),t.stream=a.join(`
`),t},OffPushDown:function(e){var t=zl(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Tr(Zt.internal.getWidth(e))+" "+Tr(Zt.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+r}};Zt.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=Zt.internal.getWidth(e),r=Zt.internal.getHeight(e),a=Math.min(t,r);return{x1:{x:(t-a)/2,y:(r-a)/2+a},x2:{x:(t-a)/2+a,y:(r-a)/2},x3:{x:(t-a)/2,y:(r-a)/2},x4:{x:(t-a)/2+a,y:(r-a)/2+a}}}},Zt.internal.getWidth=function(e){var t=0;return va(e)==="object"&&(t=J4(e.Rect[2])),t},Zt.internal.getHeight=function(e){var t=0;return va(e)==="object"&&(t=J4(e.Rect[3])),t};var LL=hn.addField=function(e){if(PL(this,e),!(e instanceof pl))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=e).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};hn.AcroFormChoiceField=Q0,hn.AcroFormListBox=eh,hn.AcroFormComboBox=th,hn.AcroFormEditBox=Ym,hn.AcroFormButton=ls,hn.AcroFormPushButton=Jm,hn.AcroFormRadioButton=rh,hn.AcroFormCheckBox=Km,hn.AcroFormTextField=Rf,hn.AcroFormPasswordField=Zm,hn.AcroFormAppearance=Zt,hn.AcroForm={ChoiceField:Q0,ListBox:eh,ComboBox:th,EditBox:Ym,Button:ls,PushButton:Jm,RadioButton:rh,CheckBox:Km,TextField:Rf,PasswordField:Zm,Appearance:Zt},dr.AcroForm={ChoiceField:Q0,ListBox:eh,ComboBox:th,EditBox:Ym,Button:ls,PushButton:Jm,RadioButton:rh,CheckBox:Km,TextField:Rf,PasswordField:Zm,Appearance:Zt};dr.AcroForm;function t_(e){return e.reduce(function(t,r,a){return t[r]=a,t},{})}(function(e){e.__addimage__={};var t="UNKNOWN",r={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},a=e.__addimage__.getImageFileTypeByImageData=function(R,F){var Y,K,X,Z,ce,te=t;if((F=F||t)==="RGBA"||R.data!==void 0&&R.data instanceof Uint8ClampedArray&&"height"in R&&"width"in R)return"RGBA";if(V(R))for(ce in r)for(X=r[ce],Y=0;Y<X.length;Y+=1){for(Z=!0,K=0;K<X[Y].length;K+=1)if(X[Y][K]!==void 0&&X[Y][K]!==R[K]){Z=!1;break}if(Z===!0){te=ce;break}}else for(ce in r)for(X=r[ce],Y=0;Y<X.length;Y+=1){for(Z=!0,K=0;K<X[Y].length;K+=1)if(X[Y][K]!==void 0&&X[Y][K]!==R.charCodeAt(K)){Z=!1;break}if(Z===!0){te=ce;break}}return te===t&&F!==t&&(te=F),te},n=function R(F){for(var Y=this.internal.write,K=this.internal.putStream,X=(0,this.internal.getFilters)();X.indexOf("FlateEncode")!==-1;)X.splice(X.indexOf("FlateEncode"),1);F.objectId=this.internal.newObject();var Z=[];if(Z.push({key:"Type",value:"/XObject"}),Z.push({key:"Subtype",value:"/Image"}),Z.push({key:"Width",value:F.width}),Z.push({key:"Height",value:F.height}),F.colorSpace===N.INDEXED?Z.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(F.palette.length/3-1)+" "+("sMask"in F&&F.sMask!==void 0?F.objectId+2:F.objectId+1)+" 0 R]"}):(Z.push({key:"ColorSpace",value:"/"+F.colorSpace}),F.colorSpace===N.DEVICE_CMYK&&Z.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),Z.push({key:"BitsPerComponent",value:F.bitsPerComponent}),"decodeParameters"in F&&F.decodeParameters!==void 0&&Z.push({key:"DecodeParms",value:"<<"+F.decodeParameters+">>"}),"transparency"in F&&Array.isArray(F.transparency)){for(var ce="",te=0,Q=F.transparency.length;te<Q;te++)ce+=F.transparency[te]+" "+F.transparency[te]+" ";Z.push({key:"Mask",value:"["+ce+"]"})}F.sMask!==void 0&&Z.push({key:"SMask",value:F.objectId+1+" 0 R"});var G=F.filter!==void 0?["/"+F.filter]:void 0;if(K({data:F.data,additionalKeyValues:Z,alreadyAppliedFilters:G,objectId:F.objectId}),Y("endobj"),"sMask"in F&&F.sMask!==void 0){var ye="/Predictor "+F.predictor+" /Colors 1 /BitsPerComponent "+F.bitsPerComponent+" /Columns "+F.width,D={width:F.width,height:F.height,colorSpace:"DeviceGray",bitsPerComponent:F.bitsPerComponent,decodeParameters:ye,data:F.sMask};"filter"in F&&(D.filter=F.filter),R.call(this,D)}if(F.colorSpace===N.INDEXED){var O=this.internal.newObject();K({data:z(new Uint8Array(F.palette)),objectId:O}),Y("endobj")}},s=function(){var R=this.internal.collections.addImage_images;for(var F in R)n.call(this,R[F])},o=function(){var R,F=this.internal.collections.addImage_images,Y=this.internal.write;for(var K in F)Y("/I"+(R=F[K]).index,R.objectId,"0","R")},c=function(){this.internal.collections.addImage_images||(this.internal.collections.addImage_images={},this.internal.events.subscribe("putResources",s),this.internal.events.subscribe("putXobjectDict",o))},u=function(){var R=this.internal.collections.addImage_images;return c.call(this),R},h=function(){return Object.keys(this.internal.collections.addImage_images).length},p=function(R){return typeof e["process"+R.toUpperCase()]=="function"},x=function(R){return va(R)==="object"&&R.nodeType===1},v=function(R,F){if(R.nodeName==="IMG"&&R.hasAttribute("src")){var Y=""+R.getAttribute("src");if(Y.indexOf("data:image/")===0)return jd(unescape(Y).split("base64,").pop());var K=e.loadFile(Y,!0);if(K!==void 0)return K}if(R.nodeName==="CANVAS"){if(R.width===0||R.height===0)throw new Error("Given canvas must have data. Canvas width: "+R.width+", height: "+R.height);var X;switch(F){case"PNG":X="image/png";break;case"WEBP":X="image/webp";break;case"JPEG":case"JPG":default:X="image/jpeg"}return jd(R.toDataURL(X,1).split("base64,").pop())}},g=function(R){var F=this.internal.collections.addImage_images;if(F){for(var Y in F)if(R===F[Y].alias)return F[Y]}},w=function(R,F,Y){return R||F||(R=-96,F=-96),R<0&&(R=-1*Y.width*72/R/this.internal.scaleFactor),F<0&&(F=-1*Y.height*72/F/this.internal.scaleFactor),R===0&&(R=F*Y.width/Y.height),F===0&&(F=R*Y.height/Y.width),[R,F]},b=function(R,F,Y,K,X,Z){var ce=w.call(this,Y,K,X),te=this.internal.getCoordinateString,Q=this.internal.getVerticalCoordinateString,G=u.call(this);if(Y=ce[0],K=ce[1],G[X.index]=X,Z){Z*=Math.PI/180;var ye=Math.cos(Z),D=Math.sin(Z),O=function(q){return q.toFixed(4)},L=[O(ye),O(D),O(-1*D),O(ye),0,0,"cm"]}this.internal.write("q"),Z?(this.internal.write([1,"0","0",1,te(R),Q(F+K),"cm"].join(" ")),this.internal.write(L.join(" ")),this.internal.write([te(Y),"0","0",te(K),"0","0","cm"].join(" "))):this.internal.write([te(Y),"0","0",te(K),te(R),Q(F+K),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+X.index+" Do"),this.internal.write("Q")},N=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var _=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},E=e.__addimage__.sHashCode=function(R){var F,Y,K=0;if(typeof R=="string")for(Y=R.length,F=0;F<Y;F++)K=(K<<5)-K+R.charCodeAt(F),K|=0;else if(V(R))for(Y=R.byteLength/2,F=0;F<Y;F++)K=(K<<5)-K+R[F],K|=0;return K},j=e.__addimage__.validateStringAsBase64=function(R){(R=R||"").toString().trim();var F=!0;return R.length===0&&(F=!1),R.length%4!=0&&(F=!1),/^[A-Za-z0-9+/]+$/.test(R.substr(0,R.length-2))===!1&&(F=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(R.substr(-2))===!1&&(F=!1),F},M=e.__addimage__.extractImageFromDataUrl=function(R){if(R==null||!(R=R.trim()).startsWith("data:"))return null;var F=R.indexOf(",");return F<0?null:R.substring(0,F).trim().endsWith("base64")?R.substring(F+1):null},U=e.__addimage__.supportsArrayBuffer=function(){return typeof ArrayBuffer<"u"&&typeof Uint8Array<"u"};e.__addimage__.isArrayBuffer=function(R){return U()&&R instanceof ArrayBuffer};var V=e.__addimage__.isArrayBufferView=function(R){return U()&&typeof Uint32Array<"u"&&(R instanceof Int8Array||R instanceof Uint8Array||typeof Uint8ClampedArray<"u"&&R instanceof Uint8ClampedArray||R instanceof Int16Array||R instanceof Uint16Array||R instanceof Int32Array||R instanceof Uint32Array||R instanceof Float32Array||R instanceof Float64Array)},I=e.__addimage__.binaryStringToUint8Array=function(R){for(var F=R.length,Y=new Uint8Array(F),K=0;K<F;K++)Y[K]=R.charCodeAt(K);return Y},z=e.__addimage__.arrayBufferToBinaryString=function(R){for(var F="",Y=V(R)?R:new Uint8Array(R),K=0;K<Y.length;K+=8192)F+=String.fromCharCode.apply(null,Y.subarray(K,K+8192));return F};e.addImage=function(){var R,F,Y,K,X,Z,ce,te,Q;if(typeof arguments[1]=="number"?(F=t,Y=arguments[1],K=arguments[2],X=arguments[3],Z=arguments[4],ce=arguments[5],te=arguments[6],Q=arguments[7]):(F=arguments[1],Y=arguments[2],K=arguments[3],X=arguments[4],Z=arguments[5],ce=arguments[6],te=arguments[7],Q=arguments[8]),va(R=arguments[0])==="object"&&!x(R)&&"imageData"in R){var G=R;R=G.imageData,F=G.format||F||t,Y=G.x||Y||0,K=G.y||K||0,X=G.w||G.width||X,Z=G.h||G.height||Z,ce=G.alias||ce,te=G.compression||te,Q=G.rotation||G.angle||Q}var ye=this.internal.getFilters();if(te===void 0&&ye.indexOf("FlateEncode")!==-1&&(te="SLOW"),isNaN(Y)||isNaN(K))throw new Error("Invalid coordinates passed to jsPDF.addImage");c.call(this);var D=H.call(this,R,F,ce,te);return b.call(this,Y,K,X,Z,D,Q),this};var H=function(R,F,Y,K){var X,Z,ce;if(typeof R=="string"&&a(R)===t){R=unescape(R);var te=re(R,!1);(te!==""||(te=e.loadFile(R,!0))!==void 0)&&(R=te)}if(x(R)&&(R=v(R,F)),F=a(R,F),!p(F))throw new Error("addImage does not support files of type '"+F+"', please ensure that a plugin for '"+F+"' support is added.");if(((ce=Y)==null||ce.length===0)&&(Y=function(Q){return typeof Q=="string"||V(Q)?E(Q):V(Q.data)?E(Q.data):null}(R)),(X=g.call(this,Y))||(U()&&(R instanceof Uint8Array||F==="RGBA"||(Z=R,R=I(R))),X=this["process"+F.toUpperCase()](R,h.call(this),Y,function(Q){return Q&&typeof Q=="string"&&(Q=Q.toUpperCase()),Q in e.image_compression?Q:_.NONE}(K),Z)),!X)throw new Error("An unknown error occurred whilst processing the image.");return X},re=e.__addimage__.convertBase64ToBinaryString=function(R,F){F=typeof F!="boolean"||F;var Y,K="";if(typeof R=="string"){var X;Y=(X=M(R))!==null&&X!==void 0?X:R;try{K=jd(Y)}catch(Z){if(F)throw j(Y)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+Z.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return K};e.getImageProperties=function(R){var F,Y,K="";if(x(R)&&(R=v(R)),typeof R=="string"&&a(R)===t&&((K=re(R,!1))===""&&(K=e.loadFile(R)||""),R=K),Y=a(R),!p(Y))throw new Error("addImage does not support files of type '"+Y+"', please ensure that a plugin for '"+Y+"' support is added.");if(!U()||R instanceof Uint8Array||(R=I(R)),!(F=this["process"+Y.toUpperCase()](R)))throw new Error("An unknown error occurred whilst processing the image");return F.fileType=Y,F}})(dr.API),function(e){var t=function(r){if(r!==void 0&&r!="")return!0};dr.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(r){for(var a,n,s,o=this.internal.getCoordinateString,c=this.internal.getVerticalCoordinateString,u=this.internal.getPageInfoByObjId(r.objId),h=r.pageContext.annotations,p=!1,x=0;x<h.length&&!p;x++)switch((a=h[x]).type){case"link":(t(a.options.url)||t(a.options.pageNumber))&&(p=!0);break;case"reference":case"text":case"freetext":p=!0}if(p!=0){this.internal.write("/Annots [");for(var v=0;v<h.length;v++){a=h[v];var g=this.internal.pdfEscape,w=this.internal.getEncryptor(r.objId);switch(a.type){case"reference":this.internal.write(" "+a.object.objId+" 0 R ");break;case"text":var b=this.internal.newAdditionalObject(),N=this.internal.newAdditionalObject(),_=this.internal.getEncryptor(b.objId),E=a.title||"Note";s="<</Type /Annot /Subtype /Text "+(n="/Rect ["+o(a.bounds.x)+" "+c(a.bounds.y+a.bounds.h)+" "+o(a.bounds.x+a.bounds.w)+" "+c(a.bounds.y)+"] ")+"/Contents ("+g(_(a.contents))+")",s+=" /Popup "+N.objId+" 0 R",s+=" /P "+u.objId+" 0 R",s+=" /T ("+g(_(E))+") >>",b.content=s;var j=b.objId+" 0 R";s="<</Type /Annot /Subtype /Popup "+(n="/Rect ["+o(a.bounds.x+30)+" "+c(a.bounds.y+a.bounds.h)+" "+o(a.bounds.x+a.bounds.w+30)+" "+c(a.bounds.y)+"] ")+" /Parent "+j,a.open&&(s+=" /Open true"),s+=" >>",N.content=s,this.internal.write(b.objId,"0 R",N.objId,"0 R");break;case"freetext":n="/Rect ["+o(a.bounds.x)+" "+c(a.bounds.y)+" "+o(a.bounds.x+a.bounds.w)+" "+c(a.bounds.y+a.bounds.h)+"] ";var M=a.color||"#000000";s="<</Type /Annot /Subtype /FreeText "+n+"/Contents ("+g(w(a.contents))+")",s+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+M+")",s+=" /Border [0 0 0]",s+=" >>",this.internal.write(s);break;case"link":if(a.options.name){var U=this.annotations._nameMap[a.options.name];a.options.pageNumber=U.page,a.options.top=U.y}else a.options.top||(a.options.top=0);if(n="/Rect ["+a.finalBounds.x+" "+a.finalBounds.y+" "+a.finalBounds.w+" "+a.finalBounds.h+"] ",s="",a.options.url)s="<</Type /Annot /Subtype /Link "+n+"/Border [0 0 0] /A <</S /URI /URI ("+g(w(a.options.url))+") >>";else if(a.options.pageNumber)switch(s="<</Type /Annot /Subtype /Link "+n+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(a.options.pageNumber).objId+" 0 R",a.options.magFactor=a.options.magFactor||"XYZ",a.options.magFactor){case"Fit":s+=" /Fit]";break;case"FitH":s+=" /FitH "+a.options.top+"]";break;case"FitV":a.options.left=a.options.left||0,s+=" /FitV "+a.options.left+"]";break;case"XYZ":default:var V=c(a.options.top);a.options.left=a.options.left||0,a.options.zoom===void 0&&(a.options.zoom=0),s+=" /XYZ "+a.options.left+" "+V+" "+a.options.zoom+"]"}s!=""&&(s+=" >>",this.internal.write(s))}}this.internal.write("]")}}]),e.createAnnotation=function(r){var a=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":a.pageContext.annotations.push(r)}},e.link=function(r,a,n,s,o){var c=this.internal.getCurrentPageInfo(),u=this.internal.getCoordinateString,h=this.internal.getVerticalCoordinateString;c.pageContext.annotations.push({finalBounds:{x:u(r),y:h(a),w:u(r+n),h:h(a+s)},options:o,type:"link"})},e.textWithLink=function(r,a,n,s){var o,c,u=this.getTextWidth(r),h=this.internal.getLineHeight()/this.internal.scaleFactor;if(s.maxWidth!==void 0){c=s.maxWidth;var p=this.splitTextToSize(r,c).length;o=Math.ceil(h*p)}else c=u,o=h;return this.text(r,a,n,s),n+=.2*h,s.align==="center"&&(a-=u/2),s.align==="right"&&(a-=u),this.link(a,n-h,c,o,s),u},e.getTextWidth=function(r){var a=this.internal.getFontSize();return this.getStringUnitWidth(r)*a/this.internal.scaleFactor}}(dr.API),function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},a={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},n=[1570,1571,1573,1575];e.__arabicParser__={};var s=e.__arabicParser__.isInArabicSubstitutionA=function(b){return t[b.charCodeAt(0)]!==void 0},o=e.__arabicParser__.isArabicLetter=function(b){return typeof b=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(b)},c=e.__arabicParser__.isArabicEndLetter=function(b){return o(b)&&s(b)&&t[b.charCodeAt(0)].length<=2},u=e.__arabicParser__.isArabicAlfLetter=function(b){return o(b)&&n.indexOf(b.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(b){return o(b)&&s(b)&&t[b.charCodeAt(0)].length>=1};var h=e.__arabicParser__.arabicLetterHasFinalForm=function(b){return o(b)&&s(b)&&t[b.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(b){return o(b)&&s(b)&&t[b.charCodeAt(0)].length>=3};var p=e.__arabicParser__.arabicLetterHasMedialForm=function(b){return o(b)&&s(b)&&t[b.charCodeAt(0)].length==4},x=e.__arabicParser__.resolveLigatures=function(b){var N=0,_=r,E="",j=0;for(N=0;N<b.length;N+=1)_[b.charCodeAt(N)]!==void 0?(j++,typeof(_=_[b.charCodeAt(N)])=="number"&&(E+=String.fromCharCode(_),_=r,j=0),N===b.length-1&&(_=r,E+=b.charAt(N-(j-1)),N-=j-1,j=0)):(_=r,E+=b.charAt(N-j),N-=j,j=0);return E};e.__arabicParser__.isArabicDiacritic=function(b){return b!==void 0&&a[b.charCodeAt(0)]!==void 0};var v=e.__arabicParser__.getCorrectForm=function(b,N,_){return o(b)?s(b)===!1?-1:!h(b)||!o(N)&&!o(_)||!o(_)&&c(N)||c(b)&&!o(N)||c(b)&&u(N)||c(b)&&c(N)?0:p(b)&&o(N)&&!c(N)&&o(_)&&h(_)?3:c(b)||!o(_)?1:2:-1},g=function(b){var N=0,_=0,E=0,j="",M="",U="",V=(b=b||"").split("\\s+"),I=[];for(N=0;N<V.length;N+=1){for(I.push(""),_=0;_<V[N].length;_+=1)j=V[N][_],M=V[N][_-1],U=V[N][_+1],o(j)?(E=v(j,M,U),I[N]+=E!==-1?String.fromCharCode(t[j.charCodeAt(0)][E]):j):I[N]+=j;I[N]=x(I[N])}return I.join(" ")},w=e.__arabicParser__.processArabic=e.processArabic=function(){var b,N=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,_=[];if(Array.isArray(N)){var E=0;for(_=[],E=0;E<N.length;E+=1)Array.isArray(N[E])?_.push([g(N[E][0]),N[E][1],N[E][2]]):_.push([g(N[E])]);b=_}else b=g(N);return typeof arguments[0]=="string"?b:(arguments[0].text=b,arguments[0])};e.events.push(["preProcessText",w])}(dr.API),dr.API.autoPrint=function(e){var t;switch((e=e||{}).variant=e.variant||"non-conform",e.variant){case"javascript":this.addJS("print({});");break;case"non-conform":default:this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})}return this},function(e){var t=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(c){r=c}});var a=150;Object.defineProperty(this,"width",{get:function(){return a},set:function(c){a=isNaN(c)||Number.isInteger(c)===!1||c<0?150:c,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=a+1)}});var n=300;Object.defineProperty(this,"height",{get:function(){return n},set:function(c){n=isNaN(c)||Number.isInteger(c)===!1||c<0?300:c,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=n+1)}});var s=[];Object.defineProperty(this,"childNodes",{get:function(){return s},set:function(c){s=c}});var o={};Object.defineProperty(this,"style",{get:function(){return o},set:function(c){o=c}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(r,a){var n;if((r=r||"2d")!=="2d")return null;for(n in a)this.pdf.context2d.hasOwnProperty(n)&&(this.pdf.context2d[n]=a[n]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(dr.API),function(e){var t={left:0,top:0,bottom:0,right:0},r=!1,a=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),n.call(this))},n=function(){this.internal.__cell__.lastCell=new s,this.internal.__cell__.pages=1},s=function(){var u=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return u},set:function(b){u=b}});var h=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return h},set:function(b){h=b}});var p=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return p},set:function(b){p=b}});var x=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return x},set:function(b){x=b}});var v=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return v},set:function(b){v=b}});var g=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return g},set:function(b){g=b}});var w=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return w},set:function(b){w=b}}),this};s.prototype.clone=function(){return new s(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},s.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(u){return a.call(this),this.internal.__cell__.headerFunction=typeof u=="function"?u:void 0,this},e.getTextDimensions=function(u,h){a.call(this);var p=(h=h||{}).fontSize||this.getFontSize(),x=h.font||this.getFont(),v=h.scaleFactor||this.internal.scaleFactor,g=0,w=0,b=0,N=this;if(!Array.isArray(u)&&typeof u!="string"){if(typeof u!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");u=String(u)}var _=h.maxWidth;_>0?typeof u=="string"?u=this.splitTextToSize(u,_):Object.prototype.toString.call(u)==="[object Array]"&&(u=u.reduce(function(j,M){return j.concat(N.splitTextToSize(M,_))},[])):u=Array.isArray(u)?u:[u];for(var E=0;E<u.length;E++)g<(b=this.getStringUnitWidth(u[E],{font:x})*p)&&(g=b);return g!==0&&(w=u.length),{w:g/=v,h:Math.max((w*p*this.getLineHeightFactor()-p*(this.getLineHeightFactor()-1))/v,0)}},e.cellAddPage=function(){a.call(this),this.addPage();var u=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new s(u.left,u.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var o=e.cell=function(){var u;u=arguments[0]instanceof s?arguments[0]:new s(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),a.call(this);var h=this.internal.__cell__.lastCell,p=this.internal.__cell__.padding,x=this.internal.__cell__.margins||t,v=this.internal.__cell__.tableHeaderRow,g=this.internal.__cell__.printHeaders;return h.lineNumber!==void 0&&(h.lineNumber===u.lineNumber?(u.x=(h.x||0)+(h.width||0),u.y=h.y||0):h.y+h.height+u.height+x.bottom>this.getPageHeight()?(this.cellAddPage(),u.y=x.top,g&&v&&(this.printHeaderRow(u.lineNumber,!0),u.y+=v[0].height)):u.y=h.y+h.height||u.y),u.text[0]!==void 0&&(this.rect(u.x,u.y,u.width,u.height,r===!0?"FD":void 0),u.align==="right"?this.text(u.text,u.x+u.width-p,u.y+p,{align:"right",baseline:"top"}):u.align==="center"?this.text(u.text,u.x+u.width/2,u.y+p,{align:"center",baseline:"top",maxWidth:u.width-p-p}):this.text(u.text,u.x+p,u.y+p,{align:"left",baseline:"top",maxWidth:u.width-p-p})),this.internal.__cell__.lastCell=u,this};e.table=function(u,h,p,x,v){if(a.call(this),!p)throw new Error("No data for PDF table.");var g,w,b,N,_=[],E=[],j=[],M={},U={},V=[],I=[],z=(v=v||{}).autoSize||!1,H=v.printHeaders!==!1,re=v.css&&v.css["font-size"]!==void 0?16*v.css["font-size"]:v.fontSize||12,R=v.margins||Object.assign({width:this.getPageWidth()},t),F=typeof v.padding=="number"?v.padding:3,Y=v.headerBackgroundColor||"#c8c8c8",K=v.headerTextColor||"#000";if(n.call(this),this.internal.__cell__.printHeaders=H,this.internal.__cell__.margins=R,this.internal.__cell__.table_font_size=re,this.internal.__cell__.padding=F,this.internal.__cell__.headerBackgroundColor=Y,this.internal.__cell__.headerTextColor=K,this.setFontSize(re),x==null)E=_=Object.keys(p[0]),j=_.map(function(){return"left"});else if(Array.isArray(x)&&va(x[0])==="object")for(_=x.map(function(G){return G.name}),E=x.map(function(G){return G.prompt||G.name||""}),j=x.map(function(G){return G.align||"left"}),g=0;g<x.length;g+=1)U[x[g].name]=x[g].width*(19.049976/25.4);else Array.isArray(x)&&typeof x[0]=="string"&&(E=_=x,j=_.map(function(){return"left"}));if(z||Array.isArray(x)&&typeof x[0]=="string")for(g=0;g<_.length;g+=1){for(M[N=_[g]]=p.map(function(G){return G[N]}),this.setFont(void 0,"bold"),V.push(this.getTextDimensions(E[g],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),w=M[N],this.setFont(void 0,"normal"),b=0;b<w.length;b+=1)V.push(this.getTextDimensions(w[b],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);U[N]=Math.max.apply(null,V)+F+F,V=[]}if(H){var X={};for(g=0;g<_.length;g+=1)X[_[g]]={},X[_[g]].text=E[g],X[_[g]].align=j[g];var Z=c.call(this,X,U);I=_.map(function(G){return new s(u,h,U[G],Z,X[G].text,void 0,X[G].align)}),this.setTableHeaderRow(I),this.printHeaderRow(1,!1)}var ce=x.reduce(function(G,ye){return G[ye.name]=ye.align,G},{});for(g=0;g<p.length;g+=1){"rowStart"in v&&v.rowStart instanceof Function&&v.rowStart({row:g,data:p[g]},this);var te=c.call(this,p[g],U);for(b=0;b<_.length;b+=1){var Q=p[g][_[b]];"cellStart"in v&&v.cellStart instanceof Function&&v.cellStart({row:g,col:b,data:Q},this),o.call(this,new s(u,h,U[_[b]],te,Q,g+2,ce[_[b]]))}}return this.internal.__cell__.table_x=u,this.internal.__cell__.table_y=h,this};var c=function(u,h){var p=this.internal.__cell__.padding,x=this.internal.__cell__.table_font_size,v=this.internal.scaleFactor;return Object.keys(u).map(function(g){var w=u[g];return this.splitTextToSize(w.hasOwnProperty("text")?w.text:w,h[g]-p-p)},this).map(function(g){return this.getLineHeightFactor()*g.length*x/v+p+p},this).reduce(function(g,w){return Math.max(g,w)},0)};e.setTableHeaderRow=function(u){a.call(this),this.internal.__cell__.tableHeaderRow=u},e.printHeaderRow=function(u,h){if(a.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var p;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var x=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new s(x[0],x[1],x[2],x[3],void 0,-1)}this.setFont(void 0,"bold");for(var v=[],g=0;g<this.internal.__cell__.tableHeaderRow.length;g+=1){p=this.internal.__cell__.tableHeaderRow[g].clone(),h&&(p.y=this.internal.__cell__.margins.top||0,v.push(p)),p.lineNumber=u;var w=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),o.call(this,p),this.setTextColor(w)}v.length>0&&this.setTableHeaderRow(v),this.setFont(void 0,"normal"),r=!1}}(dr.API);var r_={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},a_=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],rv=t_(a_),n_=[100,200,300,400,500,600,700,800,900],OL=t_(n_);function av(e){var t=e.family.replace(/"|'/g,"").toLowerCase(),r=function(s){return r_[s=s||"normal"]?s:"normal"}(e.style),a=function(s){if(!s)return 400;if(typeof s=="number")return s>=100&&s<=900&&s%100==0?s:400;if(/^\d00$/.test(s))return parseInt(s);switch(s){case"bold":return 700;case"normal":default:return 400}}(e.weight),n=function(s){return typeof rv[s=s||"normal"]=="number"?s:"normal"}(e.stretch);return{family:t,style:r,weight:a,stretch:n,src:e.src||[],ref:e.ref||{name:t,style:[n,r,a].join(" ")}}}function K4(e,t,r,a){var n;for(n=r;n>=0&&n<t.length;n+=a)if(e[t[n]])return e[t[n]];for(n=r;n>=0&&n<t.length;n-=a)if(e[t[n]])return e[t[n]]}var RL={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},Z4={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function Q4(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function ML(e,t,r){for(var a=(r=r||{}).defaultFontFamily||"times",n=Object.assign({},RL,r.genericFontFamilies||{}),s=null,o=null,c=0;c<t.length;++c)if(n[(s=av(t[c])).family]&&(s.family=n[s.family]),e.hasOwnProperty(s.family)){o=e[s.family];break}if(!(o=o||e[a]))throw new Error("Could not find a font-family for the rule '"+Q4(s)+"' and default family '"+a+"'.");if(o=function(u,h){if(h[u])return h[u];var p=rv[u],x=p<=rv.normal?-1:1,v=K4(h,a_,p,x);if(!v)throw new Error("Could not find a matching font-stretch value for "+u);return v}(s.stretch,o),o=function(u,h){if(h[u])return h[u];for(var p=r_[u],x=0;x<p.length;++x)if(h[p[x]])return h[p[x]];throw new Error("Could not find a matching font-style for "+u)}(s.style,o),!(o=function(u,h){if(h[u])return h[u];if(u===400&&h[500])return h[500];if(u===500&&h[400])return h[400];var p=OL[u],x=K4(h,n_,p,u<400?-1:1);if(!x)throw new Error("Could not find a matching font-weight for value "+u);return x}(s.weight,o)))throw new Error("Failed to resolve a font for the rule '"+Q4(s)+"'.");return o}function e3(e){return e.trimLeft()}function IL(e,t){for(var r=0;r<e.length;){if(e.charAt(r)===t)return[e.substring(0,r),e.substring(r+1)];r+=1}return null}function BL(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],e.substring(t[0].length)]}var jm,t3,r3,Kg=["times"];(function(e){var t,r,a,n,s,o,c,u,h,p=function(D){return D=D||{},this.isStrokeTransparent=D.isStrokeTransparent||!1,this.strokeOpacity=D.strokeOpacity||1,this.strokeStyle=D.strokeStyle||"#000000",this.fillStyle=D.fillStyle||"#000000",this.isFillTransparent=D.isFillTransparent||!1,this.fillOpacity=D.fillOpacity||1,this.font=D.font||"10px sans-serif",this.textBaseline=D.textBaseline||"alphabetic",this.textAlign=D.textAlign||"left",this.lineWidth=D.lineWidth||1,this.lineJoin=D.lineJoin||"miter",this.lineCap=D.lineCap||"butt",this.path=D.path||[],this.transform=D.transform!==void 0?D.transform.clone():new u,this.globalCompositeOperation=D.globalCompositeOperation||"normal",this.globalAlpha=D.globalAlpha||1,this.clip_path=D.clip_path||[],this.currentPoint=D.currentPoint||new o,this.miterLimit=D.miterLimit||10,this.lastPoint=D.lastPoint||new o,this.lineDashOffset=D.lineDashOffset||0,this.lineDash=D.lineDash||[],this.margin=D.margin||[0,0,0,0],this.prevPageLastElemOffset=D.prevPageLastElemOffset||0,this.ignoreClearRect=typeof D.ignoreClearRect!="boolean"||D.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new x(this),t=this.internal.f2,r=this.internal.getCoordinateString,a=this.internal.getVerticalCoordinateString,n=this.internal.getHorizontalCoordinate,s=this.internal.getVerticalCoordinate,o=this.internal.Point,c=this.internal.Rectangle,u=this.internal.Matrix,h=new p}]);var x=function(D){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var O=D;Object.defineProperty(this,"pdf",{get:function(){return O}});var L=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return L},set:function(ke){L=!!ke}});var q=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return q},set:function(ke){q=!!ke}});var oe=0;Object.defineProperty(this,"posX",{get:function(){return oe},set:function(ke){isNaN(ke)||(oe=ke)}});var be=0;Object.defineProperty(this,"posY",{get:function(){return be},set:function(ke){isNaN(ke)||(be=ke)}}),Object.defineProperty(this,"margin",{get:function(){return h.margin},set:function(ke){var de;typeof ke=="number"?de=[ke,ke,ke,ke]:((de=new Array(4))[0]=ke[0],de[1]=ke.length>=2?ke[1]:de[0],de[2]=ke.length>=3?ke[2]:de[0],de[3]=ke.length>=4?ke[3]:de[1]),h.margin=de}});var ve=!1;Object.defineProperty(this,"autoPaging",{get:function(){return ve},set:function(ke){ve=ke}});var ue=0;Object.defineProperty(this,"lastBreak",{get:function(){return ue},set:function(ke){ue=ke}});var fe=[];Object.defineProperty(this,"pageBreaks",{get:function(){return fe},set:function(ke){fe=ke}}),Object.defineProperty(this,"ctx",{get:function(){return h},set:function(ke){ke instanceof p&&(h=ke)}}),Object.defineProperty(this,"path",{get:function(){return h.path},set:function(ke){h.path=ke}});var Ee=[];Object.defineProperty(this,"ctxStack",{get:function(){return Ee},set:function(ke){Ee=ke}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(ke){var de;de=v(ke),this.ctx.fillStyle=de.style,this.ctx.isFillTransparent=de.a===0,this.ctx.fillOpacity=de.a,this.pdf.setFillColor(de.r,de.g,de.b,{a:de.a}),this.pdf.setTextColor(de.r,de.g,de.b,{a:de.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(ke){var de=v(ke);this.ctx.strokeStyle=de.style,this.ctx.isStrokeTransparent=de.a===0,this.ctx.strokeOpacity=de.a,de.a===0?this.pdf.setDrawColor(255,255,255):(de.a,this.pdf.setDrawColor(de.r,de.g,de.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(ke){["butt","round","square"].indexOf(ke)!==-1&&(this.ctx.lineCap=ke,this.pdf.setLineCap(ke))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(ke){isNaN(ke)||(this.ctx.lineWidth=ke,this.pdf.setLineWidth(ke))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(ke){["bevel","round","miter"].indexOf(ke)!==-1&&(this.ctx.lineJoin=ke,this.pdf.setLineJoin(ke))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(ke){isNaN(ke)||(this.ctx.miterLimit=ke,this.pdf.setMiterLimit(ke))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(ke){this.ctx.textBaseline=ke}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(ke){["right","end","center","left","start"].indexOf(ke)!==-1&&(this.ctx.textAlign=ke)}});var J=null;function Pe(ke,de){if(J===null){var rt=function(Ue){var Xe=[];return Object.keys(Ue).forEach(function(ot){Ue[ot].forEach(function(ut){var vt=null;switch(ut){case"bold":vt={family:ot,weight:"bold"};break;case"italic":vt={family:ot,style:"italic"};break;case"bolditalic":vt={family:ot,weight:"bold",style:"italic"};break;case"":case"normal":vt={family:ot}}vt!==null&&(vt.ref={name:ot,style:ut},Xe.push(vt))})}),Xe}(ke.getFontList());J=function(Ue){for(var Xe={},ot=0;ot<Ue.length;++ot){var ut=av(Ue[ot]),vt=ut.family,At=ut.stretch,ct=ut.style,ze=ut.weight;Xe[vt]=Xe[vt]||{},Xe[vt][At]=Xe[vt][At]||{},Xe[vt][At][ct]=Xe[vt][At][ct]||{},Xe[vt][At][ct][ze]=ut}return Xe}(rt.concat(de))}return J}var st=null;Object.defineProperty(this,"fontFaces",{get:function(){return st},set:function(ke){J=null,st=ke}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(ke){var de;if(this.ctx.font=ke,(de=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(ke))!==null){var rt=de[1];de[2];var Ue=de[3],Xe=de[4];de[5];var ot=de[6],ut=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Xe)[2];Xe=Math.floor(ut==="px"?parseFloat(Xe)*this.pdf.internal.scaleFactor:ut==="em"?parseFloat(Xe)*this.pdf.getFontSize():parseFloat(Xe)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Xe);var vt=function(Lt){var Ct,wt,hr=[],zt=Lt.trim();if(zt==="")return Kg;if(zt in Z4)return[Z4[zt]];for(;zt!=="";){switch(wt=null,Ct=(zt=e3(zt)).charAt(0)){case'"':case"'":wt=IL(zt.substring(1),Ct);break;default:wt=BL(zt)}if(wt===null||(hr.push(wt[0]),(zt=e3(wt[1]))!==""&&zt.charAt(0)!==","))return Kg;zt=zt.replace(/^,/,"")}return hr}(ot);if(this.fontFaces){var At=ML(Pe(this.pdf,this.fontFaces),vt.map(function(Lt){return{family:Lt,stretch:"normal",weight:Ue,style:rt}}));this.pdf.setFont(At.ref.name,At.ref.style)}else{var ct="";(Ue==="bold"||parseInt(Ue,10)>=700||rt==="bold")&&(ct="bold"),rt==="italic"&&(ct+="italic"),ct.length===0&&(ct="normal");for(var ze="",pt={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Ot=0;Ot<vt.length;Ot++){if(this.pdf.internal.getFont(vt[Ot],ct,{noFallback:!0,disableWarning:!0})!==void 0){ze=vt[Ot];break}if(ct==="bolditalic"&&this.pdf.internal.getFont(vt[Ot],"bold",{noFallback:!0,disableWarning:!0})!==void 0)ze=vt[Ot],ct="bold";else if(this.pdf.internal.getFont(vt[Ot],"normal",{noFallback:!0,disableWarning:!0})!==void 0){ze=vt[Ot],ct="normal";break}}if(ze===""){for(var It=0;It<vt.length;It++)if(pt[vt[It]]){ze=pt[vt[It]];break}}ze=ze===""?"Times":ze,this.pdf.setFont(ze,ct)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(ke){this.ctx.globalCompositeOperation=ke}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(ke){this.ctx.globalAlpha=ke}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(ke){this.ctx.lineDashOffset=ke,ye.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(ke){this.ctx.lineDash=ke,ye.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(ke){this.ctx.ignoreClearRect=!!ke}})};x.prototype.setLineDash=function(D){this.lineDash=D},x.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},x.prototype.fill=function(){M.call(this,"fill",!1)},x.prototype.stroke=function(){M.call(this,"stroke",!1)},x.prototype.beginPath=function(){this.path=[{type:"begin"}]},x.prototype.moveTo=function(D,O){if(isNaN(D)||isNaN(O))throw Ta.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var L=this.ctx.transform.applyToPoint(new o(D,O));this.path.push({type:"mt",x:L.x,y:L.y}),this.ctx.lastPoint=new o(D,O)},x.prototype.closePath=function(){var D=new o(0,0),O=0;for(O=this.path.length-1;O!==-1;O--)if(this.path[O].type==="begin"&&va(this.path[O+1])==="object"&&typeof this.path[O+1].x=="number"){D=new o(this.path[O+1].x,this.path[O+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new o(D.x,D.y)},x.prototype.lineTo=function(D,O){if(isNaN(D)||isNaN(O))throw Ta.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var L=this.ctx.transform.applyToPoint(new o(D,O));this.path.push({type:"lt",x:L.x,y:L.y}),this.ctx.lastPoint=new o(L.x,L.y)},x.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),M.call(this,null,!0)},x.prototype.quadraticCurveTo=function(D,O,L,q){if(isNaN(L)||isNaN(q)||isNaN(D)||isNaN(O))throw Ta.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var oe=this.ctx.transform.applyToPoint(new o(L,q)),be=this.ctx.transform.applyToPoint(new o(D,O));this.path.push({type:"qct",x1:be.x,y1:be.y,x:oe.x,y:oe.y}),this.ctx.lastPoint=new o(oe.x,oe.y)},x.prototype.bezierCurveTo=function(D,O,L,q,oe,be){if(isNaN(oe)||isNaN(be)||isNaN(D)||isNaN(O)||isNaN(L)||isNaN(q))throw Ta.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var ve=this.ctx.transform.applyToPoint(new o(oe,be)),ue=this.ctx.transform.applyToPoint(new o(D,O)),fe=this.ctx.transform.applyToPoint(new o(L,q));this.path.push({type:"bct",x1:ue.x,y1:ue.y,x2:fe.x,y2:fe.y,x:ve.x,y:ve.y}),this.ctx.lastPoint=new o(ve.x,ve.y)},x.prototype.arc=function(D,O,L,q,oe,be){if(isNaN(D)||isNaN(O)||isNaN(L)||isNaN(q)||isNaN(oe))throw Ta.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(be=!!be,!this.ctx.transform.isIdentity){var ve=this.ctx.transform.applyToPoint(new o(D,O));D=ve.x,O=ve.y;var ue=this.ctx.transform.applyToPoint(new o(0,L)),fe=this.ctx.transform.applyToPoint(new o(0,0));L=Math.sqrt(Math.pow(ue.x-fe.x,2)+Math.pow(ue.y-fe.y,2))}Math.abs(oe-q)>=2*Math.PI&&(q=0,oe=2*Math.PI),this.path.push({type:"arc",x:D,y:O,radius:L,startAngle:q,endAngle:oe,counterclockwise:be})},x.prototype.arcTo=function(D,O,L,q,oe){throw new Error("arcTo not implemented.")},x.prototype.rect=function(D,O,L,q){if(isNaN(D)||isNaN(O)||isNaN(L)||isNaN(q))throw Ta.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(D,O),this.lineTo(D+L,O),this.lineTo(D+L,O+q),this.lineTo(D,O+q),this.lineTo(D,O),this.lineTo(D+L,O),this.lineTo(D,O)},x.prototype.fillRect=function(D,O,L,q){if(isNaN(D)||isNaN(O)||isNaN(L)||isNaN(q))throw Ta.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!g.call(this)){var oe={};this.lineCap!=="butt"&&(oe.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(oe.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(D,O,L,q),this.fill(),oe.hasOwnProperty("lineCap")&&(this.lineCap=oe.lineCap),oe.hasOwnProperty("lineJoin")&&(this.lineJoin=oe.lineJoin)}},x.prototype.strokeRect=function(D,O,L,q){if(isNaN(D)||isNaN(O)||isNaN(L)||isNaN(q))throw Ta.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");w.call(this)||(this.beginPath(),this.rect(D,O,L,q),this.stroke())},x.prototype.clearRect=function(D,O,L,q){if(isNaN(D)||isNaN(O)||isNaN(L)||isNaN(q))throw Ta.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(D,O,L,q))},x.prototype.save=function(D){D=typeof D!="boolean"||D;for(var O=this.pdf.internal.getCurrentPageInfo().pageNumber,L=0;L<this.pdf.internal.getNumberOfPages();L++)this.pdf.setPage(L+1),this.pdf.internal.out("q");if(this.pdf.setPage(O),D){this.ctx.fontSize=this.pdf.internal.getFontSize();var q=new p(this.ctx);this.ctxStack.push(this.ctx),this.ctx=q}},x.prototype.restore=function(D){D=typeof D!="boolean"||D;for(var O=this.pdf.internal.getCurrentPageInfo().pageNumber,L=0;L<this.pdf.internal.getNumberOfPages();L++)this.pdf.setPage(L+1),this.pdf.internal.out("Q");this.pdf.setPage(O),D&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},x.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var v=function(D){var O,L,q,oe;if(D.isCanvasGradient===!0&&(D=D.getColor()),!D)return{r:0,g:0,b:0,a:0,style:D};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(D))O=0,L=0,q=0,oe=0;else{var be=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(D);if(be!==null)O=parseInt(be[1]),L=parseInt(be[2]),q=parseInt(be[3]),oe=1;else if((be=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(D))!==null)O=parseInt(be[1]),L=parseInt(be[2]),q=parseInt(be[3]),oe=parseFloat(be[4]);else{if(oe=1,typeof D=="string"&&D.charAt(0)!=="#"){var ve=new YA(D);D=ve.ok?ve.toHex():"#000000"}D.length===4?(O=D.substring(1,2),O+=O,L=D.substring(2,3),L+=L,q=D.substring(3,4),q+=q):(O=D.substring(1,3),L=D.substring(3,5),q=D.substring(5,7)),O=parseInt(O,16),L=parseInt(L,16),q=parseInt(q,16)}}return{r:O,g:L,b:q,a:oe,style:D}},g=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},w=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};x.prototype.fillText=function(D,O,L,q){if(isNaN(O)||isNaN(L)||typeof D!="string")throw Ta.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(q=isNaN(q)?void 0:q,!g.call(this)){var oe=te(this.ctx.transform.rotation),be=this.ctx.transform.scaleX;F.call(this,{text:D,x:O,y:L,scale:be,angle:oe,align:this.textAlign,maxWidth:q})}},x.prototype.strokeText=function(D,O,L,q){if(isNaN(O)||isNaN(L)||typeof D!="string")throw Ta.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!w.call(this)){q=isNaN(q)?void 0:q;var oe=te(this.ctx.transform.rotation),be=this.ctx.transform.scaleX;F.call(this,{text:D,x:O,y:L,scale:be,renderingMode:"stroke",angle:oe,align:this.textAlign,maxWidth:q})}},x.prototype.measureText=function(D){if(typeof D!="string")throw Ta.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var O=this.pdf,L=this.pdf.internal.scaleFactor,q=O.internal.getFontSize(),oe=O.getStringUnitWidth(D)*q/O.internal.scaleFactor,be=function(ve){var ue=(ve=ve||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return ue}}),this};return new be({width:oe*=Math.round(96*L/72*1e4)/1e4})},x.prototype.scale=function(D,O){if(isNaN(D)||isNaN(O))throw Ta.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var L=new u(D,0,0,O,0,0);this.ctx.transform=this.ctx.transform.multiply(L)},x.prototype.rotate=function(D){if(isNaN(D))throw Ta.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var O=new u(Math.cos(D),Math.sin(D),-Math.sin(D),Math.cos(D),0,0);this.ctx.transform=this.ctx.transform.multiply(O)},x.prototype.translate=function(D,O){if(isNaN(D)||isNaN(O))throw Ta.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var L=new u(1,0,0,1,D,O);this.ctx.transform=this.ctx.transform.multiply(L)},x.prototype.transform=function(D,O,L,q,oe,be){if(isNaN(D)||isNaN(O)||isNaN(L)||isNaN(q)||isNaN(oe)||isNaN(be))throw Ta.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var ve=new u(D,O,L,q,oe,be);this.ctx.transform=this.ctx.transform.multiply(ve)},x.prototype.setTransform=function(D,O,L,q,oe,be){D=isNaN(D)?1:D,O=isNaN(O)?0:O,L=isNaN(L)?0:L,q=isNaN(q)?1:q,oe=isNaN(oe)?0:oe,be=isNaN(be)?0:be,this.ctx.transform=new u(D,O,L,q,oe,be)};var b=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};x.prototype.drawImage=function(D,O,L,q,oe,be,ve,ue,fe){var Ee=this.pdf.getImageProperties(D),J=1,Pe=1,st=1,ke=1;q!==void 0&&ue!==void 0&&(st=ue/q,ke=fe/oe,J=Ee.width/q*ue/q,Pe=Ee.height/oe*fe/oe),be===void 0&&(be=O,ve=L,O=0,L=0),q!==void 0&&ue===void 0&&(ue=q,fe=oe),q===void 0&&ue===void 0&&(ue=Ee.width,fe=Ee.height);for(var de,rt=this.ctx.transform.decompose(),Ue=te(rt.rotate.shx),Xe=new u,ot=(Xe=(Xe=(Xe=Xe.multiply(rt.translate)).multiply(rt.skew)).multiply(rt.scale)).applyToRectangle(new c(be-O*st,ve-L*ke,q*J,oe*Pe)),ut=N.call(this,ot),vt=[],At=0;At<ut.length;At+=1)vt.indexOf(ut[At])===-1&&vt.push(ut[At]);if(j(vt),this.autoPaging)for(var ct=vt[0],ze=vt[vt.length-1],pt=ct;pt<ze+1;pt++){this.pdf.setPage(pt);var Ot=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],It=pt===1?this.posY+this.margin[0]:this.margin[0],Lt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Ct=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],wt=pt===1?0:Lt+(pt-2)*Ct;if(this.ctx.clip_path.length!==0){var hr=this.path;de=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=E(de,this.posX+this.margin[3],-wt+It+this.ctx.prevPageLastElemOffset),U.call(this,"fill",!0),this.path=hr}var zt=JSON.parse(JSON.stringify(ot));zt=E([zt],this.posX+this.margin[3],-wt+It+this.ctx.prevPageLastElemOffset)[0];var Yt=(pt>ct||pt<ze)&&b.call(this);Yt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ot,Ct,null).clip().discardPath()),this.pdf.addImage(D,"JPEG",zt.x,zt.y,zt.w,zt.h,null,null,Ue),Yt&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(D,"JPEG",ot.x,ot.y,ot.w,ot.h,null,null,Ue)};var N=function(D,O,L){var q=[];O=O||this.pdf.internal.pageSize.width,L=L||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var oe=this.posY+this.ctx.prevPageLastElemOffset;switch(D.type){default:case"mt":case"lt":q.push(Math.floor((D.y+oe)/L)+1);break;case"arc":q.push(Math.floor((D.y+oe-D.radius)/L)+1),q.push(Math.floor((D.y+oe+D.radius)/L)+1);break;case"qct":var be=Q(this.ctx.lastPoint.x,this.ctx.lastPoint.y,D.x1,D.y1,D.x,D.y);q.push(Math.floor((be.y+oe)/L)+1),q.push(Math.floor((be.y+be.h+oe)/L)+1);break;case"bct":var ve=G(this.ctx.lastPoint.x,this.ctx.lastPoint.y,D.x1,D.y1,D.x2,D.y2,D.x,D.y);q.push(Math.floor((ve.y+oe)/L)+1),q.push(Math.floor((ve.y+ve.h+oe)/L)+1);break;case"rect":q.push(Math.floor((D.y+oe)/L)+1),q.push(Math.floor((D.y+D.h+oe)/L)+1)}for(var ue=0;ue<q.length;ue+=1)for(;this.pdf.internal.getNumberOfPages()<q[ue];)_.call(this);return q},_=function(){var D=this.fillStyle,O=this.strokeStyle,L=this.font,q=this.lineCap,oe=this.lineWidth,be=this.lineJoin;this.pdf.addPage(),this.fillStyle=D,this.strokeStyle=O,this.font=L,this.lineCap=q,this.lineWidth=oe,this.lineJoin=be},E=function(D,O,L){for(var q=0;q<D.length;q++)switch(D[q].type){case"bct":D[q].x2+=O,D[q].y2+=L;case"qct":D[q].x1+=O,D[q].y1+=L;case"mt":case"lt":case"arc":default:D[q].x+=O,D[q].y+=L}return D},j=function(D){return D.sort(function(O,L){return O-L})},M=function(D,O){for(var L,q,oe=this.fillStyle,be=this.strokeStyle,ve=this.lineCap,ue=this.lineWidth,fe=Math.abs(ue*this.ctx.transform.scaleX),Ee=this.lineJoin,J=JSON.parse(JSON.stringify(this.path)),Pe=JSON.parse(JSON.stringify(this.path)),st=[],ke=0;ke<Pe.length;ke++)if(Pe[ke].x!==void 0)for(var de=N.call(this,Pe[ke]),rt=0;rt<de.length;rt+=1)st.indexOf(de[rt])===-1&&st.push(de[rt]);for(var Ue=0;Ue<st.length;Ue++)for(;this.pdf.internal.getNumberOfPages()<st[Ue];)_.call(this);if(j(st),this.autoPaging)for(var Xe=st[0],ot=st[st.length-1],ut=Xe;ut<ot+1;ut++){this.pdf.setPage(ut),this.fillStyle=oe,this.strokeStyle=be,this.lineCap=ve,this.lineWidth=fe,this.lineJoin=Ee;var vt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],At=ut===1?this.posY+this.margin[0]:this.margin[0],ct=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ze=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],pt=ut===1?0:ct+(ut-2)*ze;if(this.ctx.clip_path.length!==0){var Ot=this.path;L=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=E(L,this.posX+this.margin[3],-pt+At+this.ctx.prevPageLastElemOffset),U.call(this,D,!0),this.path=Ot}if(q=JSON.parse(JSON.stringify(J)),this.path=E(q,this.posX+this.margin[3],-pt+At+this.ctx.prevPageLastElemOffset),O===!1||ut===0){var It=(ut>Xe||ut<ot)&&b.call(this);It&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],vt,ze,null).clip().discardPath()),U.call(this,D,O),It&&this.pdf.restoreGraphicsState()}this.lineWidth=ue}else this.lineWidth=fe,U.call(this,D,O),this.lineWidth=ue;this.path=J},U=function(D,O){if((D!=="stroke"||O||!w.call(this))&&(D==="stroke"||O||!g.call(this))){for(var L,q,oe=[],be=this.path,ve=0;ve<be.length;ve++){var ue=be[ve];switch(ue.type){case"begin":oe.push({begin:!0});break;case"close":oe.push({close:!0});break;case"mt":oe.push({start:ue,deltas:[],abs:[]});break;case"lt":var fe=oe.length;if(be[ve-1]&&!isNaN(be[ve-1].x)&&(L=[ue.x-be[ve-1].x,ue.y-be[ve-1].y],fe>0)){for(;fe>=0;fe--)if(oe[fe-1].close!==!0&&oe[fe-1].begin!==!0){oe[fe-1].deltas.push(L),oe[fe-1].abs.push(ue);break}}break;case"bct":L=[ue.x1-be[ve-1].x,ue.y1-be[ve-1].y,ue.x2-be[ve-1].x,ue.y2-be[ve-1].y,ue.x-be[ve-1].x,ue.y-be[ve-1].y],oe[oe.length-1].deltas.push(L);break;case"qct":var Ee=be[ve-1].x+2/3*(ue.x1-be[ve-1].x),J=be[ve-1].y+2/3*(ue.y1-be[ve-1].y),Pe=ue.x+2/3*(ue.x1-ue.x),st=ue.y+2/3*(ue.y1-ue.y),ke=ue.x,de=ue.y;L=[Ee-be[ve-1].x,J-be[ve-1].y,Pe-be[ve-1].x,st-be[ve-1].y,ke-be[ve-1].x,de-be[ve-1].y],oe[oe.length-1].deltas.push(L);break;case"arc":oe.push({deltas:[],abs:[],arc:!0}),Array.isArray(oe[oe.length-1].abs)&&oe[oe.length-1].abs.push(ue)}}q=O?null:D==="stroke"?"stroke":"fill";for(var rt=!1,Ue=0;Ue<oe.length;Ue++)if(oe[Ue].arc)for(var Xe=oe[Ue].abs,ot=0;ot<Xe.length;ot++){var ut=Xe[ot];ut.type==="arc"?z.call(this,ut.x,ut.y,ut.radius,ut.startAngle,ut.endAngle,ut.counterclockwise,void 0,O,!rt):Y.call(this,ut.x,ut.y),rt=!0}else if(oe[Ue].close===!0)this.pdf.internal.out("h"),rt=!1;else if(oe[Ue].begin!==!0){var vt=oe[Ue].start.x,At=oe[Ue].start.y;K.call(this,oe[Ue].deltas,vt,At),rt=!0}q&&H.call(this,q),O&&re.call(this)}},V=function(D){var O=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,L=O*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return D-L;case"top":return D+O-L;case"hanging":return D+O-2*L;case"middle":return D+O/2-L;case"ideographic":return D;case"alphabetic":default:return D}},I=function(D){return D+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};x.prototype.createLinearGradient=function(){var D=function(){};return D.colorStops=[],D.addColorStop=function(O,L){this.colorStops.push([O,L])},D.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},D.isCanvasGradient=!0,D},x.prototype.createPattern=function(){return this.createLinearGradient()},x.prototype.createRadialGradient=function(){return this.createLinearGradient()};var z=function(D,O,L,q,oe,be,ve,ue,fe){for(var Ee=Z.call(this,L,q,oe,be),J=0;J<Ee.length;J++){var Pe=Ee[J];J===0&&(fe?R.call(this,Pe.x1+D,Pe.y1+O):Y.call(this,Pe.x1+D,Pe.y1+O)),X.call(this,D,O,Pe.x2,Pe.y2,Pe.x3,Pe.y3,Pe.x4,Pe.y4)}ue?re.call(this):H.call(this,ve)},H=function(D){switch(D){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},re=function(){this.pdf.clip(),this.pdf.discardPath()},R=function(D,O){this.pdf.internal.out(r(D)+" "+a(O)+" m")},F=function(D){var O;switch(D.align){case"right":case"end":O="right";break;case"center":O="center";break;case"left":case"start":default:O="left"}var L=this.pdf.getTextDimensions(D.text),q=V.call(this,D.y),oe=I.call(this,q)-L.h,be=this.ctx.transform.applyToPoint(new o(D.x,q)),ve=this.ctx.transform.decompose(),ue=new u;ue=(ue=(ue=ue.multiply(ve.translate)).multiply(ve.skew)).multiply(ve.scale);for(var fe,Ee,J,Pe=this.ctx.transform.applyToRectangle(new c(D.x,q,L.w,L.h)),st=ue.applyToRectangle(new c(D.x,oe,L.w,L.h)),ke=N.call(this,st),de=[],rt=0;rt<ke.length;rt+=1)de.indexOf(ke[rt])===-1&&de.push(ke[rt]);if(j(de),this.autoPaging)for(var Ue=de[0],Xe=de[de.length-1],ot=Ue;ot<Xe+1;ot++){this.pdf.setPage(ot);var ut=ot===1?this.posY+this.margin[0]:this.margin[0],vt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],At=this.pdf.internal.pageSize.height-this.margin[2],ct=At-this.margin[0],ze=this.pdf.internal.pageSize.width-this.margin[1],pt=ze-this.margin[3],Ot=ot===1?0:vt+(ot-2)*ct;if(this.ctx.clip_path.length!==0){var It=this.path;fe=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=E(fe,this.posX+this.margin[3],-1*Ot+ut),U.call(this,"fill",!0),this.path=It}var Lt=E([JSON.parse(JSON.stringify(st))],this.posX+this.margin[3],-Ot+ut+this.ctx.prevPageLastElemOffset)[0];D.scale>=.01&&(Ee=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Ee*D.scale),J=this.lineWidth,this.lineWidth=J*D.scale);var Ct=this.autoPaging!=="text";if(Ct||Lt.y+Lt.h<=At){if(Ct||Lt.y>=ut&&Lt.x<=ze){var wt=Ct?D.text:this.pdf.splitTextToSize(D.text,D.maxWidth||ze-Lt.x)[0],hr=E([JSON.parse(JSON.stringify(Pe))],this.posX+this.margin[3],-Ot+ut+this.ctx.prevPageLastElemOffset)[0],zt=Ct&&(ot>Ue||ot<Xe)&&b.call(this);zt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],pt,ct,null).clip().discardPath()),this.pdf.text(wt,hr.x,hr.y,{angle:D.angle,align:O,renderingMode:D.renderingMode}),zt&&this.pdf.restoreGraphicsState()}}else Lt.y<At&&(this.ctx.prevPageLastElemOffset+=At-Lt.y);D.scale>=.01&&(this.pdf.setFontSize(Ee),this.lineWidth=J)}else D.scale>=.01&&(Ee=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Ee*D.scale),J=this.lineWidth,this.lineWidth=J*D.scale),this.pdf.text(D.text,be.x+this.posX,be.y+this.posY,{angle:D.angle,align:O,renderingMode:D.renderingMode,maxWidth:D.maxWidth}),D.scale>=.01&&(this.pdf.setFontSize(Ee),this.lineWidth=J)},Y=function(D,O,L,q){L=L||0,q=q||0,this.pdf.internal.out(r(D+L)+" "+a(O+q)+" l")},K=function(D,O,L){return this.pdf.lines(D,O,L,null,null)},X=function(D,O,L,q,oe,be,ve,ue){this.pdf.internal.out([t(n(L+D)),t(s(q+O)),t(n(oe+D)),t(s(be+O)),t(n(ve+D)),t(s(ue+O)),"c"].join(" "))},Z=function(D,O,L,q){for(var oe=2*Math.PI,be=Math.PI/2;O>L;)O-=oe;var ve=Math.abs(L-O);ve<oe&&q&&(ve=oe-ve);for(var ue=[],fe=q?-1:1,Ee=O;ve>1e-5;){var J=Ee+fe*Math.min(ve,be);ue.push(ce.call(this,D,Ee,J)),ve-=Math.abs(J-Ee),Ee=J}return ue},ce=function(D,O,L){var q=(L-O)/2,oe=D*Math.cos(q),be=D*Math.sin(q),ve=oe,ue=-be,fe=ve*ve+ue*ue,Ee=fe+ve*oe+ue*be,J=4/3*(Math.sqrt(2*fe*Ee)-Ee)/(ve*be-ue*oe),Pe=ve-J*ue,st=ue+J*ve,ke=Pe,de=-st,rt=q+O,Ue=Math.cos(rt),Xe=Math.sin(rt);return{x1:D*Math.cos(O),y1:D*Math.sin(O),x2:Pe*Ue-st*Xe,y2:Pe*Xe+st*Ue,x3:ke*Ue-de*Xe,y3:ke*Xe+de*Ue,x4:D*Math.cos(L),y4:D*Math.sin(L)}},te=function(D){return 180*D/Math.PI},Q=function(D,O,L,q,oe,be){var ve=D+.5*(L-D),ue=O+.5*(q-O),fe=oe+.5*(L-oe),Ee=be+.5*(q-be),J=Math.min(D,oe,ve,fe),Pe=Math.max(D,oe,ve,fe),st=Math.min(O,be,ue,Ee),ke=Math.max(O,be,ue,Ee);return new c(J,st,Pe-J,ke-st)},G=function(D,O,L,q,oe,be,ve,ue){var fe,Ee,J,Pe,st,ke,de,rt,Ue,Xe,ot,ut,vt,At,ct=L-D,ze=q-O,pt=oe-L,Ot=be-q,It=ve-oe,Lt=ue-be;for(Ee=0;Ee<41;Ee++)Ue=(de=(J=D+(fe=Ee/40)*ct)+fe*((st=L+fe*pt)-J))+fe*(st+fe*(oe+fe*It-st)-de),Xe=(rt=(Pe=O+fe*ze)+fe*((ke=q+fe*Ot)-Pe))+fe*(ke+fe*(be+fe*Lt-ke)-rt),Ee==0?(ot=Ue,ut=Xe,vt=Ue,At=Xe):(ot=Math.min(ot,Ue),ut=Math.min(ut,Xe),vt=Math.max(vt,Ue),At=Math.max(At,Xe));return new c(Math.round(ot),Math.round(ut),Math.round(vt-ot),Math.round(At-ut))},ye=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var D,O,L=(D=this.ctx.lineDash,O=this.ctx.lineDashOffset,JSON.stringify({lineDash:D,lineDashOffset:O}));this.prevLineDash!==L&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=L)}}})(dr.API),function(e){var t=function(s){var o,c,u,h,p,x,v,g,w,b;for(c=[],u=0,h=(s+=o="\0\0\0\0".slice(s.length%4||4)).length;h>u;u+=4)(p=(s.charCodeAt(u)<<24)+(s.charCodeAt(u+1)<<16)+(s.charCodeAt(u+2)<<8)+s.charCodeAt(u+3))!==0?(x=(p=((p=((p=((p=(p-(b=p%85))/85)-(w=p%85))/85)-(g=p%85))/85)-(v=p%85))/85)%85,c.push(x+33,v+33,g+33,w+33,b+33)):c.push(122);return function(N,_){for(var E=_;E>0;E--)N.pop()}(c,o.length),String.fromCharCode.apply(String,c)+"~>"},r=function(s){var o,c,u,h,p,x=String,v="length",g=255,w="charCodeAt",b="slice",N="replace";for(s[b](-2),s=s[b](0,-2)[N](/\s/g,"")[N]("z","!!!!!"),u=[],h=0,p=(s+=o="uuuuu"[b](s[v]%5||5))[v];p>h;h+=5)c=52200625*(s[w](h)-33)+614125*(s[w](h+1)-33)+7225*(s[w](h+2)-33)+85*(s[w](h+3)-33)+(s[w](h+4)-33),u.push(g&c>>24,g&c>>16,g&c>>8,g&c);return function(_,E){for(var j=E;j>0;j--)_.pop()}(u,o[v]),x.fromCharCode.apply(x,u)},a=function(s){var o=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((s=s.replace(/\s/g,"")).indexOf(">")!==-1&&(s=s.substr(0,s.indexOf(">"))),s.length%2&&(s+="0"),o.test(s)===!1)return"";for(var c="",u=0;u<s.length;u+=2)c+=String.fromCharCode("0x"+(s[u]+s[u+1]));return c},n=function(s){for(var o=new Uint8Array(s.length),c=s.length;c--;)o[c]=s.charCodeAt(c);return s=(o=K2(o)).reduce(function(u,h){return u+String.fromCharCode(h)},"")};e.processDataByFilters=function(s,o){var c=0,u=s||"",h=[];for(typeof(o=o||[])=="string"&&(o=[o]),c=0;c<o.length;c+=1)switch(o[c]){case"ASCII85Decode":case"/ASCII85Decode":u=r(u),h.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":u=t(u),h.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":u=a(u),h.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":u=u.split("").map(function(p){return("0"+p.charCodeAt().toString(16)).slice(-2)}).join("")+">",h.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":u=n(u),h.push("/FlateDecode");break;default:throw new Error('The filter: "'+o[c]+'" is not implemented')}return{data:u,reverseChain:h.reverse().join(" ")}}}(dr.API),function(e){e.loadFile=function(t,r,a){return function(n,s,o){s=s!==!1,o=typeof o=="function"?o:function(){};var c=void 0;try{c=function(u,h,p){var x=new XMLHttpRequest,v=0,g=function(w){var b=w.length,N=[],_=String.fromCharCode;for(v=0;v<b;v+=1)N.push(_(255&w.charCodeAt(v)));return N.join("")};if(x.open("GET",u,!h),x.overrideMimeType("text/plain; charset=x-user-defined"),h===!1&&(x.onload=function(){x.status===200?p(g(this.responseText)):p(void 0)}),x.send(null),h&&x.status===200)return g(x.responseText)}(n,s,o)}catch{}return c}(t,r,a)},e.loadImageFile=e.loadFile}(dr.API),function(e){function t(){return(gr.html2canvas?Promise.resolve(gr.html2canvas):W2(()=>import("./html2canvas.esm-CBrSDip1.js"),[])).catch(function(o){return Promise.reject(new Error("Could not load html2canvas: "+o))}).then(function(o){return o.default?o.default:o})}function r(){return(gr.DOMPurify?Promise.resolve(gr.DOMPurify):W2(()=>import("./purify.es-Ci5xwkH_.js"),[])).catch(function(o){return Promise.reject(new Error("Could not load dompurify: "+o))}).then(function(o){return o.default?o.default:o})}var a=function(o){var c=va(o);return c==="undefined"?"undefined":c==="string"||o instanceof String?"string":c==="number"||o instanceof Number?"number":c==="function"||o instanceof Function?"function":o&&o.constructor===Array?"array":o&&o.nodeType===1?"element":c==="object"?"object":"unknown"},n=function(o,c){var u=document.createElement(o);for(var h in c.className&&(u.className=c.className),c.innerHTML&&c.dompurify&&(u.innerHTML=c.dompurify.sanitize(c.innerHTML)),c.style)u.style[h]=c.style[h];return u},s=function o(c){var u=Object.assign(o.convert(Promise.resolve()),JSON.parse(JSON.stringify(o.template))),h=o.convert(Promise.resolve(),u);return h=(h=h.setProgress(1,o,1,[o])).set(c)};(s.prototype=Object.create(Promise.prototype)).constructor=s,s.convert=function(o,c){return o.__proto__=c||s.prototype,o},s.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},s.prototype.from=function(o,c){return this.then(function(){switch(c=c||function(u){switch(a(u)){case"string":return"string";case"element":return u.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(o)){case"string":return this.then(r).then(function(u){return this.set({src:n("div",{innerHTML:o,dompurify:u})})});case"element":return this.set({src:o});case"canvas":return this.set({canvas:o});case"img":return this.set({img:o});default:return this.error("Unknown source type.")}})},s.prototype.to=function(o){switch(o){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},s.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var o={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},c=function u(h,p){for(var x=h.nodeType===3?document.createTextNode(h.nodeValue):h.cloneNode(!1),v=h.firstChild;v;v=v.nextSibling)p!==!0&&v.nodeType===1&&v.nodeName==="SCRIPT"||x.appendChild(u(v,p));return h.nodeType===1&&(h.nodeName==="CANVAS"?(x.width=h.width,x.height=h.height,x.getContext("2d").drawImage(h,0,0)):h.nodeName!=="TEXTAREA"&&h.nodeName!=="SELECT"||(x.value=h.value),x.addEventListener("load",function(){x.scrollTop=h.scrollTop,x.scrollLeft=h.scrollLeft},!0)),x}(this.prop.src,this.opt.html2canvas.javascriptEnabled);c.tagName==="BODY"&&(o.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=n("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=n("div",{className:"html2pdf__container",style:o}),this.prop.container.appendChild(c),this.prop.container.firstChild.appendChild(n("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},s.prototype.toCanvas=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(t).then(function(c){var u=Object.assign({},this.opt.html2canvas);return delete u.onrendered,c(this.prop.container,u)}).then(function(c){(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},s.prototype.toContext2d=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(t).then(function(c){var u=this.opt.jsPDF,h=this.opt.fontFaces,p=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,x=Object.assign({async:!0,allowTaint:!0,scale:p,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete x.onrendered,u.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,u.context2d.posX=this.opt.x,u.context2d.posY=this.opt.y,u.context2d.margin=this.opt.margin,u.context2d.fontFaces=h,h)for(var v=0;v<h.length;++v){var g=h[v],w=g.src.find(function(b){return b.format==="truetype"});w&&u.addFont(w.url,g.ref.name,g.ref.style)}return x.windowHeight=x.windowHeight||0,x.windowHeight=x.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):x.windowHeight,u.context2d.save(!0),c(this.prop.container,x)}).then(function(c){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},s.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var o=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=o})},s.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},s.prototype.output=function(o,c,u){return(u=u||"pdf").toLowerCase()==="img"||u.toLowerCase()==="image"?this.outputImg(o,c):this.outputPdf(o,c)},s.prototype.outputPdf=function(o,c){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(o,c)})},s.prototype.outputImg=function(o){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(o){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+o+'" is not supported.'}})},s.prototype.save=function(o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(o?{filename:o}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},s.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},s.prototype.set=function(o){if(a(o)!=="object")return this;var c=Object.keys(o||{}).map(function(u){if(u in s.template.prop)return function(){this.prop[u]=o[u]};switch(u){case"margin":return this.setMargin.bind(this,o.margin);case"jsPDF":return function(){return this.opt.jsPDF=o.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,o.pageSize);default:return function(){this.opt[u]=o[u]}}},this);return this.then(function(){return this.thenList(c)})},s.prototype.get=function(o,c){return this.then(function(){var u=o in s.template.prop?this.prop[o]:this.opt[o];return c?c(u):u})},s.prototype.setMargin=function(o){return this.then(function(){switch(a(o)){case"number":o=[o,o,o,o];case"array":if(o.length===2&&(o=[o[0],o[1],o[0],o[1]]),o.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=o}).then(this.setPageSize)},s.prototype.setPageSize=function(o){function c(u,h){return Math.floor(u*h/72*96)}return this.then(function(){(o=o||dr.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(o.inner={width:o.width-this.opt.margin[1]-this.opt.margin[3],height:o.height-this.opt.margin[0]-this.opt.margin[2]},o.inner.px={width:c(o.inner.width,o.k),height:c(o.inner.height,o.k)},o.inner.ratio=o.inner.height/o.inner.width),this.prop.pageSize=o})},s.prototype.setProgress=function(o,c,u,h){return o!=null&&(this.progress.val=o),c!=null&&(this.progress.state=c),u!=null&&(this.progress.n=u),h!=null&&(this.progress.stack=h),this.progress.ratio=this.progress.val/this.progress.state,this},s.prototype.updateProgress=function(o,c,u,h){return this.setProgress(o?this.progress.val+o:null,c||null,u?this.progress.n+u:null,h?this.progress.stack.concat(h):null)},s.prototype.then=function(o,c){var u=this;return this.thenCore(o,c,function(h,p){return u.updateProgress(null,null,1,[h]),Promise.prototype.then.call(this,function(x){return u.updateProgress(null,h),x}).then(h,p).then(function(x){return u.updateProgress(1),x})})},s.prototype.thenCore=function(o,c,u){u=u||Promise.prototype.then,o&&(o=o.bind(this)),c&&(c=c.bind(this));var h=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?this:s.convert(Object.assign({},this),Promise.prototype),p=u.call(h,o,c);return s.convert(p,this.__proto__)},s.prototype.thenExternal=function(o,c){return Promise.prototype.then.call(this,o,c)},s.prototype.thenList=function(o){var c=this;return o.forEach(function(u){c=c.thenCore(u)}),c},s.prototype.catch=function(o){o&&(o=o.bind(this));var c=Promise.prototype.catch.call(this,o);return s.convert(c,this)},s.prototype.catchExternal=function(o){return Promise.prototype.catch.call(this,o)},s.prototype.error=function(o){return this.then(function(){throw new Error(o)})},s.prototype.using=s.prototype.set,s.prototype.saveAs=s.prototype.save,s.prototype.export=s.prototype.output,s.prototype.run=s.prototype.then,dr.getPageSize=function(o,c,u){if(va(o)==="object"){var h=o;o=h.orientation,c=h.unit||c,u=h.format||u}c=c||"mm",u=u||"a4",o=(""+(o||"P")).toLowerCase();var p,x=(""+u).toLowerCase(),v={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(c){case"pt":p=1;break;case"mm":p=72/25.4;break;case"cm":p=72/2.54;break;case"in":p=72;break;case"px":p=.75;break;case"pc":case"em":p=12;break;case"ex":p=6;break;default:throw"Invalid unit: "+c}var g,w=0,b=0;if(v.hasOwnProperty(x))w=v[x][1]/p,b=v[x][0]/p;else try{w=u[1],b=u[0]}catch{throw new Error("Invalid format: "+u)}if(o==="p"||o==="portrait")o="p",b>w&&(g=b,b=w,w=g);else{if(o!=="l"&&o!=="landscape")throw"Invalid orientation: "+o;o="l",w>b&&(g=b,b=w,w=g)}return{width:b,height:w,unit:c,k:p,orientation:o}},e.html=function(o,c){(c=c||{}).callback=c.callback||function(){},c.html2canvas=c.html2canvas||{},c.html2canvas.canvas=c.html2canvas.canvas||this.canvas,c.jsPDF=c.jsPDF||this,c.fontFaces=c.fontFaces?c.fontFaces.map(av):null;var u=new s(c);return c.worker?u:u.from(o).doCallback()}}(dr.API),dr.API.addJS=function(e){return r3=e,this.internal.events.subscribe("postPutResources",function(){jm=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(jm+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),t3=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+r3+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){jm!==void 0&&t3!==void 0&&this.internal.out("/Names <</JavaScript "+jm+" 0 R>>")}),this},function(e){var t;e.events.push(["postPutResources",function(){var r=this,a=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var n=r.outline.render().split(/\r\n/),s=0;s<n.length;s++){var o=n[s],c=a.exec(o);if(c!=null){var u=c[1];r.internal.newObjectDeferredBegin(u,!1)}r.internal.write(o)}if(this.outline.createNamedDestinations){var h=this.internal.pages.length,p=[];for(s=0;s<h;s++){var x=r.internal.newObject();p.push(x);var v=r.internal.getPageInfo(s+1);r.internal.write("<< /D["+v.objId+" 0 R /XYZ null null null]>> endobj")}var g=r.internal.newObject();for(r.internal.write("<< /Names [ "),s=0;s<p.length;s++)r.internal.write("(page_"+(s+1)+")"+p[s]+" 0 R");r.internal.write(" ] >>","endobj"),t=r.internal.newObject(),r.internal.write("<< /Dests "+g+" 0 R"),r.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){this.outline.root.children.length>0&&(this.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&this.internal.write("/Names "+t+" 0 R"))}]),e.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(a,n,s){var o={title:n,options:s,children:[]};return a==null&&(a=this.root),a.children.push(o),o},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(a){a.id=r.internal.newObjectDeferred();for(var n=0;n<a.children.length;n++)this.genIds_r(a.children[n])},r.outline.renderRoot=function(a){this.objStart(a),this.line("/Type /Outlines"),a.children.length>0&&(this.line("/First "+this.makeRef(a.children[0])),this.line("/Last "+this.makeRef(a.children[a.children.length-1]))),this.line("/Count "+this.count_r({count:0},a)),this.objEnd()},r.outline.renderItems=function(a){for(var n=this.ctx.pdf.internal.getVerticalCoordinateString,s=0;s<a.children.length;s++){var o=a.children[s];this.objStart(o),this.line("/Title "+this.makeString(o.title)),this.line("/Parent "+this.makeRef(a)),s>0&&this.line("/Prev "+this.makeRef(a.children[s-1])),s<a.children.length-1&&this.line("/Next "+this.makeRef(a.children[s+1])),o.children.length>0&&(this.line("/First "+this.makeRef(o.children[0])),this.line("/Last "+this.makeRef(o.children[o.children.length-1])));var c=this.count=this.count_r({count:0},o);if(c>0&&this.line("/Count "+c),o.options&&o.options.pageNumber){var u=r.internal.getPageInfo(o.options.pageNumber);this.line("/Dest ["+u.objId+" 0 R /XYZ 0 "+n(0)+" 0]")}this.objEnd()}for(var h=0;h<a.children.length;h++)this.renderItems(a.children[h])},r.outline.line=function(a){this.ctx.val+=a+`\r
`},r.outline.makeRef=function(a){return a.id+" 0 R"},r.outline.makeString=function(a){return"("+r.internal.pdfEscape(a)+")"},r.outline.objStart=function(a){this.ctx.val+=`\r
`+a.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(a,n){for(var s=0;s<n.children.length;s++)a.count++,this.count_r(a,n.children[s]);return a.count}}])}(dr.API),function(e){var t=[192,193,194,195,196,197,198,199];e.processJPEG=function(r,a,n,s,o,c){var u,h=this.decode.DCT_DECODE,p=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=o||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,(u=function(x){for(var v,g=256*x.charCodeAt(4)+x.charCodeAt(5),w=x.length,b={width:0,height:0,numcomponents:1},N=4;N<w;N+=2){if(N+=g,t.indexOf(x.charCodeAt(N+1))!==-1){v=256*x.charCodeAt(N+5)+x.charCodeAt(N+6),b={width:256*x.charCodeAt(N+7)+x.charCodeAt(N+8),height:v,numcomponents:x.charCodeAt(N+9)};break}g=256*x.charCodeAt(N+2)+x.charCodeAt(N+3)}return b}(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r)).numcomponents){case 1:c=this.color_spaces.DEVICE_GRAY;break;case 4:c=this.color_spaces.DEVICE_CMYK;break;case 3:c=this.color_spaces.DEVICE_RGB}p={data:r,width:u.width,height:u.height,colorSpace:c,bitsPerComponent:8,filter:h,index:a,alias:n}}return p}}(dr.API);var B0,Cm,a3,n3,s3,UL=function(){var e,t,r;function a(s){var o,c,u,h,p,x,v,g,w,b,N,_,E,j;for(this.data=s,this.pos=8,this.palette=[],this.imgData=[],this.transparency={},this.animation=null,this.text={},x=null;;){switch(o=this.readUInt32(),w=(function(){var M,U;for(U=[],M=0;M<4;++M)U.push(String.fromCharCode(this.data[this.pos++]));return U}).call(this).join("")){case"IHDR":this.width=this.readUInt32(),this.height=this.readUInt32(),this.bits=this.data[this.pos++],this.colorType=this.data[this.pos++],this.compressionMethod=this.data[this.pos++],this.filterMethod=this.data[this.pos++],this.interlaceMethod=this.data[this.pos++];break;case"acTL":this.animation={numFrames:this.readUInt32(),numPlays:this.readUInt32()||1/0,frames:[]};break;case"PLTE":this.palette=this.read(o);break;case"fcTL":x&&this.animation.frames.push(x),this.pos+=4,x={width:this.readUInt32(),height:this.readUInt32(),xOffset:this.readUInt32(),yOffset:this.readUInt32()},p=this.readUInt16(),h=this.readUInt16()||100,x.delay=1e3*p/h,x.disposeOp=this.data[this.pos++],x.blendOp=this.data[this.pos++],x.data=[];break;case"IDAT":case"fdAT":for(w==="fdAT"&&(this.pos+=4,o-=4),s=(x!=null?x.data:void 0)||this.imgData,_=0;0<=o?_<o:_>o;0<=o?++_:--_)s.push(this.data[this.pos++]);break;case"tRNS":switch(this.transparency={},this.colorType){case 3:if(u=this.palette.length/3,this.transparency.indexed=this.read(o),this.transparency.indexed.length>u)throw new Error("More transparent colors than palette size");if((b=u-this.transparency.indexed.length)>0)for(E=0;0<=b?E<b:E>b;0<=b?++E:--E)this.transparency.indexed.push(255);break;case 0:this.transparency.grayscale=this.read(o)[0];break;case 2:this.transparency.rgb=this.read(o)}break;case"tEXt":v=(N=this.read(o)).indexOf(0),g=String.fromCharCode.apply(String,N.slice(0,v)),this.text[g]=String.fromCharCode.apply(String,N.slice(v+1));break;case"IEND":return x&&this.animation.frames.push(x),this.colors=(function(){switch(this.colorType){case 0:case 3:case 4:return 1;case 2:case 6:return 3}}).call(this),this.hasAlphaChannel=(j=this.colorType)===4||j===6,c=this.colors+(this.hasAlphaChannel?1:0),this.pixelBitlength=this.bits*c,this.colorSpace=(function(){switch(this.colors){case 1:return"DeviceGray";case 3:return"DeviceRGB"}}).call(this),void(this.imgData=new Uint8Array(this.imgData));default:this.pos+=o}if(this.pos+=4,this.pos>this.data.length)throw new Error("Incomplete or corrupt PNG file")}}a.prototype.read=function(s){var o,c;for(c=[],o=0;0<=s?o<s:o>s;0<=s?++o:--o)c.push(this.data[this.pos++]);return c},a.prototype.readUInt32=function(){return this.data[this.pos++]<<24|this.data[this.pos++]<<16|this.data[this.pos++]<<8|this.data[this.pos++]},a.prototype.readUInt16=function(){return this.data[this.pos++]<<8|this.data[this.pos++]},a.prototype.decodePixels=function(s){var o=this.pixelBitlength/8,c=new Uint8Array(this.width*this.height*o),u=0,h=this;if(s==null&&(s=this.imgData),s.length===0)return new Uint8Array(0);function p(x,v,g,w){var b,N,_,E,j,M,U,V,I,z,H,re,R,F,Y,K,X,Z,ce,te,Q,G=Math.ceil((h.width-x)/g),ye=Math.ceil((h.height-v)/w),D=h.width==G&&h.height==ye;for(F=o*G,re=D?c:new Uint8Array(F*ye),M=s.length,R=0,N=0;R<ye&&u<M;){switch(s[u++]){case 0:for(E=X=0;X<F;E=X+=1)re[N++]=s[u++];break;case 1:for(E=Z=0;Z<F;E=Z+=1)b=s[u++],j=E<o?0:re[N-o],re[N++]=(b+j)%256;break;case 2:for(E=ce=0;ce<F;E=ce+=1)b=s[u++],_=(E-E%o)/o,Y=R&&re[(R-1)*F+_*o+E%o],re[N++]=(Y+b)%256;break;case 3:for(E=te=0;te<F;E=te+=1)b=s[u++],_=(E-E%o)/o,j=E<o?0:re[N-o],Y=R&&re[(R-1)*F+_*o+E%o],re[N++]=(b+Math.floor((j+Y)/2))%256;break;case 4:for(E=Q=0;Q<F;E=Q+=1)b=s[u++],_=(E-E%o)/o,j=E<o?0:re[N-o],R===0?Y=K=0:(Y=re[(R-1)*F+_*o+E%o],K=_&&re[(R-1)*F+(_-1)*o+E%o]),U=j+Y-K,V=Math.abs(U-j),z=Math.abs(U-Y),H=Math.abs(U-K),I=V<=z&&V<=H?j:z<=H?Y:K,re[N++]=(b+I)%256;break;default:throw new Error("Invalid filter algorithm: "+s[u-1])}if(!D){var O=((v+R*w)*h.width+x)*o,L=R*F;for(E=0;E<G;E+=1){for(var q=0;q<o;q+=1)c[O++]=re[L++];O+=(g-1)*o}}R++}}return s=vL(s),h.interlaceMethod==1?(p(0,0,8,8),p(4,0,8,8),p(0,4,4,8),p(2,0,4,4),p(0,2,2,4),p(1,0,2,2),p(0,1,1,2)):p(0,0,1,1),c},a.prototype.decodePalette=function(){var s,o,c,u,h,p,x,v,g;for(c=this.palette,p=this.transparency.indexed||[],h=new Uint8Array((p.length||0)+c.length),u=0,s=0,o=x=0,v=c.length;x<v;o=x+=3)h[u++]=c[o],h[u++]=c[o+1],h[u++]=c[o+2],h[u++]=(g=p[s++])!=null?g:255;return h},a.prototype.copyToImageData=function(s,o){var c,u,h,p,x,v,g,w,b,N,_;if(u=this.colors,b=null,c=this.hasAlphaChannel,this.palette.length&&(b=(_=this._decodedPalette)!=null?_:this._decodedPalette=this.decodePalette(),u=4,c=!0),w=(h=s.data||s).length,x=b||o,p=v=0,u===1)for(;p<w;)g=b?4*o[p/4]:v,N=x[g++],h[p++]=N,h[p++]=N,h[p++]=N,h[p++]=c?x[g++]:255,v=g;else for(;p<w;)g=b?4*o[p/4]:v,h[p++]=x[g++],h[p++]=x[g++],h[p++]=x[g++],h[p++]=c?x[g++]:255,v=g},a.prototype.decode=function(){var s;return s=new Uint8Array(this.width*this.height*4),this.copyToImageData(s,this.decodePixels()),s};var n=function(){if(Object.prototype.toString.call(gr)==="[object Window]"){try{t=gr.document.createElement("canvas"),r=t.getContext("2d")}catch{return!1}return!0}return!1};return n(),e=function(s){var o;if(n()===!0)return r.width=s.width,r.height=s.height,r.clearRect(0,0,s.width,s.height),r.putImageData(s,0,0),(o=new Image).src=t.toDataURL(),o;throw new Error("This method requires a Browser with Canvas-capability.")},a.prototype.decodeFrames=function(s){var o,c,u,h,p,x,v,g;if(this.animation){for(g=[],c=p=0,x=(v=this.animation.frames).length;p<x;c=++p)o=v[c],u=s.createImageData(o.width,o.height),h=this.decodePixels(new Uint8Array(o.data)),this.copyToImageData(u,h),o.imageData=u,g.push(o.image=e(u));return g}},a.prototype.renderFrame=function(s,o){var c,u,h;return c=(u=this.animation.frames)[o],h=u[o-1],o===0&&s.clearRect(0,0,this.width,this.height),(h!=null?h.disposeOp:void 0)===1?s.clearRect(h.xOffset,h.yOffset,h.width,h.height):(h!=null?h.disposeOp:void 0)===2&&s.putImageData(h.imageData,h.xOffset,h.yOffset),c.blendOp===0&&s.clearRect(c.xOffset,c.yOffset,c.width,c.height),s.drawImage(c.image,c.xOffset,c.yOffset)},a.prototype.animate=function(s){var o,c,u,h,p,x,v=this;return c=0,x=this.animation,h=x.numFrames,u=x.frames,p=x.numPlays,(o=function(){var g,w;if(g=c++%h,w=u[g],v.renderFrame(s,g),h>1&&c/h<p)return v.animation._timeout=setTimeout(o,w.delay)})()},a.prototype.stopAnimation=function(){var s;return clearTimeout((s=this.animation)!=null?s._timeout:void 0)},a.prototype.render=function(s){var o,c;return s._png&&s._png.stopAnimation(),s._png=this,s.width=this.width,s.height=this.height,o=s.getContext("2d"),this.animation?(this.decodeFrames(o),this.animate(o)):(c=o.createImageData(this.width,this.height),this.copyToImageData(c,this.decodePixels()),o.putImageData(c,0,0))},a}();/**
 * @license
 *
 * Copyright (c) 2014 James Robb, https://github.com/jamesbrobb
 *
 * Permission is hereby granted, free of charge, to any person obtaining
 * a copy of this software and associated documentation files (the
 * "Software"), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish,
 * distribute, sublicense, and/or sell copies of the Software, and to
 * permit persons to whom the Software is furnished to do so, subject to
 * the following conditions:
 *
 * The above copyright notice and this permission notice shall be
 * included in all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 * EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
 * MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 * NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
 * LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
 * OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
 * WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
 * ====================================================================
 *//**
 * @license
 * (c) Dean McNamee <dean@gmail.com>, 2013.
 *
 * https://github.com/deanm/omggif
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 *
 * omggif is a JavaScript implementation of a GIF 89a encoder and decoder,
 * including animation and compression.  It does not rely on any specific
 * underlying system, so should run in the browser, Node, or Plask.
 */function zL(e){var t=0;if(e[t++]!==71||e[t++]!==73||e[t++]!==70||e[t++]!==56||(e[t++]+1&253)!=56||e[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=e[t++]|e[t++]<<8,a=e[t++]|e[t++]<<8,n=e[t++],s=n>>7,o=1<<(7&n)+1;e[t++],e[t++];var c=null,u=null;s&&(c=t,u=o,t+=3*o);var h=!0,p=[],x=0,v=null,g=0,w=null;for(this.width=r,this.height=a;h&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(e[t]!==11||e[t+1]==78&&e[t+2]==69&&e[t+3]==84&&e[t+4]==83&&e[t+5]==67&&e[t+6]==65&&e[t+7]==80&&e[t+8]==69&&e[t+9]==50&&e[t+10]==46&&e[t+11]==48&&e[t+12]==3&&e[t+13]==1&&e[t+16]==0)t+=14,w=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((R=e[t++])>=0))throw Error("Invalid block size");if(R===0)break;t+=R}break;case 249:if(e[t++]!==4||e[t+4]!==0)throw new Error("Invalid graphics extension block.");var b=e[t++];x=e[t++]|e[t++]<<8,v=e[t++],(1&b)==0&&(v=null),g=b>>2&7,t++;break;case 254:for(;;){if(!((R=e[t++])>=0))throw Error("Invalid block size");if(R===0)break;t+=R}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var N=e[t++]|e[t++]<<8,_=e[t++]|e[t++]<<8,E=e[t++]|e[t++]<<8,j=e[t++]|e[t++]<<8,M=e[t++],U=M>>6&1,V=1<<(7&M)+1,I=c,z=u,H=!1;M>>7&&(H=!0,I=t,z=V,t+=3*V);var re=t;for(t++;;){var R;if(!((R=e[t++])>=0))throw Error("Invalid block size");if(R===0)break;t+=R}p.push({x:N,y:_,width:E,height:j,has_local_palette:H,palette_offset:I,palette_size:z,data_offset:re,data_length:t-re,transparent_index:v,interlaced:!!U,delay:x,disposal:g});break;case 59:h=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return p.length},this.loopCount=function(){return w},this.frameInfo=function(F){if(F<0||F>=p.length)throw new Error("Frame index out of range.");return p[F]},this.decodeAndBlitFrameBGRA=function(F,Y){var K=this.frameInfo(F),X=K.width*K.height,Z=new Uint8Array(X);i3(e,K.data_offset,Z,X);var ce=K.palette_offset,te=K.transparent_index;te===null&&(te=256);var Q=K.width,G=r-Q,ye=Q,D=4*(K.y*r+K.x),O=4*((K.y+K.height)*r+K.x),L=D,q=4*G;K.interlaced===!0&&(q+=4*r*7);for(var oe=8,be=0,ve=Z.length;be<ve;++be){var ue=Z[be];if(ye===0&&(ye=Q,(L+=q)>=O&&(q=4*G+4*r*(oe-1),L=D+(Q+G)*(oe<<1),oe>>=1)),ue===te)L+=4;else{var fe=e[ce+3*ue],Ee=e[ce+3*ue+1],J=e[ce+3*ue+2];Y[L++]=J,Y[L++]=Ee,Y[L++]=fe,Y[L++]=255}--ye}},this.decodeAndBlitFrameRGBA=function(F,Y){var K=this.frameInfo(F),X=K.width*K.height,Z=new Uint8Array(X);i3(e,K.data_offset,Z,X);var ce=K.palette_offset,te=K.transparent_index;te===null&&(te=256);var Q=K.width,G=r-Q,ye=Q,D=4*(K.y*r+K.x),O=4*((K.y+K.height)*r+K.x),L=D,q=4*G;K.interlaced===!0&&(q+=4*r*7);for(var oe=8,be=0,ve=Z.length;be<ve;++be){var ue=Z[be];if(ye===0&&(ye=Q,(L+=q)>=O&&(q=4*G+4*r*(oe-1),L=D+(Q+G)*(oe<<1),oe>>=1)),ue===te)L+=4;else{var fe=e[ce+3*ue],Ee=e[ce+3*ue+1],J=e[ce+3*ue+2];Y[L++]=fe,Y[L++]=Ee,Y[L++]=J,Y[L++]=255}--ye}}}function i3(e,t,r,a){for(var n=e[t++],s=1<<n,o=s+1,c=o+1,u=n+1,h=(1<<u)-1,p=0,x=0,v=0,g=e[t++],w=new Int32Array(4096),b=null;;){for(;p<16&&g!==0;)x|=e[t++]<<p,p+=8,g===1?g=e[t++]:--g;if(p<u)break;var N=x&h;if(x>>=u,p-=u,N!==s){if(N===o)break;for(var _=N<c?N:b,E=0,j=_;j>s;)j=w[j]>>8,++E;var M=j;if(v+E+(_!==N?1:0)>a)return void Ta.log("Warning, gif stream longer than expected.");r[v++]=M;var U=v+=E;for(_!==N&&(r[v++]=M),j=_;E--;)j=w[j],r[--U]=255&j,j>>=8;b!==null&&c<4096&&(w[c++]=b<<8|M,c>=h+1&&u<12&&(++u,h=h<<1|1)),b=N}else c=o+1,h=(1<<(u=n+1))-1,b=null}return v!==a&&Ta.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function Zg(e){var t,r,a,n,s,o=Math.floor,c=new Array(64),u=new Array(64),h=new Array(64),p=new Array(64),x=new Array(65535),v=new Array(65535),g=new Array(64),w=new Array(64),b=[],N=0,_=7,E=new Array(64),j=new Array(64),M=new Array(64),U=new Array(256),V=new Array(2048),I=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],z=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],H=[0,1,2,3,4,5,6,7,8,9,10,11],re=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],R=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],F=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],Y=[0,1,2,3,4,5,6,7,8,9,10,11],K=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],X=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function Z(D,O){for(var L=0,q=0,oe=new Array,be=1;be<=16;be++){for(var ve=1;ve<=D[be];ve++)oe[O[q]]=[],oe[O[q]][0]=L,oe[O[q]][1]=be,q++,L++;L*=2}return oe}function ce(D){for(var O=D[0],L=D[1]-1;L>=0;)O&1<<L&&(N|=1<<_),L--,--_<0&&(N==255?(te(255),te(0)):te(N),_=7,N=0)}function te(D){b.push(D)}function Q(D){te(D>>8&255),te(255&D)}function G(D,O,L,q,oe){for(var be,ve=oe[0],ue=oe[240],fe=function(Xe,ot){var ut,vt,At,ct,ze,pt,Ot,It,Lt,Ct,wt=0;for(Lt=0;Lt<8;++Lt){ut=Xe[wt],vt=Xe[wt+1],At=Xe[wt+2],ct=Xe[wt+3],ze=Xe[wt+4],pt=Xe[wt+5],Ot=Xe[wt+6];var hr=ut+(It=Xe[wt+7]),zt=ut-It,Yt=vt+Ot,Sr=vt-Ot,Mr=At+pt,fa=At-pt,Ir=ct+ze,gi=ct-ze,na=hr+Ir,Ja=hr-Ir,Dn=Yt+Mr,Br=Yt-Mr;Xe[wt]=na+Dn,Xe[wt+4]=na-Dn;var sr=.707106781*(Br+Ja);Xe[wt+2]=Ja+sr,Xe[wt+6]=Ja-sr;var kr=.382683433*((na=gi+fa)-(Br=Sr+zt)),As=.5411961*na+kr,ka=1.306562965*Br+kr,Ea=.707106781*(Dn=fa+Sr),gn=zt+Ea,Qt=zt-Ea;Xe[wt+5]=Qt+As,Xe[wt+3]=Qt-As,Xe[wt+1]=gn+ka,Xe[wt+7]=gn-ka,wt+=8}for(wt=0,Lt=0;Lt<8;++Lt){ut=Xe[wt],vt=Xe[wt+8],At=Xe[wt+16],ct=Xe[wt+24],ze=Xe[wt+32],pt=Xe[wt+40],Ot=Xe[wt+48];var Un=ut+(It=Xe[wt+56]),Vr=ut-It,qa=vt+Ot,qr=vt-Ot,ha=At+pt,ne=At-pt,Ne=ct+ze,pe=ct-ze,ge=Un+Ne,Se=Un-Ne,_e=qa+ha,Ye=qa-ha;Xe[wt]=ge+_e,Xe[wt+32]=ge-_e;var lt=.707106781*(Ye+Se);Xe[wt+16]=Se+lt,Xe[wt+48]=Se-lt;var We=.382683433*((ge=pe+ne)-(Ye=qr+Vr)),$e=.5411961*ge+We,Qe=1.306562965*Ye+We,St=.707106781*(_e=ne+qr),jt=Vr+St,Ut=Vr-St;Xe[wt+40]=Ut+$e,Xe[wt+24]=Ut-$e,Xe[wt+8]=jt+Qe,Xe[wt+56]=jt-Qe,wt++}for(Lt=0;Lt<64;++Lt)Ct=Xe[Lt]*ot[Lt],g[Lt]=Ct>0?Ct+.5|0:Ct-.5|0;return g}(D,O),Ee=0;Ee<64;++Ee)w[I[Ee]]=fe[Ee];var J=w[0]-L;L=w[0],J==0?ce(q[0]):(ce(q[v[be=32767+J]]),ce(x[be]));for(var Pe=63;Pe>0&&w[Pe]==0;)Pe--;if(Pe==0)return ce(ve),L;for(var st,ke=1;ke<=Pe;){for(var de=ke;w[ke]==0&&ke<=Pe;)++ke;var rt=ke-de;if(rt>=16){st=rt>>4;for(var Ue=1;Ue<=st;++Ue)ce(ue);rt&=15}be=32767+w[ke],ce(oe[(rt<<4)+v[be]]),ce(x[be]),ke++}return Pe!=63&&ce(ve),L}function ye(D){D=Math.min(Math.max(D,1),100),s!=D&&(function(O){for(var L=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],q=0;q<64;q++){var oe=o((L[q]*O+50)/100);oe=Math.min(Math.max(oe,1),255),c[I[q]]=oe}for(var be=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],ve=0;ve<64;ve++){var ue=o((be[ve]*O+50)/100);ue=Math.min(Math.max(ue,1),255),u[I[ve]]=ue}for(var fe=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Ee=0,J=0;J<8;J++)for(var Pe=0;Pe<8;Pe++)h[Ee]=1/(c[I[Ee]]*fe[J]*fe[Pe]*8),p[Ee]=1/(u[I[Ee]]*fe[J]*fe[Pe]*8),Ee++}(D<50?Math.floor(5e3/D):Math.floor(200-2*D)),s=D)}this.encode=function(D,O){O&&ye(O),b=new Array,N=0,_=7,Q(65496),Q(65504),Q(16),te(74),te(70),te(73),te(70),te(0),te(1),te(1),te(0),Q(1),Q(1),te(0),te(0),function(){Q(65499),Q(132),te(0);for(var vt=0;vt<64;vt++)te(c[vt]);te(1);for(var At=0;At<64;At++)te(u[At])}(),function(vt,At){Q(65472),Q(17),te(8),Q(At),Q(vt),te(3),te(1),te(17),te(0),te(2),te(17),te(1),te(3),te(17),te(1)}(D.width,D.height),function(){Q(65476),Q(418),te(0);for(var vt=0;vt<16;vt++)te(z[vt+1]);for(var At=0;At<=11;At++)te(H[At]);te(16);for(var ct=0;ct<16;ct++)te(re[ct+1]);for(var ze=0;ze<=161;ze++)te(R[ze]);te(1);for(var pt=0;pt<16;pt++)te(F[pt+1]);for(var Ot=0;Ot<=11;Ot++)te(Y[Ot]);te(17);for(var It=0;It<16;It++)te(K[It+1]);for(var Lt=0;Lt<=161;Lt++)te(X[Lt])}(),Q(65498),Q(12),te(3),te(1),te(0),te(2),te(17),te(3),te(17),te(0),te(63),te(0);var L=0,q=0,oe=0;N=0,_=7,this.encode.displayName="_encode_";for(var be,ve,ue,fe,Ee,J,Pe,st,ke,de=D.data,rt=D.width,Ue=D.height,Xe=4*rt,ot=0;ot<Ue;){for(be=0;be<Xe;){for(Ee=Xe*ot+be,Pe=-1,st=0,ke=0;ke<64;ke++)J=Ee+(st=ke>>3)*Xe+(Pe=4*(7&ke)),ot+st>=Ue&&(J-=Xe*(ot+1+st-Ue)),be+Pe>=Xe&&(J-=be+Pe-Xe+4),ve=de[J++],ue=de[J++],fe=de[J++],E[ke]=(V[ve]+V[ue+256>>0]+V[fe+512>>0]>>16)-128,j[ke]=(V[ve+768>>0]+V[ue+1024>>0]+V[fe+1280>>0]>>16)-128,M[ke]=(V[ve+1280>>0]+V[ue+1536>>0]+V[fe+1792>>0]>>16)-128;L=G(E,h,L,t,a),q=G(j,p,q,r,n),oe=G(M,p,oe,r,n),be+=32}ot+=8}if(_>=0){var ut=[];ut[1]=_+1,ut[0]=(1<<_+1)-1,ce(ut)}return Q(65497),new Uint8Array(b)},e=e||50,function(){for(var D=String.fromCharCode,O=0;O<256;O++)U[O]=D(O)}(),t=Z(z,H),r=Z(F,Y),a=Z(re,R),n=Z(K,X),function(){for(var D=1,O=2,L=1;L<=15;L++){for(var q=D;q<O;q++)v[32767+q]=L,x[32767+q]=[],x[32767+q][1]=L,x[32767+q][0]=q;for(var oe=-(O-1);oe<=-D;oe++)v[32767+oe]=L,x[32767+oe]=[],x[32767+oe][1]=L,x[32767+oe][0]=O-1+oe;D<<=1,O<<=1}}(),function(){for(var D=0;D<256;D++)V[D]=19595*D,V[D+256>>0]=38470*D,V[D+512>>0]=7471*D+32768,V[D+768>>0]=-11059*D,V[D+1024>>0]=-21709*D,V[D+1280>>0]=32768*D+8421375,V[D+1536>>0]=-27439*D,V[D+1792>>0]=-5329*D}(),ye(e)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function el(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function o3(e){function t(z){if(!z)throw Error("assert :P")}function r(z,H,re){for(var R=0;4>R;R++)if(z[H+R]!=re.charCodeAt(R))return!0;return!1}function a(z,H,re,R,F){for(var Y=0;Y<F;Y++)z[H+Y]=re[R+Y]}function n(z,H,re,R){for(var F=0;F<R;F++)z[H+F]=re}function s(z){return new Int32Array(z)}function o(z,H){for(var re=[],R=0;R<z;R++)re.push(new H);return re}function c(z,H){var re=[];return function R(F,Y,K){for(var X=K[Y],Z=0;Z<X&&(F.push(K.length>Y+1?[]:new H),!(K.length<Y+1));Z++)R(F[Z],Y+1,K)}(re,0,z),re}var u=function(){var z=this;function H(y,A){for(var C=1<<A-1>>>0;y&C;)C>>>=1;return C?(y&C-1)+C:y}function re(y,A,C,B,ee){t(!(B%C));do y[A+(B-=C)]=ee;while(0<B)}function R(y,A,C,B,ee){if(t(2328>=ee),512>=ee)var se=s(512);else if((se=s(ee))==null)return 0;return function(le,he,xe,we,Le,Je){var Ze,Ie,at=he,Ke=1<<xe,De=s(16),Re=s(16);for(t(Le!=0),t(we!=null),t(le!=null),t(0<xe),Ie=0;Ie<Le;++Ie){if(15<we[Ie])return 0;++De[we[Ie]]}if(De[0]==Le)return 0;for(Re[1]=0,Ze=1;15>Ze;++Ze){if(De[Ze]>1<<Ze)return 0;Re[Ze+1]=Re[Ze]+De[Ze]}for(Ie=0;Ie<Le;++Ie)Ze=we[Ie],0<we[Ie]&&(Je[Re[Ze]++]=Ie);if(Re[15]==1)return(we=new F).g=0,we.value=Je[0],re(le,at,1,Ke,we),Ke;var mt,yt=-1,gt=Ke-1,Vt=0,Rt=1,fr=1,Et=1<<xe;for(Ie=0,Ze=1,Le=2;Ze<=xe;++Ze,Le<<=1){if(Rt+=fr<<=1,0>(fr-=De[Ze]))return 0;for(;0<De[Ze];--De[Ze])(we=new F).g=Ze,we.value=Je[Ie++],re(le,at+Vt,Le,Et,we),Vt=H(Vt,Ze)}for(Ze=xe+1,Le=2;15>=Ze;++Ze,Le<<=1){if(Rt+=fr<<=1,0>(fr-=De[Ze]))return 0;for(;0<De[Ze];--De[Ze]){if(we=new F,(Vt&gt)!=yt){for(at+=Et,mt=1<<(yt=Ze)-xe;15>yt&&!(0>=(mt-=De[yt]));)++yt,mt<<=1;Ke+=Et=1<<(mt=yt-xe),le[he+(yt=Vt&gt)].g=mt+xe,le[he+yt].value=at-he-yt}we.g=Ze-xe,we.value=Je[Ie++],re(le,at+(Vt>>xe),Le,Et,we),Vt=H(Vt,Ze)}}return Rt!=2*Re[15]-1?0:Ke}(y,A,C,B,ee,se)}function F(){this.value=this.g=0}function Y(){this.value=this.g=0}function K(){this.G=o(5,F),this.H=s(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=o(wn,Y)}function X(y,A,C,B){t(y!=null),t(A!=null),t(2147483648>B),y.Ca=254,y.I=0,y.b=-8,y.Ka=0,y.oa=A,y.pa=C,y.Jd=A,y.Yc=C+B,y.Zc=4<=B?C+B-4+1:C,be(y)}function Z(y,A){for(var C=0;0<A--;)C|=ue(y,128)<<A;return C}function ce(y,A){var C=Z(y,A);return ve(y)?-C:C}function te(y,A,C,B){var ee,se=0;for(t(y!=null),t(A!=null),t(4294967288>B),y.Sb=B,y.Ra=0,y.u=0,y.h=0,4<B&&(B=4),ee=0;ee<B;++ee)se+=A[C+ee]<<8*ee;y.Ra=se,y.bb=B,y.oa=A,y.pa=C}function Q(y){for(;8<=y.u&&y.bb<y.Sb;)y.Ra>>>=8,y.Ra+=y.oa[y.pa+y.bb]<<sc-8>>>0,++y.bb,y.u-=8;L(y)&&(y.h=1,y.u=0)}function G(y,A){if(t(0<=A),!y.h&&A<=nc){var C=O(y)&Sl[A];return y.u+=A,Q(y),C}return y.h=1,y.u=0}function ye(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function D(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function O(y){return y.Ra>>>(y.u&sc-1)>>>0}function L(y){return t(y.bb<=y.Sb),y.h||y.bb==y.Sb&&y.u>sc}function q(y,A){y.u=A,y.h=L(y)}function oe(y){y.u>=Kc&&(t(y.u>=Kc),Q(y))}function be(y){t(y!=null&&y.oa!=null),y.pa<y.Zc?(y.I=(y.oa[y.pa++]|y.I<<8)>>>0,y.b+=8):(t(y!=null&&y.oa!=null),y.pa<y.Yc?(y.b+=8,y.I=y.oa[y.pa++]|y.I<<8):y.Ka?y.b=0:(y.I<<=8,y.b+=8,y.Ka=1))}function ve(y){return Z(y,1)}function ue(y,A){var C=y.Ca;0>y.b&&be(y);var B=y.b,ee=C*A>>>8,se=(y.I>>>B>ee)+0;for(se?(C-=ee,y.I-=ee+1<<B>>>0):C=ee+1,B=C,ee=0;256<=B;)ee+=8,B>>=8;return B=7^ee+Fs[B],y.b-=B,y.Ca=(C<<B)-1,se}function fe(y,A,C){y[A+0]=C>>24&255,y[A+1]=C>>16&255,y[A+2]=C>>8&255,y[A+3]=C>>0&255}function Ee(y,A){return y[A+0]<<0|y[A+1]<<8}function J(y,A){return Ee(y,A)|y[A+2]<<16}function Pe(y,A){return Ee(y,A)|Ee(y,A+2)<<16}function st(y,A){var C=1<<A;return t(y!=null),t(0<A),y.X=s(C),y.X==null?0:(y.Mb=32-A,y.Xa=A,1)}function ke(y,A){t(y!=null),t(A!=null),t(y.Xa==A.Xa),a(A.X,0,y.X,0,1<<A.Xa)}function de(){this.X=[],this.Xa=this.Mb=0}function rt(y,A,C,B){t(C!=null),t(B!=null);var ee=C[0],se=B[0];return ee==0&&(ee=(y*se+A/2)/A),se==0&&(se=(A*ee+y/2)/y),0>=ee||0>=se?0:(C[0]=ee,B[0]=se,1)}function Ue(y,A){return y+(1<<A)-1>>>A}function Xe(y,A){return((4278255360&y)+(4278255360&A)>>>0&4278255360)+((16711935&y)+(16711935&A)>>>0&16711935)>>>0}function ot(y,A){z[A]=function(C,B,ee,se,le,he,xe){var we;for(we=0;we<le;++we){var Le=z[y](he[xe+we-1],ee,se+we);he[xe+we]=Xe(C[B+we],Le)}}}function ut(){this.ud=this.hd=this.jd=0}function vt(y,A){return((4278124286&(y^A))>>>1)+(y&A)>>>0}function At(y){return 0<=y&&256>y?y:0>y?0:255<y?255:void 0}function ct(y,A){return At(y+(y-A+.5>>1))}function ze(y,A,C){return Math.abs(A-C)-Math.abs(y-C)}function pt(y,A,C,B,ee,se,le){for(B=se[le-1],C=0;C<ee;++C)se[le+C]=B=Xe(y[A+C],B)}function Ot(y,A,C,B,ee){var se;for(se=0;se<C;++se){var le=y[A+se],he=le>>8&255,xe=16711935&(xe=(xe=16711935&le)+((he<<16)+he));B[ee+se]=(4278255360&le)+xe>>>0}}function It(y,A){A.jd=y>>0&255,A.hd=y>>8&255,A.ud=y>>16&255}function Lt(y,A,C,B,ee,se){var le;for(le=0;le<B;++le){var he=A[C+le],xe=he>>>8,we=he,Le=255&(Le=(Le=he>>>16)+((y.jd<<24>>24)*(xe<<24>>24)>>>5));we=255&(we=(we=we+((y.hd<<24>>24)*(xe<<24>>24)>>>5))+((y.ud<<24>>24)*(Le<<24>>24)>>>5)),ee[se+le]=(4278255360&he)+(Le<<16)+we}}function Ct(y,A,C,B,ee){z[A]=function(se,le,he,xe,we,Le,Je,Ze,Ie){for(xe=Je;xe<Ze;++xe)for(Je=0;Je<Ie;++Je)we[Le++]=ee(he[B(se[le++])])},z[y]=function(se,le,he,xe,we,Le,Je){var Ze=8>>se.b,Ie=se.Ea,at=se.K[0],Ke=se.w;if(8>Ze)for(se=(1<<se.b)-1,Ke=(1<<Ze)-1;le<he;++le){var De,Re=0;for(De=0;De<Ie;++De)De&se||(Re=B(xe[we++])),Le[Je++]=ee(at[Re&Ke]),Re>>=Ze}else z["VP8LMapColor"+C](xe,we,at,Ke,Le,Je,le,he,Ie)}}function wt(y,A,C,B,ee){for(C=A+C;A<C;){var se=y[A++];B[ee++]=se>>16&255,B[ee++]=se>>8&255,B[ee++]=se>>0&255}}function hr(y,A,C,B,ee){for(C=A+C;A<C;){var se=y[A++];B[ee++]=se>>16&255,B[ee++]=se>>8&255,B[ee++]=se>>0&255,B[ee++]=se>>24&255}}function zt(y,A,C,B,ee){for(C=A+C;A<C;){var se=(le=y[A++])>>16&240|le>>12&15,le=le>>0&240|le>>28&15;B[ee++]=se,B[ee++]=le}}function Yt(y,A,C,B,ee){for(C=A+C;A<C;){var se=(le=y[A++])>>16&248|le>>13&7,le=le>>5&224|le>>3&31;B[ee++]=se,B[ee++]=le}}function Sr(y,A,C,B,ee){for(C=A+C;A<C;){var se=y[A++];B[ee++]=se>>0&255,B[ee++]=se>>8&255,B[ee++]=se>>16&255}}function Mr(y,A,C,B,ee,se){if(se==0)for(C=A+C;A<C;)fe(B,((se=y[A++])[0]>>24|se[1]>>8&65280|se[2]<<8&16711680|se[3]<<24)>>>0),ee+=32;else a(B,ee,y,A,C)}function fa(y,A){z[A][0]=z[y+"0"],z[A][1]=z[y+"1"],z[A][2]=z[y+"2"],z[A][3]=z[y+"3"],z[A][4]=z[y+"4"],z[A][5]=z[y+"5"],z[A][6]=z[y+"6"],z[A][7]=z[y+"7"],z[A][8]=z[y+"8"],z[A][9]=z[y+"9"],z[A][10]=z[y+"10"],z[A][11]=z[y+"11"],z[A][12]=z[y+"12"],z[A][13]=z[y+"13"],z[A][14]=z[y+"0"],z[A][15]=z[y+"0"]}function Ir(y){return y==Mi||y==Ii||y==co||y==l0}function gi(){this.eb=[],this.size=this.A=this.fb=0}function na(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Ja(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new gi,this.f.kb=new na,this.sd=null}function Dn(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Br(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function sr(y){return alert("todo:WebPSamplerProcessPlane"),y.T}function kr(y,A){var C=y.T,B=A.ba.f.RGBA,ee=B.eb,se=B.fb+y.ka*B.A,le=ms[A.ba.S],he=y.y,xe=y.O,we=y.f,Le=y.N,Je=y.ea,Ze=y.W,Ie=A.cc,at=A.dc,Ke=A.Mc,De=A.Nc,Re=y.ka,mt=y.ka+y.T,yt=y.U,gt=yt+1>>1;for(Re==0?le(he,xe,null,null,we,Le,Je,Ze,we,Le,Je,Ze,ee,se,null,null,yt):(le(A.ec,A.fc,he,xe,Ie,at,Ke,De,we,Le,Je,Ze,ee,se-B.A,ee,se,yt),++C);Re+2<mt;Re+=2)Ie=we,at=Le,Ke=Je,De=Ze,Le+=y.Rc,Ze+=y.Rc,se+=2*B.A,le(he,(xe+=2*y.fa)-y.fa,he,xe,Ie,at,Ke,De,we,Le,Je,Ze,ee,se-B.A,ee,se,yt);return xe+=y.fa,y.j+mt<y.o?(a(A.ec,A.fc,he,xe,yt),a(A.cc,A.dc,we,Le,gt),a(A.Mc,A.Nc,Je,Ze,gt),C--):1&mt||le(he,xe,null,null,we,Le,Je,Ze,we,Le,Je,Ze,ee,se+B.A,null,null,yt),C}function As(y,A,C){var B=y.F,ee=[y.J];if(B!=null){var se=y.U,le=A.ba.S,he=le==ps||le==co;A=A.ba.f.RGBA;var xe=[0],we=y.ka;xe[0]=y.T,y.Kb&&(we==0?--xe[0]:(--we,ee[0]-=y.width),y.j+y.ka+y.T==y.o&&(xe[0]=y.o-y.j-we));var Le=A.eb;we=A.fb+we*A.A,y=ea(B,ee[0],y.width,se,xe,Le,we+(he?0:3),A.A),t(C==xe),y&&Ir(le)&&Wa(Le,we,he,se,xe,A.A)}return 0}function ka(y){var A=y.ma,C=A.ba.S,B=11>C,ee=C==Ho||C==cc||C==ps||C==Os||C==12||Ir(C);if(A.memory=null,A.Ib=null,A.Jb=null,A.Nd=null,!bl(A.Oa,y,ee?11:12))return 0;if(ee&&Ir(C)&&_t(),y.da)alert("todo:use_scaling");else{if(B){if(A.Ib=sr,y.Kb){if(C=y.U+1>>1,A.memory=s(y.U+2*C),A.memory==null)return 0;A.ec=A.memory,A.fc=0,A.cc=A.ec,A.dc=A.fc+y.U,A.Mc=A.cc,A.Nc=A.dc+C,A.Ib=kr,_t()}}else alert("todo:EmitYUV");ee&&(A.Jb=As,B&&qe())}if(B&&!zi){for(y=0;256>y;++y)Fl[y]=89858*(y-128)+sf>>fc,qo[y]=-22014*(y-128)+sf,Pl[y]=-45773*(y-128),Dp[y]=113618*(y-128)+sf>>fc;for(y=hc;y<of;++y)A=76283*(y-16)+sf>>fc,bn[y-hc]=ii(A,255),f0[y-hc]=ii(A+8>>4,15);zi=1}return 1}function Ea(y){var A=y.ma,C=y.U,B=y.T;return t(!(1&y.ka)),0>=C||0>=B?0:(C=A.Ib(y,A),A.Jb!=null&&A.Jb(y,A,C),A.Dc+=C,1)}function gn(y){y.ma.memory=null}function Qt(y,A,C,B){return G(y,8)!=47?0:(A[0]=G(y,14)+1,C[0]=G(y,14)+1,B[0]=G(y,1),G(y,3)!=0?0:!y.h)}function Un(y,A){if(4>y)return y+1;var C=y-2>>1;return(2+(1&y)<<C)+G(A,C)+1}function Vr(y,A){return 120<A?A-120:1<=(C=((C=Bi[A-1])>>4)*y+(8-(15&C)))?C:1;var C}function qa(y,A,C){var B=O(C),ee=y[A+=255&B].g-8;return 0<ee&&(q(C,C.u+8),B=O(C),A+=y[A].value,A+=B&(1<<ee)-1),q(C,C.u+y[A].g),y[A].value}function qr(y,A,C){return C.g+=y.g,C.value+=y.value<<A>>>0,t(8>=C.g),y.g}function ha(y,A,C){var B=y.xc;return t((A=B==0?0:y.vc[y.md*(C>>B)+(A>>B)])<y.Wb),y.Ya[A]}function ne(y,A,C,B){var ee=y.ab,se=y.c*A,le=y.C;A=le+A;var he=C,xe=B;for(B=y.Ta,C=y.Ua;0<ee--;){var we=y.gc[ee],Le=le,Je=A,Ze=he,Ie=xe,at=(xe=B,he=C,we.Ea);switch(t(Le<Je),t(Je<=we.nc),we.hc){case 2:o0(Ze,Ie,(Je-Le)*at,xe,he);break;case 0:var Ke=Le,De=Je,Re=xe,mt=he,yt=(Et=we).Ea;Ke==0&&(Ah(Ze,Ie,null,null,1,Re,mt),pt(Ze,Ie+1,0,0,yt-1,Re,mt+1),Ie+=yt,mt+=yt,++Ke);for(var gt=1<<Et.b,Vt=gt-1,Rt=Ue(yt,Et.b),fr=Et.K,Et=Et.w+(Ke>>Et.b)*Rt;Ke<De;){var Yr=fr,ta=Et,$r=1;for(Ju(Ze,Ie,Re,mt-yt,1,Re,mt);$r<yt;){var Or=($r&~Vt)+gt;Or>yt&&(Or=yt),(0,Ro[Yr[ta++]>>8&15])(Ze,Ie+ +$r,Re,mt+$r-yt,Or-$r,Re,mt+$r),$r=Or}Ie+=yt,mt+=yt,++Ke&Vt||(Et+=Rt)}Je!=we.nc&&a(xe,he-at,xe,he+(Je-Le-1)*at,at);break;case 1:for(at=Ze,De=Ie,yt=(Ze=we.Ea)-(mt=Ze&~(Re=(Ie=1<<we.b)-1)),Ke=Ue(Ze,we.b),gt=we.K,we=we.w+(Le>>we.b)*Ke;Le<Je;){for(Vt=gt,Rt=we,fr=new ut,Et=De+mt,Yr=De+Ze;De<Et;)It(Vt[Rt++],fr),Al(fr,at,De,Ie,xe,he),De+=Ie,he+=Ie;De<Yr&&(It(Vt[Rt++],fr),Al(fr,at,De,yt,xe,he),De+=yt,he+=yt),++Le&Re||(we+=Ke)}break;case 3:if(Ze==xe&&Ie==he&&0<we.b){for(De=xe,Ze=at=he+(Je-Le)*at-(mt=(Je-Le)*Ue(we.Ea,we.b)),Ie=xe,Re=he,Ke=[],mt=(yt=mt)-1;0<=mt;--mt)Ke[mt]=Ie[Re+mt];for(mt=yt-1;0<=mt;--mt)De[Ze+mt]=Ke[mt];bi(we,Le,Je,xe,at,xe,he)}else bi(we,Le,Je,Ze,Ie,xe,he)}he=B,xe=C}xe!=C&&a(B,C,he,xe,se)}function Ne(y,A){var C=y.V,B=y.Ba+y.c*y.C,ee=A-y.C;if(t(A<=y.l.o),t(16>=ee),0<ee){var se=y.l,le=y.Ta,he=y.Ua,xe=se.width;if(ne(y,ee,C,B),ee=he=[he],t((C=y.C)<(B=A)),t(se.v<se.va),B>se.o&&(B=se.o),C<se.j){var we=se.j-C;C=se.j,ee[0]+=we*xe}if(C>=B?C=0:(ee[0]+=4*se.v,se.ka=C-se.j,se.U=se.va-se.v,se.T=B-C,C=1),C){if(he=he[0],11>(C=y.ca).S){var Le=C.f.RGBA,Je=(B=C.S,ee=se.U,se=se.T,we=Le.eb,Le.A),Ze=se;for(Le=Le.fb+y.Ma*Le.A;0<Ze--;){var Ie=le,at=he,Ke=ee,De=we,Re=Le;switch(B){case zo:ds(Ie,at,Ke,De,Re);break;case Ho:Vn(Ie,at,Ke,De,Re);break;case Mi:Vn(Ie,at,Ke,De,Re),Wa(De,Re,0,Ke,1,0);break;case ef:Ps(Ie,at,Ke,De,Re);break;case cc:Mr(Ie,at,Ke,De,Re,1);break;case Ii:Mr(Ie,at,Ke,De,Re,1),Wa(De,Re,0,Ke,1,0);break;case ps:Mr(Ie,at,Ke,De,Re,0);break;case co:Mr(Ie,at,Ke,De,Re,0),Wa(De,Re,1,Ke,1,0);break;case Os:_l(Ie,at,Ke,De,Re);break;case l0:_l(Ie,at,Ke,De,Re),Lr(De,Re,Ke,1,0);break;case Cl:Mo(Ie,at,Ke,De,Re);break;default:t(0)}he+=xe,Le+=Je}y.Ma+=se}else alert("todo:EmitRescaledRowsYUVA");t(y.Ma<=C.height)}}y.C=A,t(y.C<=y.i)}function pe(y){var A;if(0<y.ua)return 0;for(A=0;A<y.Wb;++A){var C=y.Ya[A].G,B=y.Ya[A].H;if(0<C[1][B[1]+0].g||0<C[2][B[2]+0].g||0<C[3][B[3]+0].g)return 0}return 1}function ge(y,A,C,B,ee,se){if(y.Z!=0){var le=y.qd,he=y.rd;for(t(Ai[y.Z]!=null);A<C;++A)Ai[y.Z](le,he,B,ee,B,ee,se),le=B,he=ee,ee+=se;y.qd=le,y.rd=he}}function Se(y,A){var C=y.l.ma,B=C.Z==0||C.Z==1?y.l.j:y.C;if(B=y.C<B?B:y.C,t(A<=y.l.o),A>B){var ee=y.l.width,se=C.ca,le=C.tb+ee*B,he=y.V,xe=y.Ba+y.c*B,we=y.gc;t(y.ab==1),t(we[0].hc==3),Nl(we[0],B,A,he,xe,se,le),ge(C,B,A,se,le,ee)}y.C=y.Ma=A}function _e(y,A,C,B,ee,se,le){var he=y.$/B,xe=y.$%B,we=y.m,Le=y.s,Je=C+y.$,Ze=Je;ee=C+B*ee;var Ie=C+B*se,at=280+Le.ua,Ke=y.Pb?he:16777216,De=0<Le.ua?Le.Wa:null,Re=Le.wc,mt=Je<Ie?ha(Le,xe,he):null;t(y.C<se),t(Ie<=ee);var yt=!1;e:for(;;){for(;yt||Je<Ie;){var gt=0;if(he>=Ke){var Vt=Je-C;t((Ke=y).Pb),Ke.wd=Ke.m,Ke.xd=Vt,0<Ke.s.ua&&ke(Ke.s.Wa,Ke.s.vb),Ke=he+kh}if(xe&Re||(mt=ha(Le,xe,he)),t(mt!=null),mt.Qb&&(A[Je]=mt.qb,yt=!0),!yt)if(oe(we),mt.jc){gt=we,Vt=A;var Rt=Je,fr=mt.pd[O(gt)&wn-1];t(mt.jc),256>fr.g?(q(gt,gt.u+fr.g),Vt[Rt]=fr.value,gt=0):(q(gt,gt.u+fr.g-256),t(256<=fr.value),gt=fr.value),gt==0&&(yt=!0)}else gt=qa(mt.G[0],mt.H[0],we);if(we.h)break;if(yt||256>gt){if(!yt)if(mt.nd)A[Je]=(mt.qb|gt<<8)>>>0;else{if(oe(we),yt=qa(mt.G[1],mt.H[1],we),oe(we),Vt=qa(mt.G[2],mt.H[2],we),Rt=qa(mt.G[3],mt.H[3],we),we.h)break;A[Je]=(Rt<<24|yt<<16|gt<<8|Vt)>>>0}if(yt=!1,++Je,++xe>=B&&(xe=0,++he,le!=null&&he<=se&&!(he%16)&&le(y,he),De!=null))for(;Ze<Je;)gt=A[Ze++],De.X[(506832829*gt&4294967295)>>>De.Mb]=gt}else if(280>gt){if(gt=Un(gt-256,we),Vt=qa(mt.G[4],mt.H[4],we),oe(we),Vt=Vr(B,Vt=Un(Vt,we)),we.h)break;if(Je-C<Vt||ee-Je<gt)break e;for(Rt=0;Rt<gt;++Rt)A[Je+Rt]=A[Je+Rt-Vt];for(Je+=gt,xe+=gt;xe>=B;)xe-=B,++he,le!=null&&he<=se&&!(he%16)&&le(y,he);if(t(Je<=ee),xe&Re&&(mt=ha(Le,xe,he)),De!=null)for(;Ze<Je;)gt=A[Ze++],De.X[(506832829*gt&4294967295)>>>De.Mb]=gt}else{if(!(gt<at))break e;for(yt=gt-280,t(De!=null);Ze<Je;)gt=A[Ze++],De.X[(506832829*gt&4294967295)>>>De.Mb]=gt;gt=Je,t(!(yt>>>(Vt=De).Xa)),A[gt]=Vt.X[yt],yt=!0}yt||t(we.h==L(we))}if(y.Pb&&we.h&&Je<ee)t(y.m.h),y.a=5,y.m=y.wd,y.$=y.xd,0<y.s.ua&&ke(y.s.vb,y.s.Wa);else{if(we.h)break e;le!=null&&le(y,he>se?se:he),y.a=0,y.$=Je-C}return 1}return y.a=3,0}function Ye(y){t(y!=null),y.vc=null,y.yc=null,y.Ya=null;var A=y.Wa;A!=null&&(A.X=null),y.vb=null,t(y!=null)}function lt(){var y=new Fo;return y==null?null:(y.a=0,y.xb=uc,fa("Predictor","VP8LPredictors"),fa("Predictor","VP8LPredictors_C"),fa("PredictorAdd","VP8LPredictorsAdd"),fa("PredictorAdd","VP8LPredictorsAdd_C"),o0=Ot,Al=Lt,ds=wt,Vn=hr,_l=zt,Mo=Yt,Ps=Sr,z.VP8LMapColor32b=On,z.VP8LMapColor8b=Ku,y)}function We(y,A,C,B,ee){var se=1,le=[y],he=[A],xe=B.m,we=B.s,Le=null,Je=0;e:for(;;){if(C)for(;se&&G(xe,1);){var Ze=le,Ie=he,at=B,Ke=1,De=at.m,Re=at.gc[at.ab],mt=G(De,2);if(at.Oc&1<<mt)se=0;else{switch(at.Oc|=1<<mt,Re.hc=mt,Re.Ea=Ze[0],Re.nc=Ie[0],Re.K=[null],++at.ab,t(4>=at.ab),mt){case 0:case 1:Re.b=G(De,3)+2,Ke=We(Ue(Re.Ea,Re.b),Ue(Re.nc,Re.b),0,at,Re.K),Re.K=Re.K[0];break;case 3:var yt,gt=G(De,8)+1,Vt=16<gt?0:4<gt?1:2<gt?2:3;if(Ze[0]=Ue(Re.Ea,Vt),Re.b=Vt,yt=Ke=We(gt,1,0,at,Re.K)){var Rt,fr=gt,Et=Re,Yr=1<<(8>>Et.b),ta=s(Yr);if(ta==null)yt=0;else{var $r=Et.K[0],Or=Et.w;for(ta[0]=Et.K[0][0],Rt=1;Rt<1*fr;++Rt)ta[Rt]=Xe($r[Or+Rt],ta[Rt-1]);for(;Rt<4*Yr;++Rt)ta[Rt]=0;Et.K[0]=null,Et.K[0]=ta,yt=1}}Ke=yt;break;case 2:break;default:t(0)}se=Ke}}if(le=le[0],he=he[0],se&&G(xe,1)&&!(se=1<=(Je=G(xe,4))&&11>=Je)){B.a=3;break e}var pa;if(pa=se)t:{var sa,Nr,Xa,ma=B,Cr=le,Wn=he,Jr=Je,as=C,xs=ma.m,ba=ma.s,ln=[null],$n=1,Rs=0,Hi=uo[Jr];r:for(;;){if(as&&G(xs,1)){var Nn=G(xs,3)+2,fo=Ue(Cr,Nn),Ll=Ue(Wn,Nn),dc=fo*Ll;if(!We(fo,Ll,0,ma,ln))break r;for(ln=ln[0],ba.xc=Nn,sa=0;sa<dc;++sa){var Go=ln[sa]>>8&65535;ln[sa]=Go,Go>=$n&&($n=Go+1)}}if(xs.h)break r;for(Nr=0;5>Nr;++Nr){var Da=rs[Nr];!Nr&&0<Jr&&(Da+=1<<Jr),Rs<Da&&(Rs=Da)}var p0=o($n*Hi,F),Pp=$n,Fh=o(Pp,K);if(Fh==null)var lf=null;else t(65536>=Pp),lf=Fh;var su=s(Rs);if(lf==null||su==null||p0==null){ma.a=1;break r}var iu=p0;for(sa=Xa=0;sa<$n;++sa){var Ti=lf[sa],pc=Ti.G,mc=Ti.H,Ph=0,cf=1,Lp=0;for(Nr=0;5>Nr;++Nr){Da=rs[Nr],pc[Nr]=iu,mc[Nr]=Xa,!Nr&&0<Jr&&(Da+=1<<Jr);n:{var uf,Ol=Da,ff=ma,Rl=su,m0=iu,Op=Xa,hf=0,Wo=ff.m,Rp=G(Wo,1);if(n(Rl,0,0,Ol),Rp){var Mp=G(Wo,1)+1,Ip=G(Wo,1),x0=G(Wo,Ip==0?1:8);Rl[x0]=1,Mp==2&&(Rl[x0=G(Wo,8)]=1);var df=1}else{var Lh=s(19),g0=G(Wo,4)+4;if(19<g0){ff.a=3;var pf=0;break n}for(uf=0;uf<g0;++uf)Lh[Zr[uf]]=G(Wo,3);var v0=void 0,mf=void 0,y0=ff,Bp=Lh,xf=Ol,w0=Rl,b0=0,$o=y0.m,Up=8,zp=o(128,F);a:for(;R(zp,0,7,Bp,19);){if(G($o,1)){var Hp=2+2*G($o,3);if((v0=2+G($o,Hp))>xf)break a}else v0=xf;for(mf=0;mf<xf&&v0--;){oe($o);var ou=zp[0+(127&O($o))];q($o,$o.u+ou.g);var Ml=ou.value;if(16>Ml)w0[mf++]=Ml,Ml!=0&&(Up=Ml);else{var S0=Ml==16,Oh=Ml-16,Vp=Th[Oh],Vi=G($o,_h[Oh])+Vp;if(mf+Vi>xf)break a;for(var xc=S0?Up:0;0<Vi--;)w0[mf++]=xc}}b0=1;break a}b0||(y0.a=3),df=b0}(df=df&&!Wo.h)&&(hf=R(m0,Op,8,Rl,Ol)),df&&hf!=0?pf=hf:(ff.a=3,pf=0)}if(pf==0)break r;if(cf&&Gn[Nr]==1&&(cf=iu[Xa].g==0),Ph+=iu[Xa].g,Xa+=pf,3>=Nr){var ki,Xo=su[0];for(ki=1;ki<Da;++ki)su[ki]>Xo&&(Xo=su[ki]);Lp+=Xo}}if(Ti.nd=cf,Ti.Qb=0,cf&&(Ti.qb=(pc[3][mc[3]+0].value<<24|pc[1][mc[1]+0].value<<16|pc[2][mc[2]+0].value)>>>0,Ph==0&&256>pc[0][mc[0]+0].value&&(Ti.Qb=1,Ti.qb+=pc[0][mc[0]+0].value<<8)),Ti.jc=!Ti.Qb&&6>Lp,Ti.jc){var lu,qi=Ti;for(lu=0;lu<wn;++lu){var Yo=lu,Jo=qi.pd[Yo],ho=qi.G[0][qi.H[0]+Yo];256<=ho.value?(Jo.g=ho.g+256,Jo.value=ho.value):(Jo.g=0,Jo.value=0,Yo>>=qr(ho,8,Jo),Yo>>=qr(qi.G[1][qi.H[1]+Yo],16,Jo),Yo>>=qr(qi.G[2][qi.H[2]+Yo],0,Jo),qr(qi.G[3][qi.H[3]+Yo],24,Jo))}}}ba.vc=ln,ba.Wb=$n,ba.Ya=lf,ba.yc=p0,pa=1;break t}pa=0}if(!(se=pa)){B.a=3;break e}if(0<Je){if(we.ua=1<<Je,!st(we.Wa,Je)){B.a=1,se=0;break e}}else we.ua=0;var cu=B,Rh=le,qp=he,N0=cu.s,uu=N0.xc;if(cu.c=Rh,cu.i=qp,N0.md=Ue(Rh,uu),N0.wc=uu==0?-1:(1<<uu)-1,C){B.xb=Cp;break e}if((Le=s(le*he))==null){B.a=1,se=0;break e}se=(se=_e(B,Le,0,le,he,he,null))&&!xe.h;break e}return se?(ee!=null?ee[0]=Le:(t(Le==null),t(C)),B.$=0,C||Ye(we)):Ye(we),se}function $e(y,A){var C=y.c*y.i,B=C+A+16*A;return t(y.c<=A),y.V=s(B),y.V==null?(y.Ta=null,y.Ua=0,y.a=1,0):(y.Ta=y.V,y.Ua=y.Ba+C+A,1)}function Qe(y,A){var C=y.C,B=A-C,ee=y.V,se=y.Ba+y.c*C;for(t(A<=y.l.o);0<B;){var le=16<B?16:B,he=y.l.ma,xe=y.l.width,we=xe*le,Le=he.ca,Je=he.tb+xe*C,Ze=y.Ta,Ie=y.Ua;ne(y,le,ee,se),Ia(Ze,Ie,Le,Je,we),ge(he,C,C+le,Le,Je,xe),B-=le,ee+=le*y.c,C+=le}t(C==A),y.C=y.Ma=A}function St(){this.ub=this.yd=this.td=this.Rb=0}function jt(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Ut(){this.Fb=this.Bb=this.Cb=0,this.Zb=s(4),this.Lb=s(4)}function ie(){this.Yb=function(){var y=[];return function A(C,B,ee){for(var se=ee[B],le=0;le<se&&(C.push(ee.length>B+1?[]:0),!(ee.length<B+1));le++)A(C[le],B+1,ee)}(y,0,[3,11]),y}()}function Ce(){this.jb=s(3),this.Wc=c([4,8],ie),this.Xc=c([4,17],ie)}function Oe(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new s(4),this.od=new s(4)}function Ve(){this.ld=this.La=this.dd=this.tc=0}function kt(){this.Na=this.la=0}function Ht(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Ft(){this.ad=s(384),this.Za=0,this.Ob=s(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function ir(){this.uc=this.M=this.Nb=0,this.wa=Array(new Ve),this.Y=0,this.ya=Array(new Ft),this.aa=0,this.l=new Pr}function Gt(){this.y=s(16),this.f=s(8),this.ea=s(8)}function yr(){this.cb=this.a=0,this.sc="",this.m=new ye,this.Od=new St,this.Kc=new jt,this.ed=new Oe,this.Qa=new Ut,this.Ic=this.$c=this.Aa=0,this.D=new ir,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=o(8,ye),this.ia=0,this.pb=o(4,Ht),this.Pa=new Ce,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Gt),this.Hd=0,this.rb=Array(new kt),this.sb=0,this.wa=Array(new Ve),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Ft),this.L=this.aa=0,this.gd=c([4,2],Ve),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Pr(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function er(){var y=new yr;return y!=null&&(y.a=0,y.sc="OK",y.cb=0,y.Xb=0,ru||(ru=zn)),y}function rr(y,A,C){return y.a==0&&(y.a=A,y.sc=C,y.cb=0),0}function Ur(y,A,C){return 3<=C&&y[A+0]==157&&y[A+1]==1&&y[A+2]==42}function ja(y,A){if(y==null)return 0;if(y.a=0,y.sc="OK",A==null)return rr(y,2,"null VP8Io passed to VP8GetHeaders()");var C=A.data,B=A.w,ee=A.ha;if(4>ee)return rr(y,7,"Truncated header.");var se=C[B+0]|C[B+1]<<8|C[B+2]<<16,le=y.Od;if(le.Rb=!(1&se),le.td=se>>1&7,le.yd=se>>4&1,le.ub=se>>5,3<le.td)return rr(y,3,"Incorrect keyframe parameters.");if(!le.yd)return rr(y,4,"Frame not displayable.");B+=3,ee-=3;var he=y.Kc;if(le.Rb){if(7>ee)return rr(y,7,"cannot parse picture header");if(!Ur(C,B,ee))return rr(y,3,"Bad code word");he.c=16383&(C[B+4]<<8|C[B+3]),he.Td=C[B+4]>>6,he.i=16383&(C[B+6]<<8|C[B+5]),he.Ud=C[B+6]>>6,B+=7,ee-=7,y.za=he.c+15>>4,y.Ub=he.i+15>>4,A.width=he.c,A.height=he.i,A.Da=0,A.j=0,A.v=0,A.va=A.width,A.o=A.height,A.da=0,A.ib=A.width,A.hb=A.height,A.U=A.width,A.T=A.height,n((se=y.Pa).jb,0,255,se.jb.length),t((se=y.Qa)!=null),se.Cb=0,se.Bb=0,se.Fb=1,n(se.Zb,0,0,se.Zb.length),n(se.Lb,0,0,se.Lb)}if(le.ub>ee)return rr(y,7,"bad partition length");X(se=y.m,C,B,le.ub),B+=le.ub,ee-=le.ub,le.Rb&&(he.Ld=ve(se),he.Kd=ve(se)),he=y.Qa;var xe,we=y.Pa;if(t(se!=null),t(he!=null),he.Cb=ve(se),he.Cb){if(he.Bb=ve(se),ve(se)){for(he.Fb=ve(se),xe=0;4>xe;++xe)he.Zb[xe]=ve(se)?ce(se,7):0;for(xe=0;4>xe;++xe)he.Lb[xe]=ve(se)?ce(se,6):0}if(he.Bb)for(xe=0;3>xe;++xe)we.jb[xe]=ve(se)?Z(se,8):255}else he.Bb=0;if(se.Ka)return rr(y,3,"cannot parse segment header");if((he=y.ed).zd=ve(se),he.Tb=Z(se,6),he.wb=Z(se,3),he.Pc=ve(se),he.Pc&&ve(se)){for(we=0;4>we;++we)ve(se)&&(he.vd[we]=ce(se,6));for(we=0;4>we;++we)ve(se)&&(he.od[we]=ce(se,6))}if(y.L=he.Tb==0?0:he.zd?1:2,se.Ka)return rr(y,3,"cannot parse filter header");var Le=ee;if(ee=xe=B,B=xe+Le,he=Le,y.Xb=(1<<Z(y.m,2))-1,Le<3*(we=y.Xb))C=7;else{for(xe+=3*we,he-=3*we,Le=0;Le<we;++Le){var Je=C[ee+0]|C[ee+1]<<8|C[ee+2]<<16;Je>he&&(Je=he),X(y.Jc[+Le],C,xe,Je),xe+=Je,he-=Je,ee+=3}X(y.Jc[+we],C,xe,he),C=xe<B?0:5}if(C!=0)return rr(y,C,"cannot parse partitions");for(C=Z(xe=y.m,7),ee=ve(xe)?ce(xe,4):0,B=ve(xe)?ce(xe,4):0,he=ve(xe)?ce(xe,4):0,we=ve(xe)?ce(xe,4):0,xe=ve(xe)?ce(xe,4):0,Le=y.Qa,Je=0;4>Je;++Je){if(Le.Cb){var Ze=Le.Zb[Je];Le.Fb||(Ze+=C)}else{if(0<Je){y.pb[Je]=y.pb[0];continue}Ze=C}var Ie=y.pb[Je];Ie.Sc[0]=Vo[ii(Ze+ee,127)],Ie.Sc[1]=c0[ii(Ze+0,127)],Ie.Eb[0]=2*Vo[ii(Ze+B,127)],Ie.Eb[1]=101581*c0[ii(Ze+he,127)]>>16,8>Ie.Eb[1]&&(Ie.Eb[1]=8),Ie.Qc[0]=Vo[ii(Ze+we,117)],Ie.Qc[1]=c0[ii(Ze+xe,127)],Ie.lc=Ze+xe}if(!le.Rb)return rr(y,4,"Not a key frame.");for(ve(se),le=y.Pa,C=0;4>C;++C){for(ee=0;8>ee;++ee)for(B=0;3>B;++B)for(he=0;11>he;++he)we=ue(se,Eh[C][ee][B][he])?Z(se,8):af[C][ee][B][he],le.Wc[C][ee].Yb[B][he]=we;for(ee=0;17>ee;++ee)le.Xc[C][ee]=le.Wc[C][jp[ee]]}return y.kc=ve(se),y.kc&&(y.Bd=Z(se,8)),y.cb=1}function zn(y,A,C,B,ee,se,le){var he=A[ee].Yb[C];for(C=0;16>ee;++ee){if(!ue(y,he[C+0]))return ee;for(;!ue(y,he[C+1]);)if(he=A[++ee].Yb[0],C=0,ee==16)return 16;var xe=A[ee+1].Yb;if(ue(y,he[C+2])){var we=y,Le=0;if(ue(we,(Ze=he)[(Je=C)+3]))if(ue(we,Ze[Je+6])){for(he=0,Je=2*(Le=ue(we,Ze[Je+8]))+(Ze=ue(we,Ze[Je+9+Le])),Le=0,Ze=tf[Je];Ze[he];++he)Le+=Le+ue(we,Ze[he]);Le+=3+(8<<Je)}else ue(we,Ze[Je+7])?(Le=7+2*ue(we,165),Le+=ue(we,145)):Le=5+ue(we,159);else Le=ue(we,Ze[Je+4])?3+ue(we,Ze[Je+5]):2;he=xe[2]}else Le=1,he=xe[1];xe=le+rf[ee],0>(we=y).b&&be(we);var Je,Ze=we.b,Ie=(Je=we.Ca>>1)-(we.I>>Ze)>>31;--we.b,we.Ca+=Ie,we.Ca|=1,we.I-=(Je+1&Ie)<<Ze,se[xe]=((Le^Ie)-Ie)*B[(0<ee)+0]}return 16}function ei(y){var A=y.rb[y.sb-1];A.la=0,A.Na=0,n(y.zc,0,0,y.zc.length),y.ja=0}function ti(y,A){if(y==null)return 0;if(A==null)return rr(y,2,"NULL VP8Io parameter in VP8Decode().");if(!y.cb&&!ja(y,A))return 0;if(t(y.cb),A.ac==null||A.ac(A)){A.ob&&(y.L=0);var C=h0[y.L];if(y.L==2?(y.yb=0,y.zb=0):(y.yb=A.v-C>>4,y.zb=A.j-C>>4,0>y.yb&&(y.yb=0),0>y.zb&&(y.zb=0)),y.Va=A.o+15+C>>4,y.Hb=A.va+15+C>>4,y.Hb>y.za&&(y.Hb=y.za),y.Va>y.Ub&&(y.Va=y.Ub),0<y.L){var B=y.ed;for(C=0;4>C;++C){var ee;if(y.Qa.Cb){var se=y.Qa.Lb[C];y.Qa.Fb||(se+=B.Tb)}else se=B.Tb;for(ee=0;1>=ee;++ee){var le=y.gd[C][ee],he=se;if(B.Pc&&(he+=B.vd[0],ee&&(he+=B.od[0])),0<(he=0>he?0:63<he?63:he)){var xe=he;0<B.wb&&(xe=4<B.wb?xe>>2:xe>>1)>9-B.wb&&(xe=9-B.wb),1>xe&&(xe=1),le.dd=xe,le.tc=2*he+xe,le.ld=40<=he?2:15<=he?1:0}else le.tc=0;le.La=ee}}}C=0}else rr(y,6,"Frame setup failed"),C=y.a;if(C=C==0){if(C){y.$c=0,0<y.Aa||(y.Ic=Sn);e:{C=y.Ic,B=4*(xe=y.za);var we=32*xe,Le=xe+1,Je=0<y.L?xe*(0<y.Aa?2:1):0,Ze=(y.Aa==2?2:1)*xe;if((le=B+832+(ee=3*(16*C+h0[y.L])/2*we)+(se=y.Fa!=null&&0<y.Fa.length?y.Kc.c*y.Kc.i:0))!=le)C=0;else{if(le>y.Vb){if(y.Vb=0,y.Ec=s(le),y.Fc=0,y.Ec==null){C=rr(y,1,"no memory during frame initialization.");break e}y.Vb=le}le=y.Ec,he=y.Fc,y.Ac=le,y.Bc=he,he+=B,y.Gd=o(we,Gt),y.Hd=0,y.rb=o(Le+1,kt),y.sb=1,y.wa=Je?o(Je,Ve):null,y.Y=0,y.D.Nb=0,y.D.wa=y.wa,y.D.Y=y.Y,0<y.Aa&&(y.D.Y+=xe),t(!0),y.oc=le,y.pc=he,he+=832,y.ya=o(Ze,Ft),y.aa=0,y.D.ya=y.ya,y.D.aa=y.aa,y.Aa==2&&(y.D.aa+=xe),y.R=16*xe,y.B=8*xe,xe=(we=h0[y.L])*y.R,we=we/2*y.B,y.sa=le,y.ta=he+xe,y.qa=y.sa,y.ra=y.ta+16*C*y.R+we,y.Ha=y.qa,y.Ia=y.ra+8*C*y.B+we,y.$c=0,he+=ee,y.mb=se?le:null,y.nb=se?he:null,t(he+se<=y.Fc+y.Vb),ei(y),n(y.Ac,y.Bc,0,B),C=1}}if(C){if(A.ka=0,A.y=y.sa,A.O=y.ta,A.f=y.qa,A.N=y.ra,A.ea=y.Ha,A.Vd=y.Ia,A.fa=y.R,A.Rc=y.B,A.F=null,A.J=0,!Qu){for(C=-255;255>=C;++C)$a[255+C]=0>C?-C:C;for(C=-1020;1020>=C;++C)Si[1020+C]=-128>C?-128:127<C?127:C;for(C=-112;112>=C;++C)lc[112+C]=-16>C?-16:15<C?15:C;for(C=-255;510>=C;++C)ci[255+C]=0>C?0:255<C?255:C;Qu=1}Tl=xl,oi=ri,Zc=_s,en=Ts,qn=ai,Ma=Kn,kl=la,Zu=Er,Ri=es,El=Pn,jl=Ga,Io=vn,ic=yn,Qc=js,oc=Jt,Bo=Dt,eu=Wt,li=$t,Ni[0]=si,Ni[1]=vi,Ni[2]=$c,Ni[3]=gl,Ni[4]=so,Ni[5]=yi,Ni[6]=vl,Ni[7]=Es,Ni[8]=yl,Ni[9]=rc,Ui[0]=no,Ui[1]=ao,Ui[2]=Zn,Ui[3]=Qn,Ui[4]=on,Ui[5]=tc,Ui[6]=ni,ui[0]=Pi,ui[1]=fs,ui[2]=Xc,ui[3]=io,ui[4]=hs,ui[5]=Fn,ui[6]=Ae,C=1}else C=0}C&&(C=function(Ie,at){for(Ie.M=0;Ie.M<Ie.Va;++Ie.M){var Ke,De=Ie.Jc[Ie.M&Ie.Xb],Re=Ie.m,mt=Ie;for(Ke=0;Ke<mt.za;++Ke){var yt=Re,gt=mt,Vt=gt.Ac,Rt=gt.Bc+4*Ke,fr=gt.zc,Et=gt.ya[gt.aa+Ke];if(gt.Qa.Bb?Et.$b=ue(yt,gt.Pa.jb[0])?2+ue(yt,gt.Pa.jb[2]):ue(yt,gt.Pa.jb[1]):Et.$b=0,gt.kc&&(Et.Ad=ue(yt,gt.Bd)),Et.Za=!ue(yt,145)+0,Et.Za){var Yr=Et.Ob,ta=0;for(gt=0;4>gt;++gt){var $r,Or=fr[0+gt];for($r=0;4>$r;++$r){Or=Ep[Vt[Rt+$r]][Or];for(var pa=au[ue(yt,Or[0])];0<pa;)pa=au[2*pa+ue(yt,Or[pa])];Or=-pa,Vt[Rt+$r]=Or}a(Yr,ta,Vt,Rt,4),ta+=4,fr[0+gt]=Or}}else Or=ue(yt,156)?ue(yt,128)?1:3:ue(yt,163)?2:0,Et.Ob[0]=Or,n(Vt,Rt,Or,4),n(fr,0,Or,4);Et.Dd=ue(yt,142)?ue(yt,114)?ue(yt,183)?1:3:2:0}if(mt.m.Ka)return rr(Ie,7,"Premature end-of-partition0 encountered.");for(;Ie.ja<Ie.za;++Ie.ja){if(mt=De,yt=(Re=Ie).rb[Re.sb-1],Vt=Re.rb[Re.sb+Re.ja],Ke=Re.ya[Re.aa+Re.ja],Rt=Re.kc?Ke.Ad:0)yt.la=Vt.la=0,Ke.Za||(yt.Na=Vt.Na=0),Ke.Hc=0,Ke.Gc=0,Ke.ia=0;else{var sa,Nr;if(yt=Vt,Vt=mt,Rt=Re.Pa.Xc,fr=Re.ya[Re.aa+Re.ja],Et=Re.pb[fr.$b],gt=fr.ad,Yr=0,ta=Re.rb[Re.sb-1],Or=$r=0,n(gt,Yr,0,384),fr.Za)var Xa=0,ma=Rt[3];else{pa=s(16);var Cr=yt.Na+ta.Na;if(Cr=ru(Vt,Rt[1],Cr,Et.Eb,0,pa,0),yt.Na=ta.Na=(0<Cr)+0,1<Cr)Tl(pa,0,gt,Yr);else{var Wn=pa[0]+3>>3;for(pa=0;256>pa;pa+=16)gt[Yr+pa]=Wn}Xa=1,ma=Rt[0]}var Jr=15&yt.la,as=15&ta.la;for(pa=0;4>pa;++pa){var xs=1&as;for(Wn=Nr=0;4>Wn;++Wn)Jr=Jr>>1|(xs=(Cr=ru(Vt,ma,Cr=xs+(1&Jr),Et.Sc,Xa,gt,Yr))>Xa)<<7,Nr=Nr<<2|(3<Cr?3:1<Cr?2:gt[Yr+0]!=0),Yr+=16;Jr>>=4,as=as>>1|xs<<7,$r=($r<<8|Nr)>>>0}for(ma=Jr,Xa=as>>4,sa=0;4>sa;sa+=2){for(Nr=0,Jr=yt.la>>4+sa,as=ta.la>>4+sa,pa=0;2>pa;++pa){for(xs=1&as,Wn=0;2>Wn;++Wn)Cr=xs+(1&Jr),Jr=Jr>>1|(xs=0<(Cr=ru(Vt,Rt[2],Cr,Et.Qc,0,gt,Yr)))<<3,Nr=Nr<<2|(3<Cr?3:1<Cr?2:gt[Yr+0]!=0),Yr+=16;Jr>>=2,as=as>>1|xs<<5}Or|=Nr<<4*sa,ma|=Jr<<4<<sa,Xa|=(240&as)<<sa}yt.la=ma,ta.la=Xa,fr.Hc=$r,fr.Gc=Or,fr.ia=43690&Or?0:Et.ia,Rt=!($r|Or)}if(0<Re.L&&(Re.wa[Re.Y+Re.ja]=Re.gd[Ke.$b][Ke.Za],Re.wa[Re.Y+Re.ja].La|=!Rt),mt.Ka)return rr(Ie,7,"Premature end-of-file encountered.")}if(ei(Ie),Re=at,mt=1,Ke=(De=Ie).D,yt=0<De.L&&De.M>=De.zb&&De.M<=De.Va,De.Aa==0)e:{if(Ke.M=De.M,Ke.uc=yt,Oo(De,Ke),mt=1,Ke=(Nr=De.D).Nb,yt=(Or=h0[De.L])*De.R,Vt=Or/2*De.B,pa=16*Ke*De.R,Wn=8*Ke*De.B,Rt=De.sa,fr=De.ta-yt+pa,Et=De.qa,gt=De.ra-Vt+Wn,Yr=De.Ha,ta=De.Ia-Vt+Wn,as=(Jr=Nr.M)==0,$r=Jr>=De.Va-1,De.Aa==2&&Oo(De,Nr),Nr.uc)for(xs=(Cr=De).D.M,t(Cr.D.uc),Nr=Cr.yb;Nr<Cr.Hb;++Nr){Xa=Nr,ma=xs;var ba=(ln=(Da=Cr).D).Nb;sa=Da.R;var ln=ln.wa[ln.Y+Xa],$n=Da.sa,Rs=Da.ta+16*ba*sa+16*Xa,Hi=ln.dd,Nn=ln.tc;if(Nn!=0)if(t(3<=Nn),Da.L==1)0<Xa&&Bo($n,Rs,sa,Nn+4),ln.La&&li($n,Rs,sa,Nn),0<ma&&oc($n,Rs,sa,Nn+4),ln.La&&eu($n,Rs,sa,Nn);else{var fo=Da.B,Ll=Da.qa,dc=Da.ra+8*ba*fo+8*Xa,Go=Da.Ha,Da=Da.Ia+8*ba*fo+8*Xa;ba=ln.ld,0<Xa&&(Zu($n,Rs,sa,Nn+4,Hi,ba),El(Ll,dc,Go,Da,fo,Nn+4,Hi,ba)),ln.La&&(Io($n,Rs,sa,Nn,Hi,ba),Qc(Ll,dc,Go,Da,fo,Nn,Hi,ba)),0<ma&&(kl($n,Rs,sa,Nn+4,Hi,ba),Ri(Ll,dc,Go,Da,fo,Nn+4,Hi,ba)),ln.La&&(jl($n,Rs,sa,Nn,Hi,ba),ic(Ll,dc,Go,Da,fo,Nn,Hi,ba))}}if(De.ia&&alert("todo:DitherRow"),Re.put!=null){if(Nr=16*Jr,Jr=16*(Jr+1),as?(Re.y=De.sa,Re.O=De.ta+pa,Re.f=De.qa,Re.N=De.ra+Wn,Re.ea=De.Ha,Re.W=De.Ia+Wn):(Nr-=Or,Re.y=Rt,Re.O=fr,Re.f=Et,Re.N=gt,Re.ea=Yr,Re.W=ta),$r||(Jr-=Or),Jr>Re.o&&(Jr=Re.o),Re.F=null,Re.J=null,De.Fa!=null&&0<De.Fa.length&&Nr<Jr&&(Re.J=Xu(De,Re,Nr,Jr-Nr),Re.F=De.mb,Re.F==null&&Re.F.length==0)){mt=rr(De,3,"Could not decode alpha data.");break e}Nr<Re.j&&(Or=Re.j-Nr,Nr=Re.j,t(!(1&Or)),Re.O+=De.R*Or,Re.N+=De.B*(Or>>1),Re.W+=De.B*(Or>>1),Re.F!=null&&(Re.J+=Re.width*Or)),Nr<Jr&&(Re.O+=Re.v,Re.N+=Re.v>>1,Re.W+=Re.v>>1,Re.F!=null&&(Re.J+=Re.v),Re.ka=Nr-Re.j,Re.U=Re.va-Re.v,Re.T=Jr-Nr,mt=Re.put(Re))}Ke+1!=De.Ic||$r||(a(De.sa,De.ta-yt,Rt,fr+16*De.R,yt),a(De.qa,De.ra-Vt,Et,gt+8*De.B,Vt),a(De.Ha,De.Ia-Vt,Yr,ta+8*De.B,Vt))}if(!mt)return rr(Ie,6,"Output aborted.")}return 1}(y,A)),A.bc!=null&&A.bc(A),C&=1}return C?(y.cb=0,C):0}function Ka(y,A,C,B,ee){ee=y[A+C+32*B]+(ee>>3),y[A+C+32*B]=-256&ee?0>ee?0:255:ee}function Aa(y,A,C,B,ee,se){Ka(y,A,0,C,B+ee),Ka(y,A,1,C,B+se),Ka(y,A,2,C,B-se),Ka(y,A,3,C,B-ee)}function da(y){return(20091*y>>16)+y}function ca(y,A,C,B){var ee,se=0,le=s(16);for(ee=0;4>ee;++ee){var he=y[A+0]+y[A+8],xe=y[A+0]-y[A+8],we=(35468*y[A+4]>>16)-da(y[A+12]),Le=da(y[A+4])+(35468*y[A+12]>>16);le[se+0]=he+Le,le[se+1]=xe+we,le[se+2]=xe-we,le[se+3]=he-Le,se+=4,A++}for(ee=se=0;4>ee;++ee)he=(y=le[se+0]+4)+le[se+8],xe=y-le[se+8],we=(35468*le[se+4]>>16)-da(le[se+12]),Ka(C,B,0,0,he+(Le=da(le[se+4])+(35468*le[se+12]>>16))),Ka(C,B,1,0,xe+we),Ka(C,B,2,0,xe-we),Ka(C,B,3,0,he-Le),se++,B+=32}function Kn(y,A,C,B){var ee=y[A+0]+4,se=35468*y[A+4]>>16,le=da(y[A+4]),he=35468*y[A+1]>>16;Aa(C,B,0,ee+le,y=da(y[A+1]),he),Aa(C,B,1,ee+se,y,he),Aa(C,B,2,ee-se,y,he),Aa(C,B,3,ee-le,y,he)}function ri(y,A,C,B,ee){ca(y,A,C,B),ee&&ca(y,A+16,C,B+4)}function _s(y,A,C,B){oi(y,A+0,C,B,1),oi(y,A+32,C,B+128,1)}function Ts(y,A,C,B){var ee;for(y=y[A+0]+4,ee=0;4>ee;++ee)for(A=0;4>A;++A)Ka(C,B,A,ee,y)}function ai(y,A,C,B){y[A+0]&&en(y,A+0,C,B),y[A+16]&&en(y,A+16,C,B+4),y[A+32]&&en(y,A+32,C,B+128),y[A+48]&&en(y,A+48,C,B+128+4)}function xl(y,A,C,B){var ee,se=s(16);for(ee=0;4>ee;++ee){var le=y[A+0+ee]+y[A+12+ee],he=y[A+4+ee]+y[A+8+ee],xe=y[A+4+ee]-y[A+8+ee],we=y[A+0+ee]-y[A+12+ee];se[0+ee]=le+he,se[8+ee]=le-he,se[4+ee]=we+xe,se[12+ee]=we-xe}for(ee=0;4>ee;++ee)le=(y=se[0+4*ee]+3)+se[3+4*ee],he=se[1+4*ee]+se[2+4*ee],xe=se[1+4*ee]-se[2+4*ee],we=y-se[3+4*ee],C[B+0]=le+he>>3,C[B+16]=we+xe>>3,C[B+32]=le-he>>3,C[B+48]=we-xe>>3,B+=64}function ks(y,A,C){var B,ee=A-32,se=Ls,le=255-y[ee-1];for(B=0;B<C;++B){var he,xe=se,we=le+y[A-1];for(he=0;he<C;++he)y[A+he]=xe[we+y[ee+he]];A+=32}}function vi(y,A){ks(y,A,4)}function fs(y,A){ks(y,A,8)}function ao(y,A){ks(y,A,16)}function Zn(y,A){var C;for(C=0;16>C;++C)a(y,A+32*C,y,A-32,16)}function Qn(y,A){var C;for(C=16;0<C;--C)n(y,A,y[A-1],16),A+=32}function Fi(y,A,C){var B;for(B=0;16>B;++B)n(A,C+32*B,y,16)}function no(y,A){var C,B=16;for(C=0;16>C;++C)B+=y[A-1+32*C]+y[A+C-32];Fi(B>>5,y,A)}function on(y,A){var C,B=8;for(C=0;16>C;++C)B+=y[A-1+32*C];Fi(B>>4,y,A)}function tc(y,A){var C,B=8;for(C=0;16>C;++C)B+=y[A+C-32];Fi(B>>4,y,A)}function ni(y,A){Fi(128,y,A)}function nr(y,A,C){return y+2*A+C+2>>2}function $c(y,A){var C,B=A-32;for(B=new Uint8Array([nr(y[B-1],y[B+0],y[B+1]),nr(y[B+0],y[B+1],y[B+2]),nr(y[B+1],y[B+2],y[B+3]),nr(y[B+2],y[B+3],y[B+4])]),C=0;4>C;++C)a(y,A+32*C,B,0,B.length)}function gl(y,A){var C=y[A-1],B=y[A-1+32],ee=y[A-1+64],se=y[A-1+96];fe(y,A+0,16843009*nr(y[A-1-32],C,B)),fe(y,A+32,16843009*nr(C,B,ee)),fe(y,A+64,16843009*nr(B,ee,se)),fe(y,A+96,16843009*nr(ee,se,se))}function si(y,A){var C,B=4;for(C=0;4>C;++C)B+=y[A+C-32]+y[A-1+32*C];for(B>>=3,C=0;4>C;++C)n(y,A+32*C,B,4)}function so(y,A){var C=y[A-1+0],B=y[A-1+32],ee=y[A-1+64],se=y[A-1-32],le=y[A+0-32],he=y[A+1-32],xe=y[A+2-32],we=y[A+3-32];y[A+0+96]=nr(B,ee,y[A-1+96]),y[A+1+96]=y[A+0+64]=nr(C,B,ee),y[A+2+96]=y[A+1+64]=y[A+0+32]=nr(se,C,B),y[A+3+96]=y[A+2+64]=y[A+1+32]=y[A+0+0]=nr(le,se,C),y[A+3+64]=y[A+2+32]=y[A+1+0]=nr(he,le,se),y[A+3+32]=y[A+2+0]=nr(xe,he,le),y[A+3+0]=nr(we,xe,he)}function vl(y,A){var C=y[A+1-32],B=y[A+2-32],ee=y[A+3-32],se=y[A+4-32],le=y[A+5-32],he=y[A+6-32],xe=y[A+7-32];y[A+0+0]=nr(y[A+0-32],C,B),y[A+1+0]=y[A+0+32]=nr(C,B,ee),y[A+2+0]=y[A+1+32]=y[A+0+64]=nr(B,ee,se),y[A+3+0]=y[A+2+32]=y[A+1+64]=y[A+0+96]=nr(ee,se,le),y[A+3+32]=y[A+2+64]=y[A+1+96]=nr(se,le,he),y[A+3+64]=y[A+2+96]=nr(le,he,xe),y[A+3+96]=nr(he,xe,xe)}function yi(y,A){var C=y[A-1+0],B=y[A-1+32],ee=y[A-1+64],se=y[A-1-32],le=y[A+0-32],he=y[A+1-32],xe=y[A+2-32],we=y[A+3-32];y[A+0+0]=y[A+1+64]=se+le+1>>1,y[A+1+0]=y[A+2+64]=le+he+1>>1,y[A+2+0]=y[A+3+64]=he+xe+1>>1,y[A+3+0]=xe+we+1>>1,y[A+0+96]=nr(ee,B,C),y[A+0+64]=nr(B,C,se),y[A+0+32]=y[A+1+96]=nr(C,se,le),y[A+1+32]=y[A+2+96]=nr(se,le,he),y[A+2+32]=y[A+3+96]=nr(le,he,xe),y[A+3+32]=nr(he,xe,we)}function Es(y,A){var C=y[A+0-32],B=y[A+1-32],ee=y[A+2-32],se=y[A+3-32],le=y[A+4-32],he=y[A+5-32],xe=y[A+6-32],we=y[A+7-32];y[A+0+0]=C+B+1>>1,y[A+1+0]=y[A+0+64]=B+ee+1>>1,y[A+2+0]=y[A+1+64]=ee+se+1>>1,y[A+3+0]=y[A+2+64]=se+le+1>>1,y[A+0+32]=nr(C,B,ee),y[A+1+32]=y[A+0+96]=nr(B,ee,se),y[A+2+32]=y[A+1+96]=nr(ee,se,le),y[A+3+32]=y[A+2+96]=nr(se,le,he),y[A+3+64]=nr(le,he,xe),y[A+3+96]=nr(he,xe,we)}function rc(y,A){var C=y[A-1+0],B=y[A-1+32],ee=y[A-1+64],se=y[A-1+96];y[A+0+0]=C+B+1>>1,y[A+2+0]=y[A+0+32]=B+ee+1>>1,y[A+2+32]=y[A+0+64]=ee+se+1>>1,y[A+1+0]=nr(C,B,ee),y[A+3+0]=y[A+1+32]=nr(B,ee,se),y[A+3+32]=y[A+1+64]=nr(ee,se,se),y[A+3+64]=y[A+2+64]=y[A+0+96]=y[A+1+96]=y[A+2+96]=y[A+3+96]=se}function yl(y,A){var C=y[A-1+0],B=y[A-1+32],ee=y[A-1+64],se=y[A-1+96],le=y[A-1-32],he=y[A+0-32],xe=y[A+1-32],we=y[A+2-32];y[A+0+0]=y[A+2+32]=C+le+1>>1,y[A+0+32]=y[A+2+64]=B+C+1>>1,y[A+0+64]=y[A+2+96]=ee+B+1>>1,y[A+0+96]=se+ee+1>>1,y[A+3+0]=nr(he,xe,we),y[A+2+0]=nr(le,he,xe),y[A+1+0]=y[A+3+32]=nr(C,le,he),y[A+1+32]=y[A+3+64]=nr(B,C,le),y[A+1+64]=y[A+3+96]=nr(ee,B,C),y[A+1+96]=nr(se,ee,B)}function Xc(y,A){var C;for(C=0;8>C;++C)a(y,A+32*C,y,A-32,8)}function io(y,A){var C;for(C=0;8>C;++C)n(y,A,y[A-1],8),A+=32}function wi(y,A,C){var B;for(B=0;8>B;++B)n(A,C+32*B,y,8)}function Pi(y,A){var C,B=8;for(C=0;8>C;++C)B+=y[A+C-32]+y[A-1+32*C];wi(B>>4,y,A)}function Fn(y,A){var C,B=4;for(C=0;8>C;++C)B+=y[A+C-32];wi(B>>3,y,A)}function hs(y,A){var C,B=4;for(C=0;8>C;++C)B+=y[A-1+32*C];wi(B>>3,y,A)}function Ae(y,A){wi(128,y,A)}function He(y,A,C){var B=y[A-C],ee=y[A+0],se=3*(ee-B)+tu[1020+y[A-2*C]-y[A+C]],le=Uo[112+(se+4>>3)];y[A-C]=Ls[255+B+Uo[112+(se+3>>3)]],y[A+0]=Ls[255+ee-le]}function tt(y,A,C,B){var ee=y[A+0],se=y[A+C];return Ba[255+y[A-2*C]-y[A-C]]>B||Ba[255+se-ee]>B}function nt(y,A,C,B){return 4*Ba[255+y[A-C]-y[A+0]]+Ba[255+y[A-2*C]-y[A+C]]<=B}function Pt(y,A,C,B,ee){var se=y[A-3*C],le=y[A-2*C],he=y[A-C],xe=y[A+0],we=y[A+C],Le=y[A+2*C],Je=y[A+3*C];return 4*Ba[255+he-xe]+Ba[255+le-we]>B?0:Ba[255+y[A-4*C]-se]<=ee&&Ba[255+se-le]<=ee&&Ba[255+le-he]<=ee&&Ba[255+Je-Le]<=ee&&Ba[255+Le-we]<=ee&&Ba[255+we-xe]<=ee}function Jt(y,A,C,B){var ee=2*B+1;for(B=0;16>B;++B)nt(y,A+B,C,ee)&&He(y,A+B,C)}function Dt(y,A,C,B){var ee=2*B+1;for(B=0;16>B;++B)nt(y,A+B*C,1,ee)&&He(y,A+B*C,1)}function Wt(y,A,C,B){var ee;for(ee=3;0<ee;--ee)Jt(y,A+=4*C,C,B)}function $t(y,A,C,B){var ee;for(ee=3;0<ee;--ee)Dt(y,A+=4,C,B)}function Xt(y,A,C,B,ee,se,le,he){for(se=2*se+1;0<ee--;){if(Pt(y,A,C,se,le))if(tt(y,A,C,he))He(y,A,C);else{var xe=y,we=A,Le=C,Je=xe[we-2*Le],Ze=xe[we-Le],Ie=xe[we+0],at=xe[we+Le],Ke=xe[we+2*Le],De=27*(mt=tu[1020+3*(Ie-Ze)+tu[1020+Je-at]])+63>>7,Re=18*mt+63>>7,mt=9*mt+63>>7;xe[we-3*Le]=Ls[255+xe[we-3*Le]+mt],xe[we-2*Le]=Ls[255+Je+Re],xe[we-Le]=Ls[255+Ze+De],xe[we+0]=Ls[255+Ie-De],xe[we+Le]=Ls[255+at-Re],xe[we+2*Le]=Ls[255+Ke-mt]}A+=B}}function lr(y,A,C,B,ee,se,le,he){for(se=2*se+1;0<ee--;){if(Pt(y,A,C,se,le))if(tt(y,A,C,he))He(y,A,C);else{var xe=y,we=A,Le=C,Je=xe[we-Le],Ze=xe[we+0],Ie=xe[we+Le],at=Uo[112+((Ke=3*(Ze-Je))+4>>3)],Ke=Uo[112+(Ke+3>>3)],De=at+1>>1;xe[we-2*Le]=Ls[255+xe[we-2*Le]+De],xe[we-Le]=Ls[255+Je+Ke],xe[we+0]=Ls[255+Ze-at],xe[we+Le]=Ls[255+Ie-De]}A+=B}}function la(y,A,C,B,ee,se){Xt(y,A,C,1,16,B,ee,se)}function Er(y,A,C,B,ee,se){Xt(y,A,1,C,16,B,ee,se)}function Ga(y,A,C,B,ee,se){var le;for(le=3;0<le;--le)lr(y,A+=4*C,C,1,16,B,ee,se)}function vn(y,A,C,B,ee,se){var le;for(le=3;0<le;--le)lr(y,A+=4,1,C,16,B,ee,se)}function es(y,A,C,B,ee,se,le,he){Xt(y,A,ee,1,8,se,le,he),Xt(C,B,ee,1,8,se,le,he)}function Pn(y,A,C,B,ee,se,le,he){Xt(y,A,1,ee,8,se,le,he),Xt(C,B,1,ee,8,se,le,he)}function yn(y,A,C,B,ee,se,le,he){lr(y,A+4*ee,ee,1,8,se,le,he),lr(C,B+4*ee,ee,1,8,se,le,he)}function js(y,A,C,B,ee,se,le,he){lr(y,A+4,1,ee,8,se,le,he),lr(C,B+4,1,ee,8,se,le,he)}function ts(){this.ba=new Ja,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Br,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Hn(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function Cs(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Ds(){this.ua=0,this.Wa=new de,this.vb=new de,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new K,this.yc=new F}function Fo(){this.xb=this.a=0,this.l=new Pr,this.ca=new Ja,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new D,this.Pb=0,this.wd=new D,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Ds,this.ab=0,this.gc=o(4,Cs),this.Oc=0}function oo(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Pr,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function lo(y,A,C,B,ee,se,le){for(y=y==null?0:y[A+0],A=0;A<le;++A)ee[se+A]=y+C[B+A]&255,y=ee[se+A]}function Po(y,A,C,B,ee,se,le){var he;if(y==null)lo(null,null,C,B,ee,se,le);else for(he=0;he<le;++he)ee[se+he]=y[A+he]+C[B+he]&255}function wl(y,A,C,B,ee,se,le){if(y==null)lo(null,null,C,B,ee,se,le);else{var he,xe=y[A+0],we=xe,Le=xe;for(he=0;he<le;++he)we=Le+(xe=y[A+he])-we,Le=C[B+he]+(-256&we?0>we?0:255:we)&255,we=xe,ee[se+he]=Le}}function Xu(y,A,C,B){var ee=A.width,se=A.o;if(t(y!=null&&A!=null),0>C||0>=B||C+B>se)return null;if(!y.Cc){if(y.ga==null){var le;if(y.ga=new oo,(le=y.ga==null)||(le=A.width*A.o,t(y.Gb.length==0),y.Gb=s(le),y.Uc=0,y.Gb==null?le=0:(y.mb=y.Gb,y.nb=y.Uc,y.rc=null,le=1),le=!le),!le){le=y.ga;var he=y.Fa,xe=y.P,we=y.qc,Le=y.mb,Je=y.nb,Ze=xe+1,Ie=we-1,at=le.l;if(t(he!=null&&Le!=null&&A!=null),Ai[0]=null,Ai[1]=lo,Ai[2]=Po,Ai[3]=wl,le.ca=Le,le.tb=Je,le.c=A.width,le.i=A.height,t(0<le.c&&0<le.i),1>=we)A=0;else if(le.$a=he[xe+0]>>0&3,le.Z=he[xe+0]>>2&3,le.Lc=he[xe+0]>>4&3,xe=he[xe+0]>>6&3,0>le.$a||1<le.$a||4<=le.Z||1<le.Lc||xe)A=0;else if(at.put=Ea,at.ac=ka,at.bc=gn,at.ma=le,at.width=A.width,at.height=A.height,at.Da=A.Da,at.v=A.v,at.va=A.va,at.j=A.j,at.o=A.o,le.$a)e:{t(le.$a==1),A=lt();t:for(;;){if(A==null){A=0;break e}if(t(le!=null),le.mc=A,A.c=le.c,A.i=le.i,A.l=le.l,A.l.ma=le,A.l.width=le.c,A.l.height=le.i,A.a=0,te(A.m,he,Ze,Ie),!We(le.c,le.i,1,A,null)||(A.ab==1&&A.gc[0].hc==3&&pe(A.s)?(le.ic=1,he=A.c*A.i,A.Ta=null,A.Ua=0,A.V=s(he),A.Ba=0,A.V==null?(A.a=1,A=0):A=1):(le.ic=0,A=$e(A,le.c)),!A))break t;A=1;break e}le.mc=null,A=0}else A=Ie>=le.c*le.i;le=!A}if(le)return null;y.ga.Lc!=1?y.Ga=0:B=se-C}t(y.ga!=null),t(C+B<=se);e:{if(A=(he=y.ga).c,se=he.l.o,he.$a==0){if(Ze=y.rc,Ie=y.Vc,at=y.Fa,xe=y.P+1+C*A,we=y.mb,Le=y.nb+C*A,t(xe<=y.P+y.qc),he.Z!=0)for(t(Ai[he.Z]!=null),le=0;le<B;++le)Ai[he.Z](Ze,Ie,at,xe,we,Le,A),Ze=we,Ie=Le,Le+=A,xe+=A;else for(le=0;le<B;++le)a(we,Le,at,xe,A),Ze=we,Ie=Le,Le+=A,xe+=A;y.rc=Ze,y.Vc=Ie}else{if(t(he.mc!=null),A=C+B,t((le=he.mc)!=null),t(A<=le.i),le.C>=A)A=1;else if(he.ic||qe(),he.ic){he=le.V,Ze=le.Ba,Ie=le.c;var Ke=le.i,De=(at=1,xe=le.$/Ie,we=le.$%Ie,Le=le.m,Je=le.s,le.$),Re=Ie*Ke,mt=Ie*A,yt=Je.wc,gt=De<mt?ha(Je,we,xe):null;t(De<=Re),t(A<=Ke),t(pe(Je));t:for(;;){for(;!Le.h&&De<mt;){if(we&yt||(gt=ha(Je,we,xe)),t(gt!=null),oe(Le),256>(Ke=qa(gt.G[0],gt.H[0],Le)))he[Ze+De]=Ke,++De,++we>=Ie&&(we=0,++xe<=A&&!(xe%16)&&Se(le,xe));else{if(!(280>Ke)){at=0;break t}Ke=Un(Ke-256,Le);var Vt,Rt=qa(gt.G[4],gt.H[4],Le);if(oe(Le),!(De>=(Rt=Vr(Ie,Rt=Un(Rt,Le)))&&Re-De>=Ke)){at=0;break t}for(Vt=0;Vt<Ke;++Vt)he[Ze+De+Vt]=he[Ze+De+Vt-Rt];for(De+=Ke,we+=Ke;we>=Ie;)we-=Ie,++xe<=A&&!(xe%16)&&Se(le,xe);De<mt&&we&yt&&(gt=ha(Je,we,xe))}t(Le.h==L(Le))}Se(le,xe>A?A:xe);break t}!at||Le.h&&De<Re?(at=0,le.a=Le.h?5:3):le.$=De,A=at}else A=_e(le,le.V,le.Ba,le.c,le.i,A,Qe);if(!A){B=0;break e}}C+B>=se&&(y.Cc=1),B=1}if(!B)return null;if(y.Cc&&((B=y.ga)!=null&&(B.mc=null),y.ga=null,0<y.Ga))return alert("todo:WebPDequantizeLevels"),null}return y.nb+C*ee}function k(y,A,C,B,ee,se){for(;0<ee--;){var le,he=y,xe=A+(C?1:0),we=y,Le=A+(C?0:3);for(le=0;le<B;++le){var Je=we[Le+4*le];Je!=255&&(Je*=32897,he[xe+4*le+0]=he[xe+4*le+0]*Je>>23,he[xe+4*le+1]=he[xe+4*le+1]*Je>>23,he[xe+4*le+2]=he[xe+4*le+2]*Je>>23)}A+=se}}function ae(y,A,C,B,ee){for(;0<B--;){var se;for(se=0;se<C;++se){var le=y[A+2*se+0],he=15&(we=y[A+2*se+1]),xe=4369*he,we=(240&we|we>>4)*xe>>16;y[A+2*se+0]=(240&le|le>>4)*xe>>16&240|(15&le|le<<4)*xe>>16>>4&15,y[A+2*se+1]=240&we|he}A+=ee}}function Te(y,A,C,B,ee,se,le,he){var xe,we,Le=255;for(we=0;we<ee;++we){for(xe=0;xe<B;++xe){var Je=y[A+xe];se[le+4*xe]=Je,Le&=Je}A+=C,le+=he}return Le!=255}function Fe(y,A,C,B,ee){var se;for(se=0;se<ee;++se)C[B+se]=y[A+se]>>8}function qe(){Wa=k,Lr=ae,ea=Te,Ia=Fe}function ft(y,A,C){z[y]=function(B,ee,se,le,he,xe,we,Le,Je,Ze,Ie,at,Ke,De,Re,mt,yt){var gt,Vt=yt-1>>1,Rt=he[xe+0]|we[Le+0]<<16,fr=Je[Ze+0]|Ie[at+0]<<16;t(B!=null);var Et=3*Rt+fr+131074>>2;for(A(B[ee+0],255&Et,Et>>16,Ke,De),se!=null&&(Et=3*fr+Rt+131074>>2,A(se[le+0],255&Et,Et>>16,Re,mt)),gt=1;gt<=Vt;++gt){var Yr=he[xe+gt]|we[Le+gt]<<16,ta=Je[Ze+gt]|Ie[at+gt]<<16,$r=Rt+Yr+fr+ta+524296,Or=$r+2*(Yr+fr)>>3;Et=Or+Rt>>1,Rt=($r=$r+2*(Rt+ta)>>3)+Yr>>1,A(B[ee+2*gt-1],255&Et,Et>>16,Ke,De+(2*gt-1)*C),A(B[ee+2*gt-0],255&Rt,Rt>>16,Ke,De+(2*gt-0)*C),se!=null&&(Et=$r+fr>>1,Rt=Or+ta>>1,A(se[le+2*gt-1],255&Et,Et>>16,Re,mt+(2*gt-1)*C),A(se[le+2*gt+0],255&Rt,Rt>>16,Re,mt+(2*gt+0)*C)),Rt=Yr,fr=ta}1&yt||(Et=3*Rt+fr+131074>>2,A(B[ee+yt-1],255&Et,Et>>16,Ke,De+(yt-1)*C),se!=null&&(Et=3*fr+Rt+131074>>2,A(se[le+yt-1],255&Et,Et>>16,Re,mt+(yt-1)*C)))}}function _t(){ms[zo]=nf,ms[Ho]=jh,ms[ef]=u0,ms[cc]=Ch,ms[ps]=Dl,ms[Os]=Dh,ms[Cl]=nu,ms[Mi]=jh,ms[Ii]=Ch,ms[co]=Dl,ms[l0]=Dh}function qt(y){return y&-16384?0>y?0:255:y>>_i}function tr(y,A){return qt((19077*y>>8)+(26149*A>>8)-14234)}function Ar(y,A,C){return qt((19077*y>>8)-(6419*A>>8)-(13320*C>>8)+8708)}function br(y,A){return qt((19077*y>>8)+(33050*A>>8)-17685)}function Gr(y,A,C,B,ee){B[ee+0]=tr(y,C),B[ee+1]=Ar(y,A,C),B[ee+2]=br(y,A)}function Ca(y,A,C,B,ee){B[ee+0]=br(y,A),B[ee+1]=Ar(y,A,C),B[ee+2]=tr(y,C)}function Ra(y,A,C,B,ee){var se=Ar(y,A,C);A=se<<3&224|br(y,A)>>3,B[ee+0]=248&tr(y,C)|se>>5,B[ee+1]=A}function Za(y,A,C,B,ee){var se=240&br(y,A)|15;B[ee+0]=240&tr(y,C)|Ar(y,A,C)>>4,B[ee+1]=se}function Qa(y,A,C,B,ee){B[ee+0]=255,Gr(y,A,C,B,ee+1)}function Ln(y,A,C,B,ee){Ca(y,A,C,B,ee),B[ee+3]=255}function Li(y,A,C,B,ee){Gr(y,A,C,B,ee),B[ee+3]=255}function ii(y,A){return 0>y?0:y>A?A:y}function Oi(y,A,C){z[y]=function(B,ee,se,le,he,xe,we,Le,Je){for(var Ze=Le+(-2&Je)*C;Le!=Ze;)A(B[ee+0],se[le+0],he[xe+0],we,Le),A(B[ee+1],se[le+0],he[xe+0],we,Le+C),ee+=2,++le,++xe,Le+=2*C;1&Je&&A(B[ee+0],se[le+0],he[xe+0],we,Le)}}function Yu(y,A,C){return C==0?y==0?A==0?6:5:A==0?4:0:C}function Lo(y,A,C,B,ee){switch(y>>>30){case 3:oi(A,C,B,ee,0);break;case 2:Ma(A,C,B,ee);break;case 1:en(A,C,B,ee)}}function Oo(y,A){var C,B,ee=A.M,se=A.Nb,le=y.oc,he=y.pc+40,xe=y.oc,we=y.pc+584,Le=y.oc,Je=y.pc+600;for(C=0;16>C;++C)le[he+32*C-1]=129;for(C=0;8>C;++C)xe[we+32*C-1]=129,Le[Je+32*C-1]=129;for(0<ee?le[he-1-32]=xe[we-1-32]=Le[Je-1-32]=129:(n(le,he-32-1,127,21),n(xe,we-32-1,127,9),n(Le,Je-32-1,127,9)),B=0;B<y.za;++B){var Ze=A.ya[A.aa+B];if(0<B){for(C=-1;16>C;++C)a(le,he+32*C-4,le,he+32*C+12,4);for(C=-1;8>C;++C)a(xe,we+32*C-4,xe,we+32*C+4,4),a(Le,Je+32*C-4,Le,Je+32*C+4,4)}var Ie=y.Gd,at=y.Hd+B,Ke=Ze.ad,De=Ze.Hc;if(0<ee&&(a(le,he-32,Ie[at].y,0,16),a(xe,we-32,Ie[at].f,0,8),a(Le,Je-32,Ie[at].ea,0,8)),Ze.Za){var Re=le,mt=he-32+16;for(0<ee&&(B>=y.za-1?n(Re,mt,Ie[at].y[15],4):a(Re,mt,Ie[at+1].y,0,4)),C=0;4>C;C++)Re[mt+128+C]=Re[mt+256+C]=Re[mt+384+C]=Re[mt+0+C];for(C=0;16>C;++C,De<<=2)Re=le,mt=he+Fp[C],Ni[Ze.Ob[C]](Re,mt),Lo(De,Ke,16*+C,Re,mt)}else if(Re=Yu(B,ee,Ze.Ob[0]),Ui[Re](le,he),De!=0)for(C=0;16>C;++C,De<<=2)Lo(De,Ke,16*+C,le,he+Fp[C]);for(C=Ze.Gc,Re=Yu(B,ee,Ze.Dd),ui[Re](xe,we),ui[Re](Le,Je),De=Ke,Re=xe,mt=we,255&(Ze=C>>0)&&(170&Ze?Zc(De,256,Re,mt):qn(De,256,Re,mt)),Ze=Le,De=Je,255&(C>>=8)&&(170&C?Zc(Ke,320,Ze,De):qn(Ke,320,Ze,De)),ee<y.Ub-1&&(a(Ie[at].y,0,le,he+480,16),a(Ie[at].f,0,xe,we+224,8),a(Ie[at].ea,0,Le,Je+224,8)),C=8*se*y.B,Ie=y.sa,at=y.ta+16*B+16*se*y.R,Ke=y.qa,Ze=y.ra+8*B+C,De=y.Ha,Re=y.Ia+8*B+C,C=0;16>C;++C)a(Ie,at+C*y.R,le,he+32*C,16);for(C=0;8>C;++C)a(Ke,Ze+C*y.B,xe,we+32*C,8),a(De,Re+C*y.B,Le,Je+32*C,8)}}function Yc(y,A,C,B,ee,se,le,he,xe){var we=[0],Le=[0],Je=0,Ze=xe!=null?xe.kd:0,Ie=xe??new Hn;if(y==null||12>C)return 7;Ie.data=y,Ie.w=A,Ie.ha=C,A=[A],C=[C],Ie.gb=[Ie.gb];e:{var at=A,Ke=C,De=Ie.gb;if(t(y!=null),t(Ke!=null),t(De!=null),De[0]=0,12<=Ke[0]&&!r(y,at[0],"RIFF")){if(r(y,at[0]+8,"WEBP")){De=3;break e}var Re=Pe(y,at[0]+4);if(12>Re||4294967286<Re){De=3;break e}if(Ze&&Re>Ke[0]-8){De=7;break e}De[0]=Re,at[0]+=12,Ke[0]-=12}De=0}if(De!=0)return De;for(Re=0<Ie.gb[0],C=C[0];;){e:{var mt=y;Ke=A,De=C;var yt=we,gt=Le,Vt=at=[0];if((Et=Je=[Je])[0]=0,8>De[0])De=7;else{if(!r(mt,Ke[0],"VP8X")){if(Pe(mt,Ke[0]+4)!=10){De=3;break e}if(18>De[0]){De=7;break e}var Rt=Pe(mt,Ke[0]+8),fr=1+J(mt,Ke[0]+12);if(2147483648<=fr*(mt=1+J(mt,Ke[0]+15))){De=3;break e}Vt!=null&&(Vt[0]=Rt),yt!=null&&(yt[0]=fr),gt!=null&&(gt[0]=mt),Ke[0]+=18,De[0]-=18,Et[0]=1}De=0}}if(Je=Je[0],at=at[0],De!=0)return De;if(Ke=!!(2&at),!Re&&Je)return 3;if(se!=null&&(se[0]=!!(16&at)),le!=null&&(le[0]=Ke),he!=null&&(he[0]=0),le=we[0],at=Le[0],Je&&Ke&&xe==null){De=0;break}if(4>C){De=7;break}if(Re&&Je||!Re&&!Je&&!r(y,A[0],"ALPH")){C=[C],Ie.na=[Ie.na],Ie.P=[Ie.P],Ie.Sa=[Ie.Sa];e:{Rt=y,De=A,Re=C;var Et=Ie.gb;yt=Ie.na,gt=Ie.P,Vt=Ie.Sa,fr=22,t(Rt!=null),t(Re!=null),mt=De[0];var Yr=Re[0];for(t(yt!=null),t(Vt!=null),yt[0]=null,gt[0]=null,Vt[0]=0;;){if(De[0]=mt,Re[0]=Yr,8>Yr){De=7;break e}var ta=Pe(Rt,mt+4);if(4294967286<ta){De=3;break e}var $r=8+ta+1&-2;if(fr+=$r,0<Et&&fr>Et){De=3;break e}if(!r(Rt,mt,"VP8 ")||!r(Rt,mt,"VP8L")){De=0;break e}if(Yr[0]<$r){De=7;break e}r(Rt,mt,"ALPH")||(yt[0]=Rt,gt[0]=mt+8,Vt[0]=ta),mt+=$r,Yr-=$r}}if(C=C[0],Ie.na=Ie.na[0],Ie.P=Ie.P[0],Ie.Sa=Ie.Sa[0],De!=0)break}C=[C],Ie.Ja=[Ie.Ja],Ie.xa=[Ie.xa];e:if(Et=y,De=A,Re=C,yt=Ie.gb[0],gt=Ie.Ja,Vt=Ie.xa,Rt=De[0],mt=!r(Et,Rt,"VP8 "),fr=!r(Et,Rt,"VP8L"),t(Et!=null),t(Re!=null),t(gt!=null),t(Vt!=null),8>Re[0])De=7;else{if(mt||fr){if(Et=Pe(Et,Rt+4),12<=yt&&Et>yt-12){De=3;break e}if(Ze&&Et>Re[0]-8){De=7;break e}gt[0]=Et,De[0]+=8,Re[0]-=8,Vt[0]=fr}else Vt[0]=5<=Re[0]&&Et[Rt+0]==47&&!(Et[Rt+4]>>5),gt[0]=Re[0];De=0}if(C=C[0],Ie.Ja=Ie.Ja[0],Ie.xa=Ie.xa[0],A=A[0],De!=0)break;if(4294967286<Ie.Ja)return 3;if(he==null||Ke||(he[0]=Ie.xa?2:1),le=[le],at=[at],Ie.xa){if(5>C){De=7;break}he=le,Ze=at,Ke=se,y==null||5>C?y=0:5<=C&&y[A+0]==47&&!(y[A+4]>>5)?(Re=[0],Et=[0],yt=[0],te(gt=new D,y,A,C),Qt(gt,Re,Et,yt)?(he!=null&&(he[0]=Re[0]),Ze!=null&&(Ze[0]=Et[0]),Ke!=null&&(Ke[0]=yt[0]),y=1):y=0):y=0}else{if(10>C){De=7;break}he=at,y==null||10>C||!Ur(y,A+3,C-3)?y=0:(Ze=y[A+0]|y[A+1]<<8|y[A+2]<<16,Ke=16383&(y[A+7]<<8|y[A+6]),y=16383&(y[A+9]<<8|y[A+8]),1&Ze||3<(Ze>>1&7)||!(Ze>>4&1)||Ze>>5>=Ie.Ja||!Ke||!y?y=0:(le&&(le[0]=Ke),he&&(he[0]=y),y=1))}if(!y||(le=le[0],at=at[0],Je&&(we[0]!=le||Le[0]!=at)))return 3;xe!=null&&(xe[0]=Ie,xe.offset=A-xe.w,t(4294967286>A-xe.w),t(xe.offset==xe.ha-C));break}return De==0||De==7&&Je&&xe==null?(se!=null&&(se[0]|=Ie.na!=null&&0<Ie.na.length),B!=null&&(B[0]=le),ee!=null&&(ee[0]=at),0):De}function bl(y,A,C){var B=A.width,ee=A.height,se=0,le=0,he=B,xe=ee;if(A.Da=y!=null&&0<y.Da,A.Da&&(he=y.cd,xe=y.bd,se=y.v,le=y.j,11>C||(se&=-2,le&=-2),0>se||0>le||0>=he||0>=xe||se+he>B||le+xe>ee))return 0;if(A.v=se,A.j=le,A.va=se+he,A.o=le+xe,A.U=he,A.T=xe,A.da=y!=null&&0<y.da,A.da){if(!rt(he,xe,C=[y.ib],se=[y.hb]))return 0;A.ib=C[0],A.hb=se[0]}return A.ob=y!=null&&y.ob,A.Kb=y==null||!y.Sd,A.da&&(A.ob=A.ib<3*B/4&&A.hb<3*ee/4,A.Kb=0),1}function Jc(y){if(y==null)return 2;if(11>y.S){var A=y.f.RGBA;A.fb+=(y.height-1)*A.A,A.A=-A.A}else A=y.f.kb,y=y.height,A.O+=(y-1)*A.fa,A.fa=-A.fa,A.N+=(y-1>>1)*A.Ab,A.Ab=-A.Ab,A.W+=(y-1>>1)*A.Db,A.Db=-A.Db,A.F!=null&&(A.J+=(y-1)*A.lb,A.lb=-A.lb);return 0}function ac(y,A,C,B){if(B==null||0>=y||0>=A)return 2;if(C!=null){if(C.Da){var ee=C.cd,se=C.bd,le=-2&C.v,he=-2&C.j;if(0>le||0>he||0>=ee||0>=se||le+ee>y||he+se>A)return 2;y=ee,A=se}if(C.da){if(!rt(y,A,ee=[C.ib],se=[C.hb]))return 2;y=ee[0],A=se[0]}}B.width=y,B.height=A;e:{var xe=B.width,we=B.height;if(y=B.S,0>=xe||0>=we||!(y>=zo&&13>y))y=2;else{if(0>=B.Rd&&B.sd==null){le=se=ee=A=0;var Le=(he=xe*d0[y])*we;if(11>y||(se=(we+1)/2*(A=(xe+1)/2),y==12&&(le=(ee=xe)*we)),(we=s(Le+2*se+le))==null){y=1;break e}B.sd=we,11>y?((xe=B.f.RGBA).eb=we,xe.fb=0,xe.A=he,xe.size=Le):((xe=B.f.kb).y=we,xe.O=0,xe.fa=he,xe.Fd=Le,xe.f=we,xe.N=0+Le,xe.Ab=A,xe.Cd=se,xe.ea=we,xe.W=0+Le+se,xe.Db=A,xe.Ed=se,y==12&&(xe.F=we,xe.J=0+Le+2*se),xe.Tc=le,xe.lb=ee)}if(A=1,ee=B.S,se=B.width,le=B.height,ee>=zo&&13>ee)if(11>ee)y=B.f.RGBA,A&=(he=Math.abs(y.A))*(le-1)+se<=y.size,A&=he>=se*d0[ee],A&=y.eb!=null;else{y=B.f.kb,he=(se+1)/2,Le=(le+1)/2,xe=Math.abs(y.fa),we=Math.abs(y.Ab);var Je=Math.abs(y.Db),Ze=Math.abs(y.lb),Ie=Ze*(le-1)+se;A&=xe*(le-1)+se<=y.Fd,A&=we*(Le-1)+he<=y.Cd,A=(A&=Je*(Le-1)+he<=y.Ed)&xe>=se&we>=he&Je>=he,A&=y.y!=null,A&=y.f!=null,A&=y.ea!=null,ee==12&&(A&=Ze>=se,A&=Ie<=y.Tc,A&=y.F!=null)}else A=0;y=A?0:2}}return y!=0||C!=null&&C.fd&&(y=Jc(B)),y}var wn=64,Sl=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],nc=24,sc=32,Kc=8,Fs=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];ot("Predictor0","PredictorAdd0"),z.Predictor0=function(){return 4278190080},z.Predictor1=function(y){return y},z.Predictor2=function(y,A,C){return A[C+0]},z.Predictor3=function(y,A,C){return A[C+1]},z.Predictor4=function(y,A,C){return A[C-1]},z.Predictor5=function(y,A,C){return vt(vt(y,A[C+1]),A[C+0])},z.Predictor6=function(y,A,C){return vt(y,A[C-1])},z.Predictor7=function(y,A,C){return vt(y,A[C+0])},z.Predictor8=function(y,A,C){return vt(A[C-1],A[C+0])},z.Predictor9=function(y,A,C){return vt(A[C+0],A[C+1])},z.Predictor10=function(y,A,C){return vt(vt(y,A[C-1]),vt(A[C+0],A[C+1]))},z.Predictor11=function(y,A,C){var B=A[C+0];return 0>=ze(B>>24&255,y>>24&255,(A=A[C-1])>>24&255)+ze(B>>16&255,y>>16&255,A>>16&255)+ze(B>>8&255,y>>8&255,A>>8&255)+ze(255&B,255&y,255&A)?B:y},z.Predictor12=function(y,A,C){var B=A[C+0];return(At((y>>24&255)+(B>>24&255)-((A=A[C-1])>>24&255))<<24|At((y>>16&255)+(B>>16&255)-(A>>16&255))<<16|At((y>>8&255)+(B>>8&255)-(A>>8&255))<<8|At((255&y)+(255&B)-(255&A)))>>>0},z.Predictor13=function(y,A,C){var B=A[C-1];return(ct((y=vt(y,A[C+0]))>>24&255,B>>24&255)<<24|ct(y>>16&255,B>>16&255)<<16|ct(y>>8&255,B>>8&255)<<8|ct(y>>0&255,B>>0&255))>>>0};var Ah=z.PredictorAdd0;z.PredictorAdd1=pt,ot("Predictor2","PredictorAdd2"),ot("Predictor3","PredictorAdd3"),ot("Predictor4","PredictorAdd4"),ot("Predictor5","PredictorAdd5"),ot("Predictor6","PredictorAdd6"),ot("Predictor7","PredictorAdd7"),ot("Predictor8","PredictorAdd8"),ot("Predictor9","PredictorAdd9"),ot("Predictor10","PredictorAdd10"),ot("Predictor11","PredictorAdd11"),ot("Predictor12","PredictorAdd12"),ot("Predictor13","PredictorAdd13");var Ju=z.PredictorAdd2;Ct("ColorIndexInverseTransform","MapARGB","32b",function(y){return y>>8&255},function(y){return y}),Ct("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(y){return y},function(y){return y>>8&255});var o0,bi=z.ColorIndexInverseTransform,On=z.MapARGB,Nl=z.VP8LColorIndexInverseTransformAlpha,Ku=z.MapAlpha,Ro=z.VP8LPredictorsAdd=[];Ro.length=16,(z.VP8LPredictors=[]).length=16,(z.VP8LPredictorsAdd_C=[]).length=16,(z.VP8LPredictors_C=[]).length=16;var Al,ds,Vn,_l,Mo,Ps,Tl,oi,Ma,Zc,en,qn,kl,Zu,Ri,El,jl,Io,ic,Qc,oc,Bo,eu,li,Wa,Lr,ea,Ia,$a=s(511),Si=s(2041),lc=s(225),ci=s(767),Qu=0,tu=Si,Uo=lc,Ls=ci,Ba=$a,zo=0,Ho=1,ef=2,cc=3,ps=4,Os=5,Cl=6,Mi=7,Ii=8,co=9,l0=10,_h=[2,3,7],Th=[3,3,11],rs=[280,256,256,256,40],Gn=[0,1,1,1,0],Zr=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],Bi=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],uo=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],kh=8,Vo=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],c0=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],ru=null,tf=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],rf=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],au=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],af=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],Ep=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],Eh=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],jp=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Ui=[],Ni=[],ui=[],Cp=1,uc=2,Ai=[],ms=[];ft("UpsampleRgbLinePair",Gr,3),ft("UpsampleBgrLinePair",Ca,3),ft("UpsampleRgbaLinePair",Li,4),ft("UpsampleBgraLinePair",Ln,4),ft("UpsampleArgbLinePair",Qa,4),ft("UpsampleRgba4444LinePair",Za,2),ft("UpsampleRgb565LinePair",Ra,2);var nf=z.UpsampleRgbLinePair,u0=z.UpsampleBgrLinePair,jh=z.UpsampleRgbaLinePair,Ch=z.UpsampleBgraLinePair,Dl=z.UpsampleArgbLinePair,Dh=z.UpsampleRgba4444LinePair,nu=z.UpsampleRgb565LinePair,fc=16,sf=1<<fc-1,hc=-227,of=482,_i=6,zi=0,Fl=s(256),Dp=s(256),Pl=s(256),qo=s(256),bn=s(of-hc),f0=s(of-hc);Oi("YuvToRgbRow",Gr,3),Oi("YuvToBgrRow",Ca,3),Oi("YuvToRgbaRow",Li,4),Oi("YuvToBgraRow",Ln,4),Oi("YuvToArgbRow",Qa,4),Oi("YuvToRgba4444Row",Za,2),Oi("YuvToRgb565Row",Ra,2);var Fp=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],h0=[0,2,8],sx=[8,7,6,4,4,2,2,2,1,1,1,1],Sn=1;this.WebPDecodeRGBA=function(y,A,C,B,ee){var se=Ho,le=new ts,he=new Ja;le.ba=he,he.S=se,he.width=[he.width],he.height=[he.height];var xe=he.width,we=he.height,Le=new Dn;if(Le==null||y==null)var Je=2;else t(Le!=null),Je=Yc(y,A,C,Le.width,Le.height,Le.Pd,Le.Qd,Le.format,null);if(Je!=0?xe=0:(xe!=null&&(xe[0]=Le.width[0]),we!=null&&(we[0]=Le.height[0]),xe=1),xe){he.width=he.width[0],he.height=he.height[0],B!=null&&(B[0]=he.width),ee!=null&&(ee[0]=he.height);e:{if(B=new Pr,(ee=new Hn).data=y,ee.w=A,ee.ha=C,ee.kd=1,A=[0],t(ee!=null),((y=Yc(ee.data,ee.w,ee.ha,null,null,null,A,null,ee))==0||y==7)&&A[0]&&(y=4),(A=y)==0){if(t(le!=null),B.data=ee.data,B.w=ee.w+ee.offset,B.ha=ee.ha-ee.offset,B.put=Ea,B.ac=ka,B.bc=gn,B.ma=le,ee.xa){if((y=lt())==null){le=1;break e}if(function(Ze,Ie){var at=[0],Ke=[0],De=[0];t:for(;;){if(Ze==null)return 0;if(Ie==null)return Ze.a=2,0;if(Ze.l=Ie,Ze.a=0,te(Ze.m,Ie.data,Ie.w,Ie.ha),!Qt(Ze.m,at,Ke,De)){Ze.a=3;break t}if(Ze.xb=uc,Ie.width=at[0],Ie.height=Ke[0],!We(at[0],Ke[0],1,Ze,null))break t;return 1}return t(Ze.a!=0),0}(y,B)){if(B=(A=ac(B.width,B.height,le.Oa,le.ba))==0){t:{B=y;r:for(;;){if(B==null){B=0;break t}if(t(B.s.yc!=null),t(B.s.Ya!=null),t(0<B.s.Wb),t((C=B.l)!=null),t((ee=C.ma)!=null),B.xb!=0){if(B.ca=ee.ba,B.tb=ee.tb,t(B.ca!=null),!bl(ee.Oa,C,cc)){B.a=2;break r}if(!$e(B,C.width)||C.da)break r;if((C.da||Ir(B.ca.S))&&qe(),11>B.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),B.ca.f.kb.F!=null&&qe()),B.Pb&&0<B.s.ua&&B.s.vb.X==null&&!st(B.s.vb,B.s.Wa.Xa)){B.a=1;break r}B.xb=0}if(!_e(B,B.V,B.Ba,B.c,B.i,C.o,Ne))break r;ee.Dc=B.Ma,B=1;break t}t(B.a!=0),B=0}B=!B}B&&(A=y.a)}else A=y.a}else{if((y=new er)==null){le=1;break e}if(y.Fa=ee.na,y.P=ee.P,y.qc=ee.Sa,ja(y,B)){if((A=ac(B.width,B.height,le.Oa,le.ba))==0){if(y.Aa=0,C=le.Oa,t((ee=y)!=null),C!=null){if(0<(xe=0>(xe=C.Md)?0:100<xe?255:255*xe/100)){for(we=Le=0;4>we;++we)12>(Je=ee.pb[we]).lc&&(Je.ia=xe*sx[0>Je.lc?0:Je.lc]>>3),Le|=Je.ia;Le&&(alert("todo:VP8InitRandom"),ee.ia=1)}ee.Ga=C.Id,100<ee.Ga?ee.Ga=100:0>ee.Ga&&(ee.Ga=0)}ti(y,B)||(A=y.a)}}else A=y.a}A==0&&le.Oa!=null&&le.Oa.fd&&(A=Jc(le.ba))}le=A}se=le!=0?null:11>se?he.f.RGBA.eb:he.f.kb.y}else se=null;return se};var d0=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function h(z,H){for(var re="",R=0;R<4;R++)re+=String.fromCharCode(z[H++]);return re}function p(z,H){return(z[H+0]<<0|z[H+1]<<8|z[H+2]<<16)>>>0}function x(z,H){return(z[H+0]<<0|z[H+1]<<8|z[H+2]<<16|z[H+3]<<24)>>>0}new u;var v=[0],g=[0],w=[],b=new u,N=e,_=function(z,H){var re={},R=0,F=!1,Y=0,K=0;if(re.frames=[],!function(O,L,q,oe){for(var be=0;be<oe;be++)if(O[L+be]!=q.charCodeAt(be))return!0;return!1}(z,H,"RIFF",4)){for(x(z,H+=4),H+=8;H<z.length;){var X=h(z,H),Z=x(z,H+=4);H+=4;var ce=Z+(1&Z);switch(X){case"VP8 ":case"VP8L":re.frames[R]===void 0&&(re.frames[R]={}),(G=re.frames[R]).src_off=F?K:H-8,G.src_size=Y+Z+8,R++,F&&(F=!1,Y=0,K=0);break;case"VP8X":(G=re.header={}).feature_flags=z[H];var te=H+4;G.canvas_width=1+p(z,te),te+=3,G.canvas_height=1+p(z,te),te+=3;break;case"ALPH":F=!0,Y=ce+8,K=H-8;break;case"ANIM":(G=re.header).bgcolor=x(z,H),te=H+4,G.loop_count=(ye=z)[(D=te)+0]<<0|ye[D+1]<<8,te+=2;break;case"ANMF":var Q,G;(G=re.frames[R]={}).offset_x=2*p(z,H),H+=3,G.offset_y=2*p(z,H),H+=3,G.width=1+p(z,H),H+=3,G.height=1+p(z,H),H+=3,G.duration=p(z,H),H+=3,Q=z[H++],G.dispose=1&Q,G.blend=Q>>1&1}X!="ANMF"&&(H+=ce)}var ye,D;return re}}(N,0);_.response=N,_.rgbaoutput=!0,_.dataurl=!1;var E=_.header?_.header:null,j=_.frames?_.frames:null;if(E){E.loop_counter=E.loop_count,v=[E.canvas_height],g=[E.canvas_width];for(var M=0;M<j.length&&j[M].blend!=0;M++);}var U=j[0],V=b.WebPDecodeRGBA(N,U.src_off,U.src_size,g,v);U.rgba=V,U.imgwidth=g[0],U.imgheight=v[0];for(var I=0;I<g[0]*v[0]*4;I++)w[I]=V[I];return this.width=g,this.height=v,this.data=w,this}(function(e){var t=function(){return typeof K2=="function"},r=function(v,g,w,b){var N=4,_=o;switch(b){case e.image_compression.FAST:N=1,_=s;break;case e.image_compression.MEDIUM:N=6,_=c;break;case e.image_compression.SLOW:N=9,_=u}v=a(v,g,w,_);var E=K2(v,{level:N});return e.__addimage__.arrayBufferToBinaryString(E)},a=function(v,g,w,b){for(var N,_,E,j=v.length/g,M=new Uint8Array(v.length+j),U=p(),V=0;V<j;V+=1){if(E=V*g,N=v.subarray(E,E+g),b)M.set(b(N,w,_),E+V);else{for(var I,z=U.length,H=[];I<z;I+=1)H[I]=U[I](N,w,_);var re=x(H.concat());M.set(H[re],E+V)}_=N}return M},n=function(v){var g=Array.apply([],v);return g.unshift(0),g},s=function(v,g){var w,b=[],N=v.length;b[0]=1;for(var _=0;_<N;_+=1)w=v[_-g]||0,b[_+1]=v[_]-w+256&255;return b},o=function(v,g,w){var b,N=[],_=v.length;N[0]=2;for(var E=0;E<_;E+=1)b=w&&w[E]||0,N[E+1]=v[E]-b+256&255;return N},c=function(v,g,w){var b,N,_=[],E=v.length;_[0]=3;for(var j=0;j<E;j+=1)b=v[j-g]||0,N=w&&w[j]||0,_[j+1]=v[j]+256-(b+N>>>1)&255;return _},u=function(v,g,w){var b,N,_,E,j=[],M=v.length;j[0]=4;for(var U=0;U<M;U+=1)b=v[U-g]||0,N=w&&w[U]||0,_=w&&w[U-g]||0,E=h(b,N,_),j[U+1]=v[U]-E+256&255;return j},h=function(v,g,w){if(v===g&&g===w)return v;var b=Math.abs(g-w),N=Math.abs(v-w),_=Math.abs(v+g-w-w);return b<=N&&b<=_?v:N<=_?g:w},p=function(){return[n,s,o,c,u]},x=function(v){var g=v.map(function(w){return w.reduce(function(b,N){return b+Math.abs(N)},0)});return g.indexOf(Math.min.apply(null,g))};e.processPNG=function(v,g,w,b){var N,_,E,j,M,U,V,I,z,H,re,R,F,Y,K,X=this.decode.FLATE_DECODE,Z="";if(this.__addimage__.isArrayBuffer(v)&&(v=new Uint8Array(v)),this.__addimage__.isArrayBufferView(v)){if(v=(E=new UL(v)).imgData,_=E.bits,N=E.colorSpace,M=E.colors,[4,6].indexOf(E.colorType)!==-1){if(E.bits===8){z=(I=E.pixelBitlength==32?new Uint32Array(E.decodePixels().buffer):E.pixelBitlength==16?new Uint16Array(E.decodePixels().buffer):new Uint8Array(E.decodePixels().buffer)).length,re=new Uint8Array(z*E.colors),H=new Uint8Array(z);var ce,te=E.pixelBitlength-E.bits;for(Y=0,K=0;Y<z;Y++){for(F=I[Y],ce=0;ce<te;)re[K++]=F>>>ce&255,ce+=E.bits;H[Y]=F>>>ce&255}}if(E.bits===16){z=(I=new Uint32Array(E.decodePixels().buffer)).length,re=new Uint8Array(z*(32/E.pixelBitlength)*E.colors),H=new Uint8Array(z*(32/E.pixelBitlength)),R=E.colors>1,Y=0,K=0;for(var Q=0;Y<z;)F=I[Y++],re[K++]=F>>>0&255,R&&(re[K++]=F>>>16&255,F=I[Y++],re[K++]=F>>>0&255),H[Q++]=F>>>16&255;_=8}b!==e.image_compression.NONE&&t()?(v=r(re,E.width*E.colors,E.colors,b),V=r(H,E.width,1,b)):(v=re,V=H,X=void 0)}if(E.colorType===3&&(N=this.color_spaces.INDEXED,U=E.palette,E.transparency.indexed)){var G=E.transparency.indexed,ye=0;for(Y=0,z=G.length;Y<z;++Y)ye+=G[Y];if((ye/=255)===z-1&&G.indexOf(0)!==-1)j=[G.indexOf(0)];else if(ye!==z){for(I=E.decodePixels(),H=new Uint8Array(I.length),Y=0,z=I.length;Y<z;Y++)H[Y]=G[I[Y]];V=r(H,E.width,1)}}var D=function(O){var L;switch(O){case e.image_compression.FAST:L=11;break;case e.image_compression.MEDIUM:L=13;break;case e.image_compression.SLOW:L=14;break;default:L=12}return L}(b);return X===this.decode.FLATE_DECODE&&(Z="/Predictor "+D+" "),Z+="/Colors "+M+" /BitsPerComponent "+_+" /Columns "+E.width,(this.__addimage__.isArrayBuffer(v)||this.__addimage__.isArrayBufferView(v))&&(v=this.__addimage__.arrayBufferToBinaryString(v)),(V&&this.__addimage__.isArrayBuffer(V)||this.__addimage__.isArrayBufferView(V))&&(V=this.__addimage__.arrayBufferToBinaryString(V)),{alias:w,data:v,index:g,filter:X,decodeParameters:Z,transparency:j,palette:U,sMask:V,predictor:D,width:E.width,height:E.height,bitsPerComponent:_,colorSpace:N}}}})(dr.API),function(e){e.processGIF89A=function(t,r,a,n){var s=new zL(t),o=s.width,c=s.height,u=[];s.decodeAndBlitFrameRGBA(0,u);var h={data:u,width:o,height:c},p=new Zg(100).encode(h,100);return e.processJPEG.call(this,p,r,a,n)},e.processGIF87A=e.processGIF89A}(dr.API),el.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var r=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:n,green:a,blue:r,quad:s}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},el.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[e]()}catch(r){Ta.log("bit decode error:"+r)}},el.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),r=t%4;for(e=this.height-1;e>=0;e--){for(var a=this.bottom_up?e:this.height-1-e,n=0;n<t;n++)for(var s=this.datav.getUint8(this.pos++,!0),o=a*this.width*4+8*n*4,c=0;c<8&&8*n+c<this.width;c++){var u=this.palette[s>>7-c&1];this.data[o+4*c]=u.blue,this.data[o+4*c+1]=u.green,this.data[o+4*c+2]=u.red,this.data[o+4*c+3]=255}r!==0&&(this.pos+=4-r)}},el.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,r=this.height-1;r>=0;r--){for(var a=this.bottom_up?r:this.height-1-r,n=0;n<e;n++){var s=this.datav.getUint8(this.pos++,!0),o=a*this.width*4+2*n*4,c=s>>4,u=15&s,h=this.palette[c];if(this.data[o]=h.blue,this.data[o+1]=h.green,this.data[o+2]=h.red,this.data[o+3]=255,2*n+1>=this.width)break;h=this.palette[u],this.data[o+4]=h.blue,this.data[o+4+1]=h.green,this.data[o+4+2]=h.red,this.data[o+4+3]=255}t!==0&&(this.pos+=4-t)}},el.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,a=0;a<this.width;a++){var n=this.datav.getUint8(this.pos++,!0),s=r*this.width*4+4*a;if(n<this.palette.length){var o=this.palette[n];this.data[s]=o.red,this.data[s+1]=o.green,this.data[s+2]=o.blue,this.data[s+3]=255}else this.data[s]=255,this.data[s+1]=255,this.data[s+2]=255,this.data[s+3]=255}e!==0&&(this.pos+=4-e)}},el.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var a=this.bottom_up?r:this.height-1-r,n=0;n<this.width;n++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(s&t)/t*255|0,c=(s>>5&t)/t*255|0,u=(s>>10&t)/t*255|0,h=s>>15?255:0,p=a*this.width*4+4*n;this.data[p]=u,this.data[p+1]=c,this.data[p+2]=o,this.data[p+3]=h}this.pos+=e}},el.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),r=parseInt("111111",2),a=this.height-1;a>=0;a--){for(var n=this.bottom_up?a:this.height-1-a,s=0;s<this.width;s++){var o=this.datav.getUint16(this.pos,!0);this.pos+=2;var c=(o&t)/t*255|0,u=(o>>5&r)/r*255|0,h=(o>>11)/t*255|0,p=n*this.width*4+4*s;this.data[p]=h,this.data[p+1]=u,this.data[p+2]=c,this.data[p+3]=255}this.pos+=e}},el.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var a=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*r;this.data[o]=s,this.data[o+1]=n,this.data[o+2]=a,this.data[o+3]=255}this.pos+=this.width%4}},el.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var a=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=this.datav.getUint8(this.pos++,!0),c=t*this.width*4+4*r;this.data[c]=s,this.data[c+1]=n,this.data[c+2]=a,this.data[c+3]=o}},el.prototype.getData=function(){return this.data},function(e){e.processBMP=function(t,r,a,n){var s=new el(t,!1),o=s.width,c=s.height,u={data:s.getData(),width:o,height:c},h=new Zg(100).encode(u,100);return e.processJPEG.call(this,h,r,a,n)}}(dr.API),o3.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(t,r,a,n){var s=new o3(t),o=s.width,c=s.height,u={data:s.getData(),width:o,height:c},h=new Zg(100).encode(u,100);return e.processJPEG.call(this,h,r,a,n)}}(dr.API),dr.API.processRGBA=function(e,t,r){for(var a=e.data,n=a.length,s=new Uint8Array(n/4*3),o=new Uint8Array(n/4),c=0,u=0,h=0;h<n;h+=4){var p=a[h],x=a[h+1],v=a[h+2],g=a[h+3];s[c++]=p,s[c++]=x,s[c++]=v,o[u++]=g}var w=this.__addimage__.arrayBufferToBinaryString(s);return{alpha:this.__addimage__.arrayBufferToBinaryString(o),data:w,index:t,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},dr.API.setLanguage=function(e){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]!==void 0&&(this.internal.languageSettings.languageCode=e,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},B0=dr.API,Cm=B0.getCharWidthsArray=function(e,t){var r,a,n=(t=t||{}).font||this.internal.getFont(),s=t.fontSize||this.internal.getFontSize(),o=t.charSpace||this.internal.getCharSpace(),c=t.widths?t.widths:n.metadata.Unicode.widths,u=c.fof?c.fof:1,h=t.kerning?t.kerning:n.metadata.Unicode.kerning,p=h.fof?h.fof:1,x=t.doKerning!==!1,v=0,g=e.length,w=0,b=c[0]||u,N=[];for(r=0;r<g;r++)a=e.charCodeAt(r),typeof n.metadata.widthOfString=="function"?N.push((n.metadata.widthOfGlyph(n.metadata.characterToGlyph(a))+o*(1e3/s)||0)/1e3):(v=x&&va(h[a])==="object"&&!isNaN(parseInt(h[a][w],10))?h[a][w]/p:0,N.push((c[a]||b)/u+v)),w=a;return N},a3=B0.getStringUnitWidth=function(e,t){var r=(t=t||{}).fontSize||this.internal.getFontSize(),a=t.font||this.internal.getFont(),n=t.charSpace||this.internal.getCharSpace();return B0.processArabic&&(e=B0.processArabic(e)),typeof a.metadata.widthOfString=="function"?a.metadata.widthOfString(e,r,n)/r:Cm.apply(this,arguments).reduce(function(s,o){return s+o},0)},n3=function(e,t,r,a){for(var n=[],s=0,o=e.length,c=0;s!==o&&c+t[s]<r;)c+=t[s],s++;n.push(e.slice(0,s));var u=s;for(c=0;s!==o;)c+t[s]>a&&(n.push(e.slice(u,s)),c=0,u=s),c+=t[s],s++;return u!==s&&n.push(e.slice(u,s)),n},s3=function(e,t,r){r||(r={});var a,n,s,o,c,u,h,p=[],x=[p],v=r.textIndent||0,g=0,w=0,b=e.split(" "),N=Cm.apply(this,[" ",r])[0];if(u=r.lineIndent===-1?b[0].length+2:r.lineIndent||0){var _=Array(u).join(" "),E=[];b.map(function(M){(M=M.split(/\s*\n/)).length>1?E=E.concat(M.map(function(U,V){return(V&&U.length?`
`:"")+U})):E.push(M[0])}),b=E,u=a3.apply(this,[_,r])}for(s=0,o=b.length;s<o;s++){var j=0;if(a=b[s],u&&a[0]==`
`&&(a=a.substr(1),j=1),v+g+(w=(n=Cm.apply(this,[a,r])).reduce(function(M,U){return M+U},0))>t||j){if(w>t){for(c=n3.apply(this,[a,n,t-(v+g),t]),p.push(c.shift()),p=[c.pop()];c.length;)x.push([c.shift()]);w=n.slice(a.length-(p[0]?p[0].length:0)).reduce(function(M,U){return M+U},0)}else p=[a];x.push(p),v=w+u,g=N}else p.push(a),v+=g+w,g=N}return h=u?function(M,U){return(U?_:"")+M.join(" ")}:function(M){return M.join(" ")},x.map(h)},B0.splitTextToSize=function(e,t,r){var a,n=(r=r||{}).fontSize||this.internal.getFontSize(),s=(function(p){if(p.widths&&p.kerning)return{widths:p.widths,kerning:p.kerning};var x=this.internal.getFont(p.fontName,p.fontStyle);return x.metadata.Unicode?{widths:x.metadata.Unicode.widths||{0:1},kerning:x.metadata.Unicode.kerning||{}}:{font:x.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);a=Array.isArray(e)?e:String(e).split(/\r?\n/);var o=1*this.internal.scaleFactor*t/n;s.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/n:0,s.lineIndent=r.lineIndent;var c,u,h=[];for(c=0,u=a.length;c<u;c++)h=h.concat(s3.apply(this,[a[c],o,s]));return h},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var t="klmnopqrstuvwxyz",r={},a={},n=0;n<t.length;n++)r[t[n]]="0123456789abcdef"[n],a["0123456789abcdef"[n]]=t[n];var s=function(x){return"0x"+parseInt(x,10).toString(16)},o=e.__fontmetrics__.compress=function(x){var v,g,w,b,N=["{"];for(var _ in x){if(v=x[_],isNaN(parseInt(_,10))?g="'"+_+"'":(_=parseInt(_,10),g=(g=s(_).slice(2)).slice(0,-1)+a[g.slice(-1)]),typeof v=="number")v<0?(w=s(v).slice(3),b="-"):(w=s(v).slice(2),b=""),w=b+w.slice(0,-1)+a[w.slice(-1)];else{if(va(v)!=="object")throw new Error("Don't know what to do with value type "+va(v)+".");w=o(v)}N.push(g+w)}return N.push("}"),N.join("")},c=e.__fontmetrics__.uncompress=function(x){if(typeof x!="string")throw new Error("Invalid argument passed to uncompress.");for(var v,g,w,b,N={},_=1,E=N,j=[],M="",U="",V=x.length-1,I=1;I<V;I+=1)(b=x[I])=="'"?v?(w=v.join(""),v=void 0):v=[]:v?v.push(b):b=="{"?(j.push([E,w]),E={},w=void 0):b=="}"?((g=j.pop())[0][g[1]]=E,w=void 0,E=g[0]):b=="-"?_=-1:w===void 0?r.hasOwnProperty(b)?(M+=r[b],w=parseInt(M,16)*_,_=1,M=""):M+=b:r.hasOwnProperty(b)?(U+=r[b],E[w]=parseInt(U,16)*_,_=1,w=void 0,U=""):U+=b;return N},u={codePages:["WinAnsiEncoding"],WinAnsiEncoding:c("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},h={Unicode:{Courier:u,"Courier-Bold":u,"Courier-BoldOblique":u,"Courier-Oblique":u,Helvetica:u,"Helvetica-Bold":u,"Helvetica-BoldOblique":u,"Helvetica-Oblique":u,"Times-Roman":u,"Times-Bold":u,"Times-BoldItalic":u,"Times-Italic":u}},p={Unicode:{"Courier-Oblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":c("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":c("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:c("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:c("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":c("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":c("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(x){var v=x.font,g=p.Unicode[v.postScriptName];g&&(v.metadata.Unicode={},v.metadata.Unicode.widths=g.widths,v.metadata.Unicode.kerning=g.kerning);var w=h.Unicode[v.postScriptName];w&&(v.metadata.Unicode.encoding=w,v.encoding=w.codePages[0])}])}(dr.API),function(e){var t=function(r){for(var a=r.length,n=new Uint8Array(a),s=0;s<a;s++)n[s]=r.charCodeAt(s);return n};e.API.events.push(["addFont",function(r){var a=void 0,n=r.font,s=r.instance;if(!n.isStandardFont){if(s===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+n.postScriptName+"').");if(typeof(a=s.existsFileInVFS(n.postScriptName)===!1?s.loadFile(n.postScriptName):s.getFileFromVFS(n.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+n.postScriptName+"').");(function(o,c){c=/^\x00\x01\x00\x00/.test(c)?t(c):t(jd(c)),o.metadata=e.API.TTFFont.open(c),o.metadata.Unicode=o.metadata.Unicode||{encoding:{},kerning:{},widths:[]},o.metadata.glyIdsUsed=[0]})(n,a)}}])}(dr),function(e){function t(){return(gr.canvg?Promise.resolve(gr.canvg):W2(()=>import("./index.es-CWEIHY-9.js"),[])).catch(function(r){return Promise.reject(new Error("Could not load canvg: "+r))}).then(function(r){return r.default?r.default:r})}dr.API.addSvgAsImage=function(r,a,n,s,o,c,u,h){if(isNaN(a)||isNaN(n))throw Ta.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(s)||isNaN(o))throw Ta.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var p=document.createElement("canvas");p.width=s,p.height=o;var x=p.getContext("2d");x.fillStyle="#fff",x.fillRect(0,0,p.width,p.height);var v={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},g=this;return t().then(function(w){return w.fromString(x,r,v)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(w){return w.render(v)}).then(function(){g.addImage(p.toDataURL("image/jpeg",1),a,n,s,o,u,h)})}}(),dr.API.putTotalPages=function(e){var t,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),r=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var a=1;a<=this.internal.getNumberOfPages();a++)for(var n=0;n<this.internal.pages[a].length;n++)this.internal.pages[a][n]=this.internal.pages[a][n].replace(t,r);return this},dr.API.viewerPreferences=function(e,t){var r;e=e||{},t=t||!1;var a,n,s,o={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},c=Object.keys(o),u=[],h=0,p=0,x=0;function v(w,b){var N,_=!1;for(N=0;N<w.length;N+=1)w[N]===b&&(_=!0);return _}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(o)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,e==="reset"||t===!0){var g=c.length;for(x=0;x<g;x+=1)r[c[x]].value=r[c[x]].defaultValue,r[c[x]].explicitSet=!1}if(va(e)==="object"){for(n in e)if(s=e[n],v(c,n)&&s!==void 0){if(r[n].type==="boolean"&&typeof s=="boolean")r[n].value=s;else if(r[n].type==="name"&&v(r[n].valueSet,s))r[n].value=s;else if(r[n].type==="integer"&&Number.isInteger(s))r[n].value=s;else if(r[n].type==="array"){for(h=0;h<s.length;h+=1)if(a=!0,s[h].length===1&&typeof s[h][0]=="number")u.push(String(s[h]-1));else if(s[h].length>1){for(p=0;p<s[h].length;p+=1)typeof s[h][p]!="number"&&(a=!1);a===!0&&u.push([s[h][0]-1,s[h][1]-1].join(" "))}r[n].value="["+u.join(" ")+"]"}else r[n].value=r[n].defaultValue;r[n].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var w,b=[];for(w in r)r[w].explicitSet===!0&&(r[w].type==="name"?b.push("/"+w+" /"+r[w].value):b.push("/"+w+" "+r[w].value));b.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+b.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},function(e){var t=function(){var a='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',n=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),s=unescape(encodeURIComponent(a)),o=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),c=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),u=unescape(encodeURIComponent("</x:xmpmeta>")),h=s.length+o.length+c.length+n.length+u.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+h+" >>"),this.internal.write("stream"),this.internal.write(n+s+o+c+u),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(a,n){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:a,namespaceuri:n||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",t)),this}}(dr.API),function(e){var t=e.API,r=t.pdfEscape16=function(s,o){for(var c,u=o.metadata.Unicode.widths,h=["","0","00","000","0000"],p=[""],x=0,v=s.length;x<v;++x){if(c=o.metadata.characterToGlyph(s.charCodeAt(x)),o.metadata.glyIdsUsed.push(c),o.metadata.toUnicode[c]=s.charCodeAt(x),u.indexOf(c)==-1&&(u.push(c),u.push([parseInt(o.metadata.widthOfGlyph(c),10)])),c=="0")return p.join("");c=c.toString(16),p.push(h[4-c.length],c)}return p.join("")},a=function(s){var o,c,u,h,p,x,v;for(p=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,u=[],x=0,v=(c=Object.keys(s).sort(function(g,w){return g-w})).length;x<v;x++)o=c[x],u.length>=100&&(p+=`
`+u.length+` beginbfchar
`+u.join(`
`)+`
endbfchar`,u=[]),s[o]!==void 0&&s[o]!==null&&typeof s[o].toString=="function"&&(h=("0000"+s[o].toString(16)).slice(-4),o=("0000"+(+o).toString(16)).slice(-4),u.push("<"+o+"><"+h+">"));return u.length&&(p+=`
`+u.length+` beginbfchar
`+u.join(`
`)+`
endbfchar
`),p+=`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(s){(function(o){var c=o.font,u=o.out,h=o.newObject,p=o.putStream;if(c.metadata instanceof e.API.TTFFont&&c.encoding==="Identity-H"){for(var x=c.metadata.Unicode.widths,v=c.metadata.subset.encode(c.metadata.glyIdsUsed,1),g="",w=0;w<v.length;w++)g+=String.fromCharCode(v[w]);var b=h();p({data:g,addLength1:!0,objectId:b}),u("endobj");var N=h();p({data:a(c.metadata.toUnicode),addLength1:!0,objectId:N}),u("endobj");var _=h();u("<<"),u("/Type /FontDescriptor"),u("/FontName /"+q0(c.fontName)),u("/FontFile2 "+b+" 0 R"),u("/FontBBox "+e.API.PDFObject.convert(c.metadata.bbox)),u("/Flags "+c.metadata.flags),u("/StemV "+c.metadata.stemV),u("/ItalicAngle "+c.metadata.italicAngle),u("/Ascent "+c.metadata.ascender),u("/Descent "+c.metadata.decender),u("/CapHeight "+c.metadata.capHeight),u(">>"),u("endobj");var E=h();u("<<"),u("/Type /Font"),u("/BaseFont /"+q0(c.fontName)),u("/FontDescriptor "+_+" 0 R"),u("/W "+e.API.PDFObject.convert(x)),u("/CIDToGIDMap /Identity"),u("/DW 1000"),u("/Subtype /CIDFontType2"),u("/CIDSystemInfo"),u("<<"),u("/Supplement 0"),u("/Registry (Adobe)"),u("/Ordering ("+c.encoding+")"),u(">>"),u(">>"),u("endobj"),c.objectNumber=h(),u("<<"),u("/Type /Font"),u("/Subtype /Type0"),u("/ToUnicode "+N+" 0 R"),u("/BaseFont /"+q0(c.fontName)),u("/Encoding /"+c.encoding),u("/DescendantFonts ["+E+" 0 R]"),u(">>"),u("endobj"),c.isAlreadyPutted=!0}})(s)}]),t.events.push(["putFont",function(s){(function(o){var c=o.font,u=o.out,h=o.newObject,p=o.putStream;if(c.metadata instanceof e.API.TTFFont&&c.encoding==="WinAnsiEncoding"){for(var x=c.metadata.rawData,v="",g=0;g<x.length;g++)v+=String.fromCharCode(x[g]);var w=h();p({data:v,addLength1:!0,objectId:w}),u("endobj");var b=h();p({data:a(c.metadata.toUnicode),addLength1:!0,objectId:b}),u("endobj");var N=h();u("<<"),u("/Descent "+c.metadata.decender),u("/CapHeight "+c.metadata.capHeight),u("/StemV "+c.metadata.stemV),u("/Type /FontDescriptor"),u("/FontFile2 "+w+" 0 R"),u("/Flags 96"),u("/FontBBox "+e.API.PDFObject.convert(c.metadata.bbox)),u("/FontName /"+q0(c.fontName)),u("/ItalicAngle "+c.metadata.italicAngle),u("/Ascent "+c.metadata.ascender),u(">>"),u("endobj"),c.objectNumber=h();for(var _=0;_<c.metadata.hmtx.widths.length;_++)c.metadata.hmtx.widths[_]=parseInt(c.metadata.hmtx.widths[_]*(1e3/c.metadata.head.unitsPerEm));u("<</Subtype/TrueType/Type/Font/ToUnicode "+b+" 0 R/BaseFont/"+q0(c.fontName)+"/FontDescriptor "+N+" 0 R/Encoding/"+c.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(c.metadata.hmtx.widths)+">>"),u("endobj"),c.isAlreadyPutted=!0}})(s)}]);var n=function(s){var o,c=s.text||"",u=s.x,h=s.y,p=s.options||{},x=s.mutex||{},v=x.pdfEscape,g=x.activeFontKey,w=x.fonts,b=g,N="",_=0,E="",j=w[b].encoding;if(w[b].encoding!=="Identity-H")return{text:c,x:u,y:h,options:p,mutex:x};for(E=c,b=g,Array.isArray(c)&&(E=c[0]),_=0;_<E.length;_+=1)w[b].metadata.hasOwnProperty("cmap")&&(o=w[b].metadata.cmap.unicode.codeMap[E[_].charCodeAt(0)]),o||E[_].charCodeAt(0)<256&&w[b].metadata.hasOwnProperty("Unicode")?N+=E[_]:N+="";var M="";return parseInt(b.slice(1))<14||j==="WinAnsiEncoding"?M=v(N,b).split("").map(function(U){return U.charCodeAt(0).toString(16)}).join(""):j==="Identity-H"&&(M=r(N,w[b])),x.isHex=!0,{text:M,x:u,y:h,options:p,mutex:x}};t.events.push(["postProcessText",function(s){var o=s.text||"",c=[],u={text:o,x:s.x,y:s.y,options:s.options,mutex:s.mutex};if(Array.isArray(o)){var h=0;for(h=0;h<o.length;h+=1)Array.isArray(o[h])&&o[h].length===3?c.push([n(Object.assign({},u,{text:o[h][0]})).text,o[h][1],o[h][2]]):c.push(n(Object.assign({},u,{text:o[h]})).text);s.text=c}else s.text=n(Object.assign({},u,{text:o})).text}])}(dr),function(e){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0},e.addFileToVFS=function(r,a){return t.call(this),this.internal.vFS[r]=a,this},e.getFileFromVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}}(dr.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(a){var n,s,o,c,u,h,p,x=t,v=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],g=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],w={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},b={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},N=["(",")","(","<",">","<","[","]","[","{","}","{","«","»","«","‹","›","‹","⁅","⁆","⁅","⁽","⁾","⁽","₍","₎","₍","≤","≥","≤","〈","〉","〈","﹙","﹚","﹙","﹛","﹜","﹛","﹝","﹞","﹝","﹤","﹥","﹤"],_=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),E=!1,j=0;this.__bidiEngine__={};var M=function(R){var F=R.charCodeAt(),Y=F>>8,K=b[Y];return K!==void 0?x[256*K+(255&F)]:Y===252||Y===253?"AL":_.test(Y)?"L":Y===8?"R":"N"},U=function(R){for(var F,Y=0;Y<R.length;Y++){if((F=M(R.charAt(Y)))==="L")return!1;if(F==="R")return!0}return!1},V=function(R,F,Y,K){var X,Z,ce,te,Q=F[K];switch(Q){case"L":case"R":E=!1;break;case"N":case"AN":break;case"EN":E&&(Q="AN");break;case"AL":E=!0,Q="R";break;case"WS":Q="N";break;case"CS":K<1||K+1>=F.length||(X=Y[K-1])!=="EN"&&X!=="AN"||(Z=F[K+1])!=="EN"&&Z!=="AN"?Q="N":E&&(Z="AN"),Q=Z===X?Z:"N";break;case"ES":Q=(X=K>0?Y[K-1]:"B")==="EN"&&K+1<F.length&&F[K+1]==="EN"?"EN":"N";break;case"ET":if(K>0&&Y[K-1]==="EN"){Q="EN";break}if(E){Q="N";break}for(ce=K+1,te=F.length;ce<te&&F[ce]==="ET";)ce++;Q=ce<te&&F[ce]==="EN"?"EN":"N";break;case"NSM":if(o&&!c){for(te=F.length,ce=K+1;ce<te&&F[ce]==="NSM";)ce++;if(ce<te){var G=R[K],ye=G>=1425&&G<=2303||G===64286;if(X=F[ce],ye&&(X==="R"||X==="AL")){Q="R";break}}}Q=K<1||(X=F[K-1])==="B"?"N":Y[K-1];break;case"B":E=!1,n=!0,Q=j;break;case"S":s=!0,Q="N";break;case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":E=!1;break;case"BN":Q="N"}return Q},I=function(R,F,Y){var K=R.split("");return Y&&z(K,Y,{hiLevel:j}),K.reverse(),F&&F.reverse(),K.join("")},z=function(R,F,Y){var K,X,Z,ce,te,Q=-1,G=R.length,ye=0,D=[],O=j?g:v,L=[];for(E=!1,n=!1,s=!1,X=0;X<G;X++)L[X]=M(R[X]);for(Z=0;Z<G;Z++){if(te=ye,D[Z]=V(R,L,D,Z),K=240&(ye=O[te][w[D[Z]]]),ye&=15,F[Z]=ce=O[ye][5],K>0)if(K===16){for(X=Q;X<Z;X++)F[X]=1;Q=-1}else Q=-1;if(O[ye][6])Q===-1&&(Q=Z);else if(Q>-1){for(X=Q;X<Z;X++)F[X]=ce;Q=-1}L[Z]==="B"&&(F[Z]=0),Y.hiLevel|=ce}s&&function(q,oe,be){for(var ve=0;ve<be;ve++)if(q[ve]==="S"){oe[ve]=j;for(var ue=ve-1;ue>=0&&q[ue]==="WS";ue--)oe[ue]=j}}(L,F,G)},H=function(R,F,Y,K,X){if(!(X.hiLevel<R)){if(R===1&&j===1&&!n)return F.reverse(),void(Y&&Y.reverse());for(var Z,ce,te,Q,G=F.length,ye=0;ye<G;){if(K[ye]>=R){for(te=ye+1;te<G&&K[te]>=R;)te++;for(Q=ye,ce=te-1;Q<ce;Q++,ce--)Z=F[Q],F[Q]=F[ce],F[ce]=Z,Y&&(Z=Y[Q],Y[Q]=Y[ce],Y[ce]=Z);ye=te}ye++}}},re=function(R,F,Y){var K=R.split(""),X={hiLevel:j};return Y||(Y=[]),z(K,Y,X),function(Z,ce,te){if(te.hiLevel!==0&&p)for(var Q,G=0;G<Z.length;G++)ce[G]===1&&(Q=N.indexOf(Z[G]))>=0&&(Z[G]=N[Q+1])}(K,Y,X),H(2,K,F,Y,X),H(1,K,F,Y,X),K.join("")};return this.__bidiEngine__.doBidiReorder=function(R,F,Y){if(function(X,Z){if(Z)for(var ce=0;ce<X.length;ce++)Z[ce]=ce;c===void 0&&(c=U(X)),h===void 0&&(h=U(X))}(R,F),o||!u||h)if(o&&u&&c^h)j=c?1:0,R=I(R,F,Y);else if(!o&&u&&h)j=c?1:0,R=re(R,F,Y),R=I(R,F);else if(!o||c||u||h){if(o&&!u&&c^h)R=I(R,F),c?(j=0,R=re(R,F,Y)):(j=1,R=re(R,F,Y),R=I(R,F));else if(o&&c&&!u&&h)j=1,R=re(R,F,Y),R=I(R,F);else if(!o&&!u&&c^h){var K=p;c?(j=1,R=re(R,F,Y),j=0,p=!1,R=re(R,F,Y),p=K):(j=0,R=re(R,F,Y),R=I(R,F),j=1,p=!1,R=re(R,F,Y),p=K,R=I(R,F))}}else j=0,R=re(R,F,Y);else j=c?1:0,R=re(R,F,Y);return R},this.__bidiEngine__.setOptions=function(R){R&&(o=R.isInputVisual,u=R.isOutputVisual,c=R.isInputRtl,h=R.isOutputRtl,p=R.isSymmetricSwapping)},this.__bidiEngine__.setOptions(a),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(a){var n=a.text;a.x,a.y;var s=a.options||{};a.mutex,s.lang;var o=[];if(s.isInputVisual=typeof s.isInputVisual!="boolean"||s.isInputVisual,r.setOptions(s),Object.prototype.toString.call(n)==="[object Array]"){var c=0;for(o=[],c=0;c<n.length;c+=1)Object.prototype.toString.call(n[c])==="[object Array]"?o.push([r.doBidiReorder(n[c][0]),n[c][1],n[c][2]]):o.push([r.doBidiReorder(n[c])]);a.text=o}else a.text=r.doBidiReorder(n);r.setOptions({isInputVisual:!0})}])}(dr),dr.API.TTFFont=function(){function e(t){var r;if(this.rawData=t,r=this.contents=new Bu(t),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new rO(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new HL(this.contents),this.head=new qL(this),this.name=new YL(this),this.cmap=new s_(this),this.toUnicode={},this.hhea=new GL(this),this.maxp=new JL(this),this.hmtx=new KL(this),this.post=new $L(this),this.os2=new WL(this),this.loca=new tO(this),this.glyf=new ZL(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var t,r,a,n,s;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var o,c,u,h;for(h=[],o=0,c=(u=this.bbox).length;o<c;o++)t=u[o],h.push(Math.round(t*this.scaleFactor));return h}).call(this),this.stemV=0,this.post.exists?(a=255&(n=this.post.italic_angle),(32768&(r=n>>16))!=0&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+a)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(s=this.familyClass)===1||s===2||s===3||s===4||s===5||s===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(t){var r;return((r=this.cmap.unicode)!=null?r.codeMap[t]:void 0)||0},e.prototype.widthOfGlyph=function(t){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*r},e.prototype.widthOfString=function(t,r,a){var n,s,o,c;for(o=0,s=0,c=(t=""+t).length;0<=c?s<c:s>c;s=0<=c?++s:--s)n=t.charCodeAt(s),o+=this.widthOfGlyph(this.characterToGlyph(n))+a*(1e3/r)||0;return o*(r/1e3)},e.prototype.lineHeight=function(t,r){var a;return r==null&&(r=!1),a=r?this.lineGap:0,(this.ascender+a-this.decender)/1e3*t},e}();var ml,Bu=function(){function e(t){this.data=t??[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(t){return this.data[this.pos++]=t},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},e.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},e.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},e.prototype.readString=function(t){var r,a;for(a=[],r=0;0<=t?r<t:r>t;r=0<=t?++r:--r)a[r]=String.fromCharCode(this.readByte());return a.join("")},e.prototype.writeString=function(t){var r,a,n;for(n=[],r=0,a=t.length;0<=a?r<a:r>a;r=0<=a?++r:--r)n.push(this.writeByte(t.charCodeAt(r)));return n},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(t){return this.writeInt16(t)},e.prototype.readLongLong=function(){var t,r,a,n,s,o,c,u;return t=this.readByte(),r=this.readByte(),a=this.readByte(),n=this.readByte(),s=this.readByte(),o=this.readByte(),c=this.readByte(),u=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^r)+1099511627776*(255^a)+4294967296*(255^n)+16777216*(255^s)+65536*(255^o)+256*(255^c)+(255^u)+1):72057594037927940*t+281474976710656*r+1099511627776*a+4294967296*n+16777216*s+65536*o+256*c+u},e.prototype.writeLongLong=function(t){var r,a;return r=Math.floor(t/4294967296),a=4294967295&t,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(a>>24&255),this.writeByte(a>>16&255),this.writeByte(a>>8&255),this.writeByte(255&a)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(t){return this.writeInt32(t)},e.prototype.read=function(t){var r,a;for(r=[],a=0;0<=t?a<t:a>t;a=0<=t?++a:--a)r.push(this.readByte());return r},e.prototype.write=function(t){var r,a,n,s;for(s=[],a=0,n=t.length;a<n;a++)r=t[a],s.push(this.writeByte(r));return s},e}(),HL=function(){var e;function t(r){var a,n,s;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},n=0,s=this.tableCount;0<=s?n<s:n>s;n=0<=s?++n:--n)a={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[a.tag]=a}return t.prototype.encode=function(r){var a,n,s,o,c,u,h,p,x,v,g,w,b;for(b in g=Object.keys(r).length,u=Math.log(2),x=16*Math.floor(Math.log(g)/u),o=Math.floor(x/u),p=16*g-x,(n=new Bu).writeInt(this.scalarType),n.writeShort(g),n.writeShort(x),n.writeShort(o),n.writeShort(p),s=16*g,h=n.pos+s,c=null,w=[],r)for(v=r[b],n.writeString(b),n.writeInt(e(v)),n.writeInt(h),n.writeInt(v.length),w=w.concat(v),b==="head"&&(c=h),h+=v.length;h%4;)w.push(0),h++;return n.write(w),a=2981146554-e(n.data),n.pos=c+8,n.writeUInt32(a),n.data},e=function(r){var a,n,s,o;for(r=i_.call(r);r.length%4;)r.push(0);for(s=new Bu(r),n=0,a=0,o=r.length;a<o;a=a+=4)n+=s.readUInt32();return 4294967295&n},t}(),VL={}.hasOwnProperty,Zl=function(e,t){for(var r in t)VL.call(t,r)&&(e[r]=t[r]);function a(){this.constructor=e}return a.prototype=t.prototype,e.prototype=new a,e.__super__=t.prototype,e};ml=function(){function e(t){var r;this.file=t,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var qL=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Zl(t,ml),t.prototype.tag="head",t.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.revision=r.readInt(),this.checkSumAdjustment=r.readInt(),this.magicNumber=r.readInt(),this.flags=r.readShort(),this.unitsPerEm=r.readShort(),this.created=r.readLongLong(),this.modified=r.readLongLong(),this.xMin=r.readShort(),this.yMin=r.readShort(),this.xMax=r.readShort(),this.yMax=r.readShort(),this.macStyle=r.readShort(),this.lowestRecPPEM=r.readShort(),this.fontDirectionHint=r.readShort(),this.indexToLocFormat=r.readShort(),this.glyphDataFormat=r.readShort()},t.prototype.encode=function(r){var a;return(a=new Bu).writeInt(this.version),a.writeInt(this.revision),a.writeInt(this.checkSumAdjustment),a.writeInt(this.magicNumber),a.writeShort(this.flags),a.writeShort(this.unitsPerEm),a.writeLongLong(this.created),a.writeLongLong(this.modified),a.writeShort(this.xMin),a.writeShort(this.yMin),a.writeShort(this.xMax),a.writeShort(this.yMax),a.writeShort(this.macStyle),a.writeShort(this.lowestRecPPEM),a.writeShort(this.fontDirectionHint),a.writeShort(r),a.writeShort(this.glyphDataFormat),a.data},t}(),l3=function(){function e(t,r){var a,n,s,o,c,u,h,p,x,v,g,w,b,N,_,E,j;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=r+t.readInt(),x=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(u=0;u<256;++u)this.codeMap[u]=t.readByte();break;case 4:for(g=t.readUInt16(),v=g/2,t.pos+=6,s=function(){var M,U;for(U=[],u=M=0;0<=v?M<v:M>v;u=0<=v?++M:--M)U.push(t.readUInt16());return U}(),t.pos+=2,b=function(){var M,U;for(U=[],u=M=0;0<=v?M<v:M>v;u=0<=v?++M:--M)U.push(t.readUInt16());return U}(),h=function(){var M,U;for(U=[],u=M=0;0<=v?M<v:M>v;u=0<=v?++M:--M)U.push(t.readUInt16());return U}(),p=function(){var M,U;for(U=[],u=M=0;0<=v?M<v:M>v;u=0<=v?++M:--M)U.push(t.readUInt16());return U}(),n=(this.length-t.pos+this.offset)/2,c=function(){var M,U;for(U=[],u=M=0;0<=n?M<n:M>n;u=0<=n?++M:--M)U.push(t.readUInt16());return U}(),u=_=0,j=s.length;_<j;u=++_)for(N=s[u],a=E=w=b[u];w<=N?E<=N:E>=N;a=w<=N?++E:--E)p[u]===0?o=a+h[u]:(o=c[p[u]/2+(a-w)-(v-u)]||0)!==0&&(o+=h[u]),this.codeMap[a]=65535&o}t.pos=x}return e.encode=function(t,r){var a,n,s,o,c,u,h,p,x,v,g,w,b,N,_,E,j,M,U,V,I,z,H,re,R,F,Y,K,X,Z,ce,te,Q,G,ye,D,O,L,q,oe,be,ve,ue,fe,Ee,J;switch(K=new Bu,o=Object.keys(t).sort(function(Pe,st){return Pe-st}),r){case"macroman":for(b=0,N=function(){var Pe=[];for(w=0;w<256;++w)Pe.push(0);return Pe}(),E={0:0},s={},X=0,Q=o.length;X<Q;X++)E[ue=t[n=o[X]]]==null&&(E[ue]=++b),s[n]={old:t[n],new:E[t[n]]},N[n]=E[t[n]];return K.writeUInt16(1),K.writeUInt16(0),K.writeUInt32(12),K.writeUInt16(0),K.writeUInt16(262),K.writeUInt16(0),K.write(N),{charMap:s,subtable:K.data,maxGlyphID:b+1};case"unicode":for(F=[],x=[],j=0,E={},a={},_=h=null,Z=0,G=o.length;Z<G;Z++)E[U=t[n=o[Z]]]==null&&(E[U]=++j),a[n]={old:U,new:E[U]},c=E[U]-n,_!=null&&c===h||(_&&x.push(_),F.push(n),h=c),_=n;for(_&&x.push(_),x.push(65535),F.push(65535),re=2*(H=F.length),z=2*Math.pow(Math.log(H)/Math.LN2,2),v=Math.log(z/2)/Math.LN2,I=2*H-z,u=[],V=[],g=[],w=ce=0,ye=F.length;ce<ye;w=++ce){if(R=F[w],p=x[w],R===65535){u.push(0),V.push(0);break}if(R-(Y=a[R].new)>=32768)for(u.push(0),V.push(2*(g.length+H-w)),n=te=R;R<=p?te<=p:te>=p;n=R<=p?++te:--te)g.push(a[n].new);else u.push(Y-R),V.push(0)}for(K.writeUInt16(3),K.writeUInt16(1),K.writeUInt32(12),K.writeUInt16(4),K.writeUInt16(16+8*H+2*g.length),K.writeUInt16(0),K.writeUInt16(re),K.writeUInt16(z),K.writeUInt16(v),K.writeUInt16(I),be=0,D=x.length;be<D;be++)n=x[be],K.writeUInt16(n);for(K.writeUInt16(0),ve=0,O=F.length;ve<O;ve++)n=F[ve],K.writeUInt16(n);for(fe=0,L=u.length;fe<L;fe++)c=u[fe],K.writeUInt16(c);for(Ee=0,q=V.length;Ee<q;Ee++)M=V[Ee],K.writeUInt16(M);for(J=0,oe=g.length;J<oe;J++)b=g[J],K.writeUInt16(b);return{charMap:a,subtable:K.data,maxGlyphID:j+1}}},e}(),s_=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Zl(t,ml),t.prototype.tag="cmap",t.prototype.parse=function(r){var a,n,s;for(r.pos=this.offset,this.version=r.readUInt16(),s=r.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=s?n<s:n>s;n=0<=s?++n:--n)a=new l3(r,this.offset),this.tables.push(a),a.isUnicode&&this.unicode==null&&(this.unicode=a);return!0},t.encode=function(r,a){var n,s;return a==null&&(a="macroman"),n=l3.encode(r,a),(s=new Bu).writeUInt16(0),s.writeUInt16(1),n.table=s.data.concat(n.subtable),n},t}(),GL=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Zl(t,ml),t.prototype.tag="hhea",t.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.ascender=r.readShort(),this.decender=r.readShort(),this.lineGap=r.readShort(),this.advanceWidthMax=r.readShort(),this.minLeftSideBearing=r.readShort(),this.minRightSideBearing=r.readShort(),this.xMaxExtent=r.readShort(),this.caretSlopeRise=r.readShort(),this.caretSlopeRun=r.readShort(),this.caretOffset=r.readShort(),r.pos+=8,this.metricDataFormat=r.readShort(),this.numberOfMetrics=r.readUInt16()},t}(),WL=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Zl(t,ml),t.prototype.tag="OS/2",t.prototype.parse=function(r){if(r.pos=this.offset,this.version=r.readUInt16(),this.averageCharWidth=r.readShort(),this.weightClass=r.readUInt16(),this.widthClass=r.readUInt16(),this.type=r.readShort(),this.ySubscriptXSize=r.readShort(),this.ySubscriptYSize=r.readShort(),this.ySubscriptXOffset=r.readShort(),this.ySubscriptYOffset=r.readShort(),this.ySuperscriptXSize=r.readShort(),this.ySuperscriptYSize=r.readShort(),this.ySuperscriptXOffset=r.readShort(),this.ySuperscriptYOffset=r.readShort(),this.yStrikeoutSize=r.readShort(),this.yStrikeoutPosition=r.readShort(),this.familyClass=r.readShort(),this.panose=function(){var a,n;for(n=[],a=0;a<10;++a)n.push(r.readByte());return n}(),this.charRange=function(){var a,n;for(n=[],a=0;a<4;++a)n.push(r.readInt());return n}(),this.vendorID=r.readString(4),this.selection=r.readShort(),this.firstCharIndex=r.readShort(),this.lastCharIndex=r.readShort(),this.version>0&&(this.ascent=r.readShort(),this.descent=r.readShort(),this.lineGap=r.readShort(),this.winAscent=r.readShort(),this.winDescent=r.readShort(),this.codePageRange=function(){var a,n;for(n=[],a=0;a<2;a=++a)n.push(r.readInt());return n}(),this.version>1))return this.xHeight=r.readShort(),this.capHeight=r.readShort(),this.defaultChar=r.readShort(),this.breakChar=r.readShort(),this.maxContext=r.readShort()},t}(),$L=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Zl(t,ml),t.prototype.tag="post",t.prototype.parse=function(r){var a,n,s;switch(r.pos=this.offset,this.format=r.readInt(),this.italicAngle=r.readInt(),this.underlinePosition=r.readShort(),this.underlineThickness=r.readShort(),this.isFixedPitch=r.readInt(),this.minMemType42=r.readInt(),this.maxMemType42=r.readInt(),this.minMemType1=r.readInt(),this.maxMemType1=r.readInt(),this.format){case 65536:break;case 131072:var o;for(n=r.readUInt16(),this.glyphNameIndex=[],o=0;0<=n?o<n:o>n;o=0<=n?++o:--o)this.glyphNameIndex.push(r.readUInt16());for(this.names=[],s=[];r.pos<this.offset+this.length;)a=r.readByte(),s.push(this.names.push(r.readString(a)));return s;case 151552:return n=r.readUInt16(),this.offsets=r.read(n);case 196608:break;case 262144:return this.map=(function(){var c,u,h;for(h=[],o=c=0,u=this.file.maxp.numGlyphs;0<=u?c<u:c>u;o=0<=u?++c:--c)h.push(r.readUInt32());return h}).call(this)}},t}(),XL=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},YL=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Zl(t,ml),t.prototype.tag="name",t.prototype.parse=function(r){var a,n,s,o,c,u,h,p,x,v,g;for(r.pos=this.offset,r.readShort(),a=r.readShort(),u=r.readShort(),n=[],o=0;0<=a?o<a:o>a;o=0<=a?++o:--o)n.push({platformID:r.readShort(),encodingID:r.readShort(),languageID:r.readShort(),nameID:r.readShort(),length:r.readShort(),offset:this.offset+u+r.readShort()});for(h={},o=x=0,v=n.length;x<v;o=++x)s=n[o],r.pos=s.offset,p=r.readString(s.length),c=new XL(p,s),h[g=s.nameID]==null&&(h[g]=[]),h[s.nameID].push(c);this.strings=h,this.copyright=h[0],this.fontFamily=h[1],this.fontSubfamily=h[2],this.uniqueSubfamily=h[3],this.fontName=h[4],this.version=h[5];try{this.postscriptName=h[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=h[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=h[7],this.manufacturer=h[8],this.designer=h[9],this.description=h[10],this.vendorUrl=h[11],this.designerUrl=h[12],this.license=h[13],this.licenseUrl=h[14],this.preferredFamily=h[15],this.preferredSubfamily=h[17],this.compatibleFull=h[18],this.sampleText=h[19]},t}(),JL=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Zl(t,ml),t.prototype.tag="maxp",t.prototype.parse=function(r){return r.pos=this.offset,this.version=r.readInt(),this.numGlyphs=r.readUInt16(),this.maxPoints=r.readUInt16(),this.maxContours=r.readUInt16(),this.maxCompositePoints=r.readUInt16(),this.maxComponentContours=r.readUInt16(),this.maxZones=r.readUInt16(),this.maxTwilightPoints=r.readUInt16(),this.maxStorage=r.readUInt16(),this.maxFunctionDefs=r.readUInt16(),this.maxInstructionDefs=r.readUInt16(),this.maxStackElements=r.readUInt16(),this.maxSizeOfInstructions=r.readUInt16(),this.maxComponentElements=r.readUInt16(),this.maxComponentDepth=r.readUInt16()},t}(),KL=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Zl(t,ml),t.prototype.tag="hmtx",t.prototype.parse=function(r){var a,n,s,o,c,u,h;for(r.pos=this.offset,this.metrics=[],a=0,u=this.file.hhea.numberOfMetrics;0<=u?a<u:a>u;a=0<=u?++a:--a)this.metrics.push({advance:r.readUInt16(),lsb:r.readInt16()});for(s=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var p,x;for(x=[],a=p=0;0<=s?p<s:p>s;a=0<=s?++p:--p)x.push(r.readInt16());return x}(),this.widths=(function(){var p,x,v,g;for(g=[],p=0,x=(v=this.metrics).length;p<x;p++)o=v[p],g.push(o.advance);return g}).call(this),n=this.widths[this.widths.length-1],h=[],a=c=0;0<=s?c<s:c>s;a=0<=s?++c:--c)h.push(this.widths.push(n));return h},t.prototype.forGlyph=function(r){return r in this.metrics?this.metrics[r]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[r-this.metrics.length]}},t}(),i_=[].slice,ZL=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Zl(t,ml),t.prototype.tag="glyf",t.prototype.parse=function(){return this.cache={}},t.prototype.glyphFor=function(r){var a,n,s,o,c,u,h,p,x,v;return r in this.cache?this.cache[r]:(o=this.file.loca,a=this.file.contents,n=o.indexOf(r),(s=o.lengthOf(r))===0?this.cache[r]=null:(a.pos=this.offset+n,c=(u=new Bu(a.read(s))).readShort(),p=u.readShort(),v=u.readShort(),h=u.readShort(),x=u.readShort(),this.cache[r]=c===-1?new eO(u,p,v,h,x):new QL(u,c,p,v,h,x),this.cache[r]))},t.prototype.encode=function(r,a,n){var s,o,c,u,h;for(c=[],o=[],u=0,h=a.length;u<h;u++)s=r[a[u]],o.push(c.length),s&&(c=c.concat(s.encode(n)));return o.push(c.length),{table:c,offsets:o}},t}(),QL=function(){function e(t,r,a,n,s,o){this.raw=t,this.numberOfContours=r,this.xMin=a,this.yMin=n,this.xMax=s,this.yMax=o,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),eO=function(){function e(t,r,a,n,s){var o,c;for(this.raw=t,this.xMin=r,this.yMin=a,this.xMax=n,this.yMax=s,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],o=this.raw;c=o.readShort(),this.glyphOffsets.push(o.pos),this.glyphIDs.push(o.readUInt16()),32&c;)o.pos+=1&c?4:2,128&c?o.pos+=8:64&c?o.pos+=4:8&c&&(o.pos+=2)}return e.prototype.encode=function(){var t,r,a;for(r=new Bu(i_.call(this.raw.data)),t=0,a=this.glyphIDs.length;t<a;++t)r.pos=this.glyphOffsets[t];return r.data},e}(),tO=function(e){function t(){return t.__super__.constructor.apply(this,arguments)}return Zl(t,ml),t.prototype.tag="loca",t.prototype.parse=function(r){var a,n;return r.pos=this.offset,a=this.file.head.indexToLocFormat,this.offsets=a===0?(function(){var s,o;for(o=[],n=0,s=this.length;n<s;n+=2)o.push(2*r.readUInt16());return o}).call(this):(function(){var s,o;for(o=[],n=0,s=this.length;n<s;n+=4)o.push(r.readUInt32());return o}).call(this)},t.prototype.indexOf=function(r){return this.offsets[r]},t.prototype.lengthOf=function(r){return this.offsets[r+1]-this.offsets[r]},t.prototype.encode=function(r,a){for(var n=new Uint32Array(this.offsets.length),s=0,o=0,c=0;c<n.length;++c)if(n[c]=s,o<a.length&&a[o]==c){++o,n[c]=s;var u=this.offsets[c],h=this.offsets[c+1]-u;h>0&&(s+=h)}for(var p=new Array(4*n.length),x=0;x<n.length;++x)p[4*x+3]=255&n[x],p[4*x+2]=(65280&n[x])>>8,p[4*x+1]=(16711680&n[x])>>16,p[4*x]=(4278190080&n[x])>>24;return p},t}(),rO=function(){function e(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var t,r,a,n,s;for(r in n=this.font.cmap.tables[0].codeMap,t={},s=this.subset)a=s[r],t[r]=n[a];return t},e.prototype.glyphsFor=function(t){var r,a,n,s,o,c,u;for(n={},o=0,c=t.length;o<c;o++)n[s=t[o]]=this.font.glyf.glyphFor(s);for(s in r=[],n)(a=n[s])!=null&&a.compound&&r.push.apply(r,a.glyphIDs);if(r.length>0)for(s in u=this.glyphsFor(r))a=u[s],n[s]=a;return n},e.prototype.encode=function(t,r){var a,n,s,o,c,u,h,p,x,v,g,w,b,N,_;for(n in a=s_.encode(this.generateCmap(),"unicode"),o=this.glyphsFor(t),g={0:0},_=a.charMap)g[(u=_[n]).old]=u.new;for(w in v=a.maxGlyphID,o)w in g||(g[w]=v++);return p=function(E){var j,M;for(j in M={},E)M[E[j]]=j;return M}(g),x=Object.keys(p).sort(function(E,j){return E-j}),b=function(){var E,j,M;for(M=[],E=0,j=x.length;E<j;E++)c=x[E],M.push(p[c]);return M}(),s=this.font.glyf.encode(o,b,g),h=this.font.loca.encode(s.offsets,b),N={cmap:this.font.cmap.raw(),glyf:s.table,loca:h,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(N["OS/2"]=this.font.os2.raw()),this.font.directory.encode(N)},e}();dr.API.PDFObject=function(){var e;function t(){}return e=function(r,a){return(Array(a+1).join("0")+r).slice(-a)},t.convert=function(r){var a,n,s,o;if(Array.isArray(r))return"["+function(){var c,u,h;for(h=[],c=0,u=r.length;c<u;c++)a=r[c],h.push(t.convert(a));return h}().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r!=null&&r.isString)return"("+r+")";if(r instanceof Date)return"(D:"+e(r.getUTCFullYear(),4)+e(r.getUTCMonth(),2)+e(r.getUTCDate(),2)+e(r.getUTCHours(),2)+e(r.getUTCMinutes(),2)+e(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(n in s=["<<"],r)o=r[n],s.push("/"+n+" "+t.convert(o));return s.push(">>"),s.join(`
`)}return""+r},t}();function o_(e,t,r,a,n){a=a||{};var s=1.15,o=n.internal.scaleFactor,c=n.internal.getFontSize()/o,u=n.getLineHeightFactor?n.getLineHeightFactor():s,h=c*u,p=/\r\n|\r|\n/g,x="",v=1;if((a.valign==="middle"||a.valign==="bottom"||a.halign==="center"||a.halign==="right")&&(x=typeof e=="string"?e.split(p):e,v=x.length||1),r+=c*(2-s),a.valign==="middle"?r-=v/2*h:a.valign==="bottom"&&(r-=v*h),a.halign==="center"||a.halign==="right"){var g=c;if(a.halign==="center"&&(g*=.5),x&&v>=1){for(var w=0;w<x.length;w++)n.text(x[w],t-n.getStringUnitWidth(x[w])*g,r),r+=h;return n}t-=n.getStringUnitWidth(e)*g}return a.halign==="justify"?n.text(e,t,r,{maxWidth:a.maxWidth||100,align:"justify"}):n.text(e,t,r),n}var c3={},ah=function(){function e(t){this.jsPDFDocument=t,this.userStyles={textColor:t.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:t.internal.getFontSize(),fontStyle:t.internal.getFont().fontStyle,font:t.internal.getFont().fontName,lineWidth:t.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:t.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return e.setDefaults=function(t,r){r===void 0&&(r=null),r?r.__autoTableDocumentDefaults=t:c3=t},e.unifyColor=function(t){return Array.isArray(t)?t:typeof t=="number"?[t,t,t]:typeof t=="string"?[t]:null},e.prototype.applyStyles=function(t,r){var a,n,s;r===void 0&&(r=!1),t.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(t.fontStyle);var o=this.jsPDFDocument.internal.getFont(),c=o.fontStyle,u=o.fontName;if(t.font&&(u=t.font),t.fontStyle){c=t.fontStyle;var h=this.getFontList()[u];h&&h.indexOf(c)===-1&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(h[0]),c=h[0])}if(this.jsPDFDocument.setFont(u,c),t.fontSize&&this.jsPDFDocument.setFontSize(t.fontSize),!r){var p=e.unifyColor(t.fillColor);p&&(a=this.jsPDFDocument).setFillColor.apply(a,p),p=e.unifyColor(t.textColor),p&&(n=this.jsPDFDocument).setTextColor.apply(n,p),p=e.unifyColor(t.lineColor),p&&(s=this.jsPDFDocument).setDrawColor.apply(s,p),typeof t.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(t.lineWidth)}},e.prototype.splitTextToSize=function(t,r,a){return this.jsPDFDocument.splitTextToSize(t,r,a)},e.prototype.rect=function(t,r,a,n,s){return this.jsPDFDocument.rect(t,r,a,n,s)},e.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},e.prototype.getTextWidth=function(t){return this.jsPDFDocument.getTextWidth(t)},e.prototype.getDocument=function(){return this.jsPDFDocument},e.prototype.setPage=function(t){this.jsPDFDocument.setPage(t)},e.prototype.addPage=function(){return this.jsPDFDocument.addPage()},e.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},e.prototype.getGlobalOptions=function(){return c3||{}},e.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},e.prototype.pageSize=function(){var t=this.jsPDFDocument.internal.pageSize;return t.width==null&&(t={width:t.getWidth(),height:t.getHeight()}),t},e.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},e.prototype.getLineHeightFactor=function(){var t=this.jsPDFDocument;return t.getLineHeightFactor?t.getLineHeightFactor():1.15},e.prototype.getLineHeight=function(t){return t/this.scaleFactor()*this.getLineHeightFactor()},e.prototype.pageNumber=function(){var t=this.jsPDFDocument.internal.getCurrentPageInfo();return t?t.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},e}(),nv=function(e,t){return nv=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,a){r.__proto__=a}||function(r,a){for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(r[n]=a[n])},nv(e,t)};function l_(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");nv(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var c_=function(e){l_(t,e);function t(r){var a=e.call(this)||this;return a._element=r,a}return t}(Array);function aO(e){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/e,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}function nO(e){var t={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return t[e]}function v1(e,t,r){r.applyStyles(t,!0);var a=Array.isArray(e)?e:[e],n=a.map(function(s){return r.getTextWidth(s)}).reduce(function(s,o){return Math.max(s,o)},0);return n}function u_(e,t,r,a){var n=t.settings.tableLineWidth,s=t.settings.tableLineColor;e.applyStyles({lineWidth:n,lineColor:s});var o=f_(n,!1);o&&e.rect(r.x,r.y,t.getWidth(e.pageSize().width),a.y-r.y,o)}function f_(e,t){var r=e>0,a=t||t===0;return r&&a?"DF":r?"S":a?"F":null}function Y1(e,t){var r,a,n,s;if(e=e||t,Array.isArray(e)){if(e.length>=4)return{top:e[0],right:e[1],bottom:e[2],left:e[3]};if(e.length===3)return{top:e[0],right:e[1],bottom:e[2],left:e[1]};if(e.length===2)return{top:e[0],right:e[1],bottom:e[0],left:e[1]};e.length===1?e=e[0]:e=t}return typeof e=="object"?(typeof e.vertical=="number"&&(e.top=e.vertical,e.bottom=e.vertical),typeof e.horizontal=="number"&&(e.right=e.horizontal,e.left=e.horizontal),{left:(r=e.left)!==null&&r!==void 0?r:t,top:(a=e.top)!==null&&a!==void 0?a:t,right:(n=e.right)!==null&&n!==void 0?n:t,bottom:(s=e.bottom)!==null&&s!==void 0?s:t}):(typeof e!="number"&&(e=t),{top:e,right:e,bottom:e,left:e})}function h_(e,t){var r=Y1(t.settings.margin,0);return e.pageSize().width-(r.left+r.right)}function sO(e,t,r,a,n){var s={},o=1.3333333333333333,c=Qg(t,function(j){return n.getComputedStyle(j).backgroundColor});c!=null&&(s.fillColor=c);var u=Qg(t,function(j){return n.getComputedStyle(j).color});u!=null&&(s.textColor=u);var h=oO(a,r);h&&(s.cellPadding=h);var p="borderTopColor",x=o*r,v=a.borderTopWidth;if(a.borderBottomWidth===v&&a.borderRightWidth===v&&a.borderLeftWidth===v){var g=(parseFloat(v)||0)/x;g&&(s.lineWidth=g)}else s.lineWidth={top:(parseFloat(a.borderTopWidth)||0)/x,right:(parseFloat(a.borderRightWidth)||0)/x,bottom:(parseFloat(a.borderBottomWidth)||0)/x,left:(parseFloat(a.borderLeftWidth)||0)/x},s.lineWidth.top||(s.lineWidth.right?p="borderRightColor":s.lineWidth.bottom?p="borderBottomColor":s.lineWidth.left&&(p="borderLeftColor"));var w=Qg(t,function(j){return n.getComputedStyle(j)[p]});w!=null&&(s.lineColor=w);var b=["left","right","center","justify"];b.indexOf(a.textAlign)!==-1&&(s.halign=a.textAlign),b=["middle","bottom","top"],b.indexOf(a.verticalAlign)!==-1&&(s.valign=a.verticalAlign);var N=parseInt(a.fontSize||"");isNaN(N)||(s.fontSize=N/o);var _=iO(a);_&&(s.fontStyle=_);var E=(a.fontFamily||"").toLowerCase();return e.indexOf(E)!==-1&&(s.font=E),s}function iO(e){var t="";return(e.fontWeight==="bold"||e.fontWeight==="bolder"||parseInt(e.fontWeight)>=700)&&(t="bold"),(e.fontStyle==="italic"||e.fontStyle==="oblique")&&(t+="italic"),t}function Qg(e,t){var r=d_(e,t);if(!r)return null;var a=r.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!a||!Array.isArray(a))return null;var n=[parseInt(a[1]),parseInt(a[2]),parseInt(a[3])],s=parseInt(a[4]);return s===0||isNaN(n[0])||isNaN(n[1])||isNaN(n[2])?null:n}function d_(e,t){var r=t(e);return r==="rgba(0, 0, 0, 0)"||r==="transparent"||r==="initial"||r==="inherit"?e.parentElement==null?null:d_(e.parentElement,t):r}function oO(e,t){var r=[e.paddingTop,e.paddingRight,e.paddingBottom,e.paddingLeft],a=96/(72/t),n=(parseInt(e.lineHeight)-parseInt(e.fontSize))/t/2,s=r.map(function(c){return parseInt(c||"0")/a}),o=Y1(s,0);return n>o.top&&(o.top=n),n>o.bottom&&(o.bottom=n),o}function p_(e,t,r,a,n){var s,o;a===void 0&&(a=!1),n===void 0&&(n=!1);var c;typeof t=="string"?c=r.document.querySelector(t):c=t;var u=Object.keys(e.getFontList()),h=e.scaleFactor(),p=[],x=[],v=[];if(!c)return console.error("Html table could not be found with input: ",t),{head:p,body:x,foot:v};for(var g=0;g<c.rows.length;g++){var w=c.rows[g],b=(o=(s=w==null?void 0:w.parentElement)===null||s===void 0?void 0:s.tagName)===null||o===void 0?void 0:o.toLowerCase(),N=lO(u,h,r,w,a,n);N&&(b==="thead"?p.push(N):b==="tfoot"?v.push(N):x.push(N))}return{head:p,body:x,foot:v}}function lO(e,t,r,a,n,s){for(var o=new c_(a),c=0;c<a.cells.length;c++){var u=a.cells[c],h=r.getComputedStyle(u);if(n||h.display!=="none"){var p=void 0;s&&(p=sO(e,u,t,h,r)),o.push({rowSpan:u.rowSpan,colSpan:u.colSpan,styles:p,_element:u,content:cO(u)})}}var x=r.getComputedStyle(a);if(o.length>0&&(n||x.display!=="none"))return o}function cO(e){var t=e.cloneNode(!0);return t.innerHTML=t.innerHTML.replace(/\n/g,"").replace(/ +/g," "),t.innerHTML=t.innerHTML.split(/<br.*?>/).map(function(r){return r.trim()}).join(`
`),t.innerText||t.textContent||""}function uO(e,t,r){for(var a=0,n=[e,t,r];a<n.length;a++){var s=n[a];s&&typeof s!="object"&&console.error("The options parameter should be of type object, is: "+typeof s),s.startY&&typeof s.startY!="number"&&(console.error("Invalid value for startY option",s.startY),delete s.startY)}}function Cc(e,t,r,a,n){if(e==null)throw new TypeError("Cannot convert undefined or null to object");for(var s=Object(e),o=1;o<arguments.length;o++){var c=arguments[o];if(c!=null)for(var u in c)Object.prototype.hasOwnProperty.call(c,u)&&(s[u]=c[u])}return s}function m_(e,t){var r=new ah(e),a=r.getDocumentOptions(),n=r.getGlobalOptions();uO(n,a,t);var s=Cc({},n,a,t),o;typeof window<"u"&&(o=window);var c=fO(n,a,t),u=hO(n,a,t),h=dO(r,s),p=mO(r,s,o);return{id:t.tableId,content:p,hooks:u,styles:c,settings:h}}function fO(e,t,r){for(var a={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},n=function(u){if(u==="columnStyles"){var h=e[u],p=t[u],x=r[u];a.columnStyles=Cc({},h,p,x)}else{var v=[e,t,r],g=v.map(function(w){return w[u]||{}});a[u]=Cc({},g[0],g[1],g[2])}},s=0,o=Object.keys(a);s<o.length;s++){var c=o[s];n(c)}return a}function hO(e,t,r){for(var a=[e,t,r],n={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},s=0,o=a;s<o.length;s++){var c=o[s];c.didParseCell&&n.didParseCell.push(c.didParseCell),c.willDrawCell&&n.willDrawCell.push(c.willDrawCell),c.didDrawCell&&n.didDrawCell.push(c.didDrawCell),c.willDrawPage&&n.willDrawPage.push(c.willDrawPage),c.didDrawPage&&n.didDrawPage.push(c.didDrawPage)}return n}function dO(e,t){var r,a,n,s,o,c,u,h,p,x,v,g,w=Y1(t.margin,40/e.scaleFactor()),b=(r=pO(e,t.startY))!==null&&r!==void 0?r:w.top,N;t.showFoot===!0?N="everyPage":t.showFoot===!1?N="never":N=(a=t.showFoot)!==null&&a!==void 0?a:"everyPage";var _;t.showHead===!0?_="everyPage":t.showHead===!1?_="never":_=(n=t.showHead)!==null&&n!==void 0?n:"everyPage";var E=(s=t.useCss)!==null&&s!==void 0?s:!1,j=t.theme||(E?"plain":"striped"),M=!!t.horizontalPageBreak,U=(o=t.horizontalPageBreakRepeat)!==null&&o!==void 0?o:null;return{includeHiddenHtml:(c=t.includeHiddenHtml)!==null&&c!==void 0?c:!1,useCss:E,theme:j,startY:b,margin:w,pageBreak:(u=t.pageBreak)!==null&&u!==void 0?u:"auto",rowPageBreak:(h=t.rowPageBreak)!==null&&h!==void 0?h:"auto",tableWidth:(p=t.tableWidth)!==null&&p!==void 0?p:"auto",showHead:_,showFoot:N,tableLineWidth:(x=t.tableLineWidth)!==null&&x!==void 0?x:0,tableLineColor:(v=t.tableLineColor)!==null&&v!==void 0?v:200,horizontalPageBreak:M,horizontalPageBreakRepeat:U,horizontalPageBreakBehaviour:(g=t.horizontalPageBreakBehaviour)!==null&&g!==void 0?g:"afterAllRows"}}function pO(e,t){var r=e.getLastAutoTable(),a=e.scaleFactor(),n=e.pageNumber(),s=!1;if(r&&r.startPageNumber){var o=r.startPageNumber+r.pageNumber-1;s=o===n}return typeof t=="number"?t:(t==null||t===!1)&&s&&(r==null?void 0:r.finalY)!=null?r.finalY+20/a:null}function mO(e,t,r){var a=t.head||[],n=t.body||[],s=t.foot||[];if(t.html){var o=t.includeHiddenHtml;if(r){var c=p_(e,t.html,r,o,t.useCss)||{};a=c.head||a,n=c.body||a,s=c.foot||a}else console.error("Cannot parse html in non browser environment")}var u=t.columns||xO(a,n,s);return{columns:u,head:a,body:n,foot:s}}function xO(e,t,r){var a=e[0]||t[0]||r[0]||[],n=[];return Object.keys(a).filter(function(s){return s!=="_element"}).forEach(function(s){var o=1,c;Array.isArray(a)?c=a[parseInt(s)]:c=a[s],typeof c=="object"&&!Array.isArray(c)&&(o=(c==null?void 0:c.colSpan)||1);for(var u=0;u<o;u++){var h=void 0;Array.isArray(a)?h=n.length:h=s+(u>0?"_".concat(u):"");var p={dataKey:h};n.push(p)}}),n}var sv=function(){function e(t,r,a){this.table=r,this.pageNumber=r.pageNumber,this.settings=r.settings,this.cursor=a,this.doc=t.getDocument()}return e}(),gO=function(e){l_(t,e);function t(r,a,n,s,o,c){var u=e.call(this,r,a,c)||this;return u.cell=n,u.row=s,u.column=o,u.section=s.section,u}return t}(sv),vO=function(){function e(t,r){this.pageNumber=1,this.id=t.id,this.settings=t.settings,this.styles=t.styles,this.hooks=t.hooks,this.columns=r.columns,this.head=r.head,this.body=r.body,this.foot=r.foot}return e.prototype.getHeadHeight=function(t){return this.head.reduce(function(r,a){return r+a.getMaxCellHeight(t)},0)},e.prototype.getFootHeight=function(t){return this.foot.reduce(function(r,a){return r+a.getMaxCellHeight(t)},0)},e.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},e.prototype.callCellHooks=function(t,r,a,n,s,o){for(var c=0,u=r;c<u.length;c++){var h=u[c],p=new gO(t,this,a,n,s,o),x=h(p)===!1;if(a.text=Array.isArray(a.text)?a.text:[a.text],x)return!1}return!0},e.prototype.callEndPageHooks=function(t,r){t.applyStyles(t.userStyles);for(var a=0,n=this.hooks.didDrawPage;a<n.length;a++){var s=n[a];s(new sv(t,this,r))}},e.prototype.callWillDrawPageHooks=function(t,r){for(var a=0,n=this.hooks.willDrawPage;a<n.length;a++){var s=n[a];s(new sv(t,this,r))}},e.prototype.getWidth=function(t){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var r=this.columns.reduce(function(n,s){return n+s.wrappedWidth},0);return r}else{var a=this.settings.margin;return t-a.left-a.right}},e}(),x_=function(){function e(t,r,a,n,s){s===void 0&&(s=!1),this.height=0,this.raw=t,t instanceof c_&&(this.raw=t._element,this.element=t._element),this.index=r,this.section=a,this.cells=n,this.spansMultiplePages=s}return e.prototype.getMaxCellHeight=function(t){var r=this;return t.reduce(function(a,n){var s;return Math.max(a,((s=r.cells[n.index])===null||s===void 0?void 0:s.height)||0)},0)},e.prototype.hasRowSpan=function(t){var r=this;return t.filter(function(a){var n=r.cells[a.index];return n?n.rowSpan>1:!1}).length>0},e.prototype.canEntireRowFit=function(t,r){return this.getMaxCellHeight(r)<=t},e.prototype.getMinimumRowHeight=function(t,r){var a=this;return t.reduce(function(n,s){var o=a.cells[s.index];if(!o)return 0;var c=r.getLineHeight(o.styles.fontSize),u=o.padding("vertical"),h=u+c;return h>n?h:n},0)},e}(),g_=function(){function e(t,r,a){var n;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=r,this.section=a,this.raw=t;var s=t;t!=null&&typeof t=="object"&&!Array.isArray(t)?(this.rowSpan=t.rowSpan||1,this.colSpan=t.colSpan||1,s=(n=t.content)!==null&&n!==void 0?n:t,t._element&&(this.raw=t._element)):(this.rowSpan=1,this.colSpan=1);var o=s!=null?""+s:"",c=/\r\n|\r|\n/g;this.text=o.split(c)}return e.prototype.getTextPos=function(){var t;if(this.styles.valign==="top")t=this.y+this.padding("top");else if(this.styles.valign==="bottom")t=this.y+this.height-this.padding("bottom");else{var r=this.height-this.padding("vertical");t=this.y+r/2+this.padding("top")}var a;if(this.styles.halign==="right")a=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var n=this.width-this.padding("horizontal");a=this.x+n/2+this.padding("left")}else a=this.x+this.padding("left");return{x:a,y:t}},e.prototype.getContentHeight=function(t,r){r===void 0&&(r=1.15);var a=Array.isArray(this.text)?this.text.length:1,n=this.styles.fontSize/t*r,s=a*n+this.padding("vertical");return Math.max(s,this.styles.minCellHeight)},e.prototype.padding=function(t){var r=Y1(this.styles.cellPadding,0);return t==="vertical"?r.top+r.bottom:t==="horizontal"?r.left+r.right:r[t]},e}(),yO=function(){function e(t,r,a){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=t,this.raw=r,this.index=a}return e.prototype.getMaxCustomCellWidth=function(t){for(var r=0,a=0,n=t.allRows();a<n.length;a++){var s=n[a],o=s.cells[this.index];o&&typeof o.styles.cellWidth=="number"&&(r=Math.max(r,o.styles.cellWidth))}return r},e}();function wO(e,t){bO(e,t);var r=[],a=0;t.columns.forEach(function(s){var o=s.getMaxCustomCellWidth(t);o?s.width=o:(s.width=s.wrappedWidth,r.push(s)),a+=s.width});var n=t.getWidth(e.pageSize().width)-a;n&&(n=iv(r,n,function(s){return Math.max(s.minReadableWidth,s.minWidth)})),n&&(n=iv(r,n,function(s){return s.minWidth})),n=Math.abs(n),!t.settings.horizontalPageBreak&&n>.1/e.scaleFactor()&&(n=n<1?n:Math.round(n),console.warn("Of the table content, ".concat(n," units width could not fit page"))),NO(t),AO(t,e),SO(t)}function bO(e,t){var r=e.scaleFactor(),a=t.settings.horizontalPageBreak,n=h_(e,t);t.allRows().forEach(function(s){for(var o=0,c=t.columns;o<c.length;o++){var u=c[o],h=s.cells[u.index];if(h){var p=t.hooks.didParseCell;t.callCellHooks(e,p,h,s,u,null);var x=h.padding("horizontal");h.contentWidth=v1(h.text,h.styles,e)+x;var v=v1(h.text.join(" ").split(/[^\S\u00A0]+/),h.styles,e);if(h.minReadableWidth=v+h.padding("horizontal"),typeof h.styles.cellWidth=="number")h.minWidth=h.styles.cellWidth,h.wrappedWidth=h.styles.cellWidth;else if(h.styles.cellWidth==="wrap"||a===!0)h.contentWidth>n?(h.minWidth=n,h.wrappedWidth=n):(h.minWidth=h.contentWidth,h.wrappedWidth=h.contentWidth);else{var g=10/r;h.minWidth=h.styles.minCellWidth||g,h.wrappedWidth=h.contentWidth,h.minWidth>h.wrappedWidth&&(h.wrappedWidth=h.minWidth)}}}}),t.allRows().forEach(function(s){for(var o=0,c=t.columns;o<c.length;o++){var u=c[o],h=s.cells[u.index];if(h&&h.colSpan===1)u.wrappedWidth=Math.max(u.wrappedWidth,h.wrappedWidth),u.minWidth=Math.max(u.minWidth,h.minWidth),u.minReadableWidth=Math.max(u.minReadableWidth,h.minReadableWidth);else{var p=t.styles.columnStyles[u.dataKey]||t.styles.columnStyles[u.index]||{},x=p.cellWidth||p.minCellWidth;x&&typeof x=="number"&&(u.minWidth=x,u.wrappedWidth=x)}h&&(h.colSpan>1&&!u.minWidth&&(u.minWidth=h.minWidth),h.colSpan>1&&!u.wrappedWidth&&(u.wrappedWidth=h.minWidth))}})}function iv(e,t,r){for(var a=t,n=e.reduce(function(g,w){return g+w.wrappedWidth},0),s=0;s<e.length;s++){var o=e[s],c=o.wrappedWidth/n,u=a*c,h=o.width+u,p=r(o),x=h<p?p:h;t-=x-o.width,o.width=x}if(t=Math.round(t*1e10)/1e10,t){var v=e.filter(function(g){return t<0?g.width>r(g):!0});v.length&&(t=iv(v,t,r))}return t}function SO(e){for(var t={},r=1,a=e.allRows(),n=0;n<a.length;n++)for(var s=a[n],o=0,c=e.columns;o<c.length;o++){var u=c[o],h=t[u.index];if(r>1)r--,delete s.cells[u.index];else if(h)h.cell.height+=s.height,r=h.cell.colSpan,delete s.cells[u.index],h.left--,h.left<=1&&delete t[u.index];else{var p=s.cells[u.index];if(!p)continue;if(p.height=s.height,p.rowSpan>1){var x=a.length-n,v=p.rowSpan>x?x:p.rowSpan;t[u.index]={cell:p,left:v,row:s}}}}}function NO(e){for(var t=e.allRows(),r=0;r<t.length;r++)for(var a=t[r],n=null,s=0,o=0,c=0;c<e.columns.length;c++){var u=e.columns[c];if(o-=1,o>1&&e.columns[c+1])s+=u.width,delete a.cells[u.index];else if(n){var h=n;delete a.cells[u.index],n=null,h.width=u.width+s}else{var h=a.cells[u.index];if(!h)continue;if(o=h.colSpan,s=0,h.colSpan>1){n=h,s+=u.width;continue}h.width=u.width+s}}}function AO(e,t){for(var r={count:0,height:0},a=0,n=e.allRows();a<n.length;a++){for(var s=n[a],o=0,c=e.columns;o<c.length;o++){var u=c[o],h=s.cells[u.index];if(h){t.applyStyles(h.styles,!0);var p=h.width-h.padding("horizontal");if(h.styles.overflow==="linebreak")h.text=t.splitTextToSize(h.text,p+1/t.scaleFactor(),{fontSize:h.styles.fontSize});else if(h.styles.overflow==="ellipsize")h.text=u3(h.text,p,h.styles,t,"...");else if(h.styles.overflow==="hidden")h.text=u3(h.text,p,h.styles,t,"");else if(typeof h.styles.overflow=="function"){var x=h.styles.overflow(h.text,p);typeof x=="string"?h.text=[x]:h.text=x}h.contentHeight=h.getContentHeight(t.scaleFactor(),t.getLineHeightFactor());var v=h.contentHeight/h.rowSpan;h.rowSpan>1&&r.count*r.height<v*h.rowSpan?r={height:v,count:h.rowSpan}:r&&r.count>0&&r.height>v&&(v=r.height),v>s.height&&(s.height=v)}}r.count--}}function u3(e,t,r,a,n){return e.map(function(s){return _O(s,t,r,a,n)})}function _O(e,t,r,a,n){var s=1e4*a.scaleFactor();if(t=Math.ceil(t*s)/s,t>=v1(e,r,a))return e;for(;t<v1(e+n,r,a)&&!(e.length<=1);)e=e.substring(0,e.length-1);return e.trim()+n}function v_(e,t){var r=new ah(e),a=TO(t,r.scaleFactor()),n=new vO(t,a);return wO(r,n),r.applyStyles(r.userStyles),n}function TO(e,t){var r=e.content,a=EO(r.columns);if(r.head.length===0){var n=f3(a,"head");n&&r.head.push(n)}if(r.foot.length===0){var n=f3(a,"foot");n&&r.foot.push(n)}var s=e.settings.theme,o=e.styles;return{columns:a,head:e2("head",r.head,a,o,s,t),body:e2("body",r.body,a,o,s,t),foot:e2("foot",r.foot,a,o,s,t)}}function e2(e,t,r,a,n,s){var o={},c=t.map(function(u,h){for(var p=0,x={},v=0,g=0,w=0,b=r;w<b.length;w++){var N=b[w];if(o[N.index]==null||o[N.index].left===0)if(g===0){var _=void 0;Array.isArray(u)?_=u[N.index-v-p]:_=u[N.dataKey];var E={};typeof _=="object"&&!Array.isArray(_)&&(E=(_==null?void 0:_.styles)||{});var j=jO(e,N,h,n,a,s,E),M=new g_(_,j,e);x[N.dataKey]=M,x[N.index]=M,g=M.colSpan-1,o[N.index]={left:M.rowSpan-1,times:g}}else g--,v++;else o[N.index].left--,g=o[N.index].times,p++}return new x_(u,h,e,x)});return c}function f3(e,t){var r={};return e.forEach(function(a){if(a.raw!=null){var n=kO(t,a.raw);n!=null&&(r[a.dataKey]=n)}}),Object.keys(r).length>0?r:null}function kO(e,t){if(e==="head"){if(typeof t=="object")return t.header||null;if(typeof t=="string"||typeof t=="number")return t}else if(e==="foot"&&typeof t=="object")return t.footer;return null}function EO(e){return e.map(function(t,r){var a,n;return typeof t=="object"?n=(a=t.dataKey)!==null&&a!==void 0?a:r:n=r,new yO(n,t,r)})}function jO(e,t,r,a,n,s,o){var c=nO(a),u;e==="head"?u=n.headStyles:e==="body"?u=n.bodyStyles:e==="foot"&&(u=n.footStyles);var h=Cc({},c.table,c[e],n.styles,u),p=n.columnStyles[t.dataKey]||n.columnStyles[t.index]||{},x=e==="body"?p:{},v=e==="body"&&r%2===0?Cc({},c.alternateRow,n.alternateRowStyles):{},g=aO(s),w=Cc({},g,h,v,x);return Cc(w,o)}function CO(e,t,r){var a;r===void 0&&(r={});var n=h_(e,t),s=new Map,o=[],c=[],u=[];Array.isArray(t.settings.horizontalPageBreakRepeat)?u=t.settings.horizontalPageBreakRepeat:(typeof t.settings.horizontalPageBreakRepeat=="string"||typeof t.settings.horizontalPageBreakRepeat=="number")&&(u=[t.settings.horizontalPageBreakRepeat]),u.forEach(function(v){var g=t.columns.find(function(w){return w.dataKey===v||w.index===v});g&&!s.has(g.index)&&(s.set(g.index,!0),o.push(g.index),c.push(t.columns[g.index]),n-=g.wrappedWidth)});for(var h=!0,p=(a=r==null?void 0:r.start)!==null&&a!==void 0?a:0;p<t.columns.length;){if(s.has(p)){p++;continue}var x=t.columns[p].wrappedWidth;if(h||n>=x)h=!1,o.push(p),c.push(t.columns[p]),n-=x;else break;p++}return{colIndexes:o,columns:c,lastIndex:p-1}}function DO(e,t){for(var r=[],a=0;a<t.columns.length;a++){var n=CO(e,t,{start:a});n.columns.length&&(r.push(n),a=n.lastIndex)}return r}function y_(e,t){var r=t.settings,a=r.startY,n=r.margin,s={x:n.left,y:a},o=t.getHeadHeight(t.columns)+t.getFootHeight(t.columns),c=a+n.bottom+o;if(r.pageBreak==="avoid"){var u=t.body,h=u.reduce(function(v,g){return v+g.height},0);c+=h}var p=new ah(e);(r.pageBreak==="always"||r.startY!=null&&c>p.pageSize().height)&&(b_(p),s.y=n.top),t.callWillDrawPageHooks(p,s);var x=Cc({},s);t.startPageNumber=p.pageNumber(),r.horizontalPageBreak?FO(p,t,x,s):(p.applyStyles(p.userStyles),(r.showHead==="firstPage"||r.showHead==="everyPage")&&t.head.forEach(function(v){return zc(p,t,v,s,t.columns)}),p.applyStyles(p.userStyles),t.body.forEach(function(v,g){var w=g===t.body.length-1;y1(p,t,v,w,x,s,t.columns)}),p.applyStyles(p.userStyles),(r.showFoot==="lastPage"||r.showFoot==="everyPage")&&t.foot.forEach(function(v){return zc(p,t,v,s,t.columns)})),u_(p,t,x,s),t.callEndPageHooks(p,s),t.finalY=s.y,e.lastAutoTable=t,p.applyStyles(p.userStyles)}function FO(e,t,r,a){var n=DO(e,t),s=t.settings;if(s.horizontalPageBreakBehaviour==="afterAllRows")n.forEach(function(h,p){e.applyStyles(e.userStyles),p>0?Cd(e,t,r,a,h.columns,!0):h3(e,t,a,h.columns),PO(e,t,r,a,h.columns),t2(e,t,a,h.columns)});else for(var o=-1,c=n[0],u=function(){var h=o;if(c){e.applyStyles(e.userStyles);var p=c.columns;o>=0?Cd(e,t,r,a,p,!0):h3(e,t,a,p),h=d3(e,t,o+1,a,p),t2(e,t,a,p)}var x=h-o;n.slice(1).forEach(function(v){e.applyStyles(e.userStyles),Cd(e,t,r,a,v.columns,!0),d3(e,t,o+1,a,v.columns,x),t2(e,t,a,v.columns)}),o=h};o<t.body.length-1;)u()}function h3(e,t,r,a){var n=t.settings;e.applyStyles(e.userStyles),(n.showHead==="firstPage"||n.showHead==="everyPage")&&t.head.forEach(function(s){return zc(e,t,s,r,a)})}function PO(e,t,r,a,n){e.applyStyles(e.userStyles),t.body.forEach(function(s,o){var c=o===t.body.length-1;y1(e,t,s,c,r,a,n)})}function d3(e,t,r,a,n,s){e.applyStyles(e.userStyles),s=s??t.body.length;var o=Math.min(r+s,t.body.length),c=-1;return t.body.slice(r,o).forEach(function(u,h){var p=r+h===t.body.length-1,x=w_(e,t,p,a);u.canEntireRowFit(x,n)&&(zc(e,t,u,a,n),c=r+h)}),c}function t2(e,t,r,a){var n=t.settings;e.applyStyles(e.userStyles),(n.showFoot==="lastPage"||n.showFoot==="everyPage")&&t.foot.forEach(function(s){return zc(e,t,s,r,a)})}function LO(e,t,r){var a=r.getLineHeight(e.styles.fontSize),n=e.padding("vertical"),s=Math.floor((t-n)/a);return Math.max(0,s)}function OO(e,t,r,a){var n={};e.spansMultiplePages=!0,e.height=0;for(var s=0,o=0,c=r.columns;o<c.length;o++){var u=c[o],h=e.cells[u.index];if(h){Array.isArray(h.text)||(h.text=[h.text]);var p=new g_(h.raw,h.styles,h.section);p=Cc(p,h),p.text=[];var x=LO(h,t,a);h.text.length>x&&(p.text=h.text.splice(x,h.text.length));var v=a.scaleFactor(),g=a.getLineHeightFactor();h.contentHeight=h.getContentHeight(v,g),h.contentHeight>=t&&(h.contentHeight=t,p.styles.minCellHeight-=t),h.contentHeight>e.height&&(e.height=h.contentHeight),p.contentHeight=p.getContentHeight(v,g),p.contentHeight>s&&(s=p.contentHeight),n[u.index]=p}}var w=new x_(e.raw,-1,e.section,n,!0);w.height=s;for(var b=0,N=r.columns;b<N.length;b++){var u=N[b],p=w.cells[u.index];p&&(p.height=w.height);var h=e.cells[u.index];h&&(h.height=e.height)}return w}function RO(e,t,r,a){var n=e.pageSize().height,s=a.settings.margin,o=s.top+s.bottom,c=n-o;t.section==="body"&&(c-=a.getHeadHeight(a.columns)+a.getFootHeight(a.columns));var u=t.getMinimumRowHeight(a.columns,e),h=u<r;if(u>c)return console.error("Will not be able to print row ".concat(t.index," correctly since it's minimum height is larger than page height")),!0;if(!h)return!1;var p=t.hasRowSpan(a.columns),x=t.getMaxCellHeight(a.columns)>c;return x?(p&&console.error("The content of row ".concat(t.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(p||a.settings.rowPageBreak==="avoid")}function y1(e,t,r,a,n,s,o){var c=w_(e,t,a,s);if(r.canEntireRowFit(c,o))zc(e,t,r,s,o);else if(RO(e,r,c,t)){var u=OO(r,c,t,e);zc(e,t,r,s,o),Cd(e,t,n,s,o),y1(e,t,u,a,n,s,o)}else Cd(e,t,n,s,o),y1(e,t,r,a,n,s,o)}function zc(e,t,r,a,n){a.x=t.settings.margin.left;for(var s=0,o=n;s<o.length;s++){var c=o[s],u=r.cells[c.index];if(!u){a.x+=c.width;continue}e.applyStyles(u.styles),u.x=a.x,u.y=a.y;var h=t.callCellHooks(e,t.hooks.willDrawCell,u,r,c,a);if(h===!1){a.x+=c.width;continue}MO(e,u,a);var p=u.getTextPos();o_(u.text,p.x,p.y,{halign:u.styles.halign,valign:u.styles.valign,maxWidth:Math.ceil(u.width-u.padding("left")-u.padding("right"))},e.getDocument()),t.callCellHooks(e,t.hooks.didDrawCell,u,r,c,a),a.x+=c.width}a.y+=r.height}function MO(e,t,r){var a=t.styles;if(e.getDocument().setFillColor(e.getDocument().getFillColor()),typeof a.lineWidth=="number"){var n=f_(a.lineWidth,a.fillColor);n&&e.rect(t.x,r.y,t.width,t.height,n)}else typeof a.lineWidth=="object"&&(a.fillColor&&e.rect(t.x,r.y,t.width,t.height,"F"),IO(e,t,r,a.lineWidth))}function IO(e,t,r,a){var n,s,o,c;a.top&&(n=r.x,s=r.y,o=r.x+t.width,c=r.y,a.right&&(o+=.5*a.right),a.left&&(n-=.5*a.left),u(a.top,n,s,o,c)),a.bottom&&(n=r.x,s=r.y+t.height,o=r.x+t.width,c=r.y+t.height,a.right&&(o+=.5*a.right),a.left&&(n-=.5*a.left),u(a.bottom,n,s,o,c)),a.left&&(n=r.x,s=r.y,o=r.x,c=r.y+t.height,a.top&&(s-=.5*a.top),a.bottom&&(c+=.5*a.bottom),u(a.left,n,s,o,c)),a.right&&(n=r.x+t.width,s=r.y,o=r.x+t.width,c=r.y+t.height,a.top&&(s-=.5*a.top),a.bottom&&(c+=.5*a.bottom),u(a.right,n,s,o,c));function u(h,p,x,v,g){e.getDocument().setLineWidth(h),e.getDocument().line(p,x,v,g,"S")}}function w_(e,t,r,a){var n=t.settings.margin.bottom,s=t.settings.showFoot;return(s==="everyPage"||s==="lastPage"&&r)&&(n+=t.getFootHeight(t.columns)),e.pageSize().height-a.y-n}function Cd(e,t,r,a,n,s){n===void 0&&(n=[]),s===void 0&&(s=!1),e.applyStyles(e.userStyles),t.settings.showFoot==="everyPage"&&!s&&t.foot.forEach(function(c){return zc(e,t,c,a,n)}),t.callEndPageHooks(e,a);var o=t.settings.margin;u_(e,t,r,a),b_(e),t.pageNumber++,a.x=o.left,a.y=o.top,r.y=o.top,t.callWillDrawPageHooks(e,a),t.settings.showHead==="everyPage"&&(t.head.forEach(function(c){return zc(e,t,c,a,n)}),e.applyStyles(e.userStyles))}function b_(e){var t=e.pageNumber();e.setPage(t+1);var r=e.pageNumber();return r===t?(e.addPage(),!0):!1}function BO(e){e.API.autoTable=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var a=t[0],n=m_(this,a),s=v_(this,n);return y_(this,s),this},e.API.lastAutoTable=!1,e.API.autoTableText=function(t,r,a,n){o_(t,r,a,n,this)},e.API.autoTableSetDefaults=function(t){return ah.setDefaults(t,this),this},e.autoTableSetDefaults=function(t,r){ah.setDefaults(t,r)},e.API.autoTableHtmlToJson=function(t,r){var a;if(r===void 0&&(r=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var n=new ah(this),s=p_(n,t,window,r,!1),o=s.head,c=s.body,u=((a=o[0])===null||a===void 0?void 0:a.map(function(h){return h.content}))||[];return{columns:u,rows:c,data:c}}}var r2;function vy(e,t){var r=m_(e,t),a=v_(e,r);y_(e,a)}try{if(typeof window<"u"&&window){var p3=window,m3=p3.jsPDF||((r2=p3.jspdf)===null||r2===void 0?void 0:r2.jsPDF);m3&&BO(m3)}}catch(e){console.error("Could not apply autoTable plugin",e)}const UO=({setConfirmBox:e,deleteProject:t,project:r})=>{const a=n=>{n&&t(r.projectName),e(!1)};return f.jsx("div",{className:"fixed inset-0 bg-transparent backdrop-blur-lg bg-opacity-40 flex items-center justify-center z-50",children:f.jsxs("div",{className:"bg-white p-6 rounded-md shadow-md text-center",children:[f.jsx("p",{className:"mb-4",children:"Do you want to the delete the project ?"}),f.jsxs("div",{className:"flex justify-center gap-4",children:[f.jsx("button",{onClick:()=>a(!0),className:"px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600",children:"Yes"}),f.jsx("button",{onClick:()=>a(!1),className:"px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600",children:"No"})]})]})})},zO=["All","Approved","Goods Pending","Goods Complete","Tailor Complete","Tailor Pending"];function HO(){const[e,t]=P.useState([]),[r,a]=P.useState("all"),[n,s]=P.useState(null),[o,c]=P.useState(!1),[u,h]=P.useState([]),[p,x]=P.useState([]),[v,g]=P.useState(0),w=wa(),b=ur(ue=>ue.data.projects),N=ur(ue=>ue.data.tasks);ur(ue=>ue.data.projectFlag),ur(ue=>ue.data.paymentData);const[_,E]=P.useState([]),[j,M]=P.useState(0),U=async()=>{const ue=await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/getprojectdata",{credentials:"include"});if(!ue.ok)throw new Error(`HTTP error! Status: ${ue.status}`);const fe=await ue.json();if(!fe.body||!Array.isArray(fe.body))throw new Error("Invalid data format: Expected an array in data.body");const Ee=(ke,de)=>{try{return typeof ke=="string"?JSON.parse(ke):ke||de}catch(rt){return console.warn("Invalid JSON:",ke,rt),de}},J=ke=>JSON.parse(JSON.stringify(ke)),Pe=ke=>{if(Array.isArray(ke))return ke;if(typeof ke!="string")return[];try{const de=JSON.parse(ke);return Array.isArray(de)?de:[]}catch{try{return ke.replace(/^\[|\]$/g,"").split(",").map(rt=>rt.trim().replace(/^"+|"+$/g,""))}catch{return[]}}};return fe.body.map(ke=>({projectName:ke[0],customerLink:Ee(ke[1],[]),projectReference:ke[2]||"",status:ke[3]||"",totalAmount:parseFloat(ke[4])||0,totalTax:parseFloat(ke[5])||0,paid:parseFloat(ke[6])||0,discount:parseFloat(ke[7])||0,createdBy:ke[8]||"",allData:J(Ee(ke[9],[])),projectDate:ke[10]||"",additionalRequests:Ee(ke[11],[]),interiorArray:Pe(ke[12]),salesAssociateArray:Pe(ke[13]),additionalItems:J(Ee(ke[14],[])),goodsArray:J(Ee(ke[15],[])),tailorsArray:J(Ee(ke[16],[])),projectAddress:ke[17],date:ke[18],grandTotal:ke[19]}))},[V,I]=P.useState(!1),z=async()=>(await(await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/getPayments")).json()).message,[H,re]=P.useState(!1);P.useEffect(()=>{(async()=>{var fe,Ee;try{const J=localStorage.getItem("projectData"),Pe=Date.now(),st=5*60*1e3;if(J){const de=JSON.parse(J);if(((fe=de==null?void 0:de.data)==null?void 0:fe.length)>0&&Pe-de.time<st){w(La(de.data)),t(de.data);return}}const ke=await U();Array.isArray(ke)?(w(La(ke)),t(ke),localStorage.setItem("projectData",JSON.stringify({data:ke,time:Pe}))):console.warn("Fetched project data is not an array:",ke)}catch(J){console.error("Failed to fetch projects:",J);const Pe=localStorage.getItem("projectData");if(Pe){const st=JSON.parse(Pe);((Ee=st==null?void 0:st.data)==null?void 0:Ee.length)>0&&(w(La(st.data)),t(st.data))}}})()},[w]),P.useEffect(()=>{const ue=async()=>{try{const fe=await R();w(sl(fe)),x(fe),re(!1)}catch(fe){console.error("Failed to fetch tasks:",fe)}};(!N.length||H)&&ue()},[w,N.length,H]),P.useEffect(()=>{const ue=async()=>{try{const fe=await z();if(w(Kl(fe)),fe&&(b!=null&&b.length)){const Ee=b.map(J=>fe.filter(st=>st[1]===J.projectName).reduce((st,ke)=>{const de=parseFloat(ke[2]);return st+(isNaN(de)?0:de)},0));E(Ee)}I(!0)}catch(fe){console.error("Failed to fetch payments:",fe)}};!V&&(b!=null&&b.length)&&ue()},[w,V,b]);const R=async()=>(await(await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/gettasks")).json()).body||[],[F,Y]=P.useState([]),K=async ue=>{await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/deletetask",{method:"POST",headers:{"content-type":"application/json"},credentials:"include",body:JSON.stringify({title:ue})}),I(!1)},X=r==="all"?e:e.filter(ue=>ue.status===r),Z=async ue=>{try{const fe=await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/deleteprojectdata",{method:"POST",headers:{"content-type":"application/json"},credentials:"include",body:JSON.stringify({projectName:ue})}),J=(await R()).filter(Pe=>Pe[5]===ue).map(Pe=>Pe[0]);Y(J);for(const Pe of J)await K(Pe);if(fe.status===200){alert("Project Deleted");const Pe=localStorage.getItem("projectData");let st=[];if(Pe){const de=JSON.parse(Pe);Array.isArray(de.data)&&(st=de.data)}const ke=st.filter(de=>de.projectName!==ue);w(La(ke)),t(ke),localStorage.setItem("projectData",JSON.stringify({data:ke,time:Date.now()}))}else alert("Error")}catch(fe){console.error("Error deleting project:",fe),alert("Error: Network issue or server not responding")}},[ce,te]=P.useState(!1),[Q,G]=P.useState(!1),[ye,D]=P.useState(0),[O,L]=P.useState(0),[q,oe]=P.useState(0),be=ue=>{L(b[ue].totalTax),D(b[ue].totalAmount),oe(b[ue].discount!==void 0?b[ue].discount:0),M(b[ue].grandTotal)},ve=ue=>{var de;const fe=new dr,Ee=fe.internal.pageSize.getWidth(),J=fe.internal.pageSize.getHeight();let Pe=20;fe.setFontSize(18),fe.setFont("helvetica","bold"),fe.text("Quotation",Ee/2,Pe,{align:"center"}),Pe+=10,fe.setFontSize(12),fe.setFont("helvetica","normal"),fe.text("Sheela Decor",20,Pe),Pe+=7,fe.text("123 Business Street, City, Country",20,Pe),Pe+=7,fe.text("Email: contact@sheeladecor.com",20,Pe),Pe+=7,fe.text("Phone: +123 456 7890",20,Pe),Pe+=10,fe.setFontSize(10),fe.text(`Quotation Date: ${ue.projectDate||"N/A"}`,20,Pe),fe.text(`Project: ${ue.projectName||"N/A"}`,Ee-80,Pe),Pe+=7,fe.text(`Customer: ${((de=ue.customerLink)==null?void 0:de[0])||"N/A"}`,20,Pe),fe.text(`Reference: ${ue.projectReference||"N/A"}`,Ee-80,Pe),Pe+=15;const st=[];let ke=1;ue.allData.forEach(rt=>{rt.areacollection&&rt.areacollection.length>0&&rt.areacollection.forEach(Ue=>{const Xe=Ue.productGroup;if(!Array.isArray(Xe)||Xe.length<2)return;(Xe.length>2?Xe.slice(1,-2):[]).map(At=>Ue.items.find(ze=>ze[0]===At)||At).filter(At=>Array.isArray(At)).forEach((At,ct)=>{var pt,Ot,It;const ze=((pt=Ue.quantities)==null?void 0:pt[ct])||0;st.push([ke++,`${At[0]} * ${Ue.measurement.quantity}`,`${Ue.measurement.width} x ${Ue.measurement.height} ${Ue.measurement.unit}`,(At[4]*parseFloat(Ue.measurement.quantity)).toFixed(2),ze,(At[4]*parseFloat(Ue.measurement.quantity)*ze).toFixed(2),At[5].toFixed(2),((Ot=Ue.totalTax[ct])==null?void 0:Ot.toFixed(2))||"0.00",((It=Ue.totalAmount[ct])==null?void 0:It.toFixed(2))||"0.00"])})})}),ue.additionalItems.forEach(rt=>{st.push([ke++,rt.name||"N/A","N/A",rt.rate.toFixed(2),rt.quantity,rt.netRate.toFixed(2),rt.tax.toFixed(2),rt.taxAmount.toFixed(2),rt.totalAmount.toFixed(2)])}),vy(fe,{startY:Pe,head:[["Sr. No.","Product Name","Size","MRP","Quantity","Subtotal","Tax Rate (%)","Tax Amount","Total"]],body:st,theme:"grid",styles:{fontSize:8,cellPadding:2},headStyles:{fillColor:[0,102,204],textColor:[255,255,255]},alternateRowStyles:{fillColor:[240,240,240]}}),Pe=fe.lastAutoTable.finalY+10,fe.setFontSize(10),fe.setFont("helvetica","bold"),fe.text("Summary",20,Pe),Pe+=7,fe.setFont("helvetica","normal"),fe.text(`Sub Total: ${ue.totalAmount.toFixed(2)}`,Ee-80,Pe),Pe+=7,fe.text(`Total Tax Amount: ${ue.totalTax.toFixed(2)}`,Ee-80,Pe),Pe+=7,fe.text(`Total Amount: ${(ue.totalAmount+ue.totalTax).toFixed(2)}`,Ee-80,Pe),Pe+=7,fe.text(`Discount: ${ue.discount.toFixed(2)}`,Ee-80,Pe),Pe+=7,fe.text(`Grand Total: ${j.toFixed(2)}`,Ee-80,Pe),Pe=J-20,fe.setFontSize(8),fe.text("Thank you for your business!",Ee/2,Pe,{align:"center"}),fe.save(`Quotation_${ue.projectName||"Project"}_${ue.projectDate||"Date"}.pdf`)};return f.jsxs("div",{className:"md:!p-6 p-2 md:mt-0 mt-20 h-screen bg-gray-50",children:[f.jsxs("div",{className:"flex justify-between flex-wrap items-center mb-4",children:[f.jsx("h1",{className:"text-2xl font-bold",children:"Projects"}),f.jsx(xi,{to:"/add-project",children:f.jsxs("button",{className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 !rounded-md",children:[f.jsx(Vc,{size:18})," Add Project"]})})]}),f.jsxs("div",{className:"bg-white md:!p-6 p-2 mt-5 md:mt-0 rounded-md shadow overflow-x-auto",children:[f.jsxs("div",{className:`${o?"hidden":""} mb-4 flex gap-4`,children:[f.jsx("select",{value:r,onChange:ue=>a(ue.target.value),className:"border px-3 py-2 rounded-md",children:zO.map(ue=>f.jsx("option",{value:ue,children:ue},ue))}),f.jsx("input",{type:"text",placeholder:"Search projects...",className:"border px-3 py-2 rounded-md"})]}),f.jsxs("table",{className:`${o?"hidden":""} w-full`,children:[f.jsx("thead",{className:"bg-sky-50",children:f.jsxs("tr",{children:[f.jsx("th",{className:"px-4 py-2",children:"Project Name"}),f.jsx("th",{className:"px-4 py-2",children:"Customer Name"}),f.jsx("th",{className:"px-4 py-2",children:"Amount"}),f.jsx("th",{className:"px-4 py-2",children:"Received"}),f.jsx("th",{className:"px-4 py-2",children:"Due"}),f.jsx("th",{className:"px-4 py-2",children:"Created By"}),f.jsx("th",{className:"px-4 py-2",children:"Deadline Date"}),f.jsx("th",{className:"px-4 py-2",children:"Created On"}),f.jsx("th",{className:"px-4 py-2",children:"Quote"}),f.jsx("th",{className:"px-4 py-2",children:"Actions"})]})}),f.jsx("tbody",{children:X.map((ue,fe)=>f.jsxs("tr",{onClick:()=>{be(fe),s(fe),h(ue),c(!0)},className:"hover:bg-sky-50",children:[f.jsx("td",{className:"px-4 py-2",children:ue.projectName}),f.jsx("td",{className:"px-4 py-2",children:ue.customerLink?ue.customerLink[0]:""}),f.jsx("td",{className:"px-4 py-2",children:ue.grandTotal}),f.jsx("td",{className:"px-4 py-2",children:_[fe]}),f.jsx("td",{className:"px-4 py-2",children:(ue.totalAmount+ue.totalTax-ue.discount-(_[fe]||0)).toFixed(2)}),f.jsx("td",{className:"px-4 py-2",children:ue.createdBy}),f.jsx("td",{className:"px-4 py-2",children:ue.projectDate}),f.jsx("td",{className:"px-4 py-2",children:ue.date}),f.jsx("td",{className:"px-4 py-2",children:f.jsx("button",{onClick:()=>ve(ue),className:"border px-2 py-1 rounded-md bg-green-500 text-white",children:f.jsx(B8,{size:16})})}),f.jsx("td",{className:"px-4 py-2",children:f.jsxs("div",{className:"flex gap-2",children:[f.jsx("button",{onClick:()=>{be(fe),s(fe),h(ue),c(!0)},className:"border px-2 py-1 rounded-md",children:f.jsx(Zf,{size:16})}),f.jsx("button",{onClick:()=>{G(ue),te(!0)},className:"border px-2 py-1 rounded-md",children:f.jsx(Kf,{size:16})})]})})]},fe))})]}),o&&f.jsx(BA,{projectData:u,index:n,goBack:()=>{c(!1),w(ch(!1))},tasks:p,projects:X,Tax:O,setTax:L,Amount:ye,setAmount:D,Discount:q,setDiscount:oe,grandTotal:j,setGrandTotal:M}),ce&&f.jsx(UO,{setConfirmBox:te,deleteProject:Z,project:Q})]})]})}async function VO(){try{const e=await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/getcustomerdata",{credentials:"include"});if(!e.ok)throw new Error(`HTTP error! Status: ${e.status}`);const t=await e.json();return Array.isArray(t.body)?t.body:[]}catch(e){return console.error("Error fetching customer data:",e),[]}}const S_=({setDialogOpen:e,setCustomers:t,editing:r,setEditing:a})=>{const n=ua(),[s,o]=P.useState(r?r[0]:""),[c,u]=P.useState(r?r[1]:""),[h,p]=P.useState(r?r[3]:""),[x,v]=P.useState(r?r[4]:""),[g,w]=P.useState(r?r[2]:""),b=wa();ur(_=>_.data.customers);async function N(){const _=c;let E;if(r||(E=new Date().toISOString().slice(0,16)),r&&o(r[0]),(await fetch(r?"https://sheeladecor.netlify.app/.netlify/functions/server/updatecustomerdata":"https://sheeladecor.netlify.app/.netlify/functions/server/sendcustomerdata",{method:"POST",headers:{"content-type":"application/json"},credentials:"include",body:JSON.stringify({name:s,phonenumber:_,email:g,address:h,alternatenumber:x,addedDate:E})})).status===200){const U=await VO();b(Lc(U)),localStorage.setItem("customerData",JSON.stringify({data:U,time:Date.now()})),o(""),p(""),u(""),w(""),v(""),alert(r?"Customer Updated Successfully":"Customer added successfully")}else alert(r?"Error in updating customer":"Error in adding customer");r||n("/customers"),a(null),e(!1)}return f.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-white bg-opacity-30 z-50",children:f.jsxs("div",{className:"bg-white p-6 rounded shadow-md w-full max-w-md border",children:[f.jsx("h2",{className:"text-xl font-bold mb-4",children:r?"Edit Customer":"Add Customer"}),f.jsx("input",{className:`${r?"hidden":""} border p-2 rounded w-full mb-2`,placeholder:"Name",value:s,onChange:_=>o(_.target.value)}),f.jsx("input",{className:"border p-2 rounded w-full mb-2",placeholder:"Email",value:g,onChange:_=>w(_.target.value)}),f.jsx("input",{className:"border p-2 rounded w-full mb-2",placeholder:"Mobile Number",value:c,onChange:_=>u(_.target.value)}),f.jsx("input",{className:"border p-2 rounded w-full mb-2",placeholder:"Address",value:h,onChange:_=>p(_.target.value)}),f.jsx("input",{className:"border p-2 rounded w-full mb-2",placeholder:"Alternate Number",value:x,onChange:_=>v(_.target.value)}),f.jsxs("div",{className:"flex justify-end gap-2",children:[f.jsx("button",{className:"bg-gray-500 text-white px-4 py-2 rounded",onClick:()=>{r||n("/customers"),a(null),e(!1)},children:"Cancel"}),f.jsx("button",{className:"bg-blue-500 text-white px-4 py-2 rounded",onClick:N,children:"Save"})]})]})})};async function qO(){try{const e=await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/getcustomerdata",{credentials:"include"});if(!e.ok)throw new Error(`HTTP error! Status: ${e.status}`);const t=await e.json();return Array.isArray(t.body)?t.body:[]}catch(e){return console.error("Error fetching customer data:",e),[]}}const GO=async()=>(await(await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/getPayments")).json()).message,WO=async()=>{const e=await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/getprojectdata",{credentials:"include"});if(!e.ok)throw new Error(`HTTP error! Status: ${e.status}`);const t=await e.json();if(!t.body||!Array.isArray(t.body))throw new Error("Invalid data format: Expected an array in data.body");const r=(o,c)=>{try{return typeof o=="string"?JSON.parse(o):o||c}catch(u){return console.warn("Invalid JSON:",o,u),c}},a=o=>JSON.parse(JSON.stringify(o)),n=o=>{if(Array.isArray(o))return o;if(typeof o!="string")return[];try{const c=JSON.parse(o);return Array.isArray(c)?c:[]}catch{try{return o.replace(/^\[|\]$/g,"").split(",").map(u=>u.trim().replace(/^"+|"+$/g,""))}catch{return[]}}};return t.body.map(o=>({projectName:o[0],customerLink:r(o[1],[]),projectReference:o[2]||"",status:o[3]||"",totalAmount:parseFloat(o[4])||0,totalTax:parseFloat(o[5])||0,paid:parseFloat(o[6])||0,discount:parseFloat(o[7])||0,createdBy:o[8]||"",allData:a(r(o[9],[])),projectDate:o[10]||"",additionalRequests:r(o[11],[]),interiorArray:n(o[12]),salesAssociateArray:n(o[13]),additionalItems:a(r(o[14],[])),goodsArray:a(r(o[15],[])),tailorsArray:a(r(o[16],[])),projectAddress:o[17]}))},$O=({customerDashboardData:e,setCustomerDashboardData:t,setCustomerDashboard:r})=>{const[a,n]=P.useState(""),[s,o]=P.useState(""),[c,u]=P.useState(""),[h,p]=P.useState(""),[x,v]=P.useState(""),[g,w]=P.useState([]),[b,N]=P.useState(0),[_,E]=P.useState(0),[j,M]=P.useState(0),U=wa(),V=ur(X=>X.data.paymentData),I=ur(X=>X.data.projects),[z,H]=P.useState(""),[re,R]=P.useState(""),[F,Y]=P.useState([]);P.useEffect(()=>{o(e[2]),n(e[0]),u(e[1]),p(e[4]),v(e[3])},[]),P.useEffect(()=>{const X=async()=>{const ce=localStorage.getItem("projectData"),te=Date.now();if(ce){const Q=JSON.parse(ce);if(te-Q.time<3e5&&Q.data.length>0){U(La(Q.data)),Z(Q.data);return}}try{const Q=await WO();U(La(Q)),localStorage.setItem("projectData",JSON.stringify({data:Q,time:te})),Z(Q)}catch(Q){console.error("Failed to fetch projects:",Q)}},Z=ce=>{if(!e[0])return;const te=ce.filter(ye=>ye.customerLink[0]===e[0]);w(te),M(te.length),console.log(te);let Q=0,G=0;te.forEach(ye=>{Q+=parseFloat(ye.totalTax)||0,G+=parseFloat(ye.totalAmount)||0}),N(b+G+Q)};I.length?Z(I):X()},[U,I]),P.useEffect(()=>{const X=async()=>{try{const ce=localStorage.getItem("paymentData"),te=Date.now();if(ce){const G=JSON.parse(ce);if(te-G.time<3e5&&G.data.length){U(Kl(G.data)),Z(G.data);return}}const Q=await GO();U(Kl(Q)),localStorage.setItem("paymentData",JSON.stringify({data:Q,time:te})),Z(Q)}catch(ce){console.error("Failed to fetch payments:",ce)}},Z=ce=>{if(!e[0])return;console.log(ce);const te=ce.filter(Q=>Q[0]===e[0]).reduce((Q,G)=>{const ye=parseFloat(G[2]);return Q+(isNaN(ye)?0:ye)},0);E(te)};V.length&&X()},[U]);async function K(){let X;if(X=new Date().toISOString().slice(0,16),(await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/updatecustomerdata",{method:"POST",headers:{"content-type":"application/json"},credentials:"include",body:JSON.stringify({name:a,phonenumber:c,email:s,address:x,alternatenumber:h,addedDate:X,companyName:z,GST:re})})).status===200){const Q=await qO();U(Lc(Q)),localStorage.setItem("customerData",JSON.stringify({data:Q,time:Date.now()})),alert("Customer Updated Successfully")}else alert("Error in updating customer")}return f.jsxs("div",{className:"flex flex-col gap-3 w-full p-6",children:[f.jsxs("div",{className:"flex flex-row w-full justify-between items-center",children:[f.jsxs("div",{className:"flex flex-col gap-1",children:[f.jsx("p",{className:"text-[1.6vw] font-semibold",children:a}),f.jsxs("div",{className:"text-[0.8vw] flex flex-row gap-2",children:[f.jsx(xi,{to:"/",className:"!no-underline text-black",children:"Dashboard"}),"  •  ",f.jsx(xi,{to:"/customers",onClick:()=>r(!1),className:"!no-underline text-black",children:"Customers"}),"  •  ",a]})]}),f.jsx("button",{style:{borderRadius:"6px"},className:"text-white px-2 py-1 bg-sky-600 hover:bg-sky-700",onClick:()=>r(!1),children:"Cancel"})]}),f.jsxs("div",{className:"flex flex-row w-full justify-between gap-3",children:[f.jsxs("div",{className:"flex flex-col border rounded-xl p-3 w-1/3",children:[f.jsx("p",{className:"text-[1.2vw] text-sky-700",children:"Active Orders"}),f.jsx("p",{className:"text-[1.1vw]",children:j})]}),f.jsxs("div",{className:"flex flex-col border rounded-xl p-3 w-1/3",children:[f.jsx("p",{className:"text-[1.2vw] text-green-600",children:"Payment Received"}),f.jsxs("p",{className:"text-[1.1vw]",children:["₹",Math.round(_).toLocaleString("en-IN")]})]}),f.jsxs("div",{className:"flex flex-col border rounded-xl p-3 w-1/3",children:[f.jsx("p",{className:"text-[1.2vw] text-red-500",children:"Payment Due"}),f.jsxs("p",{className:"text-[1.1vw]",children:["₹",Math.round(b-_).toLocaleString("en-IN")]})]})]}),f.jsx("div",{className:"flex flex-col w-full border rounded-xl p-3",children:f.jsxs("table",{children:[f.jsx("thead",{children:f.jsxs("tr",{className:"text-gray-600",children:[f.jsx("th",{children:"Project Name"}),f.jsx("th",{children:"Status"}),f.jsx("th",{children:"Amount"}),f.jsx("th",{children:"Received"}),f.jsx("th",{children:"Due"}),f.jsx("th",{children:"Date"}),f.jsx("th",{children:"Quote"})]})}),f.jsx("tbody",{children:g&&g.map((X,Z)=>f.jsxs("tr",{className:"",children:[f.jsx("td",{children:X.projectName}),f.jsx("td",{children:X.status}),f.jsxs("td",{children:["₹",Math.round(b).toLocaleString("en-IN")]}),f.jsxs("td",{children:["₹",Math.round(_).toLocaleString("en-IN")]}),f.jsxs("td",{children:["₹",Math.round(b-_).toLocaleString("en-IN")]}),f.jsx("td",{className:"py-2",children:X.projectDate}),f.jsx("td",{className:"py-2",children:X.quote})]},Z))})]})}),f.jsxs("div",{className:"flex flex-col w-2/3 border rounded-xl p-3 gap-3",children:[f.jsx("p",{className:"text-[1.3vw] font-semibold",children:"Customer Details"}),f.jsxs("div",{className:"flex flex-row w-full justify-between gap-2",children:[f.jsxs("div",{className:"flex flex-col w-1/2",children:[f.jsxs("div",{className:"flex flex-row gap-1 -mb-3",children:[f.jsx("p",{className:"text-[0.9vw] text-gray-600",children:"Customer"}),f.jsx("p",{className:"text-red-600",children:"*"})]}),f.jsx("input",{type:"text",className:"border rounded-lg px-2 py-2 w-full",value:a})]}),f.jsxs("div",{className:"flex flex-col w-1/2",children:[f.jsx("div",{className:"flex flex-row gap-1 -mb-2",children:f.jsx("p",{className:"text-[0.9vw] text-gray-600",children:"Email"})}),f.jsx("input",{type:"text",onChange:X=>o(X.target.value),className:"border rounded-lg px-2 py-2 w-full",value:s})]})]}),f.jsxs("div",{className:"flex flex-row w-full justify-between gap-2",children:[f.jsxs("div",{className:"flex flex-col w-1/2",children:[f.jsx("div",{className:"flex flex-row gap-1 -mb-3 mt-1",children:f.jsx("p",{className:"text-[0.9vw] text-gray-600",children:"Phone Number"})}),f.jsx("input",{type:"text",onChange:X=>u(X.target.value),className:"border rounded-lg px-2 py-2 w-full",value:c})]}),f.jsxs("div",{className:"flex flex-col w-1/2",children:[f.jsx("div",{className:"flex flex-row gap-1 -mb-2",children:f.jsx("p",{className:"text-[0.9vw] text-gray-600",children:"Alternate Phone Number"})}),f.jsx("input",{type:"text",onChange:X=>p(X.target.value),className:"border rounded-lg px-2 py-2 w-full",value:h})]})]}),f.jsxs("div",{className:"flex flex-col w-full",children:[f.jsx("p",{className:"text-[0.9vw] text-gray-600",children:"Address"}),f.jsx("input",{type:"text",onChange:X=>v(X.target.value),className:"border rounded-lg px-2 py-2",value:x})]}),f.jsxs("div",{className:"flex flex-row w-full justify-between gap-2",children:[f.jsxs("div",{className:"flex flex-col w-full",children:[f.jsx("p",{className:"text-[0.9vw] text-gray-600",children:"Company Name"}),f.jsx("input",{type:"text",placeholder:"Company Name",onChange:X=>H(X.target.value),className:"border rounded-lg px-2 py-2",value:z})]}),f.jsxs("div",{className:"flex flex-col w-full",children:[f.jsx("p",{className:"text-[0.9vw] text-gray-600",children:"GST IN"}),f.jsx("input",{type:"text",placeholder:"GST Number",onChange:X=>R(X.target.value),className:"border rounded-lg px-2 py-2",value:re})]})]}),f.jsx("div",{className:"w-full flex flex-row justify-end",children:f.jsx("button",{onClick:K,style:{borderRadius:"6px"},className:"text-white bg-sky-600 hover:bg-sky-700 px-2 py-1 w-[6vw]",children:"Update"})})]})]})};async function x3(){try{const e=await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/getcustomerdata",{credentials:"include"});if(!e.ok)throw new Error(`HTTP error! Status: ${e.status}`);const t=await e.json();return Array.isArray(t.body)?t.body:[]}catch(e){return console.error("Error fetching customer data:",e),[]}}function XO(){const[e,t]=P.useState([]),[r,a]=P.useState(""),[n,s]=P.useState(!1),[o,c]=P.useState(!1),[u,h]=P.useState(null),[p,x]=P.useState(null),v=P.useRef(null),g=ua(),w=wa();ur(M=>M.data.customers);async function b(M){if((await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/deletecustomerdata",{method:"POST",headers:{"content-type":"application/json"},credentials:"include",body:JSON.stringify({name:M})})).status===200){const V=await x3();w(Lc(V)),alert("Customer deleted"),c(!o)}else alert("Error in customer deletion")}const[N,_]=P.useState(!1),[E,j]=P.useState(null);return P.useEffect(()=>{(async()=>{const U=localStorage.getItem("customerData"),V=Date.now();if(U&&!o){const z=JSON.parse(U);if(V-z.time<3e5&&z.data.length>0){w(Lc(z.data)),t(z.data);return}}const I=await x3();w(Lc(I)),t(I),localStorage.setItem("customerData",JSON.stringify({data:I,time:V})),o&&(s(!1),c(!1))})()},[o,w,N]),f.jsxs("div",{className:"p-6 bg-gray-50 md:mt-0 mt-20 h-screen",children:[f.jsxs("div",{className:`flex flex-wrap justify-between items-center p-2 mb-4 ${N?"hidden":""}`,children:[f.jsx("h1",{className:"text-[1.5vw] font-semibold",children:"Customers"}),f.jsxs("button",{className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2",style:{borderRadius:"8px"},onClick:()=>g("/add-customer"),children:[f.jsx(Vc,{size:18})," Add Customer"]})]}),f.jsxs("div",{className:`bg-white p-5 rounded-md shadow overflow-x-auto ${N?"hidden":""}`,onClick:M=>{M.stopPropagation(),x(null)},children:[f.jsx("div",{className:"mb-4",children:f.jsx("input",{type:"text",placeholder:"Search customers...",value:r,onChange:M=>a(M.target.value),className:"border px-3 py-2 rounded-md w-full"})}),f.jsxs("table",{className:"w-full border-collapse border border-gray-300",onClick:M=>{M.stopPropagation(),x(null)},children:[f.jsx("thead",{className:"bg-sky-50",children:f.jsxs("tr",{className:"text-gray-600",children:[f.jsx("th",{className:"px-4 py-2",children:"Customer Name"}),f.jsx("th",{className:"px-4 py-2",children:"Mobile"}),f.jsx("th",{className:"px-4 py-2",children:"Alternate Number"}),f.jsx("th",{className:"px-4 py-2",children:"Email"}),f.jsx("th",{className:"px-6 py-2 w-1/5",children:"Address"}),f.jsx("th",{className:"px-4 py-2",children:"Action"})]})}),f.jsx("tbody",{children:e.length>0?e.map((M,U)=>f.jsxs("tr",{className:"hover:bg-sky-50",onClick:()=>{_(!0),j(M)},children:[f.jsx("td",{className:"px-4 py-2",children:M[0]}),f.jsx("td",{className:"px-4 py-2",children:M[1]}),f.jsx("td",{className:"px-6 py-2",children:M[4]}),f.jsx("td",{className:"px-4 py-2",children:M[2]}),f.jsx("td",{className:"px-4 py-2",children:M[3]}),f.jsxs("td",{className:"px-4 py-2 relative",children:[f.jsx("button",{className:"p-2 hover:bg-gray-200 rounded-full",onClick:V=>{V.stopPropagation(),x(p===U?null:U)},children:f.jsx(kv,{size:18})}),p===U&&f.jsxs("div",{ref:v,className:"absolute bg-white shadow-md rounded-md z-[50] border flex flex-col",children:[f.jsxs("button",{className:"w-full text-left px-3 py-2 hover:bg-gray-100 flex items-center gap-2",onClick:()=>{h(M),s(!0)},children:[f.jsx(R1,{size:16})," edit"]}),f.jsxs("button",{className:"w-full text-left px-3 py-2 hover:bg-red-100 text-red-600 flex items-center gap-2",onClick:()=>b(M[0]),children:[f.jsx(WS,{size:16})," delete"]})]})]})]},U)):f.jsx("tr",{children:f.jsx("td",{colSpan:7,className:"text-center py-4",children:"No customers found."})})})]})]}),n&&f.jsx(S_,{setDialogOpen:s,editing:u,setEditing:h,reset:o,setReset:c}),N&&f.jsx($O,{setCustomerDashboardData:j,customerDashboardData:E,setCustomerDashboard:_})]})}function YO(){return f.jsx("h1",{className:"text-2xl font-bold",children:"📋 Masters"})}const g3=async()=>{const t=await(await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/gettasks")).json();return t.body?t.body:[]};function JO(){const[e,t]=P.useState([]),[r,a]=P.useState([]),[n,s]=P.useState(""),[o,c]=P.useState(!1),[u,h]=P.useState(""),[p,x]=P.useState(null),[v,g]=P.useState(!1),[w,b]=P.useState(!1),[N,_]=P.useState(null),[E,j]=P.useState("All Tasks"),M=wa();ur(re=>re.data.tasks);const U=ur(re=>re.data.projects),V=ur(re=>re.data.taskDialogOpen),I=async re=>{await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/deletetask",{method:"POST",headers:{"content-type":"application/json"},credentials:"include",body:JSON.stringify({title:re})}),g(!v),b(!0)},z=async()=>{try{return(await(await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/getprojectdata",{credentials:"include"})).json()).body.map((Y,K)=>{const X=(Z,ce)=>{try{return Z?JSON.parse(Z):ce}catch{return ce}};return{projectName:Y[0]||"",customerLink:X(Y[1],[]),projectReference:Y[2]||"",status:Y[3]||"",totalAmount:parseFloat(Y[4])||0,totalTax:parseFloat(Y[5])||0,paid:parseFloat(Y[6])||0,discount:parseFloat(Y[7])||0,createdBy:Y[8]||"",allData:X(Y[9],[]),projectDate:Y[10]||"",additionalRequests:Y[11],interiorArray:typeof Y[12]=="string"?Y[12].replace(/^"(.*)"$/,"$1").split(",").map(Z=>Z.trim()):[],salesAssociateArray:typeof Y[13]=="string"?Y[13].replace(/^"(.*)"$/,"$1").split(",").map(Z=>Z.trim()):[]}})}catch{return alert("Failed to fetch projects. Please try again."),[]}};P.useEffect(()=>{(async()=>{try{const R=localStorage.getItem("taskData"),F=Date.now();if(R){const X=JSON.parse(R);if(F-X.time<3e5&&X.data.length>0){const ce=X.data.sort((te,Q)=>new Date(te[2]).getTime()-new Date(Q[2]).getTime());M(sl(ce)),t(ce);return}}const K=(await g3()).sort((X,Z)=>new Date(X[2]).getTime()-new Date(Z[2]).getTime());M(sl(K)),t(K),localStorage.setItem("taskData",JSON.stringify({data:K,time:F}))}catch(R){console.error("Failed to fetch tasks:",R)}})()},[M,w]),P.useEffect(()=>{const re=async()=>{try{const R=localStorage.getItem("projectData"),F=Date.now();if(R){const K=JSON.parse(R);if(F-K.time<3e5&&K.data.length>0){M(La(K.data)),a(K.data);return}}const Y=await z();M(La(Y)),a(Y),localStorage.setItem("projectData",JSON.stringify({data:Y,time:F}))}catch(R){console.error("Failed to fetch projects:",R)}};r.length===0&&(U.length===0?re():a(U))},[M,U]),P.useEffect(()=>{w&&(async()=>{try{const F=(await g3()).sort((K,X)=>new Date(K[2]).getTime()-new Date(X[2]).getTime());M(sl(F)),t(F),localStorage.setItem("taskData",JSON.stringify({data:F,time:Date.now()}));const Y=await z();M(La(Y)),a(Y),localStorage.setItem("projectData",JSON.stringify({data:Y,time:Date.now()})),b(!1)}catch(R){console.error("Error refreshing data:",R)}})()},[w]);const H=[{label:"All Tasks",value:"All Tasks"},{label:"To Do",value:"To Do"},{label:"In Progress",value:"In Progress"},{label:"Completed",value:"Completed"}];return f.jsxs("div",{className:"p-6 bg-gray-50 md:mt-0 mt-20 h-screen",children:[f.jsxs("div",{className:"flex flex-wrap justify-between items-center mb-4",children:[f.jsx("h1",{className:"text-2xl font-bold",children:" Tasks"}),f.jsxs("button",{onClick:()=>c(!0),style:{borderRadius:"8px"},className:"flex items-center gap-2 bg-blue-600 rounded-3xl shadow-2xl text-white px-4 py-2",children:[f.jsx(Vc,{size:18})," Add Task"]})]}),f.jsx("div",{className:"flex flex-wrap gap-2 space-x-4 border-b pb-2 mb-4 lg:gap-4",children:H.map(re=>f.jsx("button",{className:`px-4 py-2 rounded transition ${E===re.value?"bg-blue-600 text-white":"bg-gray-200 hover:bg-gray-300"}`,onClick:()=>j(re.value),children:re.label},re.value))}),f.jsxs("div",{className:"bg-white p-5 rounded-md shadow overflow-x-auto",children:[f.jsx("input",{type:"text",placeholder:"Search tasks...",className:"border px-3 py-2 rounded-md w-full mb-4"}),f.jsxs("table",{className:"w-full border-collapse border border-gray-300",children:[f.jsx("thead",{className:"bg-sky-50",children:f.jsxs("tr",{children:[f.jsx("th",{className:"px-4 py-2",children:"Task"}),f.jsx("th",{className:"px-4 py-2",children:"Priority"}),f.jsx("th",{className:"px-4 py-2",children:"Project"}),f.jsx("th",{className:"px-4 py-2",children:"Due Date"}),f.jsx("th",{className:"px-4 py-2",children:"Created At"}),f.jsx("th",{className:"px-4 py-2",children:"Assignee"}),f.jsx("th",{className:"px-4 py-2",children:"Status"}),f.jsx("th",{className:"px-4 py-2",children:"Actions"})]})}),f.jsx("tbody",{children:e!=null&&e.map((re,R)=>re[7]===`${E}`||E==="All Tasks"?f.jsxs("tr",{className:"hover:bg-sky-50",children:[f.jsx("td",{className:"px-4 py-2",children:re[0]}),f.jsx("td",{className:`font-bold px-4 ${re[6]==="High"?"text-red-600":re[6]==="Moderate"?"text-yellow-400":"text-green-600"}`,children:re[6]}),f.jsx("td",{className:"px-4 py-2",children:re[5]}),f.jsx("td",{className:"px-4 py-2",children:re[2]}),f.jsx("td",{className:"px-4 py-2",children:re[3]}),f.jsx("td",{className:"px-4 py-2",children:re[4]}),f.jsx("td",{className:"px-4 py-2",children:re[7]}),f.jsxs("td",{className:"px-4 py-2 relative",children:[f.jsx("button",{className:"p-2 hover:bg-gray-200 rounded-full",onClick:()=>_(N===R?null:R),children:f.jsx(kv,{size:18})}),N===R&&f.jsxs("div",{className:"absolute w-32 bg-white shadow-md rounded-md z-[50] border",children:[f.jsxs("button",{className:"w-full text-left px-3 py-2 hover:bg-gray-100 flex items-center gap-2",onClick:()=>{_(null),c(!0),x(re)},children:[f.jsx(R1,{size:16})," Edit"]}),f.jsxs("button",{className:"w-full text-left px-3 py-2 hover:bg-red-100 text-red-600 flex items-center gap-2",onClick:()=>{I(re[0]),_(null)},children:[f.jsx(WS,{size:16})," Delete"]})]})]})]},R):null)})]})]}),f.jsx(qd,{children:o&&f.jsxs(f.Fragment,{children:[f.jsx(ko.div,{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-40",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>c(!1)}),f.jsx(ko.div,{className:"fixed inset-0 z-50 flex items-center justify-center",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.3},children:f.jsx(Vd,{onClose:()=>c(!1),isEditing:p,setediting:x,name:u,setrefresh:b,projectData:r})})]})}),f.jsx(qd,{children:V&&f.jsxs(f.Fragment,{children:[f.jsx(ko.div,{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-40",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>M(Ad(!1))}),f.jsx(ko.div,{className:"fixed inset-0 z-50 flex items-center justify-center",initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.3},children:f.jsx(Vd,{onClose:()=>c(!1),isEditing:p,setediting:x,name:u,setrefresh:b,projectData:r,setTaskDialogOpen:Ad,taskDialogOpen:V,setProjectFlag:ch})})]})})]})}var Qm={exports:{}},KO=Qm.exports,v3;function ZO(){return v3||(v3=1,function(e,t){(function(r,a){e.exports=a()})(KO,function(){var r=1e3,a=6e4,n=36e5,s="millisecond",o="second",c="minute",u="hour",h="day",p="week",x="month",v="quarter",g="year",w="date",b="Invalid Date",N=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,_=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,E={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(K){var X=["th","st","nd","rd"],Z=K%100;return"["+K+(X[(Z-20)%10]||X[Z]||X[0])+"]"}},j=function(K,X,Z){var ce=String(K);return!ce||ce.length>=X?K:""+Array(X+1-ce.length).join(Z)+K},M={s:j,z:function(K){var X=-K.utcOffset(),Z=Math.abs(X),ce=Math.floor(Z/60),te=Z%60;return(X<=0?"+":"-")+j(ce,2,"0")+":"+j(te,2,"0")},m:function K(X,Z){if(X.date()<Z.date())return-K(Z,X);var ce=12*(Z.year()-X.year())+(Z.month()-X.month()),te=X.clone().add(ce,x),Q=Z-te<0,G=X.clone().add(ce+(Q?-1:1),x);return+(-(ce+(Z-te)/(Q?te-G:G-te))||0)},a:function(K){return K<0?Math.ceil(K)||0:Math.floor(K)},p:function(K){return{M:x,y:g,w:p,d:h,D:w,h:u,m:c,s:o,ms:s,Q:v}[K]||String(K||"").toLowerCase().replace(/s$/,"")},u:function(K){return K===void 0}},U="en",V={};V[U]=E;var I="$isDayjsObject",z=function(K){return K instanceof F||!(!K||!K[I])},H=function K(X,Z,ce){var te;if(!X)return U;if(typeof X=="string"){var Q=X.toLowerCase();V[Q]&&(te=Q),Z&&(V[Q]=Z,te=Q);var G=X.split("-");if(!te&&G.length>1)return K(G[0])}else{var ye=X.name;V[ye]=X,te=ye}return!ce&&te&&(U=te),te||!ce&&U},re=function(K,X){if(z(K))return K.clone();var Z=typeof X=="object"?X:{};return Z.date=K,Z.args=arguments,new F(Z)},R=M;R.l=H,R.i=z,R.w=function(K,X){return re(K,{locale:X.$L,utc:X.$u,x:X.$x,$offset:X.$offset})};var F=function(){function K(Z){this.$L=H(Z.locale,null,!0),this.parse(Z),this.$x=this.$x||Z.x||{},this[I]=!0}var X=K.prototype;return X.parse=function(Z){this.$d=function(ce){var te=ce.date,Q=ce.utc;if(te===null)return new Date(NaN);if(R.u(te))return new Date;if(te instanceof Date)return new Date(te);if(typeof te=="string"&&!/Z$/i.test(te)){var G=te.match(N);if(G){var ye=G[2]-1||0,D=(G[7]||"0").substring(0,3);return Q?new Date(Date.UTC(G[1],ye,G[3]||1,G[4]||0,G[5]||0,G[6]||0,D)):new Date(G[1],ye,G[3]||1,G[4]||0,G[5]||0,G[6]||0,D)}}return new Date(te)}(Z),this.init()},X.init=function(){var Z=this.$d;this.$y=Z.getFullYear(),this.$M=Z.getMonth(),this.$D=Z.getDate(),this.$W=Z.getDay(),this.$H=Z.getHours(),this.$m=Z.getMinutes(),this.$s=Z.getSeconds(),this.$ms=Z.getMilliseconds()},X.$utils=function(){return R},X.isValid=function(){return this.$d.toString()!==b},X.isSame=function(Z,ce){var te=re(Z);return this.startOf(ce)<=te&&te<=this.endOf(ce)},X.isAfter=function(Z,ce){return re(Z)<this.startOf(ce)},X.isBefore=function(Z,ce){return this.endOf(ce)<re(Z)},X.$g=function(Z,ce,te){return R.u(Z)?this[ce]:this.set(te,Z)},X.unix=function(){return Math.floor(this.valueOf()/1e3)},X.valueOf=function(){return this.$d.getTime()},X.startOf=function(Z,ce){var te=this,Q=!!R.u(ce)||ce,G=R.p(Z),ye=function(ue,fe){var Ee=R.w(te.$u?Date.UTC(te.$y,fe,ue):new Date(te.$y,fe,ue),te);return Q?Ee:Ee.endOf(h)},D=function(ue,fe){return R.w(te.toDate()[ue].apply(te.toDate("s"),(Q?[0,0,0,0]:[23,59,59,999]).slice(fe)),te)},O=this.$W,L=this.$M,q=this.$D,oe="set"+(this.$u?"UTC":"");switch(G){case g:return Q?ye(1,0):ye(31,11);case x:return Q?ye(1,L):ye(0,L+1);case p:var be=this.$locale().weekStart||0,ve=(O<be?O+7:O)-be;return ye(Q?q-ve:q+(6-ve),L);case h:case w:return D(oe+"Hours",0);case u:return D(oe+"Minutes",1);case c:return D(oe+"Seconds",2);case o:return D(oe+"Milliseconds",3);default:return this.clone()}},X.endOf=function(Z){return this.startOf(Z,!1)},X.$set=function(Z,ce){var te,Q=R.p(Z),G="set"+(this.$u?"UTC":""),ye=(te={},te[h]=G+"Date",te[w]=G+"Date",te[x]=G+"Month",te[g]=G+"FullYear",te[u]=G+"Hours",te[c]=G+"Minutes",te[o]=G+"Seconds",te[s]=G+"Milliseconds",te)[Q],D=Q===h?this.$D+(ce-this.$W):ce;if(Q===x||Q===g){var O=this.clone().set(w,1);O.$d[ye](D),O.init(),this.$d=O.set(w,Math.min(this.$D,O.daysInMonth())).$d}else ye&&this.$d[ye](D);return this.init(),this},X.set=function(Z,ce){return this.clone().$set(Z,ce)},X.get=function(Z){return this[R.p(Z)]()},X.add=function(Z,ce){var te,Q=this;Z=Number(Z);var G=R.p(ce),ye=function(L){var q=re(Q);return R.w(q.date(q.date()+Math.round(L*Z)),Q)};if(G===x)return this.set(x,this.$M+Z);if(G===g)return this.set(g,this.$y+Z);if(G===h)return ye(1);if(G===p)return ye(7);var D=(te={},te[c]=a,te[u]=n,te[o]=r,te)[G]||1,O=this.$d.getTime()+Z*D;return R.w(O,this)},X.subtract=function(Z,ce){return this.add(-1*Z,ce)},X.format=function(Z){var ce=this,te=this.$locale();if(!this.isValid())return te.invalidDate||b;var Q=Z||"YYYY-MM-DDTHH:mm:ssZ",G=R.z(this),ye=this.$H,D=this.$m,O=this.$M,L=te.weekdays,q=te.months,oe=te.meridiem,be=function(fe,Ee,J,Pe){return fe&&(fe[Ee]||fe(ce,Q))||J[Ee].slice(0,Pe)},ve=function(fe){return R.s(ye%12||12,fe,"0")},ue=oe||function(fe,Ee,J){var Pe=fe<12?"AM":"PM";return J?Pe.toLowerCase():Pe};return Q.replace(_,function(fe,Ee){return Ee||function(J){switch(J){case"YY":return String(ce.$y).slice(-2);case"YYYY":return R.s(ce.$y,4,"0");case"M":return O+1;case"MM":return R.s(O+1,2,"0");case"MMM":return be(te.monthsShort,O,q,3);case"MMMM":return be(q,O);case"D":return ce.$D;case"DD":return R.s(ce.$D,2,"0");case"d":return String(ce.$W);case"dd":return be(te.weekdaysMin,ce.$W,L,2);case"ddd":return be(te.weekdaysShort,ce.$W,L,3);case"dddd":return L[ce.$W];case"H":return String(ye);case"HH":return R.s(ye,2,"0");case"h":return ve(1);case"hh":return ve(2);case"a":return ue(ye,D,!0);case"A":return ue(ye,D,!1);case"m":return String(D);case"mm":return R.s(D,2,"0");case"s":return String(ce.$s);case"ss":return R.s(ce.$s,2,"0");case"SSS":return R.s(ce.$ms,3,"0");case"Z":return G}return null}(fe)||G.replace(":","")})},X.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},X.diff=function(Z,ce,te){var Q,G=this,ye=R.p(ce),D=re(Z),O=(D.utcOffset()-this.utcOffset())*a,L=this-D,q=function(){return R.m(G,D)};switch(ye){case g:Q=q()/12;break;case x:Q=q();break;case v:Q=q()/3;break;case p:Q=(L-O)/6048e5;break;case h:Q=(L-O)/864e5;break;case u:Q=L/n;break;case c:Q=L/a;break;case o:Q=L/r;break;default:Q=L}return te?Q:R.a(Q)},X.daysInMonth=function(){return this.endOf(x).$D},X.$locale=function(){return V[this.$L]},X.locale=function(Z,ce){if(!Z)return this.$L;var te=this.clone(),Q=H(Z,ce,!0);return Q&&(te.$L=Q),te},X.clone=function(){return R.w(this.$d,this)},X.toDate=function(){return new Date(this.valueOf())},X.toJSON=function(){return this.isValid()?this.toISOString():null},X.toISOString=function(){return this.$d.toISOString()},X.toString=function(){return this.$d.toUTCString()},K}(),Y=F.prototype;return re.prototype=Y,[["$ms",s],["$s",o],["$m",c],["$H",u],["$W",h],["$M",x],["$y",g],["$D",w]].forEach(function(K){Y[K[1]]=function(X){return this.$g(X,K[0],K[1])}}),re.extend=function(K,X){return K.$i||(K(X,F,re),K.$i=!0),re},re.locale=H,re.isDayjs=z,re.unix=function(K){return re(1e3*K)},re.en=V[U],re.Ls=V,re.p={},re})}(Qm)),Qm.exports}var QO=ZO();const Dm=CS(QO);function eR(){const e=wa(),t=async()=>{const V=await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/getprojectdata",{credentials:"include"});if(!V.ok)throw new Error(`HTTP error! Status: ${V.status}`);const I=await V.json();if(!I.body||!Array.isArray(I.body))throw new Error("Invalid data format: Expected an array in data.body");const z=(F,Y)=>{try{return typeof F=="string"?JSON.parse(F):F||Y}catch(K){return console.warn("Invalid JSON:",F,K),Y}},H=F=>JSON.parse(JSON.stringify(F)),re=F=>{if(Array.isArray(F))return F;if(typeof F!="string")return[];try{const Y=JSON.parse(F);return Array.isArray(Y)?Y:[]}catch{try{return F.replace(/^\[|\]$/g,"").split(",").map(K=>K.trim().replace(/^"+|"+$/g,""))}catch{return[]}}};return I.body.map(F=>({projectName:F[0],customerLink:z(F[1],[]),projectReference:F[2]||"",status:F[3]||"",totalAmount:parseFloat(F[4])||0,totalTax:parseFloat(F[5])||0,paid:parseFloat(F[6])||0,discount:parseFloat(F[7])||0,createdBy:F[8]||"",allData:H(z(F[9],[])),projectDate:F[10]||"",additionalRequests:z(F[11],[]),interiorArray:re(F[12]),salesAssociateArray:re(F[13]),additionalItems:H(z(F[14],[])),goodsArray:H(z(F[15],[])),tailorsArray:H(z(F[16],[])),projectAddress:F[17],date:F[18],grandTotal:F[19]}))},[r,a]=P.useState([]),[n,s]=P.useState([]),[o,c]=P.useState(!0),[u,h]=P.useState("payments"),[p,x]=P.useState(""),[v,g]=P.useState(""),[w,b]=P.useState("");ur(V=>V.data.projects),ur(V=>V.data.paymentData);const[N,_]=P.useState([]);P.useEffect(()=>{(async()=>{const I=Date.now(),z=localStorage.getItem("projectData");let H=[];if(z){const re=JSON.parse(z);I-re.time<3e5&&re.data.length>0?(e(La(re.data)),s(re.data),H=re.data):(H=await t(),e(La(H)),s(H),localStorage.setItem("projectData",JSON.stringify({data:H,time:I})))}else H=await t(),e(La(H)),s(H),localStorage.setItem("projectData",JSON.stringify({data:H,time:I}));try{const re=await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/getPayments",{credentials:"include"});if(re.ok){const R=await re.json();if(R.success==="true"){e(Kl(R.message)),a(R.message);const F=H.map(Y=>R.message.filter(X=>X[1]==Y.projectName).reduce((X,Z)=>X+(parseFloat(Z[2])||0),0));_(F),console.log(F)}}else console.error("Failed to fetch payment data:",re.status)}catch(re){console.error("Error fetching payments:",re)}c(!1)})()},[e]);const E=(r??[]).filter(([V,,,I])=>{const z=V.toLowerCase().includes(p.toLowerCase()),H=(!v||Dm(I).isAfter(Dm(v).subtract(1,"day")))&&(!w||Dm(I).isBefore(Dm(w).add(1,"day")));return z&&H}),j=E.reduce((V,I)=>V+parseFloat(I[2]||0),0),M=n.reduce((V,I)=>V+parseFloat(I[4]||0),0),U=n.reduce((V,I)=>V+parseFloat(I[7]||0),0);return f.jsxs("div",{className:"p-6 bg-gray-100 min-h-screen",children:[f.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Reports Dashboard"}),f.jsxs("div",{className:"flex gap-4 mb-6 mt-10",children:[f.jsx("button",{onClick:()=>h("payments"),className:`px-4 py-2 rounded  ${u==="payments"?"bg-blue-600 text-white":"bg-white border border-gray-300"}`,children:"Payments"}),f.jsx("button",{onClick:()=>h("projects"),className:`px-4 py-2 rounded ${u==="projects"?"bg-blue-600 text-white":"bg-white border border-gray-300"}`,children:"Projects"})]}),o?f.jsx("p",{children:"Loading..."}):f.jsxs(f.Fragment,{children:[u==="payments"&&f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"grid md:grid-cols-3 gap-4 mb-6",children:[f.jsx("input",{type:"text",placeholder:"Search by customer",value:p,onChange:V=>x(V.target.value),className:"border rounded px-4 py-2 w-full"}),f.jsx("input",{type:"date",value:v,onChange:V=>g(V.target.value),className:"border rounded px-4 py-2 w-full"}),f.jsx("input",{type:"date",value:w,onChange:V=>b(V.target.value),className:"border rounded px-4 py-2 w-full"})]}),f.jsxs("div",{className:"mb-4 text-lg font-semibold",children:["Total Payments: ₹",j.toLocaleString()]}),f.jsx("div",{className:"overflow-x-auto",children:f.jsxs("table",{className:"min-w-full bg-white border rounded shadow",children:[f.jsx("thead",{children:f.jsxs("tr",{className:"bg-gray-200 text-left",children:[f.jsx("th",{className:"px-4 py-2",children:"Customer"}),f.jsx("th",{className:"px-4 py-2",children:"Project"}),f.jsx("th",{className:"px-4 py-2",children:"Amount"}),f.jsx("th",{className:"px-4 py-2",children:"Date"}),f.jsx("th",{className:"px-4 py-2",children:"Mode"}),f.jsx("th",{className:"px-4 py-2",children:"Remarks"})]})}),f.jsx("tbody",{children:E.map((V,I)=>f.jsx("tr",{className:"border-t",children:V.map((z,H)=>f.jsx("td",{className:"px-4 py-2",children:z},H))},I))})]})})]}),u==="projects"&&f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"mb-4 text-lg font-semibold",children:["Total Project Value: ₹",M.toLocaleString()," | Total Advance: ₹",U.toLocaleString()]}),f.jsx("div",{className:"overflow-x-auto",children:f.jsxs("table",{className:"min-w-full bg-white border rounded shadow",children:[f.jsx("thead",{children:f.jsxs("tr",{className:"bg-gray-200 text-left",children:[f.jsx("th",{className:"px-4 py-2",children:"Project Name"}),f.jsx("th",{className:"px-4 py-2",children:"Customer Name"}),f.jsx("th",{className:"px-4 py-2",children:"Total Amount"}),f.jsx("th",{className:"px-4 py-2",children:"Paid"}),f.jsx("th",{className:"px-4 py-2",children:"Due"})]})}),f.jsx("tbody",{children:n.map((V,I)=>f.jsxs("tr",{className:"border-t",children:[f.jsx("td",{className:"px-4 py-2",children:V.projectName}),f.jsx("td",{className:"px-4 py-2",children:V.customerLink[0]}),f.jsxs("td",{className:"px-4 py-2",children:["₹",V.grandTotal]}),f.jsxs("td",{className:"px-4 py-2",children:["₹",N[I]]}),f.jsx("td",{className:"px-4 py-2",children:V.grandTotal-N[I]})]},I))})]})})]})]})]})}function tR(){return f.jsx("h1",{className:"text-2xl font-bold",children:" Settings"})}const N_=({editingStore:e,setEditingStore:t,setIsAddStoreOpen:r,onSave:a})=>{ua();const[n,s]=P.useState(""),[o,c]=P.useState(""),[u,h]=P.useState(""),[p,x]=P.useState(""),v=()=>{a(n,o,u,p)};return P.useEffect(()=>{e!=null&&(x(e[1]),s(e[0]),h(e[3]),c(e[2]))},[e]),f.jsxs("div",{style:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",backgroundColor:"white",padding:"20px",border:"1px solid #ccc",borderRadius:"4px",boxShadow:"0 2px 4px rgba(0, 0, 0, 0.2)",width:"400px",zIndex:1e3},children:[f.jsx("h3",{style:{marginBottom:"15px",textAlign:"center"},children:e?"Edit Store":"Add Store"}),e==null&&f.jsxs("div",{style:{marginBottom:"10px"},children:[f.jsx("label",{style:{display:"block",marginBottom:"5px"},children:"Store Name:"}),f.jsx("input",{type:"text",value:n,onChange:g=>s(g.target.value),style:{padding:"8px",borderRadius:"4px",border:"1px solid #ccc",width:"100%"}})]}),f.jsxs("div",{style:{marginBottom:"10px"},children:[f.jsx("label",{style:{display:"block",marginBottom:"5px"},children:"Phone:"}),f.jsx("input",{type:"text",value:o,onChange:g=>c(g.target.value),style:{padding:"8px",borderRadius:"4px",border:"1px solid #ccc",width:"100%"}})]}),f.jsxs("div",{style:{marginBottom:"10px"},children:[f.jsx("label",{style:{display:"block",marginBottom:"5px"},children:"Email:"}),f.jsx("input",{type:"text",value:u,onChange:g=>h(g.target.value),style:{padding:"8px",borderRadius:"4px",border:"1px solid #ccc",width:"100%"}})]}),f.jsxs("div",{style:{marginBottom:"10px"},children:[f.jsx("label",{style:{display:"block",marginBottom:"5px"},children:"Address:"}),f.jsx("input",{type:"text",value:p,onChange:g=>x(g.target.value),style:{padding:"8px",borderRadius:"4px",border:"1px solid #ccc",width:"100%"}})]}),f.jsxs("div",{style:{display:"flex",justifyContent:"flex-end"},children:[f.jsx("button",{onClick:v,style:{backgroundColor:"#1890ff",color:"white",border:"none",padding:"8px 16px",borderRadius:"4px",marginRight:"10px"},children:"Save"}),f.jsx("button",{onClick:()=>{t(null),r(!1)},style:{padding:"8px 16px",borderRadius:"4px"},className:"bg-gray-500 text-white px-4 py-2 rounded",children:"Cancel"})]})]})};async function a2(){const t=await(await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/getallstores",{credentials:"include"})).json();return Array.isArray(t.body)?t:[]}const rR=()=>{ua();const[e,t]=P.useState([]),r=wa(),a=ur(F=>F.data.stores),[n,s]=P.useState(!1),[o,c]=P.useState(""),[u,h]=P.useState(""),[p,x]=P.useState(""),[v,g]=P.useState(""),[w,b]=P.useState(null),[N,_]=P.useState(null),E=P.useRef(null),[j,M]=P.useState(null),[U,V]=P.useState(!0),I=()=>{s(!1),c(""),h(""),x(""),g(""),b(null),M(null)},z=async(F,Y,K,X)=>{await fetch(j?"https://sheeladecor.netlify.app/.netlify/functions/server/updatestore":"https://sheeladecor.netlify.app/.netlify/functions/server/addstore",{method:"POST",headers:{"content-type":"application/json"},credentials:"include",body:JSON.stringify({storeName:F,storeAddress:Y,email:K,phonenumber:X})});const ce=await a2();r(jg(ce.body)),t(ce.body),V(te=>!te),I()},H=(F,Y)=>{const K=Y.currentTarget.getBoundingClientRect();_({top:K.top+window.scrollY+24,left:K.left+window.scrollX}),b(w===F?null:F)},re=async F=>{M(F),c(F.name),h(F.phone),x(F.email),g(F.address),s(!0),b(null)},R=async F=>{const Y=F.name||F[0];await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/deletestore",{method:"POST",headers:{"content-type":"application/json"},credentials:"include",body:JSON.stringify({storeName:Y})});const K=await a2();r(jg(K.body)),t(K.body),V(X=>!X),b(null)};return P.useEffect(()=>{async function F(){const Y=await a2();r(jg(Y.body)),t(Array.isArray(Y.body)?Y.body:[])}a!==void 0&&a.length===0?F():t(a||[])},[U,r,a]),f.jsxs("div",{style:{backgroundColor:"#f0f2f5",borderRadius:"20px"},className:"p-6 mb-20 md:mt-0 mt-20",children:[f.jsxs("div",{className:"flex-wrap",style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"20px"},children:[f.jsx("h2",{className:"font-bold text-3xl",children:"Stores"}),f.jsx("button",{onClick:()=>s(!0),style:{backgroundColor:"#1890ff",color:"white",border:"none",padding:"8px 16px",borderRadius:"8px"},children:"+ Add Store"})]}),f.jsx("div",{style:{marginBottom:"20px"},children:f.jsx("input",{type:"text",placeholder:"🔍 Search Stores...",style:{padding:"8px",borderRadius:"4px",border:"1px solid #ccc"},className:"px-3 py-2 rounded-md w-full"})}),f.jsxs("div",{style:{overflowX:"auto"},children:[f.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",minWidth:"600px"},children:[f.jsx("thead",{children:f.jsxs("tr",{children:[f.jsx("th",{style:{textAlign:"left",padding:"8px",borderBottom:"1px solid #eee"},children:"Store Name"}),f.jsx("th",{style:{textAlign:"left",padding:"8px",borderBottom:"1px solid #eee"},children:"Phone"}),f.jsx("th",{style:{textAlign:"left",padding:"8px",borderBottom:"1px solid #eee"},children:"Email"}),f.jsx("th",{style:{textAlign:"left",padding:"8px",borderBottom:"1px solid #eee"},children:"Address"}),f.jsx("th",{style:{textAlign:"left",padding:"8px",borderBottom:"1px solid #eee"},children:"Actions"})]})}),f.jsx("tbody",{children:e==null?void 0:e.map((F,Y)=>f.jsxs("tr",{children:[f.jsx("td",{style:{padding:"8px",borderBottom:"1px solid #eee"},children:F[0]}),f.jsx("td",{style:{padding:"8px",borderBottom:"1px solid #eee"},children:F[2]}),f.jsx("td",{style:{padding:"8px",borderBottom:"1px solid #eee"},children:F[3]}),f.jsx("td",{style:{padding:"8px",borderBottom:"1px solid #eee"},children:F[1]}),f.jsx("td",{style:{padding:"8px",borderBottom:"1px solid #eee"},children:f.jsx("button",{onClick:K=>H(Y,K),style:{border:"none",background:"none",cursor:"pointer"},children:"⋮"})})]},Y))})]}),w!==null&&N&&f.jsxs("div",{ref:E,style:{position:"absolute",top:N.top,left:N.left,backgroundColor:"white",border:"1px solid #ccc",borderRadius:"4px",padding:"8px",zIndex:1e3,boxShadow:"0 2px 8px rgba(0,0,0,0.15)"},children:[f.jsx("button",{onClick:()=>re(e[w]),style:{border:"none",background:"none",cursor:"pointer",display:"block",padding:"4px 8px"},children:"Edit"}),f.jsx("button",{onClick:()=>R(e[w]),style:{border:"none",background:"none",cursor:"pointer",display:"block",padding:"4px 8px",color:"red"},children:"Delete"})]})]}),n&&f.jsx(N_,{onSave:z,setIsAddStoreOpen:s,editingStore:j,setEditingStore:M})]})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var w1={};w1.version="0.18.5";var A_=1252,aR=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],yy={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},wy=function(e){aR.indexOf(e)!=-1&&(A_=yy[0]=e)};function nR(){wy(1252)}var il=function(e){wy(e)};function by(){il(1200),nR()}function y3(e){for(var t=[],r=0,a=e.length;r<a;++r)t[r]=e.charCodeAt(r);return t}function sR(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function __(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var bd=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?sR(e.slice(2)):t==254&&r==255?__(e.slice(2)):t==65279?e.slice(1):e},Fm=function(t){return String.fromCharCode(t)},w3=function(t){return String.fromCharCode(t)},ov,Du="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function tp(e){for(var t="",r=0,a=0,n=0,s=0,o=0,c=0,u=0,h=0;h<e.length;)r=e.charCodeAt(h++),s=r>>2,a=e.charCodeAt(h++),o=(r&3)<<4|a>>4,n=e.charCodeAt(h++),c=(a&15)<<2|n>>6,u=n&63,isNaN(a)?c=u=64:isNaN(n)&&(u=64),t+=Du.charAt(s)+Du.charAt(o)+Du.charAt(c)+Du.charAt(u);return t}function ro(e){var t="",r=0,a=0,n=0,s=0,o=0,c=0,u=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var h=0;h<e.length;)s=Du.indexOf(e.charAt(h++)),o=Du.indexOf(e.charAt(h++)),r=s<<2|o>>4,t+=String.fromCharCode(r),c=Du.indexOf(e.charAt(h++)),a=(o&15)<<4|c>>2,c!==64&&(t+=String.fromCharCode(a)),u=Du.indexOf(e.charAt(h++)),n=(c&3)<<6|u,u!==64&&(t+=String.fromCharCode(n));return t}var Rr=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),qc=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Uu(e){return Rr?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function b3(e){return Rr?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Ki=function(t){return Rr?qc(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function J1(e){if(typeof ArrayBuffer>"u")return Ki(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),a=0;a!=e.length;++a)r[a]=e.charCodeAt(a)&255;return t}function Gu(e){if(Array.isArray(e))return e.map(function(a){return String.fromCharCode(a)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function iR(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function Sy(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Sy(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var cs=Rr?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:qc(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var a=new Uint8Array(r),n=0;for(t=0,r=0;t<e.length;r+=n,++t)if(n=e[t].length,e[t]instanceof Uint8Array)a.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";a.set(new Uint8Array(e[t]),r)}return a}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function oR(e){for(var t=[],r=0,a=e.length+250,n=Uu(e.length+255),s=0;s<e.length;++s){var o=e.charCodeAt(s);if(o<128)n[r++]=o;else if(o<2048)n[r++]=192|o>>6&31,n[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var c=e.charCodeAt(++s)&1023;n[r++]=240|o>>8&7,n[r++]=128|o>>2&63,n[r++]=128|c>>6&15|(o&3)<<4,n[r++]=128|c&63}else n[r++]=224|o>>12&15,n[r++]=128|o>>6&63,n[r++]=128|o&63;r>a&&(t.push(n.slice(0,r)),r=0,n=Uu(65535),a=65530)}return t.push(n.slice(0,r)),cs(t)}var mi=/\u0000/g,Sd=/[\u0001-\u0006]/g;function nh(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function ol(e,t){var r=""+e;return r.length>=t?r:pn("0",t-r.length)+r}function Ny(e,t){var r=""+e;return r.length>=t?r:pn(" ",t-r.length)+r}function b1(e,t){var r=""+e;return r.length>=t?r:r+pn(" ",t-r.length)}function lR(e,t){var r=""+Math.round(e);return r.length>=t?r:pn("0",t-r.length)+r}function cR(e,t){var r=""+e;return r.length>=t?r:pn("0",t-r.length)+r}var S3=Math.pow(2,32);function U0(e,t){if(e>S3||e<-S3)return lR(e,t);var r=Math.round(e);return cR(r,t)}function S1(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var N3=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],n2=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function uR(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var xr={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},A3={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},fR={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function N1(e,t,r){for(var a=e<0?-1:1,n=e*a,s=0,o=1,c=0,u=1,h=0,p=0,x=Math.floor(n);h<t&&(x=Math.floor(n),c=x*o+s,p=x*h+u,!(n-x<5e-8));)n=1/(n-x),s=o,o=c,u=h,h=p;if(p>t&&(h>t?(p=u,c=s):(p=h,c=o)),!r)return[0,a*c,p];var v=Math.floor(a*c/p);return[v,a*c-v*p,p]}function Pf(e,t,r){if(e>2958465||e<0)return null;var a=e|0,n=Math.floor(86400*(e-a)),s=0,o=[],c={D:a,T:n,u:86400*(e-a)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(c.u)<1e-6&&(c.u=0),t&&t.date1904&&(a+=1462),c.u>.9999&&(c.u=0,++n==86400&&(c.T=n=0,++a,++c.D)),a===60)o=r?[1317,10,29]:[1900,2,29],s=3;else if(a===0)o=r?[1317,8,29]:[1900,1,0],s=6;else{a>60&&--a;var u=new Date(1900,0,1);u.setDate(u.getDate()+a-1),o=[u.getFullYear(),u.getMonth()+1,u.getDate()],s=u.getDay(),a<60&&(s=(s+6)%7),r&&(s=gR(u,o))}return c.y=o[0],c.m=o[1],c.d=o[2],c.S=n%60,n=Math.floor(n/60),c.M=n%60,n=Math.floor(n/60),c.H=n,c.q=s,c}var T_=new Date(1899,11,31,0,0,0),hR=T_.getTime(),dR=new Date(1900,2,1,0,0,0);function k_(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=dR&&(r+=24*60*60*1e3),(r-(hR+(e.getTimezoneOffset()-T_.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Ay(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function pR(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function mR(e){var t=e<0?12:11,r=Ay(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function xR(e){var t=Ay(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function rp(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=mR(e):t===10?r=e.toFixed(10).substr(0,12):r=xR(e),Ay(pR(r.toUpperCase()))}function Gf(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):rp(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Co(14,k_(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function gR(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function vR(e,t,r,a){var n="",s=0,o=0,c=r.y,u,h=0;switch(e){case 98:c=r.y+543;case 121:switch(t.length){case 1:case 2:u=c%100,h=2;break;default:u=c%1e4,h=4;break}break;case 109:switch(t.length){case 1:case 2:u=r.m,h=t.length;break;case 3:return n2[r.m-1][1];case 5:return n2[r.m-1][0];default:return n2[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:u=r.d,h=t.length;break;case 3:return N3[r.q][0];default:return N3[r.q][1]}break;case 104:switch(t.length){case 1:case 2:u=1+(r.H+11)%12,h=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:u=r.H,h=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:u=r.M,h=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?ol(r.S,t.length):(a>=2?o=a===3?1e3:100:o=a===1?10:1,s=Math.round(o*(r.S+r.u)),s>=60*o&&(s=0),t==="s"?s===0?"0":""+s/o:(n=ol(s,2+a),t==="ss"?n.substr(0,2):"."+n.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":u=r.D*24+r.H;break;case"[m]":case"[mm]":u=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":u=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}h=t.length===3?1:2;break;case 101:u=c,h=1;break}var p=h>0?ol(u,h):"";return p}function Fu(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,a=e.substr(0,r);r!=e.length;r+=t)a+=(a.length>0?",":"")+e.substr(r,t);return a}var E_=/%/g;function yR(e,t,r){var a=t.replace(E_,""),n=t.length-a.length;return Oc(e,a,r*Math.pow(10,2*n))+pn("%",n)}function wR(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return Oc(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function j_(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+j_(e,-t);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%n;if(s<0&&(s+=n),r=(t/Math.pow(10,s)).toPrecision(a+1+(n+s)%n),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+s):r+="E+"+(o-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,n)+"."+r.substr(2+n),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,u,h,p){return u+h+p.substr(0,(n+s)%n)+"."+p.substr(s)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var C_=/# (\?+)( ?)\/( ?)(\d+)/;function bR(e,t,r){var a=parseInt(e[4],10),n=Math.round(t*a),s=Math.floor(n/a),o=n-s*a,c=a;return r+(s===0?"":""+s)+" "+(o===0?pn(" ",e[1].length+1+e[4].length):Ny(o,e[1].length)+e[2]+"/"+e[3]+ol(c,e[4].length))}function SR(e,t,r){return r+(t===0?"":""+t)+pn(" ",e[1].length+2+e[4].length)}var D_=/^#*0*\.([0#]+)/,F_=/\).*[0#]/,P_=/\(###\) ###\\?-####/;function hi(e){for(var t="",r,a=0;a!=e.length;++a)switch(r=e.charCodeAt(a)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function _3(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function T3(e,t){var r=e-Math.floor(e),a=Math.pow(10,t);return t<(""+Math.round(r*a)).length?0:Math.round(r*a)}function NR(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function AR(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function bo(e,t,r){if(e.charCodeAt(0)===40&&!t.match(F_)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?bo("n",a,r):"("+bo("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return wR(e,t,r);if(t.indexOf("%")!==-1)return yR(e,t,r);if(t.indexOf("E")!==-1)return j_(t,r);if(t.charCodeAt(0)===36)return"$"+bo(e,t.substr(t.charAt(1)==" "?2:1),r);var n,s,o,c,u=Math.abs(r),h=r<0?"-":"";if(t.match(/^00+$/))return h+U0(u,t.length);if(t.match(/^[#?]+$/))return n=U0(r,0),n==="0"&&(n=""),n.length>t.length?n:hi(t.substr(0,t.length-n.length))+n;if(s=t.match(C_))return bR(s,u,h);if(t.match(/^#+0+$/))return h+U0(u,t.length-t.indexOf("0"));if(s=t.match(D_))return n=_3(r,s[1].length).replace(/^([^\.]+)$/,"$1."+hi(s[1])).replace(/\.$/,"."+hi(s[1])).replace(/\.(\d*)$/,function(w,b){return"."+b+pn("0",hi(s[1]).length-b.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return h+_3(u,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return h+Fu(U0(u,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+bo(e,t,-r):Fu(""+(Math.floor(r)+NR(r,s[1].length)))+"."+ol(T3(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return bo(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=nh(bo(e,t.replace(/[\\-]/g,""),r)),o=0,nh(nh(t.replace(/\\/g,"")).replace(/[0#]/g,function(w){return o<n.length?n.charAt(o++):w==="0"?"0":""}));if(t.match(P_))return n=bo(e,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var p="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),c=N1(u,Math.pow(10,o)-1,!1),n=""+h,p=Oc("n",s[1],c[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),n+=p+s[2]+"/"+s[3],p=b1(c[2],o),p.length<s[4].length&&(p=hi(s[4].substr(s[4].length-p.length))+p),n+=p,n;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),c=N1(u,Math.pow(10,o)-1,!0),h+(c[0]||(c[1]?"":"0"))+" "+(c[1]?Ny(c[1],o)+s[2]+"/"+s[3]+b1(c[2],o):pn(" ",2*o+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return n=U0(r,0),t.length<=n.length?n:hi(t.substr(0,t.length-n.length))+n;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=n.indexOf(".");var x=t.indexOf(".")-o,v=t.length-n.length-x;return hi(t.substr(0,x)+n+t.substr(t.length-v))}if(s=t.match(/^00,000\.([#0]*0)$/))return o=T3(r,s[1].length),r<0?"-"+bo(e,t,-r):Fu(AR(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?ol(0,3-w.length):"")+w})+"."+ol(o,s[1].length);switch(t){case"###,##0.00":return bo(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var g=Fu(U0(u,0));return g!=="0"?h+g:"";case"###,###.00":return bo(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return bo(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function _R(e,t,r){for(var a=t.length-1;t.charCodeAt(a-1)===44;)--a;return Oc(e,t.substr(0,a),r/Math.pow(10,3*(t.length-a)))}function TR(e,t,r){var a=t.replace(E_,""),n=t.length-a.length;return Oc(e,a,r*Math.pow(10,2*n))+pn("%",n)}function L_(e,t){var r,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+L_(e,-t);var n=e.indexOf(".");n===-1&&(n=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%n;if(s<0&&(s+=n),r=(t/Math.pow(10,s)).toPrecision(a+1+(n+s)%n),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+s):r+="E+"+(o-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(c,u,h,p){return u+h+p.substr(0,(n+s)%n)+"."+p.substr(s)+"E"})}else r=t.toExponential(a);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Hl(e,t,r){if(e.charCodeAt(0)===40&&!t.match(F_)){var a=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Hl("n",a,r):"("+Hl("n",a,-r)+")"}if(t.charCodeAt(t.length-1)===44)return _R(e,t,r);if(t.indexOf("%")!==-1)return TR(e,t,r);if(t.indexOf("E")!==-1)return L_(t,r);if(t.charCodeAt(0)===36)return"$"+Hl(e,t.substr(t.charAt(1)==" "?2:1),r);var n,s,o,c,u=Math.abs(r),h=r<0?"-":"";if(t.match(/^00+$/))return h+ol(u,t.length);if(t.match(/^[#?]+$/))return n=""+r,r===0&&(n=""),n.length>t.length?n:hi(t.substr(0,t.length-n.length))+n;if(s=t.match(C_))return SR(s,u,h);if(t.match(/^#+0+$/))return h+ol(u,t.length-t.indexOf("0"));if(s=t.match(D_))return n=(""+r).replace(/^([^\.]+)$/,"$1."+hi(s[1])).replace(/\.$/,"."+hi(s[1])),n=n.replace(/\.(\d*)$/,function(w,b){return"."+b+pn("0",hi(s[1]).length-b.length)}),t.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return h+(""+u).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return h+Fu(""+u);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Hl(e,t,-r):Fu(""+r)+"."+pn("0",s[1].length);if(s=t.match(/^#,#*,#0/))return Hl(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return n=nh(Hl(e,t.replace(/[\\-]/g,""),r)),o=0,nh(nh(t.replace(/\\/g,"")).replace(/[0#]/g,function(w){return o<n.length?n.charAt(o++):w==="0"?"0":""}));if(t.match(P_))return n=Hl(e,"##########",r),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var p="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),c=N1(u,Math.pow(10,o)-1,!1),n=""+h,p=Oc("n",s[1],c[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),n+=p+s[2]+"/"+s[3],p=b1(c[2],o),p.length<s[4].length&&(p=hi(s[4].substr(s[4].length-p.length))+p),n+=p,n;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),c=N1(u,Math.pow(10,o)-1,!0),h+(c[0]||(c[1]?"":"0"))+" "+(c[1]?Ny(c[1],o)+s[2]+"/"+s[3]+b1(c[2],o):pn(" ",2*o+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return n=""+r,t.length<=n.length?n:hi(t.substr(0,t.length-n.length))+n;if(s=t.match(/^([#0]+)\.([#0]+)$/)){n=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=n.indexOf(".");var x=t.indexOf(".")-o,v=t.length-n.length-x;return hi(t.substr(0,x)+n+t.substr(t.length-v))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Hl(e,t,-r):Fu(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?ol(0,3-w.length):"")+w})+"."+ol(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var g=Fu(""+u);return g!=="0"?h+g:"";default:if(t.match(/\.[0#?]*$/))return Hl(e,t.slice(0,t.lastIndexOf(".")),r)+hi(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Oc(e,t,r){return(r|0)===r?Hl(e,t,r):bo(e,t,r)}function kR(e){for(var t=[],r=!1,a=0,n=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:r=!r;break;case 95:case 42:case 92:++a;break;case 59:t[t.length]=e.substr(n,a-n),n=a+1}if(t[t.length]=e.substr(n),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var O_=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function wh(e){for(var t=0,r="",a="";t<e.length;)switch(r=e.charAt(t)){case"G":S1(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="上午/下午")return!0;++t;break;case"[":for(a=r;e.charAt(t++)!=="]"&&t<e.length;)a+=e.charAt(t);if(a.match(O_))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function ER(e,t,r,a){for(var n=[],s="",o=0,c="",u="t",h,p,x,v="H";o<e.length;)switch(c=e.charAt(o)){case"G":if(!S1(e,o))throw new Error("unrecognized character "+c+" in "+e);n[n.length]={t:"G",v:"General"},o+=7;break;case'"':for(s="";(x=e.charCodeAt(++o))!==34&&o<e.length;)s+=String.fromCharCode(x);n[n.length]={t:"t",v:s},++o;break;case"\\":var g=e.charAt(++o),w=g==="("||g===")"?g:"t";n[n.length]={t:w,v:g},++o;break;case"_":n[n.length]={t:"t",v:" "},o+=2;break;case"@":n[n.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(h==null&&(h=Pf(t,r,e.charAt(o+1)==="2"),h==null))return"";n[n.length]={t:"X",v:e.substr(o,2)},u=c,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":c=c.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||h==null&&(h=Pf(t,r),h==null))return"";for(s=c;++o<e.length&&e.charAt(o).toLowerCase()===c;)s+=c;c==="m"&&u.toLowerCase()==="h"&&(c="M"),c==="h"&&(c=v),n[n.length]={t:c,v:s},u=c;break;case"A":case"a":case"上":var b={t:c,v:c};if(h==null&&(h=Pf(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(h!=null&&(b.v=h.H>=12?"P":"A"),b.t="T",v="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(h!=null&&(b.v=h.H>=12?"PM":"AM"),b.t="T",o+=5,v="h"):e.substr(o,5).toUpperCase()==="上午/下午"?(h!=null&&(b.v=h.H>=12?"下午":"上午"),b.t="T",o+=5,v="h"):(b.t="t",++o),h==null&&b.t==="T")return"";n[n.length]=b,u=c;break;case"[":for(s=c;e.charAt(o++)!=="]"&&o<e.length;)s+=e.charAt(o);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(O_)){if(h==null&&(h=Pf(t,r),h==null))return"";n[n.length]={t:"Z",v:s.toLowerCase()},u=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",wh(e)||(n[n.length]={t:"t",v:s}));break;case".":if(h!=null){for(s=c;++o<e.length&&(c=e.charAt(o))==="0";)s+=c;n[n.length]={t:"s",v:s};break}case"0":case"#":for(s=c;++o<e.length&&"0#?.,E+-%".indexOf(c=e.charAt(o))>-1;)s+=c;n[n.length]={t:"n",v:s};break;case"?":for(s=c;e.charAt(++o)===c;)s+=c;n[n.length]={t:c,v:s},u=c;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":n[n.length]={t:a===1?"t":c,v:c},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=c;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)s+=e.charAt(o);n[n.length]={t:"D",v:s};break;case" ":n[n.length]={t:c,v:c},++o;break;case"$":n[n.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(c)===-1)throw new Error("unrecognized character "+c+" in "+e);n[n.length]={t:"t",v:c},++o;break}var N=0,_=0,E;for(o=n.length-1,u="t";o>=0;--o)switch(n[o].t){case"h":case"H":n[o].t=v,u="h",N<1&&(N=1);break;case"s":(E=n[o].v.match(/\.0+$/))&&(_=Math.max(_,E[0].length-1)),N<3&&(N=3);case"d":case"y":case"M":case"e":u=n[o].t;break;case"m":u==="s"&&(n[o].t="M",N<2&&(N=2));break;case"X":break;case"Z":N<1&&n[o].v.match(/[Hh]/)&&(N=1),N<2&&n[o].v.match(/[Mm]/)&&(N=2),N<3&&n[o].v.match(/[Ss]/)&&(N=3)}switch(N){case 0:break;case 1:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M),h.M>=60&&(h.M=0,++h.H);break;case 2:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M);break}var j="",M;for(o=0;o<n.length;++o)switch(n[o].t){case"t":case"T":case" ":case"D":break;case"X":n[o].v="",n[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":n[o].v=vR(n[o].t.charCodeAt(0),n[o].v,h,_),n[o].t="t";break;case"n":case"?":for(M=o+1;n[M]!=null&&((c=n[M].t)==="?"||c==="D"||(c===" "||c==="t")&&n[M+1]!=null&&(n[M+1].t==="?"||n[M+1].t==="t"&&n[M+1].v==="/")||n[o].t==="("&&(c===" "||c==="n"||c===")")||c==="t"&&(n[M].v==="/"||n[M].v===" "&&n[M+1]!=null&&n[M+1].t=="?"));)n[o].v+=n[M].v,n[M]={v:"",t:";"},++M;j+=n[o].v,o=M-1;break;case"G":n[o].t="t",n[o].v=Gf(t,r);break}var U="",V,I;if(j.length>0){j.charCodeAt(0)==40?(V=t<0&&j.charCodeAt(0)===45?-t:t,I=Oc("n",j,V)):(V=t<0&&a>1?-t:t,I=Oc("n",j,V),V<0&&n[0]&&n[0].t=="t"&&(I=I.substr(1),n[0].v="-"+n[0].v)),M=I.length-1;var z=n.length;for(o=0;o<n.length;++o)if(n[o]!=null&&n[o].t!="t"&&n[o].v.indexOf(".")>-1){z=o;break}var H=n.length;if(z===n.length&&I.indexOf("E")===-1){for(o=n.length-1;o>=0;--o)n[o]==null||"n?".indexOf(n[o].t)===-1||(M>=n[o].v.length-1?(M-=n[o].v.length,n[o].v=I.substr(M+1,n[o].v.length)):M<0?n[o].v="":(n[o].v=I.substr(0,M+1),M=-1),n[o].t="t",H=o);M>=0&&H<n.length&&(n[H].v=I.substr(0,M+1)+n[H].v)}else if(z!==n.length&&I.indexOf("E")===-1){for(M=I.indexOf(".")-1,o=z;o>=0;--o)if(!(n[o]==null||"n?".indexOf(n[o].t)===-1)){for(p=n[o].v.indexOf(".")>-1&&o===z?n[o].v.indexOf(".")-1:n[o].v.length-1,U=n[o].v.substr(p+1);p>=0;--p)M>=0&&(n[o].v.charAt(p)==="0"||n[o].v.charAt(p)==="#")&&(U=I.charAt(M--)+U);n[o].v=U,n[o].t="t",H=o}for(M>=0&&H<n.length&&(n[H].v=I.substr(0,M+1)+n[H].v),M=I.indexOf(".")+1,o=z;o<n.length;++o)if(!(n[o]==null||"n?(".indexOf(n[o].t)===-1&&o!==z)){for(p=n[o].v.indexOf(".")>-1&&o===z?n[o].v.indexOf(".")+1:0,U=n[o].v.substr(0,p);p<n[o].v.length;++p)M<I.length&&(U+=I.charAt(M++));n[o].v=U,n[o].t="t",H=o}}}for(o=0;o<n.length;++o)n[o]!=null&&"n?".indexOf(n[o].t)>-1&&(V=a>1&&t<0&&o>0&&n[o-1].v==="-"?-t:t,n[o].v=Oc(n[o].t,n[o].v,V),n[o].t="t");var re="";for(o=0;o!==n.length;++o)n[o]!=null&&(re+=n[o].v);return re}var k3=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function E3(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function jR(e,t){var r=kR(e),a=r.length,n=r[a-1].indexOf("@");if(a<4&&n>-1&&--a,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||n>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=n>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=n>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=n>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[a,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(k3),c=r[1].match(k3);return E3(t,o)?[a,r[0]]:E3(t,c)?[a,r[1]]:[a,r[o!=null&&c!=null?2:1]]}return[a,s]}function Co(e,t,r){r==null&&(r={});var a="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?a=r.dateNF:a=e;break;case"number":e==14&&r.dateNF?a=r.dateNF:a=(r.table!=null?r.table:xr)[e],a==null&&(a=r.table&&r.table[A3[e]]||xr[A3[e]]),a==null&&(a=fR[e]||"General");break}if(S1(a,0))return Gf(t,r);t instanceof Date&&(t=k_(t,r.date1904));var n=jR(a,t);if(S1(n[1]))return Gf(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return ER(n[1],t,r,n[0])}function Rc(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(xr[r]==null){t<0&&(t=r);continue}if(xr[r]==e){t=r;break}}t<0&&(t=391)}return xr[t]=e,t}function K1(e){for(var t=0;t!=392;++t)e[t]!==void 0&&Rc(e[t],t)}function bh(){xr=uR()}var CR={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},R_=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function DR(e){var t=typeof e=="number"?xr[e]:e;return t=t.replace(R_,"(\\d+)"),new RegExp("^"+t+"$")}function FR(e,t,r){var a=-1,n=-1,s=-1,o=-1,c=-1,u=-1;(t.match(R_)||[]).forEach(function(x,v){var g=parseInt(r[v+1],10);switch(x.toLowerCase().charAt(0)){case"y":a=g;break;case"d":s=g;break;case"h":o=g;break;case"s":u=g;break;case"m":o>=0?c=g:n=g;break}}),u>=0&&c==-1&&n>=0&&(c=n,n=-1);var h=(""+(a>=0?a:new Date().getFullYear())).slice(-4)+"-"+("00"+(n>=1?n:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);h.length==7&&(h="0"+h),h.length==8&&(h="20"+h);var p=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(u>=0?u:0)).slice(-2);return o==-1&&c==-1&&u==-1?h:a==-1&&n==-1&&s==-1?p:h+"T"+p}var PR=function(){var e={};e.version="1.2.0";function t(){for(var I=0,z=new Array(256),H=0;H!=256;++H)I=H,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,z[H]=I;return typeof Int32Array<"u"?new Int32Array(z):z}var r=t();function a(I){var z=0,H=0,re=0,R=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(re=0;re!=256;++re)R[re]=I[re];for(re=0;re!=256;++re)for(H=I[re],z=256+re;z<4096;z+=256)H=R[z]=H>>>8^I[H&255];var F=[];for(re=1;re!=16;++re)F[re-1]=typeof Int32Array<"u"?R.subarray(re*256,re*256+256):R.slice(re*256,re*256+256);return F}var n=a(r),s=n[0],o=n[1],c=n[2],u=n[3],h=n[4],p=n[5],x=n[6],v=n[7],g=n[8],w=n[9],b=n[10],N=n[11],_=n[12],E=n[13],j=n[14];function M(I,z){for(var H=z^-1,re=0,R=I.length;re<R;)H=H>>>8^r[(H^I.charCodeAt(re++))&255];return~H}function U(I,z){for(var H=z^-1,re=I.length-15,R=0;R<re;)H=j[I[R++]^H&255]^E[I[R++]^H>>8&255]^_[I[R++]^H>>16&255]^N[I[R++]^H>>>24]^b[I[R++]]^w[I[R++]]^g[I[R++]]^v[I[R++]]^x[I[R++]]^p[I[R++]]^h[I[R++]]^u[I[R++]]^c[I[R++]]^o[I[R++]]^s[I[R++]]^r[I[R++]];for(re+=15;R<re;)H=H>>>8^r[(H^I[R++])&255];return~H}function V(I,z){for(var H=z^-1,re=0,R=I.length,F=0,Y=0;re<R;)F=I.charCodeAt(re++),F<128?H=H>>>8^r[(H^F)&255]:F<2048?(H=H>>>8^r[(H^(192|F>>6&31))&255],H=H>>>8^r[(H^(128|F&63))&255]):F>=55296&&F<57344?(F=(F&1023)+64,Y=I.charCodeAt(re++)&1023,H=H>>>8^r[(H^(240|F>>8&7))&255],H=H>>>8^r[(H^(128|F>>2&63))&255],H=H>>>8^r[(H^(128|Y>>6&15|(F&3)<<4))&255],H=H>>>8^r[(H^(128|Y&63))&255]):(H=H>>>8^r[(H^(224|F>>12&15))&255],H=H>>>8^r[(H^(128|F>>6&63))&255],H=H>>>8^r[(H^(128|F&63))&255]);return~H}return e.table=r,e.bstr=M,e.buf=U,e.str=V,e}(),cr=function(){var t={};t.version="1.2.1";function r(ne,Ne){for(var pe=ne.split("/"),ge=Ne.split("/"),Se=0,_e=0,Ye=Math.min(pe.length,ge.length);Se<Ye;++Se){if(_e=pe[Se].length-ge[Se].length)return _e;if(pe[Se]!=ge[Se])return pe[Se]<ge[Se]?-1:1}return pe.length-ge.length}function a(ne){if(ne.charAt(ne.length-1)=="/")return ne.slice(0,-1).indexOf("/")===-1?ne:a(ne.slice(0,-1));var Ne=ne.lastIndexOf("/");return Ne===-1?ne:ne.slice(0,Ne+1)}function n(ne){if(ne.charAt(ne.length-1)=="/")return n(ne.slice(0,-1));var Ne=ne.lastIndexOf("/");return Ne===-1?ne:ne.slice(Ne+1)}function s(ne,Ne){typeof Ne=="string"&&(Ne=new Date(Ne));var pe=Ne.getHours();pe=pe<<6|Ne.getMinutes(),pe=pe<<5|Ne.getSeconds()>>>1,ne.write_shift(2,pe);var ge=Ne.getFullYear()-1980;ge=ge<<4|Ne.getMonth()+1,ge=ge<<5|Ne.getDate(),ne.write_shift(2,ge)}function o(ne){var Ne=ne.read_shift(2)&65535,pe=ne.read_shift(2)&65535,ge=new Date,Se=pe&31;pe>>>=5;var _e=pe&15;pe>>>=4,ge.setMilliseconds(0),ge.setFullYear(pe+1980),ge.setMonth(_e-1),ge.setDate(Se);var Ye=Ne&31;Ne>>>=5;var lt=Ne&63;return Ne>>>=6,ge.setHours(Ne),ge.setMinutes(lt),ge.setSeconds(Ye<<1),ge}function c(ne){Ss(ne,0);for(var Ne={},pe=0;ne.l<=ne.length-4;){var ge=ne.read_shift(2),Se=ne.read_shift(2),_e=ne.l+Se,Ye={};switch(ge){case 21589:pe=ne.read_shift(1),pe&1&&(Ye.mtime=ne.read_shift(4)),Se>5&&(pe&2&&(Ye.atime=ne.read_shift(4)),pe&4&&(Ye.ctime=ne.read_shift(4))),Ye.mtime&&(Ye.mt=new Date(Ye.mtime*1e3));break}ne.l=_e,Ne[ge]=Ye}return Ne}var u;function h(){return u||(u={})}function p(ne,Ne){if(ne[0]==80&&ne[1]==75)return na(ne,Ne);if((ne[0]|32)==109&&(ne[1]|32)==105)return gn(ne,Ne);if(ne.length<512)throw new Error("CFB file size "+ne.length+" < 512");var pe=3,ge=512,Se=0,_e=0,Ye=0,lt=0,We=0,$e=[],Qe=ne.slice(0,512);Ss(Qe,0);var St=x(Qe);switch(pe=St[0],pe){case 3:ge=512;break;case 4:ge=4096;break;case 0:if(St[1]==0)return na(ne,Ne);default:throw new Error("Major Version: Expected 3 or 4 saw "+pe)}ge!==512&&(Qe=ne.slice(0,ge),Ss(Qe,28));var jt=ne.slice(0,ge);v(Qe,pe);var Ut=Qe.read_shift(4,"i");if(pe===3&&Ut!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ut);Qe.l+=4,Ye=Qe.read_shift(4,"i"),Qe.l+=4,Qe.chk("00100000","Mini Stream Cutoff Size: "),lt=Qe.read_shift(4,"i"),Se=Qe.read_shift(4,"i"),We=Qe.read_shift(4,"i"),_e=Qe.read_shift(4,"i");for(var ie=-1,Ce=0;Ce<109&&(ie=Qe.read_shift(4,"i"),!(ie<0));++Ce)$e[Ce]=ie;var Oe=g(ne,ge);N(We,_e,Oe,ge,$e);var Ve=E(Oe,Ye,$e,ge);Ve[Ye].name="!Directory",Se>0&&lt!==Y&&(Ve[lt].name="!MiniFAT"),Ve[$e[0]].name="!FAT",Ve.fat_addrs=$e,Ve.ssz=ge;var kt={},Ht=[],Ft=[],ir=[];j(Ye,Ve,Oe,Ht,Se,kt,Ft,lt),w(Ft,ir,Ht),Ht.shift();var Gt={FileIndex:Ft,FullPaths:ir};return Ne&&Ne.raw&&(Gt.raw={header:jt,sectors:Oe}),Gt}function x(ne){if(ne[ne.l]==80&&ne[ne.l+1]==75)return[0,0];ne.chk(K,"Header Signature: "),ne.l+=16;var Ne=ne.read_shift(2,"u");return[ne.read_shift(2,"u"),Ne]}function v(ne,Ne){var pe=9;switch(ne.l+=2,pe=ne.read_shift(2)){case 9:if(Ne!=3)throw new Error("Sector Shift: Expected 9 saw "+pe);break;case 12:if(Ne!=4)throw new Error("Sector Shift: Expected 12 saw "+pe);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+pe)}ne.chk("0600","Mini Sector Shift: "),ne.chk("000000000000","Reserved: ")}function g(ne,Ne){for(var pe=Math.ceil(ne.length/Ne)-1,ge=[],Se=1;Se<pe;++Se)ge[Se-1]=ne.slice(Se*Ne,(Se+1)*Ne);return ge[pe-1]=ne.slice(pe*Ne),ge}function w(ne,Ne,pe){for(var ge=0,Se=0,_e=0,Ye=0,lt=0,We=pe.length,$e=[],Qe=[];ge<We;++ge)$e[ge]=Qe[ge]=ge,Ne[ge]=pe[ge];for(;lt<Qe.length;++lt)ge=Qe[lt],Se=ne[ge].L,_e=ne[ge].R,Ye=ne[ge].C,$e[ge]===ge&&(Se!==-1&&$e[Se]!==Se&&($e[ge]=$e[Se]),_e!==-1&&$e[_e]!==_e&&($e[ge]=$e[_e])),Ye!==-1&&($e[Ye]=ge),Se!==-1&&ge!=$e[ge]&&($e[Se]=$e[ge],Qe.lastIndexOf(Se)<lt&&Qe.push(Se)),_e!==-1&&ge!=$e[ge]&&($e[_e]=$e[ge],Qe.lastIndexOf(_e)<lt&&Qe.push(_e));for(ge=1;ge<We;++ge)$e[ge]===ge&&(_e!==-1&&$e[_e]!==_e?$e[ge]=$e[_e]:Se!==-1&&$e[Se]!==Se&&($e[ge]=$e[Se]));for(ge=1;ge<We;++ge)if(ne[ge].type!==0){if(lt=ge,lt!=$e[lt])do lt=$e[lt],Ne[ge]=Ne[lt]+"/"+Ne[ge];while(lt!==0&&$e[lt]!==-1&&lt!=$e[lt]);$e[ge]=-1}for(Ne[0]+="/",ge=1;ge<We;++ge)ne[ge].type!==2&&(Ne[ge]+="/")}function b(ne,Ne,pe){for(var ge=ne.start,Se=ne.size,_e=[],Ye=ge;pe&&Se>0&&Ye>=0;)_e.push(Ne.slice(Ye*F,Ye*F+F)),Se-=F,Ye=jf(pe,Ye*4);return _e.length===0?ht(0):cs(_e).slice(0,ne.size)}function N(ne,Ne,pe,ge,Se){var _e=Y;if(ne===Y){if(Ne!==0)throw new Error("DIFAT chain shorter than expected")}else if(ne!==-1){var Ye=pe[ne],lt=(ge>>>2)-1;if(!Ye)return;for(var We=0;We<lt&&(_e=jf(Ye,We*4))!==Y;++We)Se.push(_e);N(jf(Ye,ge-4),Ne-1,pe,ge,Se)}}function _(ne,Ne,pe,ge,Se){var _e=[],Ye=[];Se||(Se=[]);var lt=ge-1,We=0,$e=0;for(We=Ne;We>=0;){Se[We]=!0,_e[_e.length]=We,Ye.push(ne[We]);var Qe=pe[Math.floor(We*4/ge)];if($e=We*4&lt,ge<4+$e)throw new Error("FAT boundary crossed: "+We+" 4 "+ge);if(!ne[Qe])break;We=jf(ne[Qe],$e)}return{nodes:_e,data:U3([Ye])}}function E(ne,Ne,pe,ge){var Se=ne.length,_e=[],Ye=[],lt=[],We=[],$e=ge-1,Qe=0,St=0,jt=0,Ut=0;for(Qe=0;Qe<Se;++Qe)if(lt=[],jt=Qe+Ne,jt>=Se&&(jt-=Se),!Ye[jt]){We=[];var ie=[];for(St=jt;St>=0;){ie[St]=!0,Ye[St]=!0,lt[lt.length]=St,We.push(ne[St]);var Ce=pe[Math.floor(St*4/ge)];if(Ut=St*4&$e,ge<4+Ut)throw new Error("FAT boundary crossed: "+St+" 4 "+ge);if(!ne[Ce]||(St=jf(ne[Ce],Ut),ie[St]))break}_e[jt]={nodes:lt,data:U3([We])}}return _e}function j(ne,Ne,pe,ge,Se,_e,Ye,lt){for(var We=0,$e=ge.length?2:0,Qe=Ne[ne].data,St=0,jt=0,Ut;St<Qe.length;St+=128){var ie=Qe.slice(St,St+128);Ss(ie,64),jt=ie.read_shift(2),Ut=Dy(ie,0,jt-$e),ge.push(Ut);var Ce={name:Ut,type:ie.read_shift(1),color:ie.read_shift(1),L:ie.read_shift(4,"i"),R:ie.read_shift(4,"i"),C:ie.read_shift(4,"i"),clsid:ie.read_shift(16),state:ie.read_shift(4,"i"),start:0,size:0},Oe=ie.read_shift(2)+ie.read_shift(2)+ie.read_shift(2)+ie.read_shift(2);Oe!==0&&(Ce.ct=M(ie,ie.l-8));var Ve=ie.read_shift(2)+ie.read_shift(2)+ie.read_shift(2)+ie.read_shift(2);Ve!==0&&(Ce.mt=M(ie,ie.l-8)),Ce.start=ie.read_shift(4,"i"),Ce.size=ie.read_shift(4,"i"),Ce.size<0&&Ce.start<0&&(Ce.size=Ce.type=0,Ce.start=Y,Ce.name=""),Ce.type===5?(We=Ce.start,Se>0&&We!==Y&&(Ne[We].name="!StreamData")):Ce.size>=4096?(Ce.storage="fat",Ne[Ce.start]===void 0&&(Ne[Ce.start]=_(pe,Ce.start,Ne.fat_addrs,Ne.ssz)),Ne[Ce.start].name=Ce.name,Ce.content=Ne[Ce.start].data.slice(0,Ce.size)):(Ce.storage="minifat",Ce.size<0?Ce.size=0:We!==Y&&Ce.start!==Y&&Ne[We]&&(Ce.content=b(Ce,Ne[We].data,(Ne[lt]||{}).data))),Ce.content&&Ss(Ce.content,0),_e[Ut]=Ce,Ye.push(Ce)}}function M(ne,Ne){return new Date((Ji(ne,Ne+4)/1e7*Math.pow(2,32)+Ji(ne,Ne)/1e7-11644473600)*1e3)}function U(ne,Ne){return h(),p(u.readFileSync(ne),Ne)}function V(ne,Ne){var pe=Ne&&Ne.type;switch(pe||Rr&&Buffer.isBuffer(ne)&&(pe="buffer"),pe||"base64"){case"file":return U(ne,Ne);case"base64":return p(Ki(ro(ne)),Ne);case"binary":return p(Ki(ne),Ne)}return p(ne,Ne)}function I(ne,Ne){var pe=Ne||{},ge=pe.root||"Root Entry";if(ne.FullPaths||(ne.FullPaths=[]),ne.FileIndex||(ne.FileIndex=[]),ne.FullPaths.length!==ne.FileIndex.length)throw new Error("inconsistent CFB structure");ne.FullPaths.length===0&&(ne.FullPaths[0]=ge+"/",ne.FileIndex[0]={name:ge,type:5}),pe.CLSID&&(ne.FileIndex[0].clsid=pe.CLSID),z(ne)}function z(ne){var Ne="Sh33tJ5";if(!cr.find(ne,"/"+Ne)){var pe=ht(4);pe[0]=55,pe[1]=pe[3]=50,pe[2]=54,ne.FileIndex.push({name:Ne,type:2,content:pe,size:4,L:69,R:69,C:69}),ne.FullPaths.push(ne.FullPaths[0]+Ne),H(ne)}}function H(ne,Ne){I(ne);for(var pe=!1,ge=!1,Se=ne.FullPaths.length-1;Se>=0;--Se){var _e=ne.FileIndex[Se];switch(_e.type){case 0:ge?pe=!0:(ne.FileIndex.pop(),ne.FullPaths.pop());break;case 1:case 2:case 5:ge=!0,isNaN(_e.R*_e.L*_e.C)&&(pe=!0),_e.R>-1&&_e.L>-1&&_e.R==_e.L&&(pe=!0);break;default:pe=!0;break}}if(!(!pe&&!Ne)){var Ye=new Date(1987,1,19),lt=0,We=Object.create?Object.create(null):{},$e=[];for(Se=0;Se<ne.FullPaths.length;++Se)We[ne.FullPaths[Se]]=!0,ne.FileIndex[Se].type!==0&&$e.push([ne.FullPaths[Se],ne.FileIndex[Se]]);for(Se=0;Se<$e.length;++Se){var Qe=a($e[Se][0]);ge=We[Qe],ge||($e.push([Qe,{name:n(Qe).replace("/",""),type:1,clsid:Z,ct:Ye,mt:Ye,content:null}]),We[Qe]=!0)}for($e.sort(function(Ut,ie){return r(Ut[0],ie[0])}),ne.FullPaths=[],ne.FileIndex=[],Se=0;Se<$e.length;++Se)ne.FullPaths[Se]=$e[Se][0],ne.FileIndex[Se]=$e[Se][1];for(Se=0;Se<$e.length;++Se){var St=ne.FileIndex[Se],jt=ne.FullPaths[Se];if(St.name=n(jt).replace("/",""),St.L=St.R=St.C=-(St.color=1),St.size=St.content?St.content.length:0,St.start=0,St.clsid=St.clsid||Z,Se===0)St.C=$e.length>1?1:-1,St.size=0,St.type=5;else if(jt.slice(-1)=="/"){for(lt=Se+1;lt<$e.length&&a(ne.FullPaths[lt])!=jt;++lt);for(St.C=lt>=$e.length?-1:lt,lt=Se+1;lt<$e.length&&a(ne.FullPaths[lt])!=a(jt);++lt);St.R=lt>=$e.length?-1:lt,St.type=1}else a(ne.FullPaths[Se+1]||"")==a(jt)&&(St.R=Se+1),St.type=2}}}function re(ne,Ne){var pe=Ne||{};if(pe.fileType=="mad")return Qt(ne,pe);switch(H(ne),pe.fileType){case"zip":return Dn(ne,pe)}var ge=function(Ut){for(var ie=0,Ce=0,Oe=0;Oe<Ut.FileIndex.length;++Oe){var Ve=Ut.FileIndex[Oe];if(Ve.content){var kt=Ve.content.length;kt>0&&(kt<4096?ie+=kt+63>>6:Ce+=kt+511>>9)}}for(var Ht=Ut.FullPaths.length+3>>2,Ft=ie+7>>3,ir=ie+127>>7,Gt=Ft+Ce+Ht+ir,yr=Gt+127>>7,Pr=yr<=109?0:Math.ceil((yr-109)/127);Gt+yr+Pr+127>>7>yr;)Pr=++yr<=109?0:Math.ceil((yr-109)/127);var er=[1,Pr,yr,ir,Ht,Ce,ie,0];return Ut.FileIndex[0].size=ie<<6,er[7]=(Ut.FileIndex[0].start=er[0]+er[1]+er[2]+er[3]+er[4]+er[5])+(er[6]+7>>3),er}(ne),Se=ht(ge[7]<<9),_e=0,Ye=0;{for(_e=0;_e<8;++_e)Se.write_shift(1,X[_e]);for(_e=0;_e<8;++_e)Se.write_shift(2,0);for(Se.write_shift(2,62),Se.write_shift(2,3),Se.write_shift(2,65534),Se.write_shift(2,9),Se.write_shift(2,6),_e=0;_e<3;++_e)Se.write_shift(2,0);for(Se.write_shift(4,0),Se.write_shift(4,ge[2]),Se.write_shift(4,ge[0]+ge[1]+ge[2]+ge[3]-1),Se.write_shift(4,0),Se.write_shift(4,4096),Se.write_shift(4,ge[3]?ge[0]+ge[1]+ge[2]-1:Y),Se.write_shift(4,ge[3]),Se.write_shift(-4,ge[1]?ge[0]-1:Y),Se.write_shift(4,ge[1]),_e=0;_e<109;++_e)Se.write_shift(-4,_e<ge[2]?ge[1]+_e:-1)}if(ge[1])for(Ye=0;Ye<ge[1];++Ye){for(;_e<236+Ye*127;++_e)Se.write_shift(-4,_e<ge[2]?ge[1]+_e:-1);Se.write_shift(-4,Ye===ge[1]-1?Y:Ye+1)}var lt=function(Ut){for(Ye+=Ut;_e<Ye-1;++_e)Se.write_shift(-4,_e+1);Ut&&(++_e,Se.write_shift(-4,Y))};for(Ye=_e=0,Ye+=ge[1];_e<Ye;++_e)Se.write_shift(-4,ce.DIFSECT);for(Ye+=ge[2];_e<Ye;++_e)Se.write_shift(-4,ce.FATSECT);lt(ge[3]),lt(ge[4]);for(var We=0,$e=0,Qe=ne.FileIndex[0];We<ne.FileIndex.length;++We)Qe=ne.FileIndex[We],Qe.content&&($e=Qe.content.length,!($e<4096)&&(Qe.start=Ye,lt($e+511>>9)));for(lt(ge[6]+7>>3);Se.l&511;)Se.write_shift(-4,ce.ENDOFCHAIN);for(Ye=_e=0,We=0;We<ne.FileIndex.length;++We)Qe=ne.FileIndex[We],Qe.content&&($e=Qe.content.length,!(!$e||$e>=4096)&&(Qe.start=Ye,lt($e+63>>6)));for(;Se.l&511;)Se.write_shift(-4,ce.ENDOFCHAIN);for(_e=0;_e<ge[4]<<2;++_e){var St=ne.FullPaths[_e];if(!St||St.length===0){for(We=0;We<17;++We)Se.write_shift(4,0);for(We=0;We<3;++We)Se.write_shift(4,-1);for(We=0;We<12;++We)Se.write_shift(4,0);continue}Qe=ne.FileIndex[_e],_e===0&&(Qe.start=Qe.size?Qe.start-1:Y);var jt=_e===0&&pe.root||Qe.name;if($e=2*(jt.length+1),Se.write_shift(64,jt,"utf16le"),Se.write_shift(2,$e),Se.write_shift(1,Qe.type),Se.write_shift(1,Qe.color),Se.write_shift(-4,Qe.L),Se.write_shift(-4,Qe.R),Se.write_shift(-4,Qe.C),Qe.clsid)Se.write_shift(16,Qe.clsid,"hex");else for(We=0;We<4;++We)Se.write_shift(4,0);Se.write_shift(4,Qe.state||0),Se.write_shift(4,0),Se.write_shift(4,0),Se.write_shift(4,0),Se.write_shift(4,0),Se.write_shift(4,Qe.start),Se.write_shift(4,Qe.size),Se.write_shift(4,0)}for(_e=1;_e<ne.FileIndex.length;++_e)if(Qe=ne.FileIndex[_e],Qe.size>=4096)if(Se.l=Qe.start+1<<9,Rr&&Buffer.isBuffer(Qe.content))Qe.content.copy(Se,Se.l,0,Qe.size),Se.l+=Qe.size+511&-512;else{for(We=0;We<Qe.size;++We)Se.write_shift(1,Qe.content[We]);for(;We&511;++We)Se.write_shift(1,0)}for(_e=1;_e<ne.FileIndex.length;++_e)if(Qe=ne.FileIndex[_e],Qe.size>0&&Qe.size<4096)if(Rr&&Buffer.isBuffer(Qe.content))Qe.content.copy(Se,Se.l,0,Qe.size),Se.l+=Qe.size+63&-64;else{for(We=0;We<Qe.size;++We)Se.write_shift(1,Qe.content[We]);for(;We&63;++We)Se.write_shift(1,0)}if(Rr)Se.l=Se.length;else for(;Se.l<Se.length;)Se.write_shift(1,0);return Se}function R(ne,Ne){var pe=ne.FullPaths.map(function(We){return We.toUpperCase()}),ge=pe.map(function(We){var $e=We.split("/");return $e[$e.length-(We.slice(-1)=="/"?2:1)]}),Se=!1;Ne.charCodeAt(0)===47?(Se=!0,Ne=pe[0].slice(0,-1)+Ne):Se=Ne.indexOf("/")!==-1;var _e=Ne.toUpperCase(),Ye=Se===!0?pe.indexOf(_e):ge.indexOf(_e);if(Ye!==-1)return ne.FileIndex[Ye];var lt=!_e.match(Sd);for(_e=_e.replace(mi,""),lt&&(_e=_e.replace(Sd,"!")),Ye=0;Ye<pe.length;++Ye)if((lt?pe[Ye].replace(Sd,"!"):pe[Ye]).replace(mi,"")==_e||(lt?ge[Ye].replace(Sd,"!"):ge[Ye]).replace(mi,"")==_e)return ne.FileIndex[Ye];return null}var F=64,Y=-2,K="d0cf11e0a1b11ae1",X=[208,207,17,224,161,177,26,225],Z="00000000000000000000000000000000",ce={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Y,FREESECT:-1,HEADER_SIGNATURE:K,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Z,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function te(ne,Ne,pe){h();var ge=re(ne,pe);u.writeFileSync(Ne,ge)}function Q(ne){for(var Ne=new Array(ne.length),pe=0;pe<ne.length;++pe)Ne[pe]=String.fromCharCode(ne[pe]);return Ne.join("")}function G(ne,Ne){var pe=re(ne,Ne);switch(Ne&&Ne.type||"buffer"){case"file":return h(),u.writeFileSync(Ne.filename,pe),pe;case"binary":return typeof pe=="string"?pe:Q(pe);case"base64":return tp(typeof pe=="string"?pe:Q(pe));case"buffer":if(Rr)return Buffer.isBuffer(pe)?pe:qc(pe);case"array":return typeof pe=="string"?Ki(pe):pe}return pe}var ye;function D(ne){try{var Ne=ne.InflateRaw,pe=new Ne;if(pe._processChunk(new Uint8Array([3,0]),pe._finishFlushFlag),pe.bytesRead)ye=ne;else throw new Error("zlib does not expose bytesRead")}catch(ge){console.error("cannot use native zlib: "+(ge.message||ge))}}function O(ne,Ne){if(!ye)return Ir(ne,Ne);var pe=ye.InflateRaw,ge=new pe,Se=ge._processChunk(ne.slice(ne.l),ge._finishFlushFlag);return ne.l+=ge.bytesRead,Se}function L(ne){return ye?ye.deflateRawSync(ne):Ct(ne)}var q=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],oe=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],be=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ve(ne){var Ne=(ne<<1|ne<<11)&139536|(ne<<5|ne<<15)&558144;return(Ne>>16|Ne>>8|Ne)&255}for(var ue=typeof Uint8Array<"u",fe=ue?new Uint8Array(256):[],Ee=0;Ee<256;++Ee)fe[Ee]=ve(Ee);function J(ne,Ne){var pe=fe[ne&255];return Ne<=8?pe>>>8-Ne:(pe=pe<<8|fe[ne>>8&255],Ne<=16?pe>>>16-Ne:(pe=pe<<8|fe[ne>>16&255],pe>>>24-Ne))}function Pe(ne,Ne){var pe=Ne&7,ge=Ne>>>3;return(ne[ge]|(pe<=6?0:ne[ge+1]<<8))>>>pe&3}function st(ne,Ne){var pe=Ne&7,ge=Ne>>>3;return(ne[ge]|(pe<=5?0:ne[ge+1]<<8))>>>pe&7}function ke(ne,Ne){var pe=Ne&7,ge=Ne>>>3;return(ne[ge]|(pe<=4?0:ne[ge+1]<<8))>>>pe&15}function de(ne,Ne){var pe=Ne&7,ge=Ne>>>3;return(ne[ge]|(pe<=3?0:ne[ge+1]<<8))>>>pe&31}function rt(ne,Ne){var pe=Ne&7,ge=Ne>>>3;return(ne[ge]|(pe<=1?0:ne[ge+1]<<8))>>>pe&127}function Ue(ne,Ne,pe){var ge=Ne&7,Se=Ne>>>3,_e=(1<<pe)-1,Ye=ne[Se]>>>ge;return pe<8-ge||(Ye|=ne[Se+1]<<8-ge,pe<16-ge)||(Ye|=ne[Se+2]<<16-ge,pe<24-ge)||(Ye|=ne[Se+3]<<24-ge),Ye&_e}function Xe(ne,Ne,pe){var ge=Ne&7,Se=Ne>>>3;return ge<=5?ne[Se]|=(pe&7)<<ge:(ne[Se]|=pe<<ge&255,ne[Se+1]=(pe&7)>>8-ge),Ne+3}function ot(ne,Ne,pe){var ge=Ne&7,Se=Ne>>>3;return pe=(pe&1)<<ge,ne[Se]|=pe,Ne+1}function ut(ne,Ne,pe){var ge=Ne&7,Se=Ne>>>3;return pe<<=ge,ne[Se]|=pe&255,pe>>>=8,ne[Se+1]=pe,Ne+8}function vt(ne,Ne,pe){var ge=Ne&7,Se=Ne>>>3;return pe<<=ge,ne[Se]|=pe&255,pe>>>=8,ne[Se+1]=pe&255,ne[Se+2]=pe>>>8,Ne+16}function At(ne,Ne){var pe=ne.length,ge=2*pe>Ne?2*pe:Ne+5,Se=0;if(pe>=Ne)return ne;if(Rr){var _e=b3(ge);if(ne.copy)ne.copy(_e);else for(;Se<ne.length;++Se)_e[Se]=ne[Se];return _e}else if(ue){var Ye=new Uint8Array(ge);if(Ye.set)Ye.set(ne);else for(;Se<pe;++Se)Ye[Se]=ne[Se];return Ye}return ne.length=ge,ne}function ct(ne){for(var Ne=new Array(ne),pe=0;pe<ne;++pe)Ne[pe]=0;return Ne}function ze(ne,Ne,pe){var ge=1,Se=0,_e=0,Ye=0,lt=0,We=ne.length,$e=ue?new Uint16Array(32):ct(32);for(_e=0;_e<32;++_e)$e[_e]=0;for(_e=We;_e<pe;++_e)ne[_e]=0;We=ne.length;var Qe=ue?new Uint16Array(We):ct(We);for(_e=0;_e<We;++_e)$e[Se=ne[_e]]++,ge<Se&&(ge=Se),Qe[_e]=0;for($e[0]=0,_e=1;_e<=ge;++_e)$e[_e+16]=lt=lt+$e[_e-1]<<1;for(_e=0;_e<We;++_e)lt=ne[_e],lt!=0&&(Qe[_e]=$e[lt+16]++);var St=0;for(_e=0;_e<We;++_e)if(St=ne[_e],St!=0)for(lt=J(Qe[_e],ge)>>ge-St,Ye=(1<<ge+4-St)-1;Ye>=0;--Ye)Ne[lt|Ye<<St]=St&15|_e<<4;return ge}var pt=ue?new Uint16Array(512):ct(512),Ot=ue?new Uint16Array(32):ct(32);if(!ue){for(var It=0;It<512;++It)pt[It]=0;for(It=0;It<32;++It)Ot[It]=0}(function(){for(var ne=[],Ne=0;Ne<32;Ne++)ne.push(5);ze(ne,Ot,32);var pe=[];for(Ne=0;Ne<=143;Ne++)pe.push(8);for(;Ne<=255;Ne++)pe.push(9);for(;Ne<=279;Ne++)pe.push(7);for(;Ne<=287;Ne++)pe.push(8);ze(pe,pt,288)})();var Lt=function(){for(var Ne=ue?new Uint8Array(32768):[],pe=0,ge=0;pe<be.length-1;++pe)for(;ge<be[pe+1];++ge)Ne[ge]=pe;for(;ge<32768;++ge)Ne[ge]=29;var Se=ue?new Uint8Array(259):[];for(pe=0,ge=0;pe<oe.length-1;++pe)for(;ge<oe[pe+1];++ge)Se[ge]=pe;function _e(lt,We){for(var $e=0;$e<lt.length;){var Qe=Math.min(65535,lt.length-$e),St=$e+Qe==lt.length;for(We.write_shift(1,+St),We.write_shift(2,Qe),We.write_shift(2,~Qe&65535);Qe-- >0;)We[We.l++]=lt[$e++]}return We.l}function Ye(lt,We){for(var $e=0,Qe=0,St=ue?new Uint16Array(32768):[];Qe<lt.length;){var jt=Math.min(65535,lt.length-Qe);if(jt<10){for($e=Xe(We,$e,+(Qe+jt==lt.length)),$e&7&&($e+=8-($e&7)),We.l=$e/8|0,We.write_shift(2,jt),We.write_shift(2,~jt&65535);jt-- >0;)We[We.l++]=lt[Qe++];$e=We.l*8;continue}$e=Xe(We,$e,+(Qe+jt==lt.length)+2);for(var Ut=0;jt-- >0;){var ie=lt[Qe];Ut=(Ut<<5^ie)&32767;var Ce=-1,Oe=0;if((Ce=St[Ut])&&(Ce|=Qe&-32768,Ce>Qe&&(Ce-=32768),Ce<Qe))for(;lt[Ce+Oe]==lt[Qe+Oe]&&Oe<250;)++Oe;if(Oe>2){ie=Se[Oe],ie<=22?$e=ut(We,$e,fe[ie+1]>>1)-1:(ut(We,$e,3),$e+=5,ut(We,$e,fe[ie-23]>>5),$e+=3);var Ve=ie<8?0:ie-4>>2;Ve>0&&(vt(We,$e,Oe-oe[ie]),$e+=Ve),ie=Ne[Qe-Ce],$e=ut(We,$e,fe[ie]>>3),$e-=3;var kt=ie<4?0:ie-2>>1;kt>0&&(vt(We,$e,Qe-Ce-be[ie]),$e+=kt);for(var Ht=0;Ht<Oe;++Ht)St[Ut]=Qe&32767,Ut=(Ut<<5^lt[Qe])&32767,++Qe;jt-=Oe-1}else ie<=143?ie=ie+48:$e=ot(We,$e,1),$e=ut(We,$e,fe[ie]),St[Ut]=Qe&32767,++Qe}$e=ut(We,$e,0)-1}return We.l=($e+7)/8|0,We.l}return function(We,$e){return We.length<8?_e(We,$e):Ye(We,$e)}}();function Ct(ne){var Ne=ht(50+Math.floor(ne.length*1.1)),pe=Lt(ne,Ne);return Ne.slice(0,pe)}var wt=ue?new Uint16Array(32768):ct(32768),hr=ue?new Uint16Array(32768):ct(32768),zt=ue?new Uint16Array(128):ct(128),Yt=1,Sr=1;function Mr(ne,Ne){var pe=de(ne,Ne)+257;Ne+=5;var ge=de(ne,Ne)+1;Ne+=5;var Se=ke(ne,Ne)+4;Ne+=4;for(var _e=0,Ye=ue?new Uint8Array(19):ct(19),lt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],We=1,$e=ue?new Uint8Array(8):ct(8),Qe=ue?new Uint8Array(8):ct(8),St=Ye.length,jt=0;jt<Se;++jt)Ye[q[jt]]=_e=st(ne,Ne),We<_e&&(We=_e),$e[_e]++,Ne+=3;var Ut=0;for($e[0]=0,jt=1;jt<=We;++jt)Qe[jt]=Ut=Ut+$e[jt-1]<<1;for(jt=0;jt<St;++jt)(Ut=Ye[jt])!=0&&(lt[jt]=Qe[Ut]++);var ie=0;for(jt=0;jt<St;++jt)if(ie=Ye[jt],ie!=0){Ut=fe[lt[jt]]>>8-ie;for(var Ce=(1<<7-ie)-1;Ce>=0;--Ce)zt[Ut|Ce<<ie]=ie&7|jt<<3}var Oe=[];for(We=1;Oe.length<pe+ge;)switch(Ut=zt[rt(ne,Ne)],Ne+=Ut&7,Ut>>>=3){case 16:for(_e=3+Pe(ne,Ne),Ne+=2,Ut=Oe[Oe.length-1];_e-- >0;)Oe.push(Ut);break;case 17:for(_e=3+st(ne,Ne),Ne+=3;_e-- >0;)Oe.push(0);break;case 18:for(_e=11+rt(ne,Ne),Ne+=7;_e-- >0;)Oe.push(0);break;default:Oe.push(Ut),We<Ut&&(We=Ut);break}var Ve=Oe.slice(0,pe),kt=Oe.slice(pe);for(jt=pe;jt<286;++jt)Ve[jt]=0;for(jt=ge;jt<30;++jt)kt[jt]=0;return Yt=ze(Ve,wt,286),Sr=ze(kt,hr,30),Ne}function fa(ne,Ne){if(ne[0]==3&&!(ne[1]&3))return[Uu(Ne),2];for(var pe=0,ge=0,Se=b3(Ne||1<<18),_e=0,Ye=Se.length>>>0,lt=0,We=0;(ge&1)==0;){if(ge=st(ne,pe),pe+=3,ge>>>1)ge>>1==1?(lt=9,We=5):(pe=Mr(ne,pe),lt=Yt,We=Sr);else{pe&7&&(pe+=8-(pe&7));var $e=ne[pe>>>3]|ne[(pe>>>3)+1]<<8;if(pe+=32,$e>0)for(!Ne&&Ye<_e+$e&&(Se=At(Se,_e+$e),Ye=Se.length);$e-- >0;)Se[_e++]=ne[pe>>>3],pe+=8;continue}for(;;){!Ne&&Ye<_e+32767&&(Se=At(Se,_e+32767),Ye=Se.length);var Qe=Ue(ne,pe,lt),St=ge>>>1==1?pt[Qe]:wt[Qe];if(pe+=St&15,St>>>=4,(St>>>8&255)===0)Se[_e++]=St;else{if(St==256)break;St-=257;var jt=St<8?0:St-4>>2;jt>5&&(jt=0);var Ut=_e+oe[St];jt>0&&(Ut+=Ue(ne,pe,jt),pe+=jt),Qe=Ue(ne,pe,We),St=ge>>>1==1?Ot[Qe]:hr[Qe],pe+=St&15,St>>>=4;var ie=St<4?0:St-2>>1,Ce=be[St];for(ie>0&&(Ce+=Ue(ne,pe,ie),pe+=ie),!Ne&&Ye<Ut&&(Se=At(Se,Ut+100),Ye=Se.length);_e<Ut;)Se[_e]=Se[_e-Ce],++_e}}}return Ne?[Se,pe+7>>>3]:[Se.slice(0,_e),pe+7>>>3]}function Ir(ne,Ne){var pe=ne.slice(ne.l||0),ge=fa(pe,Ne);return ne.l+=ge[1],ge[0]}function gi(ne,Ne){if(ne)typeof console<"u"&&console.error(Ne);else throw new Error(Ne)}function na(ne,Ne){var pe=ne;Ss(pe,0);var ge=[],Se=[],_e={FileIndex:ge,FullPaths:Se};I(_e,{root:Ne.root});for(var Ye=pe.length-4;(pe[Ye]!=80||pe[Ye+1]!=75||pe[Ye+2]!=5||pe[Ye+3]!=6)&&Ye>=0;)--Ye;pe.l=Ye+4,pe.l+=4;var lt=pe.read_shift(2);pe.l+=6;var We=pe.read_shift(4);for(pe.l=We,Ye=0;Ye<lt;++Ye){pe.l+=20;var $e=pe.read_shift(4),Qe=pe.read_shift(4),St=pe.read_shift(2),jt=pe.read_shift(2),Ut=pe.read_shift(2);pe.l+=8;var ie=pe.read_shift(4),Ce=c(pe.slice(pe.l+St,pe.l+St+jt));pe.l+=St+jt+Ut;var Oe=pe.l;pe.l=ie+4,Ja(pe,$e,Qe,_e,Ce),pe.l=Oe}return _e}function Ja(ne,Ne,pe,ge,Se){ne.l+=2;var _e=ne.read_shift(2),Ye=ne.read_shift(2),lt=o(ne);if(_e&8257)throw new Error("Unsupported ZIP encryption");for(var We=ne.read_shift(4),$e=ne.read_shift(4),Qe=ne.read_shift(4),St=ne.read_shift(2),jt=ne.read_shift(2),Ut="",ie=0;ie<St;++ie)Ut+=String.fromCharCode(ne[ne.l++]);if(jt){var Ce=c(ne.slice(ne.l,ne.l+jt));(Ce[21589]||{}).mt&&(lt=Ce[21589].mt),((Se||{})[21589]||{}).mt&&(lt=Se[21589].mt)}ne.l+=jt;var Oe=ne.slice(ne.l,ne.l+$e);switch(Ye){case 8:Oe=O(ne,Qe);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Ye)}var Ve=!1;_e&8&&(We=ne.read_shift(4),We==134695760&&(We=ne.read_shift(4),Ve=!0),$e=ne.read_shift(4),Qe=ne.read_shift(4)),$e!=Ne&&gi(Ve,"Bad compressed size: "+Ne+" != "+$e),Qe!=pe&&gi(Ve,"Bad uncompressed size: "+pe+" != "+Qe),Vr(ge,Ut,Oe,{unsafe:!0,mt:lt})}function Dn(ne,Ne){var pe=Ne||{},ge=[],Se=[],_e=ht(1),Ye=pe.compression?8:0,lt=0,We=0,$e=0,Qe=0,St=0,jt=ne.FullPaths[0],Ut=jt,ie=ne.FileIndex[0],Ce=[],Oe=0;for(We=1;We<ne.FullPaths.length;++We)if(Ut=ne.FullPaths[We].slice(jt.length),ie=ne.FileIndex[We],!(!ie.size||!ie.content||Ut=="Sh33tJ5")){var Ve=Qe,kt=ht(Ut.length);for($e=0;$e<Ut.length;++$e)kt.write_shift(1,Ut.charCodeAt($e)&127);kt=kt.slice(0,kt.l),Ce[St]=PR.buf(ie.content,0);var Ht=ie.content;Ye==8&&(Ht=L(Ht)),_e=ht(30),_e.write_shift(4,67324752),_e.write_shift(2,20),_e.write_shift(2,lt),_e.write_shift(2,Ye),ie.mt?s(_e,ie.mt):_e.write_shift(4,0),_e.write_shift(-4,Ce[St]),_e.write_shift(4,Ht.length),_e.write_shift(4,ie.content.length),_e.write_shift(2,kt.length),_e.write_shift(2,0),Qe+=_e.length,ge.push(_e),Qe+=kt.length,ge.push(kt),Qe+=Ht.length,ge.push(Ht),_e=ht(46),_e.write_shift(4,33639248),_e.write_shift(2,0),_e.write_shift(2,20),_e.write_shift(2,lt),_e.write_shift(2,Ye),_e.write_shift(4,0),_e.write_shift(-4,Ce[St]),_e.write_shift(4,Ht.length),_e.write_shift(4,ie.content.length),_e.write_shift(2,kt.length),_e.write_shift(2,0),_e.write_shift(2,0),_e.write_shift(2,0),_e.write_shift(2,0),_e.write_shift(4,0),_e.write_shift(4,Ve),Oe+=_e.l,Se.push(_e),Oe+=kt.length,Se.push(kt),++St}return _e=ht(22),_e.write_shift(4,101010256),_e.write_shift(2,0),_e.write_shift(2,0),_e.write_shift(2,St),_e.write_shift(2,St),_e.write_shift(4,Oe),_e.write_shift(4,Qe),_e.write_shift(2,0),cs([cs(ge),cs(Se),_e])}var Br={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function sr(ne,Ne){if(ne.ctype)return ne.ctype;var pe=ne.name||"",ge=pe.match(/\.([^\.]+)$/);return ge&&Br[ge[1]]||Ne&&(ge=(pe=Ne).match(/[\.\\]([^\.\\])+$/),ge&&Br[ge[1]])?Br[ge[1]]:"application/octet-stream"}function kr(ne){for(var Ne=tp(ne),pe=[],ge=0;ge<Ne.length;ge+=76)pe.push(Ne.slice(ge,ge+76));return pe.join(`\r
`)+`\r
`}function As(ne){var Ne=ne.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function($e){var Qe=$e.charCodeAt(0).toString(16).toUpperCase();return"="+(Qe.length==1?"0"+Qe:Qe)});Ne=Ne.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),Ne.charAt(0)==`
`&&(Ne="=0D"+Ne.slice(1)),Ne=Ne.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var pe=[],ge=Ne.split(`\r
`),Se=0;Se<ge.length;++Se){var _e=ge[Se];if(_e.length==0){pe.push("");continue}for(var Ye=0;Ye<_e.length;){var lt=76,We=_e.slice(Ye,Ye+lt);We.charAt(lt-1)=="="?lt--:We.charAt(lt-2)=="="?lt-=2:We.charAt(lt-3)=="="&&(lt-=3),We=_e.slice(Ye,Ye+lt),Ye+=lt,Ye<_e.length&&(We+="="),pe.push(We)}}return pe.join(`\r
`)}function ka(ne){for(var Ne=[],pe=0;pe<ne.length;++pe){for(var ge=ne[pe];pe<=ne.length&&ge.charAt(ge.length-1)=="=";)ge=ge.slice(0,ge.length-1)+ne[++pe];Ne.push(ge)}for(var Se=0;Se<Ne.length;++Se)Ne[Se]=Ne[Se].replace(/[=][0-9A-Fa-f]{2}/g,function(_e){return String.fromCharCode(parseInt(_e.slice(1),16))});return Ki(Ne.join(`\r
`))}function Ea(ne,Ne,pe){for(var ge="",Se="",_e="",Ye,lt=0;lt<10;++lt){var We=Ne[lt];if(!We||We.match(/^\s*$/))break;var $e=We.match(/^(.*?):\s*([^\s].*)$/);if($e)switch($e[1].toLowerCase()){case"content-location":ge=$e[2].trim();break;case"content-type":_e=$e[2].trim();break;case"content-transfer-encoding":Se=$e[2].trim();break}}switch(++lt,Se.toLowerCase()){case"base64":Ye=Ki(ro(Ne.slice(lt).join("")));break;case"quoted-printable":Ye=ka(Ne.slice(lt));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+Se)}var Qe=Vr(ne,ge.slice(pe.length),Ye,{unsafe:!0});_e&&(Qe.ctype=_e)}function gn(ne,Ne){if(Q(ne.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var pe=Ne&&Ne.root||"",ge=(Rr&&Buffer.isBuffer(ne)?ne.toString("binary"):Q(ne)).split(`\r
`),Se=0,_e="";for(Se=0;Se<ge.length;++Se)if(_e=ge[Se],!!/^Content-Location:/i.test(_e)&&(_e=_e.slice(_e.indexOf("file")),pe||(pe=_e.slice(0,_e.lastIndexOf("/")+1)),_e.slice(0,pe.length)!=pe))for(;pe.length>0&&(pe=pe.slice(0,pe.length-1),pe=pe.slice(0,pe.lastIndexOf("/")+1),_e.slice(0,pe.length)!=pe););var Ye=(ge[1]||"").match(/boundary="(.*?)"/);if(!Ye)throw new Error("MAD cannot find boundary");var lt="--"+(Ye[1]||""),We=[],$e=[],Qe={FileIndex:We,FullPaths:$e};I(Qe);var St,jt=0;for(Se=0;Se<ge.length;++Se){var Ut=ge[Se];Ut!==lt&&Ut!==lt+"--"||(jt++&&Ea(Qe,ge.slice(St,Se),pe),St=Se)}return Qe}function Qt(ne,Ne){var pe=Ne||{},ge=pe.boundary||"SheetJS";ge="------="+ge;for(var Se=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+ge.slice(2)+'"',"","",""],_e=ne.FullPaths[0],Ye=_e,lt=ne.FileIndex[0],We=1;We<ne.FullPaths.length;++We)if(Ye=ne.FullPaths[We].slice(_e.length),lt=ne.FileIndex[We],!(!lt.size||!lt.content||Ye=="Sh33tJ5")){Ye=Ye.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Oe){return"_x"+Oe.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Oe){return"_u"+Oe.charCodeAt(0).toString(16)+"_"});for(var $e=lt.content,Qe=Rr&&Buffer.isBuffer($e)?$e.toString("binary"):Q($e),St=0,jt=Math.min(1024,Qe.length),Ut=0,ie=0;ie<=jt;++ie)(Ut=Qe.charCodeAt(ie))>=32&&Ut<128&&++St;var Ce=St>=jt*4/5;Se.push(ge),Se.push("Content-Location: "+(pe.root||"file:///C:/SheetJS/")+Ye),Se.push("Content-Transfer-Encoding: "+(Ce?"quoted-printable":"base64")),Se.push("Content-Type: "+sr(lt,Ye)),Se.push(""),Se.push(Ce?As(Qe):kr(Qe))}return Se.push(ge+`--\r
`),Se.join(`\r
`)}function Un(ne){var Ne={};return I(Ne,ne),Ne}function Vr(ne,Ne,pe,ge){var Se=ge&&ge.unsafe;Se||I(ne);var _e=!Se&&cr.find(ne,Ne);if(!_e){var Ye=ne.FullPaths[0];Ne.slice(0,Ye.length)==Ye?Ye=Ne:(Ye.slice(-1)!="/"&&(Ye+="/"),Ye=(Ye+Ne).replace("//","/")),_e={name:n(Ne),type:2},ne.FileIndex.push(_e),ne.FullPaths.push(Ye),Se||cr.utils.cfb_gc(ne)}return _e.content=pe,_e.size=pe?pe.length:0,ge&&(ge.CLSID&&(_e.clsid=ge.CLSID),ge.mt&&(_e.mt=ge.mt),ge.ct&&(_e.ct=ge.ct)),_e}function qa(ne,Ne){I(ne);var pe=cr.find(ne,Ne);if(pe){for(var ge=0;ge<ne.FileIndex.length;++ge)if(ne.FileIndex[ge]==pe)return ne.FileIndex.splice(ge,1),ne.FullPaths.splice(ge,1),!0}return!1}function qr(ne,Ne,pe){I(ne);var ge=cr.find(ne,Ne);if(ge){for(var Se=0;Se<ne.FileIndex.length;++Se)if(ne.FileIndex[Se]==ge)return ne.FileIndex[Se].name=n(pe),ne.FullPaths[Se]=pe,!0}return!1}function ha(ne){H(ne,!0)}return t.find=R,t.read=V,t.parse=p,t.write=G,t.writeFile=te,t.utils={cfb_new:Un,cfb_add:Vr,cfb_del:qa,cfb_mov:qr,cfb_gc:ha,ReadShift:Dd,CheckField:n6,prep_blob:Ss,bconcat:cs,use_zlib:D,_deflateRaw:Ct,_inflateRaw:Ir,consts:ce},t}();function LR(e){return typeof e=="string"?J1(e):Array.isArray(e)?iR(e):e}function wp(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=J1(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var a=r=="utf8"?Gl(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(a,e);if(typeof Blob<"u"){var n=new Blob([LR(a)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(n,e);if(typeof saveAs<"u")return saveAs(n,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(n);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=s,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var c=File(e);return c.open("w"),c.encoding="binary",Array.isArray(t)&&(t=Gu(t)),c.write(t),c.close(),t}catch(u){if(!u.message||!u.message.match(/onstruct/))throw u}throw new Error("cannot save file "+e)}function OR(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(a){if(!a.message||!a.message.match(/onstruct/))throw a}throw new Error("Cannot access file "+e)}function xn(e){for(var t=Object.keys(e),r=[],a=0;a<t.length;++a)Object.prototype.hasOwnProperty.call(e,t[a])&&r.push(t[a]);return r}function j3(e,t){for(var r=[],a=xn(e),n=0;n!==a.length;++n)r[e[a[n]][t]]==null&&(r[e[a[n]][t]]=a[n]);return r}function Z1(e){for(var t=[],r=xn(e),a=0;a!==r.length;++a)t[e[r[a]]]=r[a];return t}function Q1(e){for(var t=[],r=xn(e),a=0;a!==r.length;++a)t[e[r[a]]]=parseInt(r[a],10);return t}function RR(e){for(var t=[],r=xn(e),a=0;a!==r.length;++a)t[e[r[a]]]==null&&(t[e[r[a]]]=[]),t[e[r[a]]].push(r[a]);return t}var A1=new Date(1899,11,30,0,0,0);function Yn(e,t){var r=e.getTime(),a=A1.getTime()+(e.getTimezoneOffset()-A1.getTimezoneOffset())*6e4;return(r-a)/(24*60*60*1e3)}var M_=new Date,MR=A1.getTime()+(M_.getTimezoneOffset()-A1.getTimezoneOffset())*6e4,C3=M_.getTimezoneOffset();function ex(e){var t=new Date;return t.setTime(e*24*60*60*1e3+MR),t.getTimezoneOffset()!==C3&&t.setTime(t.getTime()+(t.getTimezoneOffset()-C3)*6e4),t}function IR(e){var t=0,r=0,a=!1,n=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!n)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=n.length;++s)if(n[s]){switch(r=1,s>3&&(a=!0),n[s].slice(n[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+n[s].slice(n[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(a)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(n[s],10)}return t}var D3=new Date("2017-02-19T19:06:09.000Z"),I_=isNaN(D3.getFullYear())?new Date("2/19/17"):D3,BR=I_.getFullYear()==2017;function Ha(e,t){var r=new Date(e);if(BR)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(I_.getFullYear()==1917&&!isNaN(r.getFullYear())){var a=r.getFullYear();return e.indexOf(""+a)>-1||r.setFullYear(r.getFullYear()+100),r}var n=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Wf(e,t){if(Rr&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Gl(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Gl(__(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Gl(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Gl(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(s){return r[s]||s})}catch{}for(var a=[],n=0;n!=e.length;++n)a.push(String.fromCharCode(e[n]));return a.join("")}function Va(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Va(e[r]));return t}function pn(e,t){for(var r="";r.length<t;)r+=e;return r}function ll(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,a=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(a))||(a=a.replace(/[(](.*)[)]/,function(n,s){return r=-r,s}),!isNaN(t=Number(a)))?t/r:t}var UR=["january","february","march","april","may","june","july","august","september","october","november","december"];function hh(e){var t=new Date(e),r=new Date(NaN),a=t.getYear(),n=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&UR.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return a<0||a>8099?r:(n>0||s>1)&&a!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var zR=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,a,n){if(e||typeof a=="string")return r.split(a);for(var s=r.split(a),o=[s[0]],c=1;c<s.length;++c)o.push(n),o.push(s[c]);return o}}();function B_(e){return e?e.content&&e.type?Wf(e.content,!0):e.data?bd(e.data):e.asNodeBuffer&&Rr?bd(e.asNodeBuffer().toString("binary")):e.asBinary?bd(e.asBinary()):e._data&&e._data.getContent?bd(Wf(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function U_(e){if(!e)return null;if(e.data)return y3(e.data);if(e.asNodeBuffer&&Rr)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?y3(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function HR(e){return e&&e.name.slice(-4)===".bin"?U_(e):B_(e)}function _o(e,t){for(var r=e.FullPaths||xn(e.files),a=t.toLowerCase().replace(/[\/]/g,"\\"),n=a.replace(/\\/g,"/"),s=0;s<r.length;++s){var o=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(a==o||n==o)return e.files?e.files[r[s]]:e.FileIndex[s]}return null}function _y(e,t){var r=_o(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function In(e,t,r){if(!r)return HR(_y(e,t));if(!t)return null;try{return In(e,t)}catch{return null}}function Zi(e,t,r){if(!r)return B_(_y(e,t));if(!t)return null;try{return Zi(e,t)}catch{return null}}function VR(e,t,r){return U_(_y(e,t))}function F3(e){for(var t=e.FullPaths||xn(e.files),r=[],a=0;a<t.length;++a)t[a].slice(-1)!="/"&&r.push(t[a].replace(/^Root Entry[\/]/,""));return r.sort()}function Fr(e,t,r){if(e.FullPaths){if(typeof r=="string"){var a;return Rr?a=qc(r):a=oR(r),cr.utils.cfb_add(e,t,a)}cr.utils.cfb_add(e,t,r)}else e.file(t,r)}function Ty(){return cr.utils.cfb_new()}function z_(e,t){switch(t.type){case"base64":return cr.read(e,{type:"base64"});case"binary":return cr.read(e,{type:"binary"});case"buffer":case"array":return cr.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Nd(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var a=e.split("/");a.length!==0;){var n=a.shift();n===".."?r.pop():n!=="."&&r.push(n)}return r.join("/")}var Cn=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,qR=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,P3=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,GR=/<[^>]*>/g,Qs=Cn.match(P3)?P3:GR,WR=/<\w*:/,$R=/<(\/?)\w+:/;function wr(e,t,r){for(var a={},n=0,s=0;n!==e.length&&!((s=e.charCodeAt(n))===32||s===10||s===13);++n);if(t||(a[0]=e.slice(0,n)),n===e.length)return a;var o=e.match(qR),c=0,u="",h=0,p="",x="",v=1;if(o)for(h=0;h!=o.length;++h){for(x=o[h],s=0;s!=x.length&&x.charCodeAt(s)!==61;++s);for(p=x.slice(0,s).trim();x.charCodeAt(s+1)==32;)++s;for(v=(n=x.charCodeAt(s+1))==34||n==39?1:0,u=x.slice(s+1+v,x.length-v),c=0;c!=p.length&&p.charCodeAt(c)!==58;++c);if(c===p.length)p.indexOf("_")>0&&(p=p.slice(0,p.indexOf("_"))),a[p]=u,a[p.toLowerCase()]=u;else{var g=(c===5&&p.slice(0,5)==="xmlns"?"xmlns":"")+p.slice(c+1);if(a[g]&&p.slice(c-3,c)=="ext")continue;a[g]=u,a[g.toLowerCase()]=u}}return a}function Ql(e){return e.replace($R,"<$1")}var H_={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},ky=Z1(H_),ra=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(a){var n=a+"",s=n.indexOf("<![CDATA[");if(s==-1)return n.replace(e,function(c,u){return H_[c]||String.fromCharCode(parseInt(u,c.indexOf("x")>-1?16:10))||c}).replace(t,function(c,u){return String.fromCharCode(parseInt(u,16))});var o=n.indexOf("]]>");return r(n.slice(0,s))+n.slice(s+9,o)+r(n.slice(o+3))}}(),Ey=/[&<>'"]/g,XR=/[\u0000-\u0008\u000b-\u001f]/g;function ya(e){var t=e+"";return t.replace(Ey,function(r){return ky[r]}).replace(XR,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function L3(e){return ya(e).replace(/ /g,"_x0020_")}var V_=/[\u0000-\u001f]/g;function jy(e){var t=e+"";return t.replace(Ey,function(r){return ky[r]}).replace(/\n/g,"<br/>").replace(V_,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function YR(e){var t=e+"";return t.replace(Ey,function(r){return ky[r]}).replace(V_,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var O3=function(){var e=/&#(\d+);/g;function t(r,a){return String.fromCharCode(parseInt(a,10))}return function(a){return a.replace(e,t)}}();function JR(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function Ua(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function s2(e){for(var t="",r=0,a=0,n=0,s=0,o=0,c=0;r<e.length;){if(a=e.charCodeAt(r++),a<128){t+=String.fromCharCode(a);continue}if(n=e.charCodeAt(r++),a>191&&a<224){o=(a&31)<<6,o|=n&63,t+=String.fromCharCode(o);continue}if(s=e.charCodeAt(r++),a<240){t+=String.fromCharCode((a&15)<<12|(n&63)<<6|s&63);continue}o=e.charCodeAt(r++),c=((a&7)<<18|(n&63)<<12|(s&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(c>>>10&1023)),t+=String.fromCharCode(56320+(c&1023))}return t}function R3(e){var t=Uu(2*e.length),r,a,n=1,s=0,o=0,c;for(a=0;a<e.length;a+=n)n=1,(c=e.charCodeAt(a))<128?r=c:c<224?(r=(c&31)*64+(e.charCodeAt(a+1)&63),n=2):c<240?(r=(c&15)*4096+(e.charCodeAt(a+1)&63)*64+(e.charCodeAt(a+2)&63),n=3):(n=4,r=(c&7)*262144+(e.charCodeAt(a+1)&63)*4096+(e.charCodeAt(a+2)&63)*64+(e.charCodeAt(a+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[s++]=o&255,t[s++]=o>>>8,o=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function M3(e){return qc(e,"binary").toString("utf8")}var Pm="foo bar bazâð£",Na=Rr&&(M3(Pm)==s2(Pm)&&M3||R3(Pm)==s2(Pm)&&R3)||s2,Gl=Rr?function(e){return qc(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,a=0,n=0;r<e.length;)switch(a=e.charCodeAt(r++),!0){case a<128:t.push(String.fromCharCode(a));break;case a<2048:t.push(String.fromCharCode(192+(a>>6))),t.push(String.fromCharCode(128+(a&63)));break;case(a>=55296&&a<57344):a-=55296,n=e.charCodeAt(r++)-56320+(a<<10),t.push(String.fromCharCode(240+(n>>18&7))),t.push(String.fromCharCode(144+(n>>12&63))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)));break;default:t.push(String.fromCharCode(224+(a>>12))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)))}return t.join("")},ap=function(){var e={};return function(r,a){var n=r+"|"+(a||"");return e[n]?e[n]:e[n]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",a||"")}}(),q_=function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var a=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),n=0;n<e.length;++n)a=a.replace(e[n][0],e[n][1]);return a}}(),KR=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),ZR=/<\/?(?:vt:)?variant>/g,QR=/<(?:vt:)([^>]*)>([\s\S]*)</;function I3(e,t){var r=wr(e),a=e.match(KR(r.baseType))||[],n=[];if(a.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+a.length+" != "+r.size);return n}return a.forEach(function(s){var o=s.replace(ZR,"").match(QR);o&&n.push({v:Na(o[2]),t:o[1]})}),n}var G_=/(^\s|\s$|\n)/;function Ns(e,t){return"<"+e+(t.match(G_)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function np(e){return xn(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Mt(e,t,r){return"<"+e+(r!=null?np(r):"")+(t!=null?(t.match(G_)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function lv(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function e9(e,t){switch(typeof e){case"string":var r=Mt("vt:lpwstr",ya(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Mt((e|0)==e?"vt:i4":"vt:r8",ya(String(e)));case"boolean":return Mt("vt:bool",e?"true":"false")}if(e instanceof Date)return Mt("vt:filetime",lv(e));throw new Error("Unable to serialize "+e)}function Cy(e){if(Rr&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Na(Gu(Sy(e)));throw new Error("Bad input format: expected Buffer or string")}var sp=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Xn={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},t0=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Yi={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function t9(e,t){for(var r=1-2*(e[t+7]>>>7),a=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),n=e[t+6]&15,s=5;s>=0;--s)n=n*256+e[t+s];return a==2047?n==0?r*(1/0):NaN:(a==0?a=-1022:(a-=1023,n+=Math.pow(2,52)),r*Math.pow(2,a-52)*n)}function r9(e,t,r){var a=(t<0||1/t==-1/0?1:0)<<7,n=0,s=0,o=a?-t:t;isFinite(o)?o==0?n=s=0:(n=Math.floor(Math.log(o)/Math.LN2),s=o*Math.pow(2,52-n),n<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?n=-1022:(s-=Math.pow(2,52),n+=1023)):(n=2047,s=isNaN(t)?26985:0);for(var c=0;c<=5;++c,s/=256)e[r+c]=s&255;e[r+6]=(n&15)<<4|s&15,e[r+7]=n>>4|a}var B3=function(e){for(var t=[],r=10240,a=0;a<e[0].length;++a)if(e[0][a])for(var n=0,s=e[0][a].length;n<s;n+=r)t.push.apply(t,e[0][a].slice(n,n+r));return t},U3=Rr?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:qc(t)})):B3(e)}:B3,z3=function(e,t,r){for(var a=[],n=t;n<r;n+=2)a.push(String.fromCharCode(Dc(e,n)));return a.join("").replace(mi,"")},Dy=Rr?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(mi,""):z3(e,t,r)}:z3,H3=function(e,t,r){for(var a=[],n=t;n<t+r;++n)a.push(("0"+e[n].toString(16)).slice(-2));return a.join("")},W_=Rr?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):H3(e,t,r)}:H3,V3=function(e,t,r){for(var a=[],n=t;n<r;n++)a.push(String.fromCharCode(G0(e,n)));return a.join("")},bp=Rr?function(t,r,a){return Buffer.isBuffer(t)?t.toString("utf8",r,a):V3(t,r,a)}:V3,$_=function(e,t){var r=Ji(e,t);return r>0?bp(e,t+4,t+4+r-1):""},X_=$_,Y_=function(e,t){var r=Ji(e,t);return r>0?bp(e,t+4,t+4+r-1):""},J_=Y_,K_=function(e,t){var r=2*Ji(e,t);return r>0?bp(e,t+4,t+4+r-1):""},Z_=K_,Q_=function(t,r){var a=Ji(t,r);return a>0?Dy(t,r+4,r+4+a):""},e6=Q_,t6=function(e,t){var r=Ji(e,t);return r>0?bp(e,t+4,t+4+r):""},r6=t6,a6=function(e,t){return t9(e,t)},_1=a6,Fy=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Rr&&(X_=function(t,r){if(!Buffer.isBuffer(t))return $_(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},J_=function(t,r){if(!Buffer.isBuffer(t))return Y_(t,r);var a=t.readUInt32LE(r);return a>0?t.toString("utf8",r+4,r+4+a-1):""},Z_=function(t,r){if(!Buffer.isBuffer(t))return K_(t,r);var a=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a-1)},e6=function(t,r){if(!Buffer.isBuffer(t))return Q_(t,r);var a=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+a)},r6=function(t,r){if(!Buffer.isBuffer(t))return t6(t,r);var a=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+a)},_1=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):a6(t,r)},Fy=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var G0=function(e,t){return e[t]},Dc=function(e,t){return e[t+1]*256+e[t]},a9=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Ji=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},jf=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},n9=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Dd(e,t){var r="",a,n,s=[],o,c,u,h;switch(t){case"dbcs":if(h=this.l,Rr&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(u=0;u<e;++u)r+=String.fromCharCode(Dc(this,h)),h+=2;e*=2;break;case"utf8":r=bp(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Dy(this,this.l,this.l+e);break;case"wstr":return Dd.call(this,e,"dbcs");case"lpstr-ansi":r=X_(this,this.l),e=4+Ji(this,this.l);break;case"lpstr-cp":r=J_(this,this.l),e=4+Ji(this,this.l);break;case"lpwstr":r=Z_(this,this.l),e=4+2*Ji(this,this.l);break;case"lpp4":e=4+Ji(this,this.l),r=e6(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Ji(this,this.l),r=r6(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=G0(this,this.l+e++))!==0;)s.push(Fm(o));r=s.join("");break;case"_wstr":for(e=0,r="";(o=Dc(this,this.l+e))!==0;)s.push(Fm(o)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",h=this.l,u=0;u<e;++u){if(this.lens&&this.lens.indexOf(h)!==-1)return o=G0(this,h),this.l=h+1,c=Dd.call(this,e-u,o?"dbcs-cont":"sbcs-cont"),s.join("")+c;s.push(Fm(Dc(this,h))),h+=2}r=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",h=this.l,u=0;u!=e;++u){if(this.lens&&this.lens.indexOf(h)!==-1)return o=G0(this,h),this.l=h+1,c=Dd.call(this,e-u,o?"dbcs-cont":"sbcs-cont"),s.join("")+c;s.push(Fm(G0(this,h))),h+=1}r=s.join("");break;default:switch(e){case 1:return a=G0(this,this.l),this.l++,a;case 2:return a=(t==="i"?a9:Dc)(this,this.l),this.l+=2,a;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(a=(e>0?jf:n9)(this,this.l),this.l+=4,a):(n=Ji(this,this.l),this.l+=4,n);case 8:case-8:if(t==="f")return e==8?n=_1(this,this.l):n=_1([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;e=8;case 16:r=W_(this,this.l,e);break}}return this.l+=e,r}var s9=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},i9=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},o9=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function l9(e,t,r){var a=0,n=0;if(r==="dbcs"){for(n=0;n!=t.length;++n)o9(this,t.charCodeAt(n),this.l+2*n);a=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),n=0;n!=t.length;++n)this[this.l+n]=t.charCodeAt(n)&255;a=t.length}else if(r==="hex"){for(;n<e;++n)this[this.l++]=parseInt(t.slice(2*n,2*n+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(n=0;n<Math.min(t.length,e);++n){var o=t.charCodeAt(n);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:a=1,this[this.l]=t&255;break;case 2:a=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:a=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:a=4,s9(this,t,this.l);break;case 8:if(a=8,r==="f"){r9(this,t,this.l);break}case 16:break;case-4:a=4,i9(this,t,this.l);break}return this.l+=a,this}function n6(e,t){var r=W_(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Ss(e,t){e.l=t,e.read_shift=Dd,e.chk=n6,e.write_shift=l9}function Zs(e,t){e.l+=t}function ht(e){var t=Uu(e);return Ss(t,0),t}function Gc(e,t,r){if(e){var a,n,s;Ss(e,e.l||0);for(var o=e.length,c=0,u=0;e.l<o;){c=e.read_shift(1),c&128&&(c=(c&127)+((e.read_shift(1)&127)<<7));var h=fp[c]||fp[65535];for(a=e.read_shift(1),s=a&127,n=1;n<4&&a&128;++n)s+=((a=e.read_shift(1))&127)<<7*n;u=e.l+s;var p=h.f&&h.f(e,s,r);if(e.l=u,t(p,h,c))return}}}function ji(){var e=[],t=Rr?256:2048,r=function(h){var p=ht(h);return Ss(p,0),p},a=r(t),n=function(){a&&(a.length>a.l&&(a=a.slice(0,a.l),a.l=a.length),a.length>0&&e.push(a),a=null)},s=function(h){return a&&h<a.length-a.l?a:(n(),a=r(Math.max(h+1,t)))},o=function(){return n(),cs(e)},c=function(h){n(),a=h,a.l==null&&(a.l=a.length),s(t)};return{next:s,push:c,end:o,_bufs:e}}function Nt(e,t,r,a){var n=+t,s;if(!isNaN(n)){a||(a=fp[n].p||(r||[]).length||0),s=1+(n>=128?1:0)+1,a>=128&&++s,a>=16384&&++s,a>=2097152&&++s;var o=e.next(s);n<=127?o.write_shift(1,n):(o.write_shift(1,(n&127)+128),o.write_shift(1,n>>7));for(var c=0;c!=4;++c)if(a>=128)o.write_shift(1,(a&127)+128),a>>=7;else{o.write_shift(1,a);break}a>0&&Fy(r)&&e.push(r)}}function Fd(e,t,r){var a=Va(e);if(t.s?(a.cRel&&(a.c+=t.s.c),a.rRel&&(a.r+=t.s.r)):(a.cRel&&(a.c+=t.c),a.rRel&&(a.r+=t.r)),!r||r.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function q3(e,t,r){var a=Va(e);return a.s=Fd(a.s,t.s,r),a.e=Fd(a.e,t.s,r),a}function Pd(e,t){if(e.cRel&&e.c<0)for(e=Va(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Va(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=vr(e);return!e.cRel&&e.cRel!=null&&(r=f9(r)),!e.rRel&&e.rRel!=null&&(r=c9(r)),r}function i2(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+nn(e.s.c)+":"+(e.e.cRel?"":"$")+nn(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+jn(e.s.r)+":"+(e.e.rRel?"":"$")+jn(e.e.r):Pd(e.s,t.biff)+":"+Pd(e.e,t.biff)}function Py(e){return parseInt(u9(e),10)-1}function jn(e){return""+(e+1)}function c9(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function u9(e){return e.replace(/\$(\d+)$/,"$1")}function Ly(e){for(var t=h9(e),r=0,a=0;a!==t.length;++a)r=26*r+t.charCodeAt(a)-64;return r-1}function nn(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function f9(e){return e.replace(/^([A-Z])/,"$$$1")}function h9(e){return e.replace(/^\$([A-Z])/,"$1")}function d9(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function sn(e){for(var t=0,r=0,a=0;a<e.length;++a){var n=e.charCodeAt(a);n>=48&&n<=57?t=10*t+(n-48):n>=65&&n<=90&&(r=26*r+(n-64))}return{c:r-1,r:t-1}}function vr(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Ci(e){var t=e.indexOf(":");return t==-1?{s:sn(e),e:sn(e)}:{s:sn(e.slice(0,t)),e:sn(e.slice(t+1))}}function jr(e,t){return typeof t>"u"||typeof t=="number"?jr(e.s,e.e):(typeof e!="string"&&(e=vr(e)),typeof t!="string"&&(t=vr(t)),e==t?e:e+":"+t)}function aa(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,a=0,n=0,s=e.length;for(r=0;a<s&&!((n=e.charCodeAt(a)-64)<1||n>26);++a)r=26*r+n;for(t.s.c=--r,r=0;a<s&&!((n=e.charCodeAt(a)-48)<0||n>9);++a)r=10*r+n;if(t.s.r=--r,a===s||n!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++a,r=0;a!=s&&!((n=e.charCodeAt(a)-64)<1||n>26);++a)r=26*r+n;for(t.e.c=--r,r=0;a!=s&&!((n=e.charCodeAt(a)-48)<0||n>9);++a)r=10*r+n;return t.e.r=--r,t}function G3(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Co(e.z,r?Yn(t):t)}catch{}try{return e.w=Co((e.XF||{}).numFmtId||(r?14:0),r?Yn(t):t)}catch{return""+t}}function Hc(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?Wc[e.v]||e.v:t==null?G3(e,e.v):G3(e,t))}function Wu(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",a={};return a[r]=e,{SheetNames:[r],Sheets:a}}function s6(e,t,r){var a=r||{},n=e?Array.isArray(e):a.dense,s=e||(n?[]:{}),o=0,c=0;if(s&&a.origin!=null){if(typeof a.origin=="number")o=a.origin;else{var u=typeof a.origin=="string"?sn(a.origin):a.origin;o=u.r,c=u.c}s["!ref"]||(s["!ref"]="A1:A1")}var h={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var p=aa(s["!ref"]);h.s.c=p.s.c,h.s.r=p.s.r,h.e.c=Math.max(h.e.c,p.e.c),h.e.r=Math.max(h.e.r,p.e.r),o==-1&&(h.e.r=o=p.e.r+1)}for(var x=0;x!=t.length;++x)if(t[x]){if(!Array.isArray(t[x]))throw new Error("aoa_to_sheet expects an array of arrays");for(var v=0;v!=t[x].length;++v)if(!(typeof t[x][v]>"u")){var g={v:t[x][v]},w=o+x,b=c+v;if(h.s.r>w&&(h.s.r=w),h.s.c>b&&(h.s.c=b),h.e.r<w&&(h.e.r=w),h.e.c<b&&(h.e.c=b),t[x][v]&&typeof t[x][v]=="object"&&!Array.isArray(t[x][v])&&!(t[x][v]instanceof Date))g=t[x][v];else if(Array.isArray(g.v)&&(g.f=t[x][v][1],g.v=g.v[0]),g.v===null)if(g.f)g.t="n";else if(a.nullError)g.t="e",g.v=0;else if(a.sheetStubs)g.t="z";else continue;else typeof g.v=="number"?g.t="n":typeof g.v=="boolean"?g.t="b":g.v instanceof Date?(g.z=a.dateNF||xr[14],a.cellDates?(g.t="d",g.w=Co(g.z,Yn(g.v))):(g.t="n",g.v=Yn(g.v),g.w=Co(g.z,g.v))):g.t="s";if(n)s[w]||(s[w]=[]),s[w][b]&&s[w][b].z&&(g.z=s[w][b].z),s[w][b]=g;else{var N=vr({c:b,r:w});s[N]&&s[N].z&&(g.z=s[N].z),s[N]=g}}}return h.s.c<1e7&&(s["!ref"]=jr(h)),s}function Sh(e,t){return s6(null,e,t)}function p9(e){return e.read_shift(4,"i")}function cl(e,t){return t||(t=ht(4)),t.write_shift(4,e),t}function Ks(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function us(e,t){var r=!1;return t==null&&(r=!0,t=ht(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function m9(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function x9(e,t){return t||(t=ht(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Oy(e,t){var r=e.l,a=e.read_shift(1),n=Ks(e),s=[],o={t:n,h:n};if((a&1)!==0){for(var c=e.read_shift(4),u=0;u!=c;++u)s.push(m9(e));o.r=s}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}function g9(e,t){var r=!1;return t==null&&(r=!0,t=ht(15+4*e.t.length)),t.write_shift(1,0),us(e.t,t),r?t.slice(0,t.l):t}var v9=Oy;function y9(e,t){var r=!1;return t==null&&(r=!0,t=ht(23+4*e.t.length)),t.write_shift(1,1),us(e.t,t),t.write_shift(4,1),x9({},t),r?t.slice(0,t.l):t}function Do(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function r0(e,t){return t==null&&(t=ht(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function a0(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function n0(e,t){return t==null&&(t=ht(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var w9=Ks,i6=us;function Ry(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function T1(e,t){var r=!1;return t==null&&(r=!0,t=ht(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var b9=Ks,cv=Ry,My=T1;function Iy(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,a=t[0]&2;e.l+=4;var n=a===0?_1([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):jf(t,0)>>2;return r?n/100:n}function o6(e,t){t==null&&(t=ht(4));var r=0,a=0,n=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?a=1:n==(n|0)&&n>=-536870912&&n<1<<29&&(a=1,r=1),a)t.write_shift(-4,((r?n:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function l6(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function S9(e,t){return t||(t=ht(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var s0=l6,Nh=S9;function Ys(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function $f(e,t){return(t||ht(8)).write_shift(8,e,"f")}function N9(e){var t={},r=e.read_shift(1),a=r>>>1,n=e.read_shift(1),s=e.read_shift(2,"i"),o=e.read_shift(1),c=e.read_shift(1),u=e.read_shift(1);switch(e.l++,a){case 0:t.auto=1;break;case 1:t.index=n;var h=Mf[n];h&&(t.rgb=op(h));break;case 2:t.rgb=op([o,c,u]);break;case 3:t.theme=n;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function k1(e,t){if(t||(t=ht(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var a=e.rgb||"FFFFFF";typeof a=="number"&&(a=("000000"+a.toString(16)).slice(-6)),t.write_shift(1,parseInt(a.slice(0,2),16)),t.write_shift(1,parseInt(a.slice(2,4),16)),t.write_shift(1,parseInt(a.slice(4,6),16)),t.write_shift(1,255)}return t}function A9(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function _9(e,t){t||(t=ht(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function c6(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},a=e.read_shift(4);switch(a){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(a>400)throw new Error("Unsupported Clipboard: "+a.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function T9(e){return c6(e,1)}function k9(e){return c6(e,2)}var By=2,Ei=3,Lm=11,W3=12,E1=19,Om=64,E9=65,j9=71,C9=4108,D9=4126,os=80,u6=81,F9=[os,u6],uv={1:{n:"CodePage",t:By},2:{n:"Category",t:os},3:{n:"PresentationFormat",t:os},4:{n:"ByteCount",t:Ei},5:{n:"LineCount",t:Ei},6:{n:"ParagraphCount",t:Ei},7:{n:"SlideCount",t:Ei},8:{n:"NoteCount",t:Ei},9:{n:"HiddenCount",t:Ei},10:{n:"MultimediaClipCount",t:Ei},11:{n:"ScaleCrop",t:Lm},12:{n:"HeadingPairs",t:C9},13:{n:"TitlesOfParts",t:D9},14:{n:"Manager",t:os},15:{n:"Company",t:os},16:{n:"LinksUpToDate",t:Lm},17:{n:"CharacterCount",t:Ei},19:{n:"SharedDoc",t:Lm},22:{n:"HyperlinksChanged",t:Lm},23:{n:"AppVersion",t:Ei,p:"version"},24:{n:"DigSig",t:E9},26:{n:"ContentType",t:os},27:{n:"ContentStatus",t:os},28:{n:"Language",t:os},29:{n:"Version",t:os},255:{},2147483648:{n:"Locale",t:E1},2147483651:{n:"Behavior",t:E1},1919054434:{}},fv={1:{n:"CodePage",t:By},2:{n:"Title",t:os},3:{n:"Subject",t:os},4:{n:"Author",t:os},5:{n:"Keywords",t:os},6:{n:"Comments",t:os},7:{n:"Template",t:os},8:{n:"LastAuthor",t:os},9:{n:"RevNumber",t:os},10:{n:"EditTime",t:Om},11:{n:"LastPrinted",t:Om},12:{n:"CreatedDate",t:Om},13:{n:"ModifiedDate",t:Om},14:{n:"PageCount",t:Ei},15:{n:"WordCount",t:Ei},16:{n:"CharCount",t:Ei},17:{n:"Thumbnail",t:j9},18:{n:"Application",t:os},19:{n:"DocSecurity",t:Ei},255:{},2147483648:{n:"Locale",t:E1},2147483651:{n:"Behavior",t:E1},1919054434:{}},$3={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},P9=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function L9(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var O9=L9([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Mf=Va(O9),Wc={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},f6={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},hv={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Rm={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Uy(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function R9(e){var t=Uy();if(!e||!e.match)return t;var r={};if((e.match(Qs)||[]).forEach(function(a){var n=wr(a);switch(n[0].replace(WR,"<")){case"<?xml":break;case"<Types":t.xmlns=n["xmlns"+(n[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[n.Extension]=n.ContentType;break;case"<Override":t[hv[n.ContentType]]!==void 0&&t[hv[n.ContentType]].push(n.PartName);break}}),t.xmlns!==Xn.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function h6(e,t){var r=RR(hv),a=[],n;a[a.length]=Cn,a[a.length]=Mt("Types",null,{xmlns:Xn.CT,"xmlns:xsd":Xn.xsd,"xmlns:xsi":Xn.xsi}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(u){return Mt("Default",null,{Extension:u[0],ContentType:u[1]})}));var s=function(u){e[u]&&e[u].length>0&&(n=e[u][0],a[a.length]=Mt("Override",null,{PartName:(n[0]=="/"?"":"/")+n,ContentType:Rm[u][t.bookType]||Rm[u].xlsx}))},o=function(u){(e[u]||[]).forEach(function(h){a[a.length]=Mt("Override",null,{PartName:(h[0]=="/"?"":"/")+h,ContentType:Rm[u][t.bookType]||Rm[u].xlsx})})},c=function(u){(e[u]||[]).forEach(function(h){a[a.length]=Mt("Override",null,{PartName:(h[0]=="/"?"":"/")+h,ContentType:r[u][0]})})};return s("workbooks"),o("sheets"),o("charts"),c("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(c),c("vba"),c("comments"),c("threadedcomments"),c("drawings"),o("metadata"),c("people"),a.length>2&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var Hr={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function ip(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Ld(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var a={};return(e.match(Qs)||[]).forEach(function(n){var s=wr(n);if(s[0]==="<Relationship"){var o={};o.Type=s.Type,o.Target=s.Target,o.Id=s.Id,s.TargetMode&&(o.TargetMode=s.TargetMode);var c=s.TargetMode==="External"?s.Target:Nd(s.Target,t);r[c]=o,a[s.Id]=o}}),r["!id"]=a,r}function sh(e){var t=[Cn,Mt("Relationships",null,{xmlns:Xn.RELS})];return xn(e["!id"]).forEach(function(r){t[t.length]=Mt("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function ga(e,t,r,a,n,s){if(n||(n={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,n.Id="rId"+t,n.Type=a,n.Target=r,[Hr.HLINK,Hr.XPATH,Hr.XMISS].indexOf(n.Type)>-1&&(n.TargetMode="External"),e["!id"][n.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][n.Id]=n,e[("/"+n.Target).replace("//","/")]=n,t}var M9="application/vnd.oasis.opendocument.spreadsheet";function I9(e,t){for(var r=Cy(e),a,n;a=sp.exec(r);)switch(a[3]){case"manifest":break;case"file-entry":if(n=wr(a[0],!1),n.path=="/"&&n.type!==M9)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw a}}function B9(e){var t=[Cn];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function X3(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function U9(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function z9(e){var t=[Cn];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(X3(e[r][0],e[r][1])),t.push(U9("",e[r][0]));return t.push(X3("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function d6(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+w1.version+"</meta:generator></office:meta></office:document-meta>"}var jo=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],H9=function(){for(var e=new Array(jo.length),t=0;t<jo.length;++t){var r=jo[t],a="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+a+"[^>]*>([\\s\\S]*?)</"+a+">")}return e}();function p6(e){var t={};e=Na(e);for(var r=0;r<jo.length;++r){var a=jo[r],n=e.match(H9[r]);n!=null&&n.length>0&&(t[a[1]]=ra(n[1])),a[2]==="date"&&t[a[1]]&&(t[a[1]]=Ha(t[a[1]]))}return t}function o2(e,t,r,a,n){n[e]!=null||t==null||t===""||(n[e]=t,t=ya(t),a[a.length]=r?Mt(e,t,r):Ns(e,t))}function m6(e,t){var r=t||{},a=[Cn,Mt("cp:coreProperties",null,{"xmlns:cp":Xn.CORE_PROPS,"xmlns:dc":Xn.dc,"xmlns:dcterms":Xn.dcterms,"xmlns:dcmitype":Xn.dcmitype,"xmlns:xsi":Xn.xsi})],n={};if(!e&&!r.Props)return a.join("");e&&(e.CreatedDate!=null&&o2("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:lv(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,n),e.ModifiedDate!=null&&o2("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:lv(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},a,n));for(var s=0;s!=jo.length;++s){var o=jo[s],c=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:e?e[o[1]]:null;c===!0?c="1":c===!1?c="0":typeof c=="number"&&(c=String(c)),c!=null&&o2(o[0],c,null,a,n)}return a.length>2&&(a[a.length]="</cp:coreProperties>",a[1]=a[1].replace("/>",">")),a.join("")}var If=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],x6=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function g6(e,t,r,a){var n=[];if(typeof e=="string")n=I3(e,a);else for(var s=0;s<e.length;++s)n=n.concat(e[s].map(function(p){return{v:p}}));var o=typeof t=="string"?I3(t,a).map(function(p){return p.v}):t,c=0,u=0;if(o.length>0)for(var h=0;h!==n.length;h+=2){switch(u=+n[h+1].v,n[h].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":r.Worksheets=u,r.SheetNames=o.slice(c,c+u);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":r.NamedRanges=u,r.DefinedNames=o.slice(c,c+u);break;case"Charts":case"Diagramme":r.Chartsheets=u,r.ChartNames=o.slice(c,c+u);break}c+=u}}function V9(e,t,r){var a={};return t||(t={}),e=Na(e),If.forEach(function(n){var s=(e.match(ap(n[0]))||[])[1];switch(n[2]){case"string":s&&(t[n[1]]=ra(s));break;case"bool":t[n[1]]=s==="true";break;case"raw":var o=e.match(new RegExp("<"+n[0]+"[^>]*>([\\s\\S]*?)</"+n[0]+">"));o&&o.length>0&&(a[n[1]]=o[1]);break}}),a.HeadingPairs&&a.TitlesOfParts&&g6(a.HeadingPairs,a.TitlesOfParts,t,r),t}function v6(e){var t=[],r=Mt;return e||(e={}),e.Application="SheetJS",t[t.length]=Cn,t[t.length]=Mt("Properties",null,{xmlns:Xn.EXT_PROPS,"xmlns:vt":Xn.vt}),If.forEach(function(a){if(e[a[1]]!==void 0){var n;switch(a[2]){case"string":n=ya(String(e[a[1]]));break;case"bool":n=e[a[1]]?"true":"false";break}n!==void 0&&(t[t.length]=r(a[0],n))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(a){return"<vt:lpstr>"+ya(a)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var q9=/<[^>]+>[^<]*/g;function G9(e,t){var r={},a="",n=e.match(q9);if(n)for(var s=0;s!=n.length;++s){var o=n[s],c=wr(o);switch(c[0]){case"<?xml":break;case"<Properties":break;case"<property":a=ra(c.name);break;case"</property>":a=null;break;default:if(o.indexOf("<vt:")===0){var u=o.split(">"),h=u[0].slice(4),p=u[1];switch(h){case"lpstr":case"bstr":case"lpwstr":r[a]=ra(p);break;case"bool":r[a]=Ua(p);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[a]=parseInt(p,10);break;case"r4":case"r8":case"decimal":r[a]=parseFloat(p);break;case"filetime":case"date":r[a]=Ha(p);break;case"cy":case"error":r[a]=ra(p);break;default:if(h.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",o,h,u)}}else if(o.slice(0,2)!=="</"){if(t.WTF)throw new Error(o)}}}return r}function y6(e){var t=[Cn,Mt("Properties",null,{xmlns:Xn.CUST_PROPS,"xmlns:vt":Xn.vt})];if(!e)return t.join("");var r=1;return xn(e).forEach(function(n){++r,t[t.length]=Mt("property",e9(e[n]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:ya(n)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var dv={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},l2;function W9(e,t,r){l2||(l2=Z1(dv)),t=l2[t]||t,e[t]=r}function $9(e,t){var r=[];return xn(dv).map(function(a){for(var n=0;n<jo.length;++n)if(jo[n][1]==a)return jo[n];for(n=0;n<If.length;++n)if(If[n][1]==a)return If[n];throw a}).forEach(function(a){if(e[a[1]]!=null){var n=t&&t.Props&&t.Props[a[1]]!=null?t.Props[a[1]]:e[a[1]];switch(a[2]){case"date":n=new Date(n).toISOString().replace(/\.\d*Z/,"Z");break}typeof n=="number"?n=String(n):n===!0||n===!1?n=n?"1":"0":n instanceof Date&&(n=new Date(n).toISOString().replace(/\.\d*Z/,"")),r.push(Ns(dv[a[1]]||a[1],n))}}),Mt("DocumentProperties",r.join(""),{xmlns:Yi.o})}function X9(e,t){var r=["Worksheets","SheetNames"],a="CustomDocumentProperties",n=[];return e&&xn(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)){for(var o=0;o<jo.length;++o)if(s==jo[o][1])return;for(o=0;o<If.length;++o)if(s==If[o][1])return;for(o=0;o<r.length;++o)if(s==r[o])return;var c=e[s],u="string";typeof c=="number"?(u="float",c=String(c)):c===!0||c===!1?(u="boolean",c=c?"1":"0"):c=String(c),n.push(Mt(L3(s),c,{"dt:dt":u}))}}),t&&xn(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)&&!(e&&Object.prototype.hasOwnProperty.call(e,s))){var o=t[s],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o instanceof Date?(c="dateTime.tz",o=o.toISOString()):o=String(o),n.push(Mt(L3(s),o,{"dt:dt":c}))}}),"<"+a+' xmlns="'+Yi.o+'">'+n.join("")+"</"+a+">"}function zy(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function Y9(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,a=r%Math.pow(2,32),n=(r-a)/Math.pow(2,32);a*=1e7,n*=1e7;var s=a/Math.pow(2,32)|0;s>0&&(a=a%Math.pow(2,32),n+=s);var o=ht(8);return o.write_shift(4,a),o.write_shift(4,n),o}function w6(e,t,r){var a=e.l,n=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-a&3;)++e.l;return n}function b6(e,t,r){var a=e.read_shift(0,"lpwstr");return a}function S6(e,t,r){return t===31?b6(e):w6(e,t,r)}function pv(e,t,r){return S6(e,t,r===!1?0:4)}function J9(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return S6(e,t,0)}function K9(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a){var n=e.l;r[a]=e.read_shift(0,"lpwstr").replace(mi,""),e.l-n&2&&(e.l+=2)}return r}function Z9(e){for(var t=e.read_shift(4),r=[],a=0;a!=t;++a)r[a]=e.read_shift(0,"lpstr-cp").replace(mi,"");return r}function Q9(e){var t=e.l,r=j1(e,u6);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var a=j1(e,Ei);return[r,a]}function eM(e){for(var t=e.read_shift(4),r=[],a=0;a<t/2;++a)r.push(Q9(e));return r}function Y3(e,t){for(var r=e.read_shift(4),a={},n=0;n!=r;++n){var s=e.read_shift(4),o=e.read_shift(4);a[s]=e.read_shift(o,t===1200?"utf16le":"utf8").replace(mi,"").replace(Sd,"!"),t===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),a}function N6(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function tM(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function j1(e,t,r){var a=e.read_shift(2),n,s=r||{};if(e.l+=2,t!==W3&&a!==t&&F9.indexOf(t)===-1&&!((t&65534)==4126&&(a&65534)==4126))throw new Error("Expected type "+t+" saw "+a);switch(t===W3?a:t){case 2:return n=e.read_shift(2,"i"),s.raw||(e.l+=2),n;case 3:return n=e.read_shift(4,"i"),n;case 11:return e.read_shift(4)!==0;case 19:return n=e.read_shift(4),n;case 30:return w6(e,a,4).replace(mi,"");case 31:return b6(e);case 64:return zy(e);case 65:return N6(e);case 71:return tM(e);case 80:return pv(e,a,!s.raw).replace(mi,"");case 81:return J9(e,a).replace(mi,"");case 4108:return eM(e);case 4126:case 4127:return a==4127?K9(e):Z9(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+a)}}function J3(e,t){var r=ht(4),a=ht(4);switch(r.write_shift(4,e==80?31:e),e){case 3:a.write_shift(-4,t);break;case 5:a=ht(8),a.write_shift(8,t,"f");break;case 11:a.write_shift(4,t?1:0);break;case 64:a=Y9(t);break;case 31:case 80:for(a=ht(4+2*(t.length+1)+(t.length%2?0:2)),a.write_shift(4,t.length+1),a.write_shift(0,t,"dbcs");a.l!=a.length;)a.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return cs([r,a])}function K3(e,t){var r=e.l,a=e.read_shift(4),n=e.read_shift(4),s=[],o=0,c=0,u=-1,h={};for(o=0;o!=n;++o){var p=e.read_shift(4),x=e.read_shift(4);s[o]=[p,x+r]}s.sort(function(E,j){return E[1]-j[1]});var v={};for(o=0;o!=n;++o){if(e.l!==s[o][1]){var g=!0;if(o>0&&t)switch(t[s[o-1][0]].t){case 2:e.l+2===s[o][1]&&(e.l+=2,g=!1);break;case 80:e.l<=s[o][1]&&(e.l=s[o][1],g=!1);break;case 4108:e.l<=s[o][1]&&(e.l=s[o][1],g=!1);break}if((!t||o==0)&&e.l<=s[o][1]&&(g=!1,e.l=s[o][1]),g)throw new Error("Read Error: Expected address "+s[o][1]+" at "+e.l+" :"+o)}if(t){var w=t[s[o][0]];if(v[w.n]=j1(e,w.t,{raw:!0}),w.p==="version"&&(v[w.n]=String(v[w.n]>>16)+"."+("0000"+String(v[w.n]&65535)).slice(-4)),w.n=="CodePage")switch(v[w.n]){case 0:v[w.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:il(c=v[w.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+v[w.n])}}else if(s[o][0]===1){if(c=v.CodePage=j1(e,By),il(c),u!==-1){var b=e.l;e.l=s[u][1],h=Y3(e,c),e.l=b}}else if(s[o][0]===0){if(c===0){u=o,e.l=s[o+1][1];continue}h=Y3(e,c)}else{var N=h[s[o][0]],_;switch(e[e.l]){case 65:e.l+=4,_=N6(e);break;case 30:e.l+=4,_=pv(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,_=pv(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,_=e.read_shift(4,"i");break;case 19:e.l+=4,_=e.read_shift(4);break;case 5:e.l+=4,_=e.read_shift(8,"f");break;case 11:e.l+=4,_=An(e,4);break;case 64:e.l+=4,_=Ha(zy(e));break;default:throw new Error("unparsed value: "+e[e.l])}v[N]=_}}return e.l=r+a,v}var A6=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function rM(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function Z3(e,t,r){var a=ht(8),n=[],s=[],o=8,c=0,u=ht(8),h=ht(8);if(u.write_shift(4,2),u.write_shift(4,1200),h.write_shift(4,1),s.push(u),n.push(h),o+=8+u.length,!t){h=ht(8),h.write_shift(4,0),n.unshift(h);var p=[ht(4)];for(p[0].write_shift(4,e.length),c=0;c<e.length;++c){var x=e[c][0];for(u=ht(8+2*(x.length+1)+(x.length%2?0:2)),u.write_shift(4,c+2),u.write_shift(4,x.length+1),u.write_shift(0,x,"dbcs");u.l!=u.length;)u.write_shift(1,0);p.push(u)}u=cs(p),s.unshift(u),o+=8+u.length}for(c=0;c<e.length;++c)if(!(t&&!t[e[c][0]])&&!(A6.indexOf(e[c][0])>-1||x6.indexOf(e[c][0])>-1)&&e[c][1]!=null){var v=e[c][1],g=0;if(t){g=+t[e[c][0]];var w=r[g];if(w.p=="version"&&typeof v=="string"){var b=v.split(".");v=(+b[0]<<16)+(+b[1]||0)}u=J3(w.t,v)}else{var N=rM(v);N==-1&&(N=31,v=String(v)),u=J3(N,v)}s.push(u),h=ht(8),h.write_shift(4,t?g:2+c),n.push(h),o+=8+u.length}var _=8*(s.length+1);for(c=0;c<s.length;++c)n[c].write_shift(4,_),_+=s[c].length;return a.write_shift(4,o),a.write_shift(4,s.length),cs([a].concat(n).concat(s))}function Q3(e,t,r){var a=e.content;if(!a)return{};Ss(a,0);var n,s,o,c,u=0;a.chk("feff","Byte Order: "),a.read_shift(2);var h=a.read_shift(4),p=a.read_shift(16);if(p!==cr.utils.consts.HEADER_CLSID&&p!==r)throw new Error("Bad PropertySet CLSID "+p);if(n=a.read_shift(4),n!==1&&n!==2)throw new Error("Unrecognized #Sets: "+n);if(s=a.read_shift(16),c=a.read_shift(4),n===1&&c!==a.l)throw new Error("Length mismatch: "+c+" !== "+a.l);n===2&&(o=a.read_shift(16),u=a.read_shift(4));var x=K3(a,t),v={SystemIdentifier:h};for(var g in x)v[g]=x[g];if(v.FMTID=s,n===1)return v;if(u-a.l==2&&(a.l+=2),a.l!==u)throw new Error("Length mismatch 2: "+a.l+" !== "+u);var w;try{w=K3(a,null)}catch{}for(g in w)v[g]=w[g];return v.FMTID=[s,o],v}function eS(e,t,r,a,n,s){var o=ht(n?68:48),c=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,cr.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,n?2:1),o.write_shift(16,t,"hex"),o.write_shift(4,n?68:48);var u=Z3(e,r,a);if(c.push(u),n){var h=Z3(n,null,null);o.write_shift(16,s,"hex"),o.write_shift(4,68+u.length),c.push(h)}return cs(c)}function Eu(e,t){return e.read_shift(t),null}function aM(e,t){t||(t=ht(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function nM(e,t,r){for(var a=[],n=e.l+t;e.l<n;)a.push(r(e,n-e.l));if(n!==e.l)throw new Error("Slurp error");return a}function An(e,t){return e.read_shift(t)===1}function di(e,t){return t||(t=ht(2)),t.write_shift(2,+!!e),t}function Bn(e){return e.read_shift(2,"u")}function To(e,t){return t||(t=ht(2)),t.write_shift(2,e),t}function _6(e,t){return nM(e,t,Bn)}function sM(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function T6(e,t,r){return r||(r=ht(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function Sp(e,t,r){var a=e.read_shift(r&&r.biff>=12?2:1),n="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=e.read_shift(1);s&&(n="dbcs-cont")}else r.biff==12&&(n="wstr");r.biff>=2&&r.biff<=5&&(n="cpstr");var o=a?e.read_shift(a,n):"";return o}function iM(e){var t=e.read_shift(2),r=e.read_shift(1),a=r&4,n=r&8,s=1+(r&1),o=0,c,u={};n&&(o=e.read_shift(2)),a&&(c=e.read_shift(4));var h=s==2?"dbcs-cont":"sbcs-cont",p=t===0?"":e.read_shift(t,h);return n&&(e.l+=4*o),a&&(e.l+=c),u.t=p,n||(u.raw="<t>"+u.t+"</t>",u.r=u.t),u}function oM(e){var t=e.t||"",r=ht(3);r.write_shift(2,t.length),r.write_shift(1,1);var a=ht(2*t.length);a.write_shift(2*t.length,t,"utf16le");var n=[r,a];return cs(n)}function Xf(e,t,r){var a;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var n=e.read_shift(1);return n===0?a=e.read_shift(t,"sbcs-cont"):a=e.read_shift(t,"dbcs-cont"),a}function Np(e,t,r){var a=e.read_shift(r&&r.biff==2?1:2);return a===0?(e.l++,""):Xf(e,a,r)}function i0(e,t,r){if(r.biff>5)return Np(e,t,r);var a=e.read_shift(1);return a===0?(e.l++,""):e.read_shift(a,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function k6(e,t,r){return r||(r=ht(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function lM(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function cM(e){var t=e.read_shift(4),r=e.l,a=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(a=!0),e.l=r);var n=e.read_shift((a?t-24:t)>>1,"utf16le").replace(mi,"");return a&&(e.l+=24),n}function uM(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var a=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var n=e.read_shift(4);if(n===0)return r+a.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(s>>1,"utf16le").replace(mi,"");return r+o}function fM(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return cM(e);case"0303000000000000c000000000000046":return uM(e);default:throw new Error("Unsupported Moniker "+r)}}function Mm(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(mi,""):"";return r}function tS(e,t){t||(t=ht(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function hM(e,t){var r=e.l+t,a=e.read_shift(4);if(a!==2)throw new Error("Unrecognized streamVersion: "+a);var n=e.read_shift(2);e.l+=2;var s,o,c,u,h="",p,x;n&16&&(s=Mm(e,r-e.l)),n&128&&(o=Mm(e,r-e.l)),(n&257)===257&&(c=Mm(e,r-e.l)),(n&257)===1&&(u=fM(e,r-e.l)),n&8&&(h=Mm(e,r-e.l)),n&32&&(p=e.read_shift(16)),n&64&&(x=zy(e)),e.l=r;var v=o||c||u||"";v&&h&&(v+="#"+h),v||(v="#"+h),n&2&&v.charAt(0)=="/"&&v.charAt(1)!="/"&&(v="file://"+v);var g={Target:v};return p&&(g.guid=p),x&&(g.time=x),s&&(g.Tooltip=s),g}function dM(e){var t=ht(512),r=0,a=e.Target;a.slice(0,7)=="file://"&&(a=a.slice(7));var n=a.indexOf("#"),s=n>-1?31:23;switch(a.charAt(0)){case"#":s=28;break;case".":s&=-3;break}t.write_shift(4,2),t.write_shift(4,s);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)t.write_shift(4,o[r]);if(s==28)a=a.slice(1),tS(a,t);else if(s&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));var c=n>-1?a.slice(0,n):a;for(t.write_shift(4,2*(c.length+1)),r=0;r<c.length;++r)t.write_shift(2,c.charCodeAt(r));t.write_shift(2,0),s&8&&tS(n>-1?a.slice(n+1):"",t)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));for(var u=0;a.slice(u*3,u*3+3)=="../"||a.slice(u*3,u*3+3)=="..\\";)++u;for(t.write_shift(2,u),t.write_shift(4,a.length-3*u+1),r=0;r<a.length-3*u;++r)t.write_shift(1,a.charCodeAt(r+3*u)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function E6(e){var t=e.read_shift(1),r=e.read_shift(1),a=e.read_shift(1),n=e.read_shift(1);return[t,r,a,n]}function j6(e,t){var r=E6(e);return r[3]=0,r}function ec(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return{r:t,c:r,ixfe:a}}function Yf(e,t,r,a){return a||(a=ht(6)),a.write_shift(2,e),a.write_shift(2,t),a.write_shift(2,r||0),a}function pM(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function mM(e,t,r){return t===0?"":i0(e,t,r)}function xM(e,t,r){var a=r.biff>8?4:2,n=e.read_shift(a),s=e.read_shift(a,"i"),o=e.read_shift(a,"i");return[n,s,o]}function C6(e){var t=e.read_shift(2),r=Iy(e);return[t,r]}function gM(e,t,r){e.l+=4,t-=4;var a=e.l+t,n=Sp(e,t,r),s=e.read_shift(2);if(a-=e.l,s!==a)throw new Error("Malformed AddinUdf: padding = "+a+" != "+s);return e.l+=s,n}function tx(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),n=e.read_shift(2);return{s:{c:a,r:t},e:{c:n,r}}}function D6(e,t){return t||(t=ht(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function F6(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(1),n=e.read_shift(1);return{s:{c:a,r:t},e:{c:n,r}}}var vM=F6;function P6(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2);return e.l+=12,[r,t,a]}function yM(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function wM(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function Vs(e){e.l+=2,e.l+=e.read_shift(2)}var bM={0:Vs,4:Vs,5:Vs,6:Vs,7:wM,8:Vs,9:Vs,10:Vs,11:Vs,12:Vs,13:yM,14:Vs,15:Vs,16:Vs,17:Vs,18:Vs,19:Vs,20:Vs,21:P6};function SM(e,t){for(var r=e.l+t,a=[];e.l<r;){var n=e.read_shift(2);e.l-=2;try{a.push(bM[n](e,r-e.l))}catch{return e.l=r,a}}return e.l!=r&&(e.l=r),a}function Im(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function Hy(e,t,r){var a=1536,n=16;switch(r.bookType){case"biff8":break;case"biff5":a=1280,n=8;break;case"biff4":a=4,n=6;break;case"biff3":a=3,n=6;break;case"biff2":a=2,n=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=ht(n);return s.write_shift(2,a),s.write_shift(2,t),n>4&&s.write_shift(2,29282),n>6&&s.write_shift(2,1997),n>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function NM(e,t){return t===0||e.read_shift(2),1200}function AM(e,t,r){if(r.enc)return e.l+=t,"";var a=e.l,n=i0(e,0,r);return e.read_shift(t+a-e.l),n}function _M(e,t){var r=!t||t.biff==8,a=ht(r?112:54);for(a.write_shift(t.biff==8?2:1,7),r&&a.write_shift(1,0),a.write_shift(4,859007059),a.write_shift(4,5458548|(r?0:536870912));a.l<a.length;)a.write_shift(1,r?0:32);return a}function TM(e,t,r){var a=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:a&16,fBelow:a&64,fRight:a&128}}function kM(e,t,r){var a=e.read_shift(4),n=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var o=Sp(e,0,r);return o.length===0&&(o="Sheet1"),{pos:a,hs:n,dt:s,name:o}}function EM(e,t){var r=!t||t.biff>=8?2:1,a=ht(8+r*e.name.length);a.write_shift(4,e.pos),a.write_shift(1,e.hs||0),a.write_shift(1,e.dt),a.write_shift(1,e.name.length),t.biff>=8&&a.write_shift(1,1),a.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var n=a.slice(0,a.l);return n.l=a.l,n}function jM(e,t){for(var r=e.l+t,a=e.read_shift(4),n=e.read_shift(4),s=[],o=0;o!=n&&e.l<r;++o)s.push(iM(e));return s.Count=a,s.Unique=n,s}function CM(e,t){var r=ht(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var a=[],n=0;n<e.length;++n)a[n]=oM(e[n]);var s=cs([r].concat(a));return s.parts=[r.length].concat(a.map(function(o){return o.length})),s}function DM(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function FM(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var a=e.read_shift(1);return e.l+=3,a&7&&(t.level=a&7),a&32&&(t.hidden=!0),a&64&&(t.hpt=r/20),t}function PM(e){var t=pM(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function LM(e){return e.read_shift(2),e.read_shift(4)}function rS(e,t,r){var a=0;r&&r.biff==2||(a=e.read_shift(2));var n=e.read_shift(2);r&&r.biff==2&&(a=1-(n>>15),n&=32767);var s={Unsynced:a&1,DyZero:(a&2)>>1,ExAsc:(a&4)>>2,ExDsc:(a&8)>>3};return[s,n]}function OM(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),c=e.read_shift(2),u=e.read_shift(2),h=e.read_shift(2);return{Pos:[t,r],Dim:[a,n],Flags:s,CurTab:o,FirstTab:c,Selected:u,TabRatio:h}}function RM(){var e=ht(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function MM(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var a=e.read_shift(2);return{RTL:a&64}}function IM(e){var t=ht(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function BM(){}function UM(e,t,r){var a={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return a.name=Sp(e,0,r),a}function zM(e,t){var r=e.name||"Arial",a=t&&t.biff==5,n=a?15+r.length:16+2*r.length,s=ht(n);return s.write_shift(2,e.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),a||s.write_shift(1,1),s.write_shift((a?1:2)*r.length,r,a?"sbcs":"utf16le"),s}function HM(e){var t=ec(e);return t.isst=e.read_shift(4),t}function VM(e,t,r,a){var n=ht(10);return Yf(e,t,a,n),n.write_shift(4,r),n}function qM(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=e.l+t,n=ec(e);r.biff==2&&e.l++;var s=Np(e,a-e.l,r);return n.val=s,n}function GM(e,t,r,a,n){var s=!n||n.biff==8,o=ht(8+ +s+(1+s)*r.length);return Yf(e,t,a,o),o.write_shift(2,r.length),s&&o.write_shift(1,1),o.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),o}function WM(e,t,r){var a=e.read_shift(2),n=i0(e,0,r);return[a,n]}function $M(e,t,r,a){var n=r&&r.biff==5;a||(a=ht(n?3+t.length:5+2*t.length)),a.write_shift(2,e),a.write_shift(n?1:2,t.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*t.length,t,n?"sbcs":"utf16le");var s=a.length>a.l?a.slice(0,a.l):a;return s.l==null&&(s.l=s.length),s}var XM=i0;function aS(e,t,r){var a=e.l+t,n=r.biff==8||!r.biff?4:2,s=e.read_shift(n),o=e.read_shift(n),c=e.read_shift(2),u=e.read_shift(2);return e.l=a,{s:{r:s,c},e:{r:o,c:u}}}function YM(e,t){var r=t.biff==8||!t.biff?4:2,a=ht(2*r+6);return a.write_shift(r,e.s.r),a.write_shift(r,e.e.r+1),a.write_shift(2,e.s.c),a.write_shift(2,e.e.c+1),a.write_shift(2,0),a}function JM(e){var t=e.read_shift(2),r=e.read_shift(2),a=C6(e);return{r:t,c:r,ixfe:a[0],rknum:a[1]}}function KM(e,t){for(var r=e.l+t-2,a=e.read_shift(2),n=e.read_shift(2),s=[];e.l<r;)s.push(C6(e));if(e.l!==r)throw new Error("MulRK read error");var o=e.read_shift(2);if(s.length!=o-n+1)throw new Error("MulRK length mismatch");return{r:a,c:n,C:o,rkrec:s}}function ZM(e,t){for(var r=e.l+t-2,a=e.read_shift(2),n=e.read_shift(2),s=[];e.l<r;)s.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var o=e.read_shift(2);if(s.length!=o-n+1)throw new Error("MulBlank length mismatch");return{r:a,c:n,C:o,ixfe:s}}function QM(e,t,r,a){var n={},s=e.read_shift(4),o=e.read_shift(4),c=e.read_shift(4),u=e.read_shift(2);return n.patternType=P9[c>>26],a.cellStyles&&(n.alc=s&7,n.fWrap=s>>3&1,n.alcV=s>>4&7,n.fJustLast=s>>7&1,n.trot=s>>8&255,n.cIndent=s>>16&15,n.fShrinkToFit=s>>20&1,n.iReadOrder=s>>22&2,n.fAtrNum=s>>26&1,n.fAtrFnt=s>>27&1,n.fAtrAlc=s>>28&1,n.fAtrBdr=s>>29&1,n.fAtrPat=s>>30&1,n.fAtrProt=s>>31&1,n.dgLeft=o&15,n.dgRight=o>>4&15,n.dgTop=o>>8&15,n.dgBottom=o>>12&15,n.icvLeft=o>>16&127,n.icvRight=o>>23&127,n.grbitDiag=o>>30&3,n.icvTop=c&127,n.icvBottom=c>>7&127,n.icvDiag=c>>14&127,n.dgDiag=c>>21&15,n.icvFore=u&127,n.icvBack=u>>7&127,n.fsxButton=u>>14&1),n}function eI(e,t,r){var a={};return a.ifnt=e.read_shift(2),a.numFmtId=e.read_shift(2),a.flags=e.read_shift(2),a.fStyle=a.flags>>2&1,t-=6,a.data=QM(e,t,a.fStyle,r),a}function nS(e,t,r,a){var n=r&&r.biff==5;a||(a=ht(n?16:20)),a.write_shift(2,0),e.style?(a.write_shift(2,e.numFmtId||0),a.write_shift(2,65524)):(a.write_shift(2,e.numFmtId||0),a.write_shift(2,t<<4));var s=0;return e.numFmtId>0&&n&&(s|=1024),a.write_shift(4,s),a.write_shift(4,0),n||a.write_shift(4,0),a.write_shift(2,0),a}function tI(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function rI(e){var t=ht(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function sS(e,t,r){var a=ec(e);(r.biff==2||t==9)&&++e.l;var n=sM(e);return a.val=n,a.t=n===!0||n===!1?"b":"e",a}function aI(e,t,r,a,n,s){var o=ht(8);return Yf(e,t,a,o),T6(r,s,o),o}function nI(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var a=ec(e),n=Ys(e);return a.val=n,a}function sI(e,t,r,a){var n=ht(14);return Yf(e,t,a,n),$f(r,n),n}var iS=mM;function iI(e,t,r){var a=e.l+t,n=e.read_shift(2),s=e.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,n];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var o=Xf(e,s),c=[];a>e.l;)c.push(Np(e));return[s,n,o,c]}function oS(e,t,r){var a=e.read_shift(2),n,s={fBuiltIn:a&1,fWantAdvise:a>>>1&1,fWantPict:a>>>2&1,fOle:a>>>3&1,fOleLink:a>>>4&1,cf:a>>>5&1023,fIcon:a>>>15&1};return r.sbcch===14849&&(n=gM(e,t-2,r)),s.body=n||e.read_shift(t-2),typeof n=="string"&&(s.Name=n),s}var oI=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function lS(e,t,r){var a=e.l+t,n=e.read_shift(2),s=e.read_shift(1),o=e.read_shift(1),c=e.read_shift(r&&r.biff==2?1:2),u=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),u=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var h=Xf(e,o,r);n&32&&(h=oI[h.charCodeAt(0)]);var p=a-e.l;r&&r.biff==2&&--p;var x=a==e.l||c===0||!(p>0)?[]:SH(e,p,r,c);return{chKey:s,Name:h,itab:u,rgce:x}}function L6(e,t,r){if(r.biff<8)return lI(e,t,r);for(var a=[],n=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)a.push(xM(e,r.biff>8?12:6,r));if(e.l!=n)throw new Error("Bad ExternSheet: "+e.l+" != "+n);return a}function lI(e,t,r){e[e.l+1]==3&&e[e.l]++;var a=Sp(e,t,r);return a.charCodeAt(0)==3?a.slice(1):a}function cI(e,t,r){if(r.biff<8){e.l+=t;return}var a=e.read_shift(2),n=e.read_shift(2),s=Xf(e,a,r),o=Xf(e,n,r);return[s,o]}function uI(e,t,r){var a=F6(e);e.l++;var n=e.read_shift(1);return t-=8,[NH(e,t,r),n,a]}function cS(e,t,r){var a=vM(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[a,wH(e,t,r)]}function fI(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,a=e.read_shift(4);return[t,r,a]}function hI(e,t,r){if(!(r.biff<8)){var a=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),c=i0(e,0,r);return r.biff<8&&e.read_shift(1),[{r:a,c:n},c,o,s]}}function dI(e,t,r){return hI(e,t,r)}function pI(e,t){for(var r=[],a=e.read_shift(2);a--;)r.push(tx(e));return r}function mI(e){var t=ht(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)D6(e[r],t);return t}function xI(e,t,r){if(r&&r.biff<8)return vI(e,t,r);var a=P6(e),n=SM(e,t-22,a[1]);return{cmo:a,ft:n}}var gI={8:function(e,t){var r=e.l+t;e.l+=10;var a=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var n=e.read_shift(1);return e.l+=n,e.l=r,{fmt:a}}};function vI(e,t,r){e.l+=4;var a=e.read_shift(2),n=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var o=[];return o.push((gI[a]||Zs)(e,t,r)),{cmo:[n,a,s],ft:o}}function yI(e,t,r){var a=e.l,n="";try{e.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:o=lM(e,6,r);var c=e.read_shift(2);e.read_shift(2),Bn(e,2);var u=e.read_shift(2);e.l+=u;for(var h=1;h<e.lens.length-1;++h){if(e.l-a!=e.lens[h])throw new Error("TxO: bad continue record");var p=e[e.l],x=Xf(e,e.lens[h+1]-e.lens[h]-1);if(n+=x,n.length>=(p?c:2*c))break}if(n.length!==c&&n.length!==c*2)throw new Error("cchText: "+c+" != "+n.length);return e.l=a+t,{t:n}}catch{return e.l=a+t,{t:n}}}function wI(e,t){var r=tx(e);e.l+=16;var a=hM(e,t-24);return[r,a]}function bI(e){var t=ht(24),r=sn(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var a="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<16;++n)t.write_shift(1,parseInt(a[n],16));return cs([t,dM(e[1])])}function SI(e,t){e.read_shift(2);var r=tx(e),a=e.read_shift((t-10)/2,"dbcs-cont");return a=a.replace(mi,""),[r,a]}function NI(e){var t=e[1].Tooltip,r=ht(10+2*(t.length+1));r.write_shift(2,2048);var a=sn(e[0]);r.write_shift(2,a.r),r.write_shift(2,a.r),r.write_shift(2,a.c),r.write_shift(2,a.c);for(var n=0;n<t.length;++n)r.write_shift(2,t.charCodeAt(n));return r.write_shift(2,0),r}function AI(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=$3[r]||r,r=e.read_shift(2),t[1]=$3[r]||r,t}function _I(e){return e||(e=ht(4)),e.write_shift(2,1),e.write_shift(2,1),e}function TI(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(j6(e));return r}function kI(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(j6(e));return r}function EI(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function O6(e,t,r){if(!r.cellStyles)return Zs(e,t);var a=r&&r.biff>=12?4:2,n=e.read_shift(a),s=e.read_shift(a),o=e.read_shift(a),c=e.read_shift(a),u=e.read_shift(2);a==2&&(e.l+=2);var h={s:n,e:s,w:o,ixfe:c,flags:u};return(r.biff>=5||!r.biff)&&(h.level=u>>8&7),h}function jI(e,t){var r=ht(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var a=0;return e.hidden&&(a|=1),r.write_shift(1,a),a=e.level||0,r.write_shift(1,a),r.write_shift(2,0),r}function CI(e,t){var r={};return t<32||(e.l+=16,r.header=Ys(e),r.footer=Ys(e),e.l+=2),r}function DI(e,t,r){var a={area:!1};if(r.biff!=5)return e.l+=t,a;var n=e.read_shift(1);return e.l+=3,n&16&&(a.area=!0),a}function FI(e){for(var t=ht(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var PI=ec,LI=_6,OI=Np;function RI(e){var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),n={fmt:t,env:r,len:a,data:e.slice(e.l,e.l+a)};return e.l+=a,n}function MI(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var a=ec(e);++e.l;var n=i0(e,t-7,r);return a.t="str",a.val=n,a}function II(e){var t=ec(e);++e.l;var r=Ys(e);return t.t="n",t.val=r,t}function BI(e,t,r){var a=ht(15);return kp(a,e,t),a.write_shift(8,r,"f"),a}function UI(e){var t=ec(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function zI(e,t,r){var a=ht(9);return kp(a,e,t),a.write_shift(2,r),a}function HI(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function VI(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function qI(e,t,r){var a=e.l+t,n=ec(e),s=e.read_shift(2),o=Xf(e,s,r);return e.l=a,n.t="str",n.val=o,n}var GI=[2,3,48,49,131,139,140,245],mv=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Z1({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(c,u){var h=[],p=Uu(1);switch(u.type){case"base64":p=Ki(ro(c));break;case"binary":p=Ki(c);break;case"buffer":case"array":p=c;break}Ss(p,0);var x=p.read_shift(1),v=!!(x&136),g=!1,w=!1;switch(x){case 2:break;case 3:break;case 48:g=!0,v=!0;break;case 49:g=!0,v=!0;break;case 131:break;case 139:break;case 140:w=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+x.toString(16))}var b=0,N=521;x==2&&(b=p.read_shift(2)),p.l+=3,x!=2&&(b=p.read_shift(4)),b>1048576&&(b=1e6),x!=2&&(N=p.read_shift(2));var _=p.read_shift(2),E=u.codepage||1252;x!=2&&(p.l+=16,p.read_shift(1),p[p.l]!==0&&(E=e[p[p.l]]),p.l+=1,p.l+=2),w&&(p.l+=36);for(var j=[],M={},U=Math.min(p.length,x==2?521:N-10-(g?264:0)),V=w?32:11;p.l<U&&p[p.l]!=13;)switch(M={},M.name=ov.utils.decode(E,p.slice(p.l,p.l+V)).replace(/[\u0000\r\n].*$/g,""),p.l+=V,M.type=String.fromCharCode(p.read_shift(1)),x!=2&&!w&&(M.offset=p.read_shift(4)),M.len=p.read_shift(1),x==2&&(M.offset=p.read_shift(2)),M.dec=p.read_shift(1),M.name.length&&j.push(M),x!=2&&(p.l+=w?13:14),M.type){case"B":(!g||M.len!=8)&&u.WTF&&console.log("Skipping "+M.name+":"+M.type);break;case"G":case"P":u.WTF&&console.log("Skipping "+M.name+":"+M.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+M.type)}if(p[p.l]!==13&&(p.l=N-1),p.read_shift(1)!==13)throw new Error("DBF Terminator not found "+p.l+" "+p[p.l]);p.l=N;var I=0,z=0;for(h[0]=[],z=0;z!=j.length;++z)h[0][z]=j[z].name;for(;b-- >0;){if(p[p.l]===42){p.l+=_;continue}for(++p.l,h[++I]=[],z=0,z=0;z!=j.length;++z){var H=p.slice(p.l,p.l+j[z].len);p.l+=j[z].len,Ss(H,0);var re=ov.utils.decode(E,H);switch(j[z].type){case"C":re.trim().length&&(h[I][z]=re.replace(/\s+$/,""));break;case"D":re.length===8?h[I][z]=new Date(+re.slice(0,4),+re.slice(4,6)-1,+re.slice(6,8)):h[I][z]=re;break;case"F":h[I][z]=parseFloat(re.trim());break;case"+":case"I":h[I][z]=w?H.read_shift(-4,"i")^2147483648:H.read_shift(4,"i");break;case"L":switch(re.trim().toUpperCase()){case"Y":case"T":h[I][z]=!0;break;case"N":case"F":h[I][z]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+re+"|")}break;case"M":if(!v)throw new Error("DBF Unexpected MEMO for type "+x.toString(16));h[I][z]="##MEMO##"+(w?parseInt(re.trim(),10):H.read_shift(4));break;case"N":re=re.replace(/\u0000/g,"").trim(),re&&re!="."&&(h[I][z]=+re||0);break;case"@":h[I][z]=new Date(H.read_shift(-8,"f")-621356832e5);break;case"T":h[I][z]=new Date((H.read_shift(4)-2440588)*864e5+H.read_shift(4));break;case"Y":h[I][z]=H.read_shift(4,"i")/1e4+H.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":h[I][z]=-H.read_shift(-8,"f");break;case"B":if(g&&j[z].len==8){h[I][z]=H.read_shift(8,"f");break}case"G":case"P":H.l+=j[z].len;break;case"0":if(j[z].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+j[z].type)}}}if(x!=2&&p.l<p.length&&p[p.l++]!=26)throw new Error("DBF EOF Marker missing "+(p.l-1)+" of "+p.length+" "+p[p.l-1].toString(16));return u&&u.sheetRows&&(h=h.slice(0,u.sheetRows)),u.DBF=j,h}function a(c,u){var h=u||{};h.dateNF||(h.dateNF="yyyymmdd");var p=Sh(r(c,h),h);return p["!cols"]=h.DBF.map(function(x){return{wch:x.len,DBF:x}}),delete h.DBF,p}function n(c,u){try{return Wu(a(c,u),u)}catch(h){if(u&&u.WTF)throw h}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function o(c,u){var h=u||{};if(+h.codepage>=0&&il(+h.codepage),h.type=="string")throw new Error("Cannot write DBF to JS string");var p=ji(),x=F1(c,{header:1,raw:!0,cellDates:!0}),v=x[0],g=x.slice(1),w=c["!cols"]||[],b=0,N=0,_=0,E=1;for(b=0;b<v.length;++b){if(((w[b]||{}).DBF||{}).name){v[b]=w[b].DBF.name,++_;continue}if(v[b]!=null){if(++_,typeof v[b]=="number"&&(v[b]=v[b].toString(10)),typeof v[b]!="string")throw new Error("DBF Invalid column name "+v[b]+" |"+typeof v[b]+"|");if(v.indexOf(v[b])!==b){for(N=0;N<1024;++N)if(v.indexOf(v[b]+"_"+N)==-1){v[b]+="_"+N;break}}}}var j=aa(c["!ref"]),M=[],U=[],V=[];for(b=0;b<=j.e.c-j.s.c;++b){var I="",z="",H=0,re=[];for(N=0;N<g.length;++N)g[N][b]!=null&&re.push(g[N][b]);if(re.length==0||v[b]==null){M[b]="?";continue}for(N=0;N<re.length;++N){switch(typeof re[N]){case"number":z="B";break;case"string":z="C";break;case"boolean":z="L";break;case"object":z=re[N]instanceof Date?"D":"C";break;default:z="C"}H=Math.max(H,String(re[N]).length),I=I&&I!=z?"C":z}H>250&&(H=250),z=((w[b]||{}).DBF||{}).type,z=="C"&&w[b].DBF.len>H&&(H=w[b].DBF.len),I=="B"&&z=="N"&&(I="N",V[b]=w[b].DBF.dec,H=w[b].DBF.len),U[b]=I=="C"||z=="N"?H:s[I]||0,E+=U[b],M[b]=I}var R=p.next(32);for(R.write_shift(4,318902576),R.write_shift(4,g.length),R.write_shift(2,296+32*_),R.write_shift(2,E),b=0;b<4;++b)R.write_shift(4,0);for(R.write_shift(4,0|(+t[A_]||3)<<8),b=0,N=0;b<v.length;++b)if(v[b]!=null){var F=p.next(32),Y=(v[b].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);F.write_shift(1,Y,"sbcs"),F.write_shift(1,M[b]=="?"?"C":M[b],"sbcs"),F.write_shift(4,N),F.write_shift(1,U[b]||s[M[b]]||0),F.write_shift(1,V[b]||0),F.write_shift(1,2),F.write_shift(4,0),F.write_shift(1,0),F.write_shift(4,0),F.write_shift(4,0),N+=U[b]||s[M[b]]||0}var K=p.next(264);for(K.write_shift(4,13),b=0;b<65;++b)K.write_shift(4,0);for(b=0;b<g.length;++b){var X=p.next(E);for(X.write_shift(1,0),N=0;N<v.length;++N)if(v[N]!=null)switch(M[N]){case"L":X.write_shift(1,g[b][N]==null?63:g[b][N]?84:70);break;case"B":X.write_shift(8,g[b][N]||0,"f");break;case"N":var Z="0";for(typeof g[b][N]=="number"&&(Z=g[b][N].toFixed(V[N]||0)),_=0;_<U[N]-Z.length;++_)X.write_shift(1,32);X.write_shift(1,Z,"sbcs");break;case"D":g[b][N]?(X.write_shift(4,("0000"+g[b][N].getFullYear()).slice(-4),"sbcs"),X.write_shift(2,("00"+(g[b][N].getMonth()+1)).slice(-2),"sbcs"),X.write_shift(2,("00"+g[b][N].getDate()).slice(-2),"sbcs")):X.write_shift(8,"00000000","sbcs");break;case"C":var ce=String(g[b][N]!=null?g[b][N]:"").slice(0,U[N]);for(X.write_shift(1,ce,"sbcs"),_=0;_<U[N]-ce.length;++_)X.write_shift(1,32);break}}return p.next(1).write_shift(1,26),p.end()}return{to_workbook:n,to_sheet:a,from_sheet:o}}(),R6=function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+xn(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(v,g){var w=e[g];return typeof w=="number"?w3(w):w},a=function(v,g,w){var b=g.charCodeAt(0)-32<<4|w.charCodeAt(0)-48;return b==59?v:w3(b)};e["|"]=254;function n(v,g){switch(g.type){case"base64":return s(ro(v),g);case"binary":return s(v,g);case"buffer":return s(Rr&&Buffer.isBuffer(v)?v.toString("binary"):Gu(v),g);case"array":return s(Wf(v),g)}throw new Error("Unrecognized type "+g.type)}function s(v,g){var w=v.split(/[\n\r]+/),b=-1,N=-1,_=0,E=0,j=[],M=[],U=null,V={},I=[],z=[],H=[],re=0,R;for(+g.codepage>=0&&il(+g.codepage);_!==w.length;++_){re=0;var F=w[_].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(t,r),Y=F.replace(/;;/g,"\0").split(";").map(function(q){return q.replace(/\u0000/g,";")}),K=Y[0],X;if(F.length>0)switch(K){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":Y[1].charAt(0)=="P"&&M.push(F.slice(3).replace(/;;/g,";"));break;case"C":var Z=!1,ce=!1,te=!1,Q=!1,G=-1,ye=-1;for(E=1;E<Y.length;++E)switch(Y[E].charAt(0)){case"A":break;case"X":N=parseInt(Y[E].slice(1))-1,ce=!0;break;case"Y":for(b=parseInt(Y[E].slice(1))-1,ce||(N=0),R=j.length;R<=b;++R)j[R]=[];break;case"K":X=Y[E].slice(1),X.charAt(0)==='"'?X=X.slice(1,X.length-1):X==="TRUE"?X=!0:X==="FALSE"?X=!1:isNaN(ll(X))?isNaN(hh(X).getDate())||(X=Ha(X)):(X=ll(X),U!==null&&wh(U)&&(X=ex(X))),Z=!0;break;case"E":Q=!0;var D=ih(Y[E].slice(1),{r:b,c:N});j[b][N]=[j[b][N],D];break;case"S":te=!0,j[b][N]=[j[b][N],"S5S"];break;case"G":break;case"R":G=parseInt(Y[E].slice(1))-1;break;case"C":ye=parseInt(Y[E].slice(1))-1;break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+F)}if(Z&&(j[b][N]&&j[b][N].length==2?j[b][N][0]=X:j[b][N]=X,U=null),te){if(Q)throw new Error("SYLK shared formula cannot have own formula");var O=G>-1&&j[G][ye];if(!O||!O[1])throw new Error("SYLK shared formula cannot find base");j[b][N][1]=eT(O[1],{r:b-G,c:N-ye})}break;case"F":var L=0;for(E=1;E<Y.length;++E)switch(Y[E].charAt(0)){case"X":N=parseInt(Y[E].slice(1))-1,++L;break;case"Y":for(b=parseInt(Y[E].slice(1))-1,R=j.length;R<=b;++R)j[R]=[];break;case"M":re=parseInt(Y[E].slice(1))/20;break;case"F":break;case"G":break;case"P":U=M[parseInt(Y[E].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(H=Y[E].slice(1).split(" "),R=parseInt(H[0],10);R<=parseInt(H[1],10);++R)re=parseInt(H[2],10),z[R-1]=re===0?{hidden:!0}:{wch:re},zu(z[R-1]);break;case"C":N=parseInt(Y[E].slice(1))-1,z[N]||(z[N]={});break;case"R":b=parseInt(Y[E].slice(1))-1,I[b]||(I[b]={}),re>0?(I[b].hpt=re,I[b].hpx=ph(re)):re===0&&(I[b].hidden=!0);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+F)}L<1&&(U=null);break;default:if(g&&g.WTF)throw new Error("SYLK bad record "+F)}}return I.length>0&&(V["!rows"]=I),z.length>0&&(V["!cols"]=z),g&&g.sheetRows&&(j=j.slice(0,g.sheetRows)),[j,V]}function o(v,g){var w=n(v,g),b=w[0],N=w[1],_=Sh(b,g);return xn(N).forEach(function(E){_[E]=N[E]}),_}function c(v,g){return Wu(o(v,g),g)}function u(v,g,w,b){var N="C;Y"+(w+1)+";X"+(b+1)+";K";switch(v.t){case"n":N+=v.v||0,v.f&&!v.F&&(N+=";E"+Xy(v.f,{r:w,c:b}));break;case"b":N+=v.v?"TRUE":"FALSE";break;case"e":N+=v.w||v.v;break;case"d":N+='"'+(v.w||v.v)+'"';break;case"s":N+='"'+v.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return N}function h(v,g){g.forEach(function(w,b){var N="F;W"+(b+1)+" "+(b+1)+" ";w.hidden?N+="0":(typeof w.width=="number"&&!w.wpx&&(w.wpx=lp(w.width)),typeof w.wpx=="number"&&!w.wch&&(w.wch=cp(w.wpx)),typeof w.wch=="number"&&(N+=Math.round(w.wch))),N.charAt(N.length-1)!=" "&&v.push(N)})}function p(v,g){g.forEach(function(w,b){var N="F;";w.hidden?N+="M0;":w.hpt?N+="M"+20*w.hpt+";":w.hpx&&(N+="M"+20*up(w.hpx)+";"),N.length>2&&v.push(N+"R"+(b+1))})}function x(v,g){var w=["ID;PWXL;N;E"],b=[],N=aa(v["!ref"]),_,E=Array.isArray(v),j=`\r
`;w.push("P;PGeneral"),w.push("F;P0;DG0G8;M255"),v["!cols"]&&h(w,v["!cols"]),v["!rows"]&&p(w,v["!rows"]),w.push("B;Y"+(N.e.r-N.s.r+1)+";X"+(N.e.c-N.s.c+1)+";D"+[N.s.c,N.s.r,N.e.c,N.e.r].join(" "));for(var M=N.s.r;M<=N.e.r;++M)for(var U=N.s.c;U<=N.e.c;++U){var V=vr({r:M,c:U});_=E?(v[M]||[])[U]:v[V],!(!_||_.v==null&&(!_.f||_.F))&&b.push(u(_,v,M,U))}return w.join(j)+j+b.join(j)+j+"E"+j}return{to_workbook:c,to_sheet:o,from_sheet:x}}(),M6=function(){function e(s,o){switch(o.type){case"base64":return t(ro(s),o);case"binary":return t(s,o);case"buffer":return t(Rr&&Buffer.isBuffer(s)?s.toString("binary"):Gu(s),o);case"array":return t(Wf(s),o)}throw new Error("Unrecognized type "+o.type)}function t(s,o){for(var c=s.split(`
`),u=-1,h=-1,p=0,x=[];p!==c.length;++p){if(c[p].trim()==="BOT"){x[++u]=[],h=0;continue}if(!(u<0)){var v=c[p].trim().split(","),g=v[0],w=v[1];++p;for(var b=c[p]||"";(b.match(/["]/g)||[]).length&1&&p<c.length-1;)b+=`
`+c[++p];switch(b=b.trim(),+g){case-1:if(b==="BOT"){x[++u]=[],h=0;continue}else if(b!=="EOD")throw new Error("Unrecognized DIF special command "+b);break;case 0:b==="TRUE"?x[u][h]=!0:b==="FALSE"?x[u][h]=!1:isNaN(ll(w))?isNaN(hh(w).getDate())?x[u][h]=w:x[u][h]=Ha(w):x[u][h]=ll(w),++h;break;case 1:b=b.slice(1,b.length-1),b=b.replace(/""/g,'"'),b&&b.match(/^=".*"$/)&&(b=b.slice(2,-1)),x[u][h++]=b!==""?b:null;break}if(b==="EOD")break}}return o&&o.sheetRows&&(x=x.slice(0,o.sheetRows)),x}function r(s,o){return Sh(e(s,o),o)}function a(s,o){return Wu(r(s,o),o)}var n=function(){var s=function(u,h,p,x,v){u.push(h),u.push(p+","+x),u.push('"'+v.replace(/"/g,'""')+'"')},o=function(u,h,p,x){u.push(h+","+p),u.push(h==1?'"'+x.replace(/"/g,'""')+'"':x)};return function(u){var h=[],p=aa(u["!ref"]),x,v=Array.isArray(u);s(h,"TABLE",0,1,"sheetjs"),s(h,"VECTORS",0,p.e.r-p.s.r+1,""),s(h,"TUPLES",0,p.e.c-p.s.c+1,""),s(h,"DATA",0,0,"");for(var g=p.s.r;g<=p.e.r;++g){o(h,-1,0,"BOT");for(var w=p.s.c;w<=p.e.c;++w){var b=vr({r:g,c:w});if(x=v?(u[g]||[])[w]:u[b],!x){o(h,1,0,"");continue}switch(x.t){case"n":var N=x.w;!N&&x.v!=null&&(N=x.v),N==null?x.f&&!x.F?o(h,1,0,"="+x.f):o(h,1,0,""):o(h,0,N,"V");break;case"b":o(h,0,x.v?1:0,x.v?"TRUE":"FALSE");break;case"s":o(h,1,0,isNaN(x.v)?x.v:'="'+x.v+'"');break;case"d":x.w||(x.w=Co(x.z||xr[14],Yn(Ha(x.v)))),o(h,0,x.w,"V");break;default:o(h,1,0,"")}}}o(h,-1,0,"EOD");var _=`\r
`,E=h.join(_);return E}}();return{to_workbook:a,to_sheet:r,from_sheet:n}}(),I6=function(){function e(x){return x.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(x){return x.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(x,v){for(var g=x.split(`
`),w=-1,b=-1,N=0,_=[];N!==g.length;++N){var E=g[N].trim().split(":");if(E[0]==="cell"){var j=sn(E[1]);if(_.length<=j.r)for(w=_.length;w<=j.r;++w)_[w]||(_[w]=[]);switch(w=j.r,b=j.c,E[2]){case"t":_[w][b]=e(E[3]);break;case"v":_[w][b]=+E[3];break;case"vtf":var M=E[E.length-1];case"vtc":switch(E[3]){case"nl":_[w][b]=!!+E[4];break;default:_[w][b]=+E[4];break}E[2]=="vtf"&&(_[w][b]=[_[w][b],M])}}}return v&&v.sheetRows&&(_=_.slice(0,v.sheetRows)),_}function a(x,v){return Sh(r(x,v),v)}function n(x,v){return Wu(a(x,v),v)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,c=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),u="--SocialCalcSpreadsheetControlSave--";function h(x){if(!x||!x["!ref"])return"";for(var v=[],g=[],w,b="",N=Ci(x["!ref"]),_=Array.isArray(x),E=N.s.r;E<=N.e.r;++E)for(var j=N.s.c;j<=N.e.c;++j)if(b=vr({r:E,c:j}),w=_?(x[E]||[])[j]:x[b],!(!w||w.v==null||w.t==="z")){switch(g=["cell",b,"t"],w.t){case"s":case"str":g.push(t(w.v));break;case"n":w.f?(g[2]="vtf",g[3]="n",g[4]=w.v,g[5]=t(w.f)):(g[2]="v",g[3]=w.v);break;case"b":g[2]="vt"+(w.f?"f":"c"),g[3]="nl",g[4]=w.v?"1":"0",g[5]=t(w.f||(w.v?"TRUE":"FALSE"));break;case"d":var M=Yn(Ha(w.v));g[2]="vtc",g[3]="nd",g[4]=""+M,g[5]=w.w||Co(w.z||xr[14],M);break;case"e":continue}v.push(g.join(":"))}return v.push("sheet:c:"+(N.e.c-N.s.c+1)+":r:"+(N.e.r-N.s.r+1)+":tvf:1"),v.push("valueformat:1:text-wiki"),v.join(`
`)}function p(x){return[s,o,c,o,h(x),u].join(`
`)}return{to_workbook:n,to_sheet:a,from_sheet:p}}(),dh=function(){function e(p,x,v,g,w){w.raw?x[v][g]=p:p===""||(p==="TRUE"?x[v][g]=!0:p==="FALSE"?x[v][g]=!1:isNaN(ll(p))?isNaN(hh(p).getDate())?x[v][g]=p:x[v][g]=Ha(p):x[v][g]=ll(p))}function t(p,x){var v=x||{},g=[];if(!p||p.length===0)return g;for(var w=p.split(/[\r\n]/),b=w.length-1;b>=0&&w[b].length===0;)--b;for(var N=10,_=0,E=0;E<=b;++E)_=w[E].indexOf(" "),_==-1?_=w[E].length:_++,N=Math.max(N,_);for(E=0;E<=b;++E){g[E]=[];var j=0;for(e(w[E].slice(0,N).trim(),g,E,j,v),j=1;j<=(w[E].length-N)/10+1;++j)e(w[E].slice(N+(j-1)*10,N+j*10).trim(),g,E,j,v)}return v.sheetRows&&(g=g.slice(0,v.sheetRows)),g}var r={44:",",9:"	",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function n(p){for(var x={},v=!1,g=0,w=0;g<p.length;++g)(w=p.charCodeAt(g))==34?v=!v:!v&&w in r&&(x[w]=(x[w]||0)+1);w=[];for(g in x)Object.prototype.hasOwnProperty.call(x,g)&&w.push([x[g],g]);if(!w.length){x=a;for(g in x)Object.prototype.hasOwnProperty.call(x,g)&&w.push([x[g],g])}return w.sort(function(b,N){return b[0]-N[0]||a[b[1]]-a[N[1]]}),r[w.pop()[1]]||44}function s(p,x){var v=x||{},g="",w=v.dense?[]:{},b={s:{c:0,r:0},e:{c:0,r:0}};p.slice(0,4)=="sep="?p.charCodeAt(5)==13&&p.charCodeAt(6)==10?(g=p.charAt(4),p=p.slice(7)):p.charCodeAt(5)==13||p.charCodeAt(5)==10?(g=p.charAt(4),p=p.slice(6)):g=n(p.slice(0,1024)):v&&v.FS?g=v.FS:g=n(p.slice(0,1024));var N=0,_=0,E=0,j=0,M=0,U=g.charCodeAt(0),V=!1,I=0,z=p.charCodeAt(0);p=p.replace(/\r\n/mg,`
`);var H=v.dateNF!=null?DR(v.dateNF):null;function re(){var R=p.slice(j,M),F={};if(R.charAt(0)=='"'&&R.charAt(R.length-1)=='"'&&(R=R.slice(1,-1).replace(/""/g,'"')),R.length===0)F.t="z";else if(v.raw)F.t="s",F.v=R;else if(R.trim().length===0)F.t="s",F.v=R;else if(R.charCodeAt(0)==61)R.charCodeAt(1)==34&&R.charCodeAt(R.length-1)==34?(F.t="s",F.v=R.slice(2,-1).replace(/""/g,'"')):iz(R)?(F.t="n",F.f=R.slice(1)):(F.t="s",F.v=R);else if(R=="TRUE")F.t="b",F.v=!0;else if(R=="FALSE")F.t="b",F.v=!1;else if(!isNaN(E=ll(R)))F.t="n",v.cellText!==!1&&(F.w=R),F.v=E;else if(!isNaN(hh(R).getDate())||H&&R.match(H)){F.z=v.dateNF||xr[14];var Y=0;H&&R.match(H)&&(R=FR(R,v.dateNF,R.match(H)||[]),Y=1),v.cellDates?(F.t="d",F.v=Ha(R,Y)):(F.t="n",F.v=Yn(Ha(R,Y))),v.cellText!==!1&&(F.w=Co(F.z,F.v instanceof Date?Yn(F.v):F.v)),v.cellNF||delete F.z}else F.t="s",F.v=R;if(F.t=="z"||(v.dense?(w[N]||(w[N]=[]),w[N][_]=F):w[vr({c:_,r:N})]=F),j=M+1,z=p.charCodeAt(j),b.e.c<_&&(b.e.c=_),b.e.r<N&&(b.e.r=N),I==U)++_;else if(_=0,++N,v.sheetRows&&v.sheetRows<=N)return!0}e:for(;M<p.length;++M)switch(I=p.charCodeAt(M)){case 34:z===34&&(V=!V);break;case U:case 10:case 13:if(!V&&re())break e;break}return M-j>0&&re(),w["!ref"]=jr(b),w}function o(p,x){return!(x&&x.PRN)||x.FS||p.slice(0,4)=="sep="||p.indexOf("	")>=0||p.indexOf(",")>=0||p.indexOf(";")>=0?s(p,x):Sh(t(p,x),x)}function c(p,x){var v="",g=x.type=="string"?[0,0,0,0]:r5(p,x);switch(x.type){case"base64":v=ro(p);break;case"binary":v=p;break;case"buffer":x.codepage==65001?v=p.toString("utf8"):(x.codepage,v=Rr&&Buffer.isBuffer(p)?p.toString("binary"):Gu(p));break;case"array":v=Wf(p);break;case"string":v=p;break;default:throw new Error("Unrecognized type "+x.type)}return g[0]==239&&g[1]==187&&g[2]==191?v=Na(v.slice(3)):x.type!="string"&&x.type!="buffer"&&x.codepage==65001?v=Na(v):x.type=="binary",v.slice(0,19)=="socialcalc:version:"?I6.to_sheet(x.type=="string"?v:Na(v),x):o(v,x)}function u(p,x){return Wu(c(p,x),x)}function h(p){for(var x=[],v=aa(p["!ref"]),g,w=Array.isArray(p),b=v.s.r;b<=v.e.r;++b){for(var N=[],_=v.s.c;_<=v.e.c;++_){var E=vr({r:b,c:_});if(g=w?(p[b]||[])[_]:p[E],!g||g.v==null){N.push("          ");continue}for(var j=(g.w||(Hc(g),g.w)||"").slice(0,10);j.length<10;)j+=" ";N.push(j+(_===0?" ":""))}x.push(N.join(""))}return x.join(`
`)}return{to_workbook:u,to_sheet:c,from_sheet:h}}();function WI(e,t){var r=t||{},a=!!r.WTF;r.WTF=!0;try{var n=R6.to_workbook(e,r);return r.WTF=a,n}catch(s){if(r.WTF=a,!s.message.match(/SYLK bad record ID/)&&a)throw s;return dh.to_workbook(e,t)}}var Bf=function(){function e(D,O,L){if(D){Ss(D,D.l||0);for(var q=L.Enum||G;D.l<D.length;){var oe=D.read_shift(2),be=q[oe]||q[65535],ve=D.read_shift(2),ue=D.l+ve,fe=be.f&&be.f(D,ve,L);if(D.l=ue,O(fe,be,oe))return}}}function t(D,O){switch(O.type){case"base64":return r(Ki(ro(D)),O);case"binary":return r(Ki(D),O);case"buffer":case"array":return r(D,O)}throw"Unsupported type "+O.type}function r(D,O){if(!D)return D;var L=O||{},q=L.dense?[]:{},oe="Sheet1",be="",ve=0,ue={},fe=[],Ee=[],J={s:{r:0,c:0},e:{r:0,c:0}},Pe=L.sheetRows||0;if(D[2]==0&&(D[3]==8||D[3]==9)&&D.length>=16&&D[14]==5&&D[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(D[2]==2)L.Enum=G,e(D,function(rt,Ue,Xe){switch(Xe){case 0:L.vers=rt,rt>=4096&&(L.qpro=!0);break;case 6:J=rt;break;case 204:rt&&(be=rt);break;case 222:be=rt;break;case 15:case 51:L.qpro||(rt[1].v=rt[1].v.slice(1));case 13:case 14:case 16:Xe==14&&(rt[2]&112)==112&&(rt[2]&15)>1&&(rt[2]&15)<15&&(rt[1].z=L.dateNF||xr[14],L.cellDates&&(rt[1].t="d",rt[1].v=ex(rt[1].v))),L.qpro&&rt[3]>ve&&(q["!ref"]=jr(J),ue[oe]=q,fe.push(oe),q=L.dense?[]:{},J={s:{r:0,c:0},e:{r:0,c:0}},ve=rt[3],oe=be||"Sheet"+(ve+1),be="");var ot=L.dense?(q[rt[0].r]||[])[rt[0].c]:q[vr(rt[0])];if(ot){ot.t=rt[1].t,ot.v=rt[1].v,rt[1].z!=null&&(ot.z=rt[1].z),rt[1].f!=null&&(ot.f=rt[1].f);break}L.dense?(q[rt[0].r]||(q[rt[0].r]=[]),q[rt[0].r][rt[0].c]=rt[1]):q[vr(rt[0])]=rt[1];break}},L);else if(D[2]==26||D[2]==14)L.Enum=ye,D[2]==14&&(L.qpro=!0,D.l=0),e(D,function(rt,Ue,Xe){switch(Xe){case 204:oe=rt;break;case 22:rt[1].v=rt[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(rt[3]>ve&&(q["!ref"]=jr(J),ue[oe]=q,fe.push(oe),q=L.dense?[]:{},J={s:{r:0,c:0},e:{r:0,c:0}},ve=rt[3],oe="Sheet"+(ve+1)),Pe>0&&rt[0].r>=Pe)break;L.dense?(q[rt[0].r]||(q[rt[0].r]=[]),q[rt[0].r][rt[0].c]=rt[1]):q[vr(rt[0])]=rt[1],J.e.c<rt[0].c&&(J.e.c=rt[0].c),J.e.r<rt[0].r&&(J.e.r=rt[0].r);break;case 27:rt[14e3]&&(Ee[rt[14e3][0]]=rt[14e3][1]);break;case 1537:Ee[rt[0]]=rt[1],rt[0]==ve&&(oe=rt[1]);break}},L);else throw new Error("Unrecognized LOTUS BOF "+D[2]);if(q["!ref"]=jr(J),ue[be||oe]=q,fe.push(be||oe),!Ee.length)return{SheetNames:fe,Sheets:ue};for(var st={},ke=[],de=0;de<Ee.length;++de)ue[fe[de]]?(ke.push(Ee[de]||fe[de]),st[Ee[de]]=ue[Ee[de]]||ue[fe[de]]):(ke.push(Ee[de]),st[Ee[de]]={"!ref":"A1"});return{SheetNames:ke,Sheets:st}}function a(D,O){var L=O||{};if(+L.codepage>=0&&il(+L.codepage),L.type=="string")throw new Error("Cannot write WK1 to JS string");var q=ji(),oe=aa(D["!ref"]),be=Array.isArray(D),ve=[];Bt(q,0,s(1030)),Bt(q,6,u(oe));for(var ue=Math.min(oe.e.r,8191),fe=oe.s.r;fe<=ue;++fe)for(var Ee=jn(fe),J=oe.s.c;J<=oe.e.c;++J){fe===oe.s.r&&(ve[J]=nn(J));var Pe=ve[J]+Ee,st=be?(D[fe]||[])[J]:D[Pe];if(!(!st||st.t=="z"))if(st.t=="n")(st.v|0)==st.v&&st.v>=-32768&&st.v<=32767?Bt(q,13,g(fe,J,st.v)):Bt(q,14,b(fe,J,st.v));else{var ke=Hc(st);Bt(q,15,x(fe,J,ke.slice(0,239)))}}return Bt(q,1),q.end()}function n(D,O){var L=O||{};if(+L.codepage>=0&&il(+L.codepage),L.type=="string")throw new Error("Cannot write WK3 to JS string");var q=ji();Bt(q,0,o(D));for(var oe=0,be=0;oe<D.SheetNames.length;++oe)(D.Sheets[D.SheetNames[oe]]||{})["!ref"]&&Bt(q,27,Q(D.SheetNames[oe],be++));var ve=0;for(oe=0;oe<D.SheetNames.length;++oe){var ue=D.Sheets[D.SheetNames[oe]];if(!(!ue||!ue["!ref"])){for(var fe=aa(ue["!ref"]),Ee=Array.isArray(ue),J=[],Pe=Math.min(fe.e.r,8191),st=fe.s.r;st<=Pe;++st)for(var ke=jn(st),de=fe.s.c;de<=fe.e.c;++de){st===fe.s.r&&(J[de]=nn(de));var rt=J[de]+ke,Ue=Ee?(ue[st]||[])[de]:ue[rt];if(!(!Ue||Ue.t=="z"))if(Ue.t=="n")Bt(q,23,re(st,de,ve,Ue.v));else{var Xe=Hc(Ue);Bt(q,22,I(st,de,ve,Xe.slice(0,239)))}}++ve}}return Bt(q,1),q.end()}function s(D){var O=ht(2);return O.write_shift(2,D),O}function o(D){var O=ht(26);O.write_shift(2,4096),O.write_shift(2,4),O.write_shift(4,0);for(var L=0,q=0,oe=0,be=0;be<D.SheetNames.length;++be){var ve=D.SheetNames[be],ue=D.Sheets[ve];if(!(!ue||!ue["!ref"])){++oe;var fe=Ci(ue["!ref"]);L<fe.e.r&&(L=fe.e.r),q<fe.e.c&&(q=fe.e.c)}}return L>8191&&(L=8191),O.write_shift(2,L),O.write_shift(1,oe),O.write_shift(1,q),O.write_shift(2,0),O.write_shift(2,0),O.write_shift(1,1),O.write_shift(1,2),O.write_shift(4,0),O.write_shift(4,0),O}function c(D,O,L){var q={s:{c:0,r:0},e:{c:0,r:0}};return O==8&&L.qpro?(q.s.c=D.read_shift(1),D.l++,q.s.r=D.read_shift(2),q.e.c=D.read_shift(1),D.l++,q.e.r=D.read_shift(2),q):(q.s.c=D.read_shift(2),q.s.r=D.read_shift(2),O==12&&L.qpro&&(D.l+=2),q.e.c=D.read_shift(2),q.e.r=D.read_shift(2),O==12&&L.qpro&&(D.l+=2),q.s.c==65535&&(q.s.c=q.e.c=q.s.r=q.e.r=0),q)}function u(D){var O=ht(8);return O.write_shift(2,D.s.c),O.write_shift(2,D.s.r),O.write_shift(2,D.e.c),O.write_shift(2,D.e.r),O}function h(D,O,L){var q=[{c:0,r:0},{t:"n",v:0},0,0];return L.qpro&&L.vers!=20768?(q[0].c=D.read_shift(1),q[3]=D.read_shift(1),q[0].r=D.read_shift(2),D.l+=2):(q[2]=D.read_shift(1),q[0].c=D.read_shift(2),q[0].r=D.read_shift(2)),q}function p(D,O,L){var q=D.l+O,oe=h(D,O,L);if(oe[1].t="s",L.vers==20768){D.l++;var be=D.read_shift(1);return oe[1].v=D.read_shift(be,"utf8"),oe}return L.qpro&&D.l++,oe[1].v=D.read_shift(q-D.l,"cstr"),oe}function x(D,O,L){var q=ht(7+L.length);q.write_shift(1,255),q.write_shift(2,O),q.write_shift(2,D),q.write_shift(1,39);for(var oe=0;oe<q.length;++oe){var be=L.charCodeAt(oe);q.write_shift(1,be>=128?95:be)}return q.write_shift(1,0),q}function v(D,O,L){var q=h(D,O,L);return q[1].v=D.read_shift(2,"i"),q}function g(D,O,L){var q=ht(7);return q.write_shift(1,255),q.write_shift(2,O),q.write_shift(2,D),q.write_shift(2,L,"i"),q}function w(D,O,L){var q=h(D,O,L);return q[1].v=D.read_shift(8,"f"),q}function b(D,O,L){var q=ht(13);return q.write_shift(1,255),q.write_shift(2,O),q.write_shift(2,D),q.write_shift(8,L,"f"),q}function N(D,O,L){var q=D.l+O,oe=h(D,O,L);if(oe[1].v=D.read_shift(8,"f"),L.qpro)D.l=q;else{var be=D.read_shift(2);M(D.slice(D.l,D.l+be),oe),D.l+=be}return oe}function _(D,O,L){var q=O&32768;return O&=-32769,O=(q?D:0)+(O>=8192?O-16384:O),(q?"":"$")+(L?nn(O):jn(O))}var E={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},j=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function M(D,O){Ss(D,0);for(var L=[],q=0,oe="",be="",ve="",ue="";D.l<D.length;){var fe=D[D.l++];switch(fe){case 0:L.push(D.read_shift(8,"f"));break;case 1:be=_(O[0].c,D.read_shift(2),!0),oe=_(O[0].r,D.read_shift(2),!1),L.push(be+oe);break;case 2:{var Ee=_(O[0].c,D.read_shift(2),!0),J=_(O[0].r,D.read_shift(2),!1);be=_(O[0].c,D.read_shift(2),!0),oe=_(O[0].r,D.read_shift(2),!1),L.push(Ee+J+":"+be+oe)}break;case 3:if(D.l<D.length){console.error("WK1 premature formula end");return}break;case 4:L.push("("+L.pop()+")");break;case 5:L.push(D.read_shift(2));break;case 6:{for(var Pe="";fe=D[D.l++];)Pe+=String.fromCharCode(fe);L.push('"'+Pe.replace(/"/g,'""')+'"')}break;case 8:L.push("-"+L.pop());break;case 23:L.push("+"+L.pop());break;case 22:L.push("NOT("+L.pop()+")");break;case 20:case 21:ue=L.pop(),ve=L.pop(),L.push(["AND","OR"][fe-20]+"("+ve+","+ue+")");break;default:if(fe<32&&j[fe])ue=L.pop(),ve=L.pop(),L.push(ve+j[fe]+ue);else if(E[fe]){if(q=E[fe][1],q==69&&(q=D[D.l++]),q>L.length){console.error("WK1 bad formula parse 0x"+fe.toString(16)+":|"+L.join("|")+"|");return}var st=L.slice(-q);L.length-=q,L.push(E[fe][0]+"("+st.join(",")+")")}else return fe<=7?console.error("WK1 invalid opcode "+fe.toString(16)):fe<=24?console.error("WK1 unsupported op "+fe.toString(16)):fe<=30?console.error("WK1 invalid opcode "+fe.toString(16)):fe<=115?console.error("WK1 unsupported function opcode "+fe.toString(16)):console.error("WK1 unrecognized opcode "+fe.toString(16))}}L.length==1?O[1].f=""+L[0]:console.error("WK1 bad formula parse |"+L.join("|")+"|")}function U(D){var O=[{c:0,r:0},{t:"n",v:0},0];return O[0].r=D.read_shift(2),O[3]=D[D.l++],O[0].c=D[D.l++],O}function V(D,O){var L=U(D);return L[1].t="s",L[1].v=D.read_shift(O-4,"cstr"),L}function I(D,O,L,q){var oe=ht(6+q.length);oe.write_shift(2,D),oe.write_shift(1,L),oe.write_shift(1,O),oe.write_shift(1,39);for(var be=0;be<q.length;++be){var ve=q.charCodeAt(be);oe.write_shift(1,ve>=128?95:ve)}return oe.write_shift(1,0),oe}function z(D,O){var L=U(D);L[1].v=D.read_shift(2);var q=L[1].v>>1;if(L[1].v&1)switch(q&7){case 0:q=(q>>3)*5e3;break;case 1:q=(q>>3)*500;break;case 2:q=(q>>3)/20;break;case 3:q=(q>>3)/200;break;case 4:q=(q>>3)/2e3;break;case 5:q=(q>>3)/2e4;break;case 6:q=(q>>3)/16;break;case 7:q=(q>>3)/64;break}return L[1].v=q,L}function H(D,O){var L=U(D),q=D.read_shift(4),oe=D.read_shift(4),be=D.read_shift(2);if(be==65535)return q===0&&oe===3221225472?(L[1].t="e",L[1].v=15):q===0&&oe===3489660928?(L[1].t="e",L[1].v=42):L[1].v=0,L;var ve=be&32768;return be=(be&32767)-16446,L[1].v=(1-ve*2)*(oe*Math.pow(2,be+32)+q*Math.pow(2,be)),L}function re(D,O,L,q){var oe=ht(14);if(oe.write_shift(2,D),oe.write_shift(1,L),oe.write_shift(1,O),q==0)return oe.write_shift(4,0),oe.write_shift(4,0),oe.write_shift(2,65535),oe;var be=0,ve=0,ue=0,fe=0;return q<0&&(be=1,q=-q),ve=Math.log2(q)|0,q/=Math.pow(2,ve-31),fe=q>>>0,(fe&2147483648)==0&&(q/=2,++ve,fe=q>>>0),q-=fe,fe|=2147483648,fe>>>=0,q*=Math.pow(2,32),ue=q>>>0,oe.write_shift(4,ue),oe.write_shift(4,fe),ve+=16383+(be?32768:0),oe.write_shift(2,ve),oe}function R(D,O){var L=H(D);return D.l+=O-14,L}function F(D,O){var L=U(D),q=D.read_shift(4);return L[1].v=q>>6,L}function Y(D,O){var L=U(D),q=D.read_shift(8,"f");return L[1].v=q,L}function K(D,O){var L=Y(D);return D.l+=O-10,L}function X(D,O){return D[D.l+O-1]==0?D.read_shift(O,"cstr"):""}function Z(D,O){var L=D[D.l++];L>O-1&&(L=O-1);for(var q="";q.length<L;)q+=String.fromCharCode(D[D.l++]);return q}function ce(D,O,L){if(!(!L.qpro||O<21)){var q=D.read_shift(1);D.l+=17,D.l+=1,D.l+=2;var oe=D.read_shift(O-21,"cstr");return[q,oe]}}function te(D,O){for(var L={},q=D.l+O;D.l<q;){var oe=D.read_shift(2);if(oe==14e3){for(L[oe]=[0,""],L[oe][0]=D.read_shift(2);D[D.l];)L[oe][1]+=String.fromCharCode(D[D.l]),D.l++;D.l++}}return L}function Q(D,O){var L=ht(5+D.length);L.write_shift(2,14e3),L.write_shift(2,O);for(var q=0;q<D.length;++q){var oe=D.charCodeAt(q);L[L.l++]=oe>127?95:oe}return L[L.l++]=0,L}var G={0:{n:"BOF",f:Bn},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:c},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:v},14:{n:"NUMBER",f:w},15:{n:"LABEL",f:p},16:{n:"FORMULA",f:N},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:p},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:X},222:{n:"SHEETNAMELP",f:Z},65535:{n:""}},ye={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:V},23:{n:"NUMBER17",f:H},24:{n:"NUMBER18",f:z},25:{n:"FORMULA19",f:R},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:te},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:F},38:{n:"??"},39:{n:"NUMBER27",f:Y},40:{n:"FORMULA28",f:K},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:X},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ce},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:a,book_to_wk3:n,to_workbook:t}}();function $I(e){var t={},r=e.match(Qs),a=0,n=!1;if(r)for(;a!=r.length;++a){var s=wr(r[a]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;t.cp=yy[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(s[0].charCodeAt(1)!==47&&!n)throw new Error("Unrecognized rich format "+s[0])}}return t}var XI=function(){var e=ap("t"),t=ap("rPr");function r(s){var o=s.match(e);if(!o)return{t:"s",v:""};var c={t:"s",v:ra(o[1])},u=s.match(t);return u&&(c.s=$I(u[1])),c}var a=/<(?:\w+:)?r>/g,n=/<\/(?:\w+:)?r>/;return function(o){return o.replace(a,"").split(n).map(r).filter(function(c){return c.v})}}(),YI=function(){var t=/(\r\n|\n)/g;function r(n,s,o){var c=[];n.u&&c.push("text-decoration: underline;"),n.uval&&c.push("text-underline-style:"+n.uval+";"),n.sz&&c.push("font-size:"+n.sz+"pt;"),n.outline&&c.push("text-effect: outline;"),n.shadow&&c.push("text-shadow: auto;"),s.push('<span style="'+c.join("")+'">'),n.b&&(s.push("<b>"),o.push("</b>")),n.i&&(s.push("<i>"),o.push("</i>")),n.strike&&(s.push("<s>"),o.push("</s>"));var u=n.valign||"";return u=="superscript"||u=="super"?u="sup":u=="subscript"&&(u="sub"),u!=""&&(s.push("<"+u+">"),o.push("</"+u+">")),o.push("</span>"),n}function a(n){var s=[[],n.v,[]];return n.v?(n.s&&r(n.s,s[0],s[2]),s[0].join("")+s[1].replace(t,"<br/>")+s[2].join("")):""}return function(s){return s.map(a).join("")}}(),JI=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,KI=/<(?:\w+:)?r>/,ZI=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Vy(e,t){var r=t?t.cellHTML:!0,a={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(a.t=ra(Na(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),a.r=Na(e),r&&(a.h=jy(a.t))):e.match(KI)&&(a.r=Na(e),a.t=ra(Na((e.replace(ZI,"").match(JI)||[]).join("").replace(Qs,""))),r&&(a.h=YI(XI(a.r)))),a):{t:""}}var QI=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,eB=/<(?:\w+:)?(?:si|sstItem)>/g,tB=/<\/(?:\w+:)?(?:si|sstItem)>/;function rB(e,t){var r=[],a="";if(!e)return r;var n=e.match(QI);if(n){a=n[2].replace(eB,"").split(tB);for(var s=0;s!=a.length;++s){var o=Vy(a[s].trim(),t);o!=null&&(r[r.length]=o)}n=wr(n[1]),r.Count=n.count,r.Unique=n.uniqueCount}return r}var aB=/^\s|\s$|[\t\n\r]/;function B6(e,t){if(!t.bookSST)return"";var r=[Cn];r[r.length]=Mt("sst",null,{xmlns:t0[0],count:e.Count,uniqueCount:e.Unique});for(var a=0;a!=e.length;++a)if(e[a]!=null){var n=e[a],s="<si>";n.r?s+=n.r:(s+="<t",n.t||(n.t=""),n.t.match(aB)&&(s+=' xml:space="preserve"'),s+=">"+ya(n.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function nB(e){return[e.read_shift(4),e.read_shift(4)]}function sB(e,t){var r=[],a=!1;return Gc(e,function(s,o,c){switch(c){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:a=!0;break;case 36:a=!1;break;default:if(o.T,!a||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}),r}function iB(e,t){return t||(t=ht(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var oB=g9;function lB(e){var t=ji();Nt(t,159,iB(e));for(var r=0;r<e.length;++r)Nt(t,19,oB(e[r]));return Nt(t,160),t.end()}function U6(e){for(var t=[],r=e.split(""),a=0;a<r.length;++a)t[a]=r[a].charCodeAt(0);return t}function Mc(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function cB(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Mc(e,4),t.U=Mc(e,4),t.W=Mc(e,4),t}function uB(e){for(var t=e.read_shift(4),r=e.l+t-4,a={},n=e.read_shift(4),s=[];n-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(a.name=e.read_shift(0,"lpp4"),a.comps=s,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return a}function fB(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(uB(e));return t}function hB(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function dB(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Mc(e,4),t.U=Mc(e,4),t.W=Mc(e,4),t}function pB(e){var t=dB(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function z6(e,t){var r=e.l+t,a={};a.Flags=e.read_shift(4)&63,e.l+=4,a.AlgID=e.read_shift(4);var n=!1;switch(a.AlgID){case 26126:case 26127:case 26128:n=a.Flags==36;break;case 26625:n=a.Flags==4;break;case 0:n=a.Flags==16||a.Flags==4||a.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+a.AlgID}if(!n)throw new Error("Encryption Flags/AlgID mismatch");return a.AlgIDHash=e.read_shift(4),a.KeySize=e.read_shift(4),a.ProviderType=e.read_shift(4),e.l+=8,a.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,a}function H6(e,t){var r={},a=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,a),e.l=a,r}function mB(e){var t=Mc(e);switch(t.Minor){case 2:return[t.Minor,xB(e)];case 3:return[t.Minor,gB()];case 4:return[t.Minor,vB(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function xB(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),a=z6(e,r),n=H6(e,e.length-e.l);return{t:"Std",h:a,v:n}}function gB(){throw new Error("File is password-protected: ECMA-376 Extensible")}function vB(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),a={};return r.replace(Qs,function(s){var o=wr(s);switch(Ql(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(c){a[c]=o[c]});break;case"<dataIntegrity":a.encryptedHmacKey=o.encryptedHmacKey,a.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":a.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":a.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":a.encs.push(o);break;default:throw o[0]}}),a}function yB(e,t){var r={},a=r.EncryptionVersionInfo=Mc(e,4);if(t-=4,a.Minor!=2)throw new Error("unrecognized minor version code: "+a.Minor);if(a.Major>4||a.Major<2)throw new Error("unrecognized major version code: "+a.Major);r.Flags=e.read_shift(4),t-=4;var n=e.read_shift(4);return t-=4,r.EncryptionHeader=z6(e,n),t-=n,r.EncryptionVerifier=H6(e,t),r}function wB(e){var t={},r=t.EncryptionVersionInfo=Mc(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function qy(e){var t=0,r,a=U6(e),n=a.length+1,s,o,c,u,h;for(r=Uu(n),r[0]=a.length,s=1;s!=n;++s)r[s]=a[s-1];for(s=n-1;s>=0;--s)o=r[s],c=(t&16384)===0?0:1,u=t<<1&32767,h=c|u,t=h^o;return t^52811}var V6=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],a=function(o){return(o/2|o*128)&255},n=function(o,c){return a(o^c)},s=function(o){for(var c=t[o.length-1],u=104,h=o.length-1;h>=0;--h)for(var p=o[h],x=0;x!=7;++x)p&64&&(c^=r[u]),p*=2,--u;return c};return function(o){for(var c=U6(o),u=s(c),h=c.length,p=Uu(16),x=0;x!=16;++x)p[x]=0;var v,g,w;for((h&1)===1&&(v=u>>8,p[h]=n(e[0],v),--h,v=u&255,g=c[c.length-1],p[h]=n(g,v));h>0;)--h,v=u>>8,p[h]=n(c[h],v),--h,v=u&255,p[h]=n(c[h],v);for(h=15,w=15-c.length;w>0;)v=u>>8,p[h]=n(e[w],v),--h,--w,v=u&255,p[h]=n(c[h],v),--h,--w;return p}}(),bB=function(e,t,r,a,n){n||(n=t),a||(a=V6(e));var s,o;for(s=0;s!=t.length;++s)o=t[s],o^=a[r],o=(o>>5|o<<3)&255,n[s]=o,++r;return[n,r,a]},SB=function(e){var t=0,r=V6(e);return function(a){var n=bB("",a,t,r);return t=n[1],n[0]}};function NB(e,t,r,a){var n={key:Bn(e),verificationBytes:Bn(e)};return r.password&&(n.verifier=qy(r.password)),a.valid=n.verificationBytes===n.verifier,a.valid&&(a.insitu=SB(r.password)),n}function AB(e,t,r){var a=r||{};return a.Info=e.read_shift(2),e.l-=2,a.Info===1?a.Data=wB(e):a.Data=yB(e,t),a}function _B(e,t,r){var a={Type:r.biff>=8?e.read_shift(2):0};return a.Type?AB(e,t-2,a):NB(e,r.biff>=8?t:t-2,r,a),a}var q6=function(){function e(n,s){switch(s.type){case"base64":return t(ro(n),s);case"binary":return t(n,s);case"buffer":return t(Rr&&Buffer.isBuffer(n)?n.toString("binary"):Gu(n),s);case"array":return t(Wf(n),s)}throw new Error("Unrecognized type "+s.type)}function t(n,s){var o=s||{},c=o.dense?[]:{},u=n.match(/\\trowd.*?\\row\b/g);if(!u.length)throw new Error("RTF missing table");var h={s:{c:0,r:0},e:{c:0,r:u.length-1}};return u.forEach(function(p,x){Array.isArray(c)&&(c[x]=[]);for(var v=/\\\w+\b/g,g=0,w,b=-1;w=v.exec(p);){switch(w[0]){case"\\cell":var N=p.slice(g,v.lastIndex-w[0].length);if(N[0]==" "&&(N=N.slice(1)),++b,N.length){var _={v:N,t:"s"};Array.isArray(c)?c[x][b]=_:c[vr({r:x,c:b})]=_}break}g=v.lastIndex}b>h.e.c&&(h.e.c=b)}),c["!ref"]=jr(h),c}function r(n,s){return Wu(e(n,s),s)}function a(n){for(var s=["{\\rtf1\\ansi"],o=aa(n["!ref"]),c,u=Array.isArray(n),h=o.s.r;h<=o.e.r;++h){s.push("\\trowd\\trautofit1");for(var p=o.s.c;p<=o.e.c;++p)s.push("\\cellx"+(p+1));for(s.push("\\pard\\intbl"),p=o.s.c;p<=o.e.c;++p){var x=vr({r:h,c:p});c=u?(n[h]||[])[p]:n[x],!(!c||c.v==null&&(!c.f||c.F))&&(s.push(" "+(c.w||(Hc(c),c.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:a}}();function TB(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function op(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function kB(e){var t=e[0]/255,r=e[1]/255,a=e[2]/255,n=Math.max(t,r,a),s=Math.min(t,r,a),o=n-s;if(o===0)return[0,0,t];var c=0,u=0,h=n+s;switch(u=o/(h>1?2-h:h),n){case t:c=((r-a)/o+6)%6;break;case r:c=(a-t)/o+2;break;case a:c=(t-r)/o+4;break}return[c/6,u,h/2]}function EB(e){var t=e[0],r=e[1],a=e[2],n=r*2*(a<.5?a:1-a),s=a-n/2,o=[s,s,s],c=6*t,u;if(r!==0)switch(c|0){case 0:case 6:u=n*c,o[0]+=n,o[1]+=u;break;case 1:u=n*(2-c),o[0]+=u,o[1]+=n;break;case 2:u=n*(c-2),o[1]+=n,o[2]+=u;break;case 3:u=n*(4-c),o[1]+=u,o[2]+=n;break;case 4:u=n*(c-4),o[2]+=n,o[0]+=u;break;case 5:u=n*(6-c),o[2]+=u,o[0]+=n;break}for(var h=0;h!=3;++h)o[h]=Math.round(o[h]*255);return o}function C1(e,t){if(t===0)return e;var r=kB(TB(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),op(EB(r))}var G6=6,jB=15,CB=1,$s=G6;function lp(e){return Math.floor((e+Math.round(128/$s)/256)*$s)}function cp(e){return Math.floor((e-5)/$s*100+.5)/100}function D1(e){return Math.round((e*$s+5)/$s*256)/256}function c2(e){return D1(cp(lp(e)))}function Gy(e){var t=Math.abs(e-c2(e)),r=$s;if(t>.005)for($s=CB;$s<jB;++$s)Math.abs(e-c2(e))<=t&&(t=Math.abs(e-c2(e)),r=$s);$s=r}function zu(e){e.width?(e.wpx=lp(e.width),e.wch=cp(e.wpx),e.MDW=$s):e.wpx?(e.wch=cp(e.wpx),e.width=D1(e.wch),e.MDW=$s):typeof e.wch=="number"&&(e.width=D1(e.wch),e.wpx=lp(e.width),e.MDW=$s),e.customWidth&&delete e.customWidth}var DB=96,W6=DB;function up(e){return e*96/W6}function ph(e){return e*W6/96}var FB={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function PB(e,t,r,a){t.Borders=[];var n={},s=!1;(e[0].match(Qs)||[]).forEach(function(o){var c=wr(o);switch(Ql(c[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":n={},c.diagonalUp&&(n.diagonalUp=Ua(c.diagonalUp)),c.diagonalDown&&(n.diagonalDown=Ua(c.diagonalDown)),t.Borders.push(n);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a&&a.WTF&&!s)throw new Error("unrecognized "+c[0]+" in borders")}})}function LB(e,t,r,a){t.Fills=[];var n={},s=!1;(e[0].match(Qs)||[]).forEach(function(o){var c=wr(o);switch(Ql(c[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":n={},t.Fills.push(n);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(n),n={};break;case"<patternFill":case"<patternFill>":c.patternType&&(n.patternType=c.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":n.bgColor||(n.bgColor={}),c.indexed&&(n.bgColor.indexed=parseInt(c.indexed,10)),c.theme&&(n.bgColor.theme=parseInt(c.theme,10)),c.tint&&(n.bgColor.tint=parseFloat(c.tint)),c.rgb&&(n.bgColor.rgb=c.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":n.fgColor||(n.fgColor={}),c.theme&&(n.fgColor.theme=parseInt(c.theme,10)),c.tint&&(n.fgColor.tint=parseFloat(c.tint)),c.rgb!=null&&(n.fgColor.rgb=c.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a&&a.WTF&&!s)throw new Error("unrecognized "+c[0]+" in fills")}})}function OB(e,t,r,a){t.Fonts=[];var n={},s=!1;(e[0].match(Qs)||[]).forEach(function(o){var c=wr(o);switch(Ql(c[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(n),n={};break;case"<name":c.val&&(n.name=Na(c.val));break;case"<name/>":case"</name>":break;case"<b":n.bold=c.val?Ua(c.val):1;break;case"<b/>":n.bold=1;break;case"<i":n.italic=c.val?Ua(c.val):1;break;case"<i/>":n.italic=1;break;case"<u":switch(c.val){case"none":n.underline=0;break;case"single":n.underline=1;break;case"double":n.underline=2;break;case"singleAccounting":n.underline=33;break;case"doubleAccounting":n.underline=34;break}break;case"<u/>":n.underline=1;break;case"<strike":n.strike=c.val?Ua(c.val):1;break;case"<strike/>":n.strike=1;break;case"<outline":n.outline=c.val?Ua(c.val):1;break;case"<outline/>":n.outline=1;break;case"<shadow":n.shadow=c.val?Ua(c.val):1;break;case"<shadow/>":n.shadow=1;break;case"<condense":n.condense=c.val?Ua(c.val):1;break;case"<condense/>":n.condense=1;break;case"<extend":n.extend=c.val?Ua(c.val):1;break;case"<extend/>":n.extend=1;break;case"<sz":c.val&&(n.sz=+c.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":c.val&&(n.vertAlign=c.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":c.val&&(n.family=parseInt(c.val,10));break;case"<family/>":case"</family>":break;case"<scheme":c.val&&(n.scheme=c.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(c.val=="1")break;c.codepage=yy[parseInt(c.val,10)];break;case"<color":if(n.color||(n.color={}),c.auto&&(n.color.auto=Ua(c.auto)),c.rgb)n.color.rgb=c.rgb.slice(-6);else if(c.indexed){n.color.index=parseInt(c.indexed,10);var u=Mf[n.color.index];n.color.index==81&&(u=Mf[1]),u||(u=Mf[1]),n.color.rgb=u[0].toString(16)+u[1].toString(16)+u[2].toString(16)}else c.theme&&(n.color.theme=parseInt(c.theme,10),c.tint&&(n.color.tint=parseFloat(c.tint)),c.theme&&r.themeElements&&r.themeElements.clrScheme&&(n.color.rgb=C1(r.themeElements.clrScheme[n.color.theme].rgb,n.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(a&&a.WTF&&!s)throw new Error("unrecognized "+c[0]+" in fonts")}})}function RB(e,t,r){t.NumberFmt=[];for(var a=xn(xr),n=0;n<a.length;++n)t.NumberFmt[a[n]]=xr[a[n]];var s=e[0].match(Qs);if(s)for(n=0;n<s.length;++n){var o=wr(s[n]);switch(Ql(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var c=ra(Na(o.formatCode)),u=parseInt(o.numFmtId,10);if(t.NumberFmt[u]=c,u>0){if(u>392){for(u=392;u>60&&t.NumberFmt[u]!=null;--u);t.NumberFmt[u]=c}Rc(c,u)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function MB(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var a=r[0];a<=r[1];++a)e[a]!=null&&(t[t.length]=Mt("numFmt",null,{numFmtId:a,formatCode:ya(e[a])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Mt("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Bm=["numFmtId","fillId","fontId","borderId","xfId"],Um=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function IB(e,t,r){t.CellXf=[];var a,n=!1;(e[0].match(Qs)||[]).forEach(function(s){var o=wr(s),c=0;switch(Ql(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(a=o,delete a[0],c=0;c<Bm.length;++c)a[Bm[c]]&&(a[Bm[c]]=parseInt(a[Bm[c]],10));for(c=0;c<Um.length;++c)a[Um[c]]&&(a[Um[c]]=Ua(a[Um[c]]));if(t.NumberFmt&&a.numFmtId>392){for(c=392;c>60;--c)if(t.NumberFmt[a.numFmtId]==t.NumberFmt[c]){a.numFmtId=c;break}}t.CellXf.push(a);break;case"</xf>":break;case"<alignment":case"<alignment/>":var u={};o.vertical&&(u.vertical=o.vertical),o.horizontal&&(u.horizontal=o.horizontal),o.textRotation!=null&&(u.textRotation=o.textRotation),o.indent&&(u.indent=o.indent),o.wrapText&&(u.wrapText=Ua(o.wrapText)),a.alignment=u;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":n=!0;break;case"</AlternateContent>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(r&&r.WTF&&!n)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function BB(e){var t=[];return t[t.length]=Mt("cellXfs",null),e.forEach(function(r){t[t.length]=Mt("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Mt("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var UB=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,a=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,n=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(c,u,h){var p={};if(!c)return p;c=c.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var x;return(x=c.match(t))&&RB(x,p,h),(x=c.match(n))&&OB(x,p,u,h),(x=c.match(a))&&LB(x,p,u,h),(x=c.match(s))&&PB(x,p,u,h),(x=c.match(r))&&IB(x,p,h),p}}();function $6(e,t){var r=[Cn,Mt("styleSheet",null,{xmlns:t0[0],"xmlns:vt":Xn.vt})],a;return e.SSF&&(a=MB(e.SSF))!=null&&(r[r.length]=a),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(a=BB(t.cellXfs))&&(r[r.length]=a),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function zB(e,t){var r=e.read_shift(2),a=Ks(e);return[r,a]}function HB(e,t,r){r||(r=ht(6+4*t.length)),r.write_shift(2,e),us(t,r);var a=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),a}function VB(e,t,r){var a={};a.sz=e.read_shift(2)/20;var n=A9(e);n.fItalic&&(a.italic=1),n.fCondense&&(a.condense=1),n.fExtend&&(a.extend=1),n.fShadow&&(a.shadow=1),n.fOutline&&(a.outline=1),n.fStrikeout&&(a.strike=1);var s=e.read_shift(2);switch(s===700&&(a.bold=1),e.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(a.underline=o);var c=e.read_shift(1);c>0&&(a.family=c);var u=e.read_shift(1);switch(u>0&&(a.charset=u),e.l++,a.color=N9(e),e.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor";break}return a.name=Ks(e),a}function qB(e,t){t||(t=ht(25+4*32)),t.write_shift(2,e.sz*20),_9(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),k1(e.color,t);var a=0;return a=2,t.write_shift(1,a),us(e.name,t),t.length>t.l?t.slice(0,t.l):t}var GB=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],u2,WB=Zs;function uS(e,t){t||(t=ht(4*3+8*7+16*1)),u2||(u2=Z1(GB));var r=u2[e.patternType];r==null&&(r=40),t.write_shift(4,r);var a=0;if(r!=40)for(k1({auto:1},t),k1({auto:1},t);a<12;++a)t.write_shift(4,0);else{for(;a<4;++a)t.write_shift(4,0);for(;a<12;++a)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function $B(e,t){var r=e.l+t,a=e.read_shift(2),n=e.read_shift(2);return e.l=r,{ixfe:a,numFmtId:n}}function X6(e,t,r){r||(r=ht(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var a=0;return r.write_shift(1,a),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function xd(e,t){return t||(t=ht(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var XB=Zs;function YB(e,t){return t||(t=ht(51)),t.write_shift(1,0),xd(null,t),xd(null,t),xd(null,t),xd(null,t),xd(null,t),t.length>t.l?t.slice(0,t.l):t}function JB(e,t){return t||(t=ht(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),T1(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function KB(e,t,r){var a=ht(2052);return a.write_shift(4,e),T1(t,a),T1(r,a),a.length>a.l?a.slice(0,a.l):a}function ZB(e,t,r){var a={};a.NumberFmt=[];for(var n in xr)a.NumberFmt[n]=xr[n];a.CellXf=[],a.Fonts=[];var s=[],o=!1;return Gc(e,function(u,h,p){switch(p){case 44:a.NumberFmt[u[0]]=u[1],Rc(u[1],u[0]);break;case 43:a.Fonts.push(u),u.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(u.color.rgb=C1(t.themeElements.clrScheme[u.color.theme].rgb,u.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&a.CellXf.push(u);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:s.push(p),o=!0;break;case 38:s.pop(),o=!1;break;default:if(h.T>0)s.push(p);else if(h.T<0)s.pop();else if(!o||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+p.toString(16))}}),a}function QB(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)t[n]!=null&&++r}),r!=0&&(Nt(e,615,cl(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)t[n]!=null&&Nt(e,44,HB(n,t[n]))}),Nt(e,616))}}function eU(e){var t=1;Nt(e,611,cl(t)),Nt(e,43,qB({sz:12,color:{theme:1},name:"Calibri",family:2})),Nt(e,612)}function tU(e){var t=2;Nt(e,603,cl(t)),Nt(e,45,uS({patternType:"none"})),Nt(e,45,uS({patternType:"gray125"})),Nt(e,604)}function rU(e){var t=1;Nt(e,613,cl(t)),Nt(e,46,YB()),Nt(e,614)}function aU(e){var t=1;Nt(e,626,cl(t)),Nt(e,47,X6({numFmtId:0},65535)),Nt(e,627)}function nU(e,t){Nt(e,617,cl(t.length)),t.forEach(function(r){Nt(e,47,X6(r,0))}),Nt(e,618)}function sU(e){var t=1;Nt(e,619,cl(t)),Nt(e,48,JB({xfId:0,name:"Normal"})),Nt(e,620)}function iU(e){var t=0;Nt(e,505,cl(t)),Nt(e,506)}function oU(e){var t=0;Nt(e,508,KB(t,"TableStyleMedium9","PivotStyleMedium4")),Nt(e,509)}function lU(e,t){var r=ji();return Nt(r,278),QB(r,e.SSF),eU(r),tU(r),rU(r),aU(r),nU(r,t.cellXfs),sU(r),iU(r),oU(r),Nt(r,279),r.end()}var cU=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function uU(e,t,r){t.themeElements.clrScheme=[];var a={};(e[0].match(Qs)||[]).forEach(function(n){var s=wr(n);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":a.rgb=s.val;break;case"<a:sysClr":a.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(t.themeElements.clrScheme[cU.indexOf(s[0])]=a,a={}):a.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function fU(){}function hU(){}var dU=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,pU=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,mU=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function xU(e,t,r){t.themeElements={};var a;[["clrScheme",dU,uU],["fontScheme",pU,fU],["fmtScheme",mU,hU]].forEach(function(n){if(!(a=e.match(n[1])))throw new Error(n[0]+" not found in themeElements");n[2](a,t,r)})}var gU=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Y6(e,t){(!e||e.length===0)&&(e=Wy());var r,a={};if(!(r=e.match(gU)))throw new Error("themeElements not found in theme");return xU(r[0],a,t),a.raw=e,a}function Wy(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[Cn];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function vU(e,t,r){var a=e.l+t,n=e.read_shift(4);if(n!==124226){if(!r.cellStyles){e.l=a;return}var s=e.slice(e.l);e.l=a;var o;try{o=z_(s,{type:"array"})}catch{return}var c=Zi(o,"theme/theme/theme1.xml",!0);if(c)return Y6(c,r)}}function yU(e){return e.read_shift(4)}function wU(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=bU(e,4);break;case 2:t.xclrValue=E6(e);break;case 3:t.xclrValue=yU(e);break;case 4:e.l+=4;break}return e.l+=8,t}function bU(e,t){return Zs(e,t)}function SU(e,t){return Zs(e,t)}function NU(e){var t=e.read_shift(2),r=e.read_shift(2)-4,a=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:a[1]=wU(e);break;case 6:a[1]=SU(e,r);break;case 14:case 15:a[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return a}function AU(e,t){var r=e.l+t;e.l+=2;var a=e.read_shift(2);e.l+=2;for(var n=e.read_shift(2),s=[];n-- >0;)s.push(NU(e,r-e.l));return{ixfe:a,ext:s}}function _U(e,t){t.forEach(function(r){r[0]})}function TU(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Ks(e)}}function kU(e){var t=ht(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),us(e.name,t),t.slice(0,t.l)}function EU(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function jU(e){var t=ht(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function CU(e,t){var r=ht(8+2*t.length);return r.write_shift(4,e),us(t,r),r.slice(0,r.l)}function DU(e){return e.l+=4,e.read_shift(4)!=0}function FU(e,t){var r=ht(8);return r.write_shift(4,e),r.write_shift(4,1),r}function PU(e,t,r){var a={Types:[],Cell:[],Value:[]},n=r||{},s=[],o=!1,c=2;return Gc(e,function(u,h,p){switch(p){case 335:a.Types.push({name:u.name});break;case 51:u.forEach(function(x){c==1?a.Cell.push({type:a.Types[x[0]-1].name,index:x[1]}):c==0&&a.Value.push({type:a.Types[x[0]-1].name,index:x[1]})});break;case 337:c=u?1:0;break;case 338:c=2;break;case 35:s.push(p),o=!0;break;case 36:s.pop(),o=!1;break;default:if(!h.T){if(!o||n.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+p.toString(16))}}}),a}function LU(){var e=ji();return Nt(e,332),Nt(e,334,cl(1)),Nt(e,335,kU({name:"XLDAPR",version:12e4,flags:3496657072})),Nt(e,336),Nt(e,339,CU(1,"XLDAPR")),Nt(e,52),Nt(e,35,cl(514)),Nt(e,4096,cl(0)),Nt(e,4097,To(1)),Nt(e,36),Nt(e,53),Nt(e,340),Nt(e,337,FU(1)),Nt(e,51,jU([[1,0]])),Nt(e,338),Nt(e,333),e.end()}function OU(e,t,r){var a={Types:[],Cell:[],Value:[]};if(!e)return a;var n=!1,s=2,o;return e.replace(Qs,function(c){var u=wr(c);switch(Ql(u[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":a.Types.push({name:u.name});break;case"</metadataType>":break;case"<futureMetadata":for(var h=0;h<a.Types.length;++h)a.Types[h].name==u.name&&(o=a.Types[h]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?a.Cell.push({type:a.Types[u.t-1].name,index:+u.v}):s==0&&a.Value.push({type:a.Types[u.t-1].name,index:+u.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+u.i);break;default:if(!n&&r.WTF)throw new Error("unrecognized "+u[0]+" in metadata")}return c}),a}function J6(){var e=[Cn];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function RU(e){var t=[];if(!e)return t;var r=1;return(e.match(Qs)||[]).forEach(function(a){var n=wr(a);switch(n[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete n[0],n.i?r=n.i:n.i=r,t.push(n);break}}),t}function MU(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=vr(r);var a=e.read_shift(1);return a&2&&(t.l="1"),a&8&&(t.a="1"),t}function IU(e,t,r){var a=[];return Gc(e,function(s,o,c){switch(c){case 63:a.push(s);break;default:if(!o.T)throw new Error("Unexpected record 0x"+c.toString(16))}}),a}function BU(e,t,r,a){if(!e)return e;var n=a||{},s=!1;Gc(e,function(c,u,h){switch(h){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!u.T){if(!s||n.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}},n)}function UU(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var Z0=1024;function K6(e,t){for(var r=[21600,21600],a=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),n=[Mt("xml",null,{"xmlns:v":Yi.v,"xmlns:o":Yi.o,"xmlns:x":Yi.x,"xmlns:mv":Yi.mv}).replace(/\/>/,">"),Mt("o:shapelayout",Mt("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Mt("v:shapetype",[Mt("v:stroke",null,{joinstyle:"miter"}),Mt("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:a})];Z0<e*1e3;)Z0+=1e3;return t.forEach(function(s){var o=sn(s[0]),c={color2:"#BEFF82",type:"gradient"};c.type=="gradient"&&(c.angle="-180");var u=c.type=="gradient"?Mt("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,h=Mt("v:fill",u,c),p={on:"t",obscured:"t"};++Z0,n=n.concat(["<v:shape"+np({id:"_x0000_s"+Z0,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",h,Mt("v:shadow",null,p),Mt("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Ns("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),Ns("x:AutoFill","False"),Ns("x:Row",String(o.r)),Ns("x:Column",String(o.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),n.push("</xml>"),n.join("")}function fS(e,t,r,a){var n=Array.isArray(e),s;t.forEach(function(o){var c=sn(o.ref);if(n?(e[c.r]||(e[c.r]=[]),s=e[c.r][c.c]):s=e[o.ref],!s){s={t:"z"},n?e[c.r][c.c]=s:e[o.ref]=s;var u=aa(e["!ref"]||"BDWGO1000001:A1");u.s.r>c.r&&(u.s.r=c.r),u.e.r<c.r&&(u.e.r=c.r),u.s.c>c.c&&(u.s.c=c.c),u.e.c<c.c&&(u.e.c=c.c);var h=jr(u);h!==e["!ref"]&&(e["!ref"]=h)}s.c||(s.c=[]);var p={a:o.author,t:o.t,r:o.r,T:r};o.h&&(p.h=o.h);for(var x=s.c.length-1;x>=0;--x){if(!r&&s.c[x].T)return;r&&!s.c[x].T&&s.c.splice(x,1)}if(r&&a){for(x=0;x<a.length;++x)if(p.a==a[x].id){p.a=a[x].name||p.a;break}}s.c.push(p)})}function zU(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],a=[],n=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);n&&n[1]&&n[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var c=o.match(/<(?:\w+:)?author[^>]*>(.*)/);c&&r.push(c[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var c=o.match(/<(?:\w+:)?comment[^>]*>/);if(c){var u=wr(c[0]),h={author:u.authorId&&r[u.authorId]||"sheetjsghost",ref:u.ref,guid:u.guid},p=sn(u.ref);if(!(t.sheetRows&&t.sheetRows<=p.r)){var x=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),v=!!x&&!!x[1]&&Vy(x[1])||{r:"",t:"",h:""};h.r=v.r,v.r=="<t></t>"&&(v.t=v.h=""),h.t=(v.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(h.h=v.h),a.push(h)}}}}),a}function Z6(e){var t=[Cn,Mt("comments",null,{xmlns:t0[0]})],r=[];return t.push("<authors>"),e.forEach(function(a){a[1].forEach(function(n){var s=ya(n.a);r.indexOf(s)==-1&&(r.push(s),t.push("<author>"+s+"</author>")),n.T&&n.ID&&r.indexOf("tc="+n.ID)==-1&&(r.push("tc="+n.ID),t.push("<author>tc="+n.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(a){var n=0,s=[];if(a[1][0]&&a[1][0].T&&a[1][0].ID?n=r.indexOf("tc="+a[1][0].ID):a[1].forEach(function(u){u.a&&(n=r.indexOf(ya(u.a))),s.push(u.t||"")}),t.push('<comment ref="'+a[0]+'" authorId="'+n+'"><text>'),s.length<=1)t.push(Ns("t",ya(s[0]||"")));else{for(var o=`Comment:
    `+s[0]+`
`,c=1;c<s.length;++c)o+=`Reply:
    `+s[c]+`
`;t.push(Ns("t",ya(o)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function HU(e,t){var r=[],a=!1,n={},s=0;return e.replace(Qs,function(c,u){var h=wr(c);switch(Ql(h[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":n={author:h.personId,guid:h.id,ref:h.ref,T:1};break;case"</threadedComment>":n.t!=null&&r.push(n);break;case"<text>":case"<text":s=u+c.length;break;case"</text>":n.t=e.slice(s,u).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":a=!0;break;case"</mentions>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+h[0]+" in threaded comments")}return c}),r}function VU(e,t,r){var a=[Cn,Mt("ThreadedComments",null,{xmlns:Xn.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(n){var s="";(n[1]||[]).forEach(function(o,c){if(!o.T){delete o.ID;return}o.a&&t.indexOf(o.a)==-1&&t.push(o.a);var u={ref:n[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};c==0?s=u.id:u.parentId=s,o.ID=u.id,o.a&&(u.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),a.push(Mt("threadedComment",Ns("text",o.t||""),u))})}),a.push("</ThreadedComments>"),a.join("")}function qU(e,t){var r=[],a=!1;return e.replace(Qs,function(s){var o=wr(s);switch(Ql(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&t.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return s}),r}function GU(e){var t=[Cn,Mt("personList",null,{xmlns:Xn.TCMNT,"xmlns:x":t0[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,a){t.push(Mt("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+a).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function WU(e){var t={};t.iauthor=e.read_shift(4);var r=s0(e);return t.rfx=r.s,t.ref=vr(r.s),e.l+=16,t}function $U(e,t){return t==null&&(t=ht(36)),t.write_shift(4,e[1].iauthor),Nh(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var XU=Ks;function YU(e){return us(e.slice(0,54))}function JU(e,t){var r=[],a=[],n={},s=!1;return Gc(e,function(c,u,h){switch(h){case 632:a.push(c);break;case 635:n=c;break;case 637:n.t=c.t,n.h=c.h,n.r=c.r;break;case 636:if(n.author=a[n.iauthor],delete n.iauthor,t.sheetRows&&n.rfx&&t.sheetRows<=n.rfx.r)break;n.t||(n.t=""),delete n.rfx,r.push(n);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!u.T){if(!s||t.WTF)throw new Error("Unexpected record 0x"+h.toString(16))}}}),r}function KU(e){var t=ji(),r=[];return Nt(t,628),Nt(t,630),e.forEach(function(a){a[1].forEach(function(n){r.indexOf(n.a)>-1||(r.push(n.a.slice(0,54)),Nt(t,632,YU(n.a)))})}),Nt(t,631),Nt(t,633),e.forEach(function(a){a[1].forEach(function(n){n.iauthor=r.indexOf(n.a);var s={s:sn(a[0]),e:sn(a[0])};Nt(t,635,$U([s,n])),n.t&&n.t.length>0&&Nt(t,637,y9(n)),Nt(t,636),delete n.iauthor})}),Nt(t,634),Nt(t,629),t.end()}var ZU="application/vnd.ms-office.vbaProject";function QU(e){var t=cr.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,a){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var n=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");cr.utils.cfb_add(t,n,e.FileIndex[a].content)}}),cr.write(t)}function ez(e,t){t.FullPaths.forEach(function(r,a){if(a!=0){var n=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");n.slice(-1)!=="/"&&cr.utils.cfb_add(e,n,t.FileIndex[a].content)}})}var Q6=["xlsb","xlsm","xlam","biff8","xla"];function tz(){return{"!type":"dialog"}}function rz(){return{"!type":"dialog"}}function az(){return{"!type":"macro"}}function nz(){return{"!type":"macro"}}var ih=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(a,n,s,o){var c=!1,u=!1;s.length==0?u=!0:s.charAt(0)=="["&&(u=!0,s=s.slice(1,-1)),o.length==0?c=!0:o.charAt(0)=="["&&(c=!0,o=o.slice(1,-1));var h=s.length>0?parseInt(s,10)|0:0,p=o.length>0?parseInt(o,10)|0:0;return c?p+=t.c:--p,u?h+=t.r:--h,n+(c?"":"$")+nn(p)+(u?"":"$")+jn(h)}return function(n,s){return t=s,n.replace(e,r)}}(),$y=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Xy=function(){return function(t,r){return t.replace($y,function(a,n,s,o,c,u){var h=Ly(o)-(s?0:r.c),p=Py(u)-(c?0:r.r),x=p==0?"":c?p+1:"["+p+"]",v=h==0?"":s?h+1:"["+h+"]";return n+"R"+x+"C"+v})}}();function eT(e,t){return e.replace($y,function(r,a,n,s,o,c){return a+(n=="$"?n+s:nn(Ly(s)+t.c))+(o=="$"?o+c:jn(Py(c)+t.r))})}function sz(e,t,r){var a=Ci(t),n=a.s,s=sn(r),o={r:s.r-n.r,c:s.c-n.c};return eT(e,o)}function iz(e){return e.length!=1}function hS(e){return e.replace(/_xlfn\./g,"")}function Mn(e){e.l+=1}function Hu(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function tT(e,t,r){var a=2;if(r){if(r.biff>=2&&r.biff<=5)return rT(e);r.biff==12&&(a=4)}var n=e.read_shift(a),s=e.read_shift(a),o=Hu(e),c=Hu(e);return{s:{r:n,c:o[0],cRel:o[1],rRel:o[2]},e:{r:s,c:c[0],cRel:c[1],rRel:c[2]}}}function rT(e){var t=Hu(e),r=Hu(e),a=e.read_shift(1),n=e.read_shift(1);return{s:{r:t[0],c:a,cRel:t[1],rRel:t[2]},e:{r:r[0],c:n,cRel:r[1],rRel:r[2]}}}function oz(e,t,r){if(r.biff<8)return rT(e);var a=e.read_shift(r.biff==12?4:2),n=e.read_shift(r.biff==12?4:2),s=Hu(e),o=Hu(e);return{s:{r:a,c:s[0],cRel:s[1],rRel:s[2]},e:{r:n,c:o[0],cRel:o[1],rRel:o[2]}}}function aT(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return lz(e);var a=e.read_shift(r&&r.biff==12?4:2),n=Hu(e);return{r:a,c:n[0],cRel:n[1],rRel:n[2]}}function lz(e){var t=Hu(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function cz(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function uz(e,t,r){var a=r&&r.biff?r.biff:8;if(a>=2&&a<=5)return fz(e);var n=e.read_shift(a>=12?4:2),s=e.read_shift(2),o=(s&16384)>>14,c=(s&32768)>>15;if(s&=16383,c==1)for(;n>524287;)n-=1048576;if(o==1)for(;s>8191;)s=s-16384;return{r:n,c:s,cRel:o,rRel:c}}function fz(e){var t=e.read_shift(2),r=e.read_shift(1),a=(t&32768)>>15,n=(t&16384)>>14;return t&=16383,a==1&&t>=8192&&(t=t-16384),n==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:n,rRel:a}}function hz(e,t,r){var a=(e[e.l++]&96)>>5,n=tT(e,r.biff>=2&&r.biff<=5?6:8,r);return[a,n]}function dz(e,t,r){var a=(e[e.l++]&96)>>5,n=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var o=tT(e,s,r);return[a,n,o]}function pz(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[a]}function mz(e,t,r){var a=(e[e.l++]&96)>>5,n=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[a,n]}function xz(e,t,r){var a=(e[e.l++]&96)>>5,n=oz(e,t-1,r);return[a,n]}function gz(e,t,r){var a=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[a]}function dS(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function vz(e,t,r){e.l+=2;for(var a=e.read_shift(r&&r.biff==2?1:2),n=[],s=0;s<=a;++s)n.push(e.read_shift(r&&r.biff==2?1:2));return n}function yz(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function wz(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=2,[a,e.read_shift(r&&r.biff==2?1:2)]}function bz(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function Sz(e,t,r){var a=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[a]}function nT(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function Nz(e){return e.read_shift(2),nT(e)}function Az(e){return e.read_shift(2),nT(e)}function _z(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=aT(e,0,r);return[a,n]}function Tz(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=uz(e,0,r);return[a,n]}function kz(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=aT(e,0,r);return[a,n,s]}function Ez(e,t,r){var a=(e[e.l]&96)>>5;e.l+=1;var n=e.read_shift(r&&r.biff<=3?1:2);return[DH[n],oT[n],a]}function jz(e,t,r){var a=e[e.l++],n=e.read_shift(1),s=r&&r.biff<=3?[a==88?-1:0,e.read_shift(1)]:Cz(e);return[n,(s[0]===0?oT:CH)[s[1]]]}function Cz(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function Dz(e,t,r){e.l+=r&&r.biff==2?3:4}function Fz(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var a=e.read_shift(2),n=e.read_shift(r&&r.biff==2?1:2);return[a,n]}function Pz(e){return e.l++,Wc[e.read_shift(1)]}function Lz(e){return e.l++,e.read_shift(2)}function Oz(e){return e.l++,e.read_shift(1)!==0}function Rz(e){return e.l++,Ys(e)}function Mz(e,t,r){return e.l++,Sp(e,t-1,r)}function Iz(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=An(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=Wc[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=Ys(e);break;case 2:r[1]=i0(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function Bz(e,t,r){for(var a=e.read_shift(r.biff==12?4:2),n=[],s=0;s!=a;++s)n.push((r.biff==12?s0:tx)(e));return n}function Uz(e,t,r){var a=0,n=0;r.biff==12?(a=e.read_shift(4),n=e.read_shift(4)):(n=1+e.read_shift(1),a=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--a,--n==0&&(n=256));for(var s=0,o=[];s!=a&&(o[s]=[]);++s)for(var c=0;c!=n;++c)o[s][c]=Iz(e,r.biff);return o}function zz(e,t,r){var a=e.read_shift(1)>>>5&3,n=!r||r.biff>=8?4:2,s=e.read_shift(n);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[a,0,s]}function Hz(e,t,r){if(r.biff==5)return Vz(e);var a=e.read_shift(1)>>>5&3,n=e.read_shift(2),s=e.read_shift(4);return[a,n,s]}function Vz(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var a=e.read_shift(2);return e.l+=12,[t,r,a]}function qz(e,t,r){var a=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var n=e.read_shift(r&&r.biff==2?1:2);return[a,n]}function Gz(e,t,r){var a=e.read_shift(1)>>>5&3,n=e.read_shift(r&&r.biff==2?1:2);return[a,n]}function Wz(e,t,r){var a=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[a]}function $z(e,t,r){var a=(e[e.l++]&96)>>5,n=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[a,n]}var Xz=Zs,Yz=Zs,Jz=Zs;function Ap(e,t,r){return e.l+=2,[cz(e)]}function Yy(e){return e.l+=6,[]}var Kz=Ap,Zz=Yy,Qz=Yy,eH=Ap;function sT(e){return e.l+=2,[Bn(e),e.read_shift(2)&1]}var tH=Ap,rH=sT,aH=Yy,nH=Ap,sH=Ap,iH=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function oH(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),a=e.read_shift(4),n=e.read_shift(2),s=e.read_shift(2),o=iH[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:a,c:n,C:s}}function lH(e){return e.l+=2,[e.read_shift(4)]}function cH(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function uH(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function fH(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function hH(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function dH(e){return e.l+=4,[0,0]}var pS={1:{n:"PtgExp",f:Fz},2:{n:"PtgTbl",f:Jz},3:{n:"PtgAdd",f:Mn},4:{n:"PtgSub",f:Mn},5:{n:"PtgMul",f:Mn},6:{n:"PtgDiv",f:Mn},7:{n:"PtgPower",f:Mn},8:{n:"PtgConcat",f:Mn},9:{n:"PtgLt",f:Mn},10:{n:"PtgLe",f:Mn},11:{n:"PtgEq",f:Mn},12:{n:"PtgGe",f:Mn},13:{n:"PtgGt",f:Mn},14:{n:"PtgNe",f:Mn},15:{n:"PtgIsect",f:Mn},16:{n:"PtgUnion",f:Mn},17:{n:"PtgRange",f:Mn},18:{n:"PtgUplus",f:Mn},19:{n:"PtgUminus",f:Mn},20:{n:"PtgPercent",f:Mn},21:{n:"PtgParen",f:Mn},22:{n:"PtgMissArg",f:Mn},23:{n:"PtgStr",f:Mz},26:{n:"PtgSheet",f:cH},27:{n:"PtgEndSheet",f:uH},28:{n:"PtgErr",f:Pz},29:{n:"PtgBool",f:Oz},30:{n:"PtgInt",f:Lz},31:{n:"PtgNum",f:Rz},32:{n:"PtgArray",f:gz},33:{n:"PtgFunc",f:Ez},34:{n:"PtgFuncVar",f:jz},35:{n:"PtgName",f:zz},36:{n:"PtgRef",f:_z},37:{n:"PtgArea",f:hz},38:{n:"PtgMemArea",f:qz},39:{n:"PtgMemErr",f:Xz},40:{n:"PtgMemNoMem",f:Yz},41:{n:"PtgMemFunc",f:Gz},42:{n:"PtgRefErr",f:Wz},43:{n:"PtgAreaErr",f:pz},44:{n:"PtgRefN",f:Tz},45:{n:"PtgAreaN",f:xz},46:{n:"PtgMemAreaN",f:fH},47:{n:"PtgMemNoMemN",f:hH},57:{n:"PtgNameX",f:Hz},58:{n:"PtgRef3d",f:kz},59:{n:"PtgArea3d",f:dz},60:{n:"PtgRefErr3d",f:$z},61:{n:"PtgAreaErr3d",f:mz},255:{}},pH={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},mH={1:{n:"PtgElfLel",f:sT},2:{n:"PtgElfRw",f:nH},3:{n:"PtgElfCol",f:Kz},6:{n:"PtgElfRwV",f:sH},7:{n:"PtgElfColV",f:eH},10:{n:"PtgElfRadical",f:tH},11:{n:"PtgElfRadicalS",f:aH},13:{n:"PtgElfColS",f:Zz},15:{n:"PtgElfColSV",f:Qz},16:{n:"PtgElfRadicalLel",f:rH},25:{n:"PtgList",f:oH},29:{n:"PtgSxName",f:lH},255:{}},xH={0:{n:"PtgAttrNoop",f:dH},1:{n:"PtgAttrSemi",f:Sz},2:{n:"PtgAttrIf",f:wz},4:{n:"PtgAttrChoose",f:vz},8:{n:"PtgAttrGoto",f:yz},16:{n:"PtgAttrSum",f:Dz},32:{n:"PtgAttrBaxcel",f:dS},33:{n:"PtgAttrBaxcel",f:dS},64:{n:"PtgAttrSpace",f:Nz},65:{n:"PtgAttrSpaceSemi",f:Az},128:{n:"PtgAttrIfError",f:bz},255:{}};function _p(e,t,r,a){if(a.biff<8)return Zs(e,t);for(var n=e.l+t,s=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=Uz(e,0,a),s.push(r[o][1]);break;case"PtgMemArea":r[o][2]=Bz(e,r[o][1],a),s.push(r[o][2]);break;case"PtgExp":a&&a.biff==12&&(r[o][1][1]=e.read_shift(4),s.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=n-e.l,t!==0&&s.push(Zs(e,t)),s}function Tp(e,t,r){for(var a=e.l+t,n,s,o=[];a!=e.l;)t=a-e.l,s=e[e.l],n=pS[s]||pS[pH[s]],(s===24||s===25)&&(n=(s===24?mH:xH)[e[e.l+1]]),!n||!n.f?Zs(e,t):o.push([n.n,n.f(e,t,r)]);return o}function gH(e){for(var t=[],r=0;r<e.length;++r){for(var a=e[r],n=[],s=0;s<a.length;++s){var o=a[s];if(o)switch(o[0]){case 2:n.push('"'+o[1].replace(/"/g,'""')+'"');break;default:n.push(o[1])}else n.push("")}t.push(n.join(","))}return t.join(";")}var vH={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function yH(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function iT(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var a=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!a)return"SH33TJSERR1";var n="";if(r.biff>8)switch(e[a[0]][0]){case 357:return n=a[1]==-1?"#REF":e.SheetNames[a[1]],a[1]==a[2]?n:n+":"+e.SheetNames[a[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[a[0]][0];case 355:default:return"SH33TJSSRC"+e[a[0]][0]}switch(e[a[0]][0][0]){case 1025:return n=a[1]==-1?"#REF":e.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?n:n+":"+e.SheetNames[a[2]];case 14849:return e[a[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[a[0]][0][3]?(n=a[1]==-1?"#REF":e[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?n:n+":"+e[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function mS(e,t,r){var a=iT(e,t,r);return a=="#REF"?a:yH(a,r)}function Ws(e,t,r,a,n){var s=n&&n.biff||8,o={s:{c:0,r:0}},c=[],u,h,p,x=0,v=0,g,w="";if(!e[0]||!e[0][0])return"";for(var b=-1,N="",_=0,E=e[0].length;_<E;++_){var j=e[0][_];switch(j[0]){case"PtgUminus":c.push("-"+c.pop());break;case"PtgUplus":c.push("+"+c.pop());break;case"PtgPercent":c.push(c.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(u=c.pop(),h=c.pop(),b>=0){switch(e[0][b][1][0]){case 0:N=pn(" ",e[0][b][1][1]);break;case 1:N=pn("\r",e[0][b][1][1]);break;default:if(N="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][b][1][0])}h=h+N,b=-1}c.push(h+vH[j[0]]+u);break;case"PtgIsect":u=c.pop(),h=c.pop(),c.push(h+" "+u);break;case"PtgUnion":u=c.pop(),h=c.pop(),c.push(h+","+u);break;case"PtgRange":u=c.pop(),h=c.pop(),c.push(h+":"+u);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":p=Fd(j[1][1],o,n),c.push(Pd(p,s));break;case"PtgRefN":p=r?Fd(j[1][1],r,n):j[1][1],c.push(Pd(p,s));break;case"PtgRef3d":x=j[1][1],p=Fd(j[1][2],o,n),w=mS(a,x,n),c.push(w+"!"+Pd(p,s));break;case"PtgFunc":case"PtgFuncVar":var M=j[1][0],U=j[1][1];M||(M=0),M&=127;var V=M==0?[]:c.slice(-M);c.length-=M,U==="User"&&(U=V.shift()),c.push(U+"("+V.join(",")+")");break;case"PtgBool":c.push(j[1]?"TRUE":"FALSE");break;case"PtgInt":c.push(j[1]);break;case"PtgNum":c.push(String(j[1]));break;case"PtgStr":c.push('"'+j[1].replace(/"/g,'""')+'"');break;case"PtgErr":c.push(j[1]);break;case"PtgAreaN":g=q3(j[1][1],r?{s:r}:o,n),c.push(i2(g,n));break;case"PtgArea":g=q3(j[1][1],o,n),c.push(i2(g,n));break;case"PtgArea3d":x=j[1][1],g=j[1][2],w=mS(a,x,n),c.push(w+"!"+i2(g,n));break;case"PtgAttrSum":c.push("SUM("+c.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":v=j[1][2];var I=(a.names||[])[v-1]||(a[0]||[])[v],z=I?I.Name:"SH33TJSNAME"+String(v);z&&z.slice(0,6)=="_xlfn."&&!n.xlfn&&(z=z.slice(6)),c.push(z);break;case"PtgNameX":var H=j[1][1];v=j[1][2];var re;if(n.biff<=5)H<0&&(H=-H),a[H]&&(re=a[H][v]);else{var R="";if(((a[H]||[])[0]||[])[0]==14849||(((a[H]||[])[0]||[])[0]==1025?a[H][v]&&a[H][v].itab>0&&(R=a.SheetNames[a[H][v].itab-1]+"!"):R=a.SheetNames[v-1]+"!"),a[H]&&a[H][v])R+=a[H][v].Name;else if(a[0]&&a[0][v])R+=a[0][v].Name;else{var F=(iT(a,H,n)||"").split(";;");F[v-1]?R=F[v-1]:R+="SH33TJSERRX"}c.push(R);break}re||(re={Name:"SH33TJSERRY"}),c.push(re.Name);break;case"PtgParen":var Y="(",K=")";if(b>=0){switch(N="",e[0][b][1][0]){case 2:Y=pn(" ",e[0][b][1][1])+Y;break;case 3:Y=pn("\r",e[0][b][1][1])+Y;break;case 4:K=pn(" ",e[0][b][1][1])+K;break;case 5:K=pn("\r",e[0][b][1][1])+K;break;default:if(n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][b][1][0])}b=-1}c.push(Y+c.pop()+K);break;case"PtgRefErr":c.push("#REF!");break;case"PtgRefErr3d":c.push("#REF!");break;case"PtgExp":p={c:j[1][1],r:j[1][0]};var X={c:r.c,r:r.r};if(a.sharedf[vr(p)]){var Z=a.sharedf[vr(p)];c.push(Ws(Z,o,X,a,n))}else{var ce=!1;for(u=0;u!=a.arrayf.length;++u)if(h=a.arrayf[u],!(p.c<h[0].s.c||p.c>h[0].e.c)&&!(p.r<h[0].s.r||p.r>h[0].e.r)){c.push(Ws(h[1],o,X,a,n)),ce=!0;break}ce||c.push(j[1])}break;case"PtgArray":c.push("{"+gH(j[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":b=_;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":c.push("");break;case"PtgAreaErr":c.push("#REF!");break;case"PtgAreaErr3d":c.push("#REF!");break;case"PtgList":c.push("Table"+j[1].idx+"[#"+j[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(j));default:throw new Error("Unrecognized Formula Token: "+String(j))}var te=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(n.biff!=3&&b>=0&&te.indexOf(e[0][_][0])==-1){j=e[0][b];var Q=!0;switch(j[1][0]){case 4:Q=!1;case 0:N=pn(" ",j[1][1]);break;case 5:Q=!1;case 1:N=pn("\r",j[1][1]);break;default:if(N="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+j[1][0])}c.push((Q?N:"")+c.pop()+(Q?"":N)),b=-1}}if(c.length>1&&n.WTF)throw new Error("bad formula stack");return c[0]}function wH(e,t,r){var a=e.l+t,n=r.biff==2?1:2,s,o=e.read_shift(n);if(o==65535)return[[],Zs(e,t-2)];var c=Tp(e,o,r);return t!==o+n&&(s=_p(e,t-o-n,c,r)),e.l=a,[c,s]}function bH(e,t,r){var a=e.l+t,n=r.biff==2?1:2,s,o=e.read_shift(n);if(o==65535)return[[],Zs(e,t-2)];var c=Tp(e,o,r);return t!==o+n&&(s=_p(e,t-o-n,c,r)),e.l=a,[c,s]}function SH(e,t,r,a){var n=e.l+t,s=Tp(e,a,r),o;return n!==e.l&&(o=_p(e,n-e.l,s,r)),[s,o]}function NH(e,t,r){var a=e.l+t,n,s=e.read_shift(2),o=Tp(e,s,r);return s==65535?[[],Zs(e,t-2)]:(t!==s+2&&(n=_p(e,a-s-2,o,r)),[o,n])}function AH(e){var t;if(Dc(e,e.l+6)!==65535)return[Ys(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function _H(e){if(e==null){var t=ht(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return $f(e);return $f(0)}function f2(e,t,r){var a=e.l+t,n=ec(e);r.biff==2&&++e.l;var s=AH(e),o=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var c=bH(e,a-e.l,r);return{cell:n,val:s[0],formula:c,shared:o>>3&1,tt:s[1]}}function TH(e,t,r,a,n){var s=Yf(t,r,n),o=_H(e.v),c=ht(6),u=33;c.write_shift(2,u),c.write_shift(4,0);for(var h=ht(e.bf.length),p=0;p<e.bf.length;++p)h[p]=e.bf[p];var x=cs([s,o,c,h]);return x}function rx(e,t,r){var a=e.read_shift(4),n=Tp(e,a,r),s=e.read_shift(4),o=s>0?_p(e,s,n,r):null;return[n,o]}var kH=rx,ax=rx,EH=rx,jH=rx,CH={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},oT={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},DH={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function xS(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function FH(e){var t="of:="+e.replace($y,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function h2(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function PH(e){return e.replace(/\./,"!")}var Od={},oh={},Rd=typeof Map<"u";function Jy(e,t,r){var a=0,n=e.length;if(r){if(Rd?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var s=Rd?r.get(t):r[t];a<s.length;++a)if(e[s[a]].t===t)return e.Count++,s[a]}}else for(;a<n;++a)if(e[a].t===t)return e.Count++,a;return e[n]={t},e.Count++,e.Unique++,r&&(Rd?(r.has(t)||r.set(t,[]),r.get(t).push(n)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(n))),n}function nx(e,t){var r={min:e+1,max:e+1},a=-1;return t.MDW&&($s=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?a=cp(t.wpx):t.wch!=null&&(a=t.wch),a>-1?(r.width=D1(a),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function Uf(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function $u(e,t,r){var a=r.revssf[t.z!=null?t.z:"General"],n=60,s=e.length;if(a==null&&r.ssf){for(;n<392;++n)if(r.ssf[n]==null){Rc(t.z,n),r.ssf[n]=t.z,r.revssf[t.z]=a=n;break}}for(n=0;n!=s;++n)if(e[n].numFmtId===a)return n;return e[s]={numFmtId:a,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function lT(e,t,r,a,n,s){try{a.cellNF&&(e.z=xr[t])}catch(c){if(a.WTF)throw c}if(!(e.t==="z"&&!a.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Ha(e.v)),(!a||a.cellText!==!1)&&e.t!=="z")try{if(xr[t]==null&&Rc(CR[t]||"General",t),e.t==="e")e.w=e.w||Wc[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=rp(e.v);else if(e.t==="d"){var o=Yn(e.v);(o|0)===o?e.w=o.toString(10):e.w=rp(o)}else{if(e.v===void 0)return"";e.w=Gf(e.v,oh)}else e.t==="d"?e.w=Co(t,Yn(e.v),oh):e.w=Co(t,e.v,oh)}catch(c){if(a.WTF)throw c}if(a.cellStyles&&r!=null)try{e.s=s.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=C1(n.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),a.WTF&&(e.s.fgColor.raw_rgb=n.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=C1(n.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),a.WTF&&(e.s.bgColor.raw_rgb=n.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(c){if(a.WTF&&s.Fills)throw c}}}function LH(e,t,r){if(e&&e["!ref"]){var a=aa(e["!ref"]);if(a.e.c<a.s.c||a.e.r<a.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function OH(e,t){var r=aa(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=jr(r))}var RH=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,MH=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,IH=/<(?:\w:)?hyperlink [^>]*>/mg,BH=/"(\w*:\w*)"/,UH=/<(?:\w:)?col\b[^>]*[\/]?>/g,zH=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,HH=/<(?:\w:)?pageMargins[^>]*\/>/g,cT=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,VH=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,qH=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function GH(e,t,r,a,n,s,o){if(!e)return e;a||(a={"!id":{}});var c=t.dense?[]:{},u={s:{r:2e6,c:2e6},e:{r:0,c:0}},h="",p="",x=e.match(MH);x?(h=e.slice(0,x.index),p=e.slice(x.index+x[0].length)):h=p=e;var v=h.match(cT);v?Ky(v[0],c,n,r):(v=h.match(VH))&&$H(v[0],v[1]||"",c,n,r);var g=(h.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(g>0){var w=h.slice(g,g+50).match(BH);w&&OH(c,w[1])}var b=h.match(qH);b&&b[1]&&iV(b[1],n);var N=[];if(t.cellStyles){var _=h.match(UH);_&&tV(N,_)}x&&cV(x[1],c,t,u,s,o);var E=p.match(zH);E&&(c["!autofilter"]=aV(E[0]));var j=[],M=p.match(RH);if(M)for(g=0;g!=M.length;++g)j[g]=aa(M[g].slice(M[g].indexOf('"')+1));var U=p.match(IH);U&&ZH(c,U,a);var V=p.match(HH);if(V&&(c["!margins"]=QH(wr(V[0]))),!c["!ref"]&&u.e.c>=u.s.c&&u.e.r>=u.s.r&&(c["!ref"]=jr(u)),t.sheetRows>0&&c["!ref"]){var I=aa(c["!ref"]);t.sheetRows<=+I.e.r&&(I.e.r=t.sheetRows-1,I.e.r>u.e.r&&(I.e.r=u.e.r),I.e.r<I.s.r&&(I.s.r=I.e.r),I.e.c>u.e.c&&(I.e.c=u.e.c),I.e.c<I.s.c&&(I.s.c=I.e.c),c["!fullref"]=c["!ref"],c["!ref"]=jr(I))}return N.length>0&&(c["!cols"]=N),j.length>0&&(c["!merges"]=j),c}function WH(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+jr(e[r])+'"/>';return t+"</mergeCells>"}function Ky(e,t,r,a){var n=wr(e);r.Sheets[a]||(r.Sheets[a]={}),n.codeName&&(r.Sheets[a].CodeName=ra(Na(n.codeName)))}function $H(e,t,r,a,n){Ky(e.slice(0,e.indexOf(">")),r,a,n)}function XH(e,t,r,a,n){var s=!1,o={},c=null;if(a.bookType!=="xlsx"&&t.vbaraw){var u=t.SheetNames[r];try{t.Workbook&&(u=t.Workbook.Sheets[r].CodeName||u)}catch{}s=!0,o.codeName=Gl(ya(u))}if(e&&e["!outline"]){var h={summaryBelow:1,summaryRight:1};e["!outline"].above&&(h.summaryBelow=0),e["!outline"].left&&(h.summaryRight=0),c=(c||"")+Mt("outlinePr",null,h)}!s&&!c||(n[n.length]=Mt("sheetPr",c,o))}var YH=["objects","scenarios","selectLockedCells","selectUnlockedCells"],JH=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function KH(e){var t={sheet:1};return YH.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),JH.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=qy(e.password).toString(16).toUpperCase()),Mt("sheetProtection",null,t)}function ZH(e,t,r){for(var a=Array.isArray(e),n=0;n!=t.length;++n){var s=wr(Na(t[n]),!0);if(!s.ref)return;var o=((r||{})["!id"]||[])[s.id];o?(s.Target=o.Target,s.location&&(s.Target+="#"+ra(s.location))):(s.Target="#"+ra(s.location),o={Target:s.Target,TargetMode:"Internal"}),s.Rel=o,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var c=aa(s.ref),u=c.s.r;u<=c.e.r;++u)for(var h=c.s.c;h<=c.e.c;++h){var p=vr({c:h,r:u});a?(e[u]||(e[u]=[]),e[u][h]||(e[u][h]={t:"z",v:void 0}),e[u][h].l=s):(e[p]||(e[p]={t:"z",v:void 0}),e[p].l=s)}}}function QH(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function eV(e){return Uf(e),Mt("pageMargins",null,e)}function tV(e,t){for(var r=!1,a=0;a!=t.length;++a){var n=wr(t[a],!0);n.hidden&&(n.hidden=Ua(n.hidden));var s=parseInt(n.min,10)-1,o=parseInt(n.max,10)-1;for(n.outlineLevel&&(n.level=+n.outlineLevel||0),delete n.min,delete n.max,n.width=+n.width,!r&&n.width&&(r=!0,Gy(n.width)),zu(n);s<=o;)e[s++]=Va(n)}}function rV(e,t){for(var r=["<cols>"],a,n=0;n!=t.length;++n)(a=t[n])&&(r[r.length]=Mt("col",null,nx(n,a)));return r[r.length]="</cols>",r.join("")}function aV(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function nV(e,t,r,a){var n=typeof e.ref=="string"?e.ref:jr(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,o=Ci(n);o.s.r==o.e.r&&(o.e.r=Ci(t["!ref"]).e.r,n=jr(o));for(var c=0;c<s.length;++c){var u=s[c];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==a){u.Ref="'"+r.SheetNames[a]+"'!"+n;break}}return c==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+n}),Mt("autoFilter",null,{ref:n})}var sV=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function iV(e,t){t.Views||(t.Views=[{}]),(e.match(sV)||[]).forEach(function(r,a){var n=wr(r);t.Views[a]||(t.Views[a]={}),+n.zoomScale&&(t.Views[a].zoom=+n.zoomScale),Ua(n.rightToLeft)&&(t.Views[a].RTL=!0)})}function oV(e,t,r,a){var n={workbookViewId:"0"};return(((a||{}).Workbook||{}).Views||[])[0]&&(n.rightToLeft=a.Workbook.Views[0].RTL?"1":"0"),Mt("sheetViews",Mt("sheetView",null,n),{})}function lV(e,t,r,a){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var n="",s=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":n=e.v?"1":"0";break;case"n":n=""+e.v;break;case"e":n=Wc[e.v];break;case"d":a&&a.cellDates?n=Ha(e.v,-1).toISOString():(e=Va(e),e.t="n",n=""+(e.v=Yn(Ha(e.v)))),typeof e.z>"u"&&(e.z=xr[14]);break;default:n=e.v;break}var c=Ns("v",ya(n)),u={r:t},h=$u(a.cellXfs,e,a);switch(h!==0&&(u.s=h),e.t){case"n":break;case"d":u.t="d";break;case"b":u.t="b";break;case"e":u.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(a&&a.bookSST){c=Ns("v",""+Jy(a.Strings,e.v,a.revStrings)),u.t="s";break}u.t="str";break}if(e.t!=s&&(e.t=s,e.v=o),typeof e.f=="string"&&e.f){var p=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;c=Mt("f",ya(e.f),p)+(e.v!=null?c:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(u.cm=1),Mt("c",c,u)}var cV=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,a=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,n=/ref=["']([^"']*)["']/,s=ap("v"),o=ap("f");return function(u,h,p,x,v,g){for(var w=0,b="",N=[],_=[],E=0,j=0,M=0,U="",V,I,z=0,H=0,re,R,F=0,Y=0,K=Array.isArray(g.CellXf),X,Z=[],ce=[],te=Array.isArray(h),Q=[],G={},ye=!1,D=!!p.sheetStubs,O=u.split(t),L=0,q=O.length;L!=q;++L){b=O[L].trim();var oe=b.length;if(oe!==0){var be=0;e:for(w=0;w<oe;++w)switch(b[w]){case">":if(b[w-1]!="/"){++w;break e}if(p&&p.cellStyles){if(I=wr(b.slice(be,w),!0),z=I.r!=null?parseInt(I.r,10):z+1,H=-1,p.sheetRows&&p.sheetRows<z)continue;G={},ye=!1,I.ht&&(ye=!0,G.hpt=parseFloat(I.ht),G.hpx=ph(G.hpt)),I.hidden=="1"&&(ye=!0,G.hidden=!0),I.outlineLevel!=null&&(ye=!0,G.level=+I.outlineLevel),ye&&(Q[z-1]=G)}break;case"<":be=w;break}if(be>=w)break;if(I=wr(b.slice(be,w),!0),z=I.r!=null?parseInt(I.r,10):z+1,H=-1,!(p.sheetRows&&p.sheetRows<z)){x.s.r>z-1&&(x.s.r=z-1),x.e.r<z-1&&(x.e.r=z-1),p&&p.cellStyles&&(G={},ye=!1,I.ht&&(ye=!0,G.hpt=parseFloat(I.ht),G.hpx=ph(G.hpt)),I.hidden=="1"&&(ye=!0,G.hidden=!0),I.outlineLevel!=null&&(ye=!0,G.level=+I.outlineLevel),ye&&(Q[z-1]=G)),N=b.slice(w).split(e);for(var ve=0;ve!=N.length&&N[ve].trim().charAt(0)=="<";++ve);for(N=N.slice(ve),w=0;w!=N.length;++w)if(b=N[w].trim(),b.length!==0){if(_=b.match(r),E=w,j=0,M=0,b="<c "+(b.slice(0,1)=="<"?">":"")+b,_!=null&&_.length===2){for(E=0,U=_[1],j=0;j!=U.length&&!((M=U.charCodeAt(j)-64)<1||M>26);++j)E=26*E+M;--E,H=E}else++H;for(j=0;j!=b.length&&b.charCodeAt(j)!==62;++j);if(++j,I=wr(b.slice(0,j),!0),I.r||(I.r=vr({r:z-1,c:H})),U=b.slice(j),V={t:""},(_=U.match(s))!=null&&_[1]!==""&&(V.v=ra(_[1])),p.cellFormula){if((_=U.match(o))!=null&&_[1]!==""){if(V.f=ra(Na(_[1])).replace(/\r\n/g,`
`),p.xlfn||(V.f=hS(V.f)),_[0].indexOf('t="array"')>-1)V.F=(U.match(n)||[])[1],V.F.indexOf(":")>-1&&Z.push([aa(V.F),V.F]);else if(_[0].indexOf('t="shared"')>-1){R=wr(_[0]);var ue=ra(Na(_[1]));p.xlfn||(ue=hS(ue)),ce[parseInt(R.si,10)]=[R,ue,I.r]}}else(_=U.match(/<f[^>]*\/>/))&&(R=wr(_[0]),ce[R.si]&&(V.f=sz(ce[R.si][1],ce[R.si][2],I.r)));var fe=sn(I.r);for(j=0;j<Z.length;++j)fe.r>=Z[j][0].s.r&&fe.r<=Z[j][0].e.r&&fe.c>=Z[j][0].s.c&&fe.c<=Z[j][0].e.c&&(V.F=Z[j][1])}if(I.t==null&&V.v===void 0)if(V.f||V.F)V.v=0,V.t="n";else if(D)V.t="z";else continue;else V.t=I.t||"n";switch(x.s.c>H&&(x.s.c=H),x.e.c<H&&(x.e.c=H),V.t){case"n":if(V.v==""||V.v==null){if(!D)continue;V.t="z"}else V.v=parseFloat(V.v);break;case"s":if(typeof V.v>"u"){if(!D)continue;V.t="z"}else re=Od[parseInt(V.v,10)],V.v=re.t,V.r=re.r,p.cellHTML&&(V.h=re.h);break;case"str":V.t="s",V.v=V.v!=null?Na(V.v):"",p.cellHTML&&(V.h=jy(V.v));break;case"inlineStr":_=U.match(a),V.t="s",_!=null&&(re=Vy(_[1]))?(V.v=re.t,p.cellHTML&&(V.h=re.h)):V.v="";break;case"b":V.v=Ua(V.v);break;case"d":p.cellDates?V.v=Ha(V.v,1):(V.v=Yn(Ha(V.v,1)),V.t="n");break;case"e":(!p||p.cellText!==!1)&&(V.w=V.v),V.v=f6[V.v];break}if(F=Y=0,X=null,K&&I.s!==void 0&&(X=g.CellXf[I.s],X!=null&&(X.numFmtId!=null&&(F=X.numFmtId),p.cellStyles&&X.fillId!=null&&(Y=X.fillId))),lT(V,F,Y,p,v,g),p.cellDates&&K&&V.t=="n"&&wh(xr[F])&&(V.t="d",V.v=ex(V.v)),I.cm&&p.xlmeta){var Ee=(p.xlmeta.Cell||[])[+I.cm-1];Ee&&Ee.type=="XLDAPR"&&(V.D=!0)}if(te){var J=sn(I.r);h[J.r]||(h[J.r]=[]),h[J.r][J.c]=V}else h[I.r]=V}}}}Q.length>0&&(h["!rows"]=Q)}}();function uV(e,t,r,a){var n=[],s=[],o=aa(e["!ref"]),c="",u,h="",p=[],x=0,v=0,g=e["!rows"],w=Array.isArray(e),b={r:h},N,_=-1;for(v=o.s.c;v<=o.e.c;++v)p[v]=nn(v);for(x=o.s.r;x<=o.e.r;++x){for(s=[],h=jn(x),v=o.s.c;v<=o.e.c;++v){u=p[v]+h;var E=w?(e[x]||[])[v]:e[u];E!==void 0&&(c=lV(E,u,e,t))!=null&&s.push(c)}(s.length>0||g&&g[x])&&(b={r:h},g&&g[x]&&(N=g[x],N.hidden&&(b.hidden=1),_=-1,N.hpx?_=up(N.hpx):N.hpt&&(_=N.hpt),_>-1&&(b.ht=_,b.customHeight=1),N.level&&(b.outlineLevel=N.level)),n[n.length]=Mt("row",s.join(""),b))}if(g)for(;x<g.length;++x)g&&g[x]&&(b={r:x+1},N=g[x],N.hidden&&(b.hidden=1),_=-1,N.hpx?_=up(N.hpx):N.hpt&&(_=N.hpt),_>-1&&(b.ht=_,b.customHeight=1),N.level&&(b.outlineLevel=N.level),n[n.length]=Mt("row","",b));return n.join("")}function uT(e,t,r,a){var n=[Cn,Mt("worksheet",null,{xmlns:t0[0],"xmlns:r":Xn.r})],s=r.SheetNames[e],o=0,c="",u=r.Sheets[s];u==null&&(u={});var h=u["!ref"]||"A1",p=aa(h);if(p.e.c>16383||p.e.r>1048575){if(t.WTF)throw new Error("Range "+h+" exceeds format limit A1:XFD1048576");p.e.c=Math.min(p.e.c,16383),p.e.r=Math.min(p.e.c,1048575),h=jr(p)}a||(a={}),u["!comments"]=[];var x=[];XH(u,r,e,t,n),n[n.length]=Mt("dimension",null,{ref:h}),n[n.length]=oV(u,t,e,r),t.sheetFormat&&(n[n.length]=Mt("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),u["!cols"]!=null&&u["!cols"].length>0&&(n[n.length]=rV(u,u["!cols"])),n[o=n.length]="<sheetData/>",u["!links"]=[],u["!ref"]!=null&&(c=uV(u,t),c.length>0&&(n[n.length]=c)),n.length>o+1&&(n[n.length]="</sheetData>",n[o]=n[o].replace("/>",">")),u["!protect"]&&(n[n.length]=KH(u["!protect"])),u["!autofilter"]!=null&&(n[n.length]=nV(u["!autofilter"],u,r,e)),u["!merges"]!=null&&u["!merges"].length>0&&(n[n.length]=WH(u["!merges"]));var v=-1,g,w=-1;return u["!links"].length>0&&(n[n.length]="<hyperlinks>",u["!links"].forEach(function(b){b[1].Target&&(g={ref:b[0]},b[1].Target.charAt(0)!="#"&&(w=ga(a,-1,ya(b[1].Target).replace(/#.*$/,""),Hr.HLINK),g["r:id"]="rId"+w),(v=b[1].Target.indexOf("#"))>-1&&(g.location=ya(b[1].Target.slice(v+1))),b[1].Tooltip&&(g.tooltip=ya(b[1].Tooltip)),n[n.length]=Mt("hyperlink",null,g))}),n[n.length]="</hyperlinks>"),delete u["!links"],u["!margins"]!=null&&(n[n.length]=eV(u["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(n[n.length]=Ns("ignoredErrors",Mt("ignoredError",null,{numberStoredAsText:1,sqref:h}))),x.length>0&&(w=ga(a,-1,"../drawings/drawing"+(e+1)+".xml",Hr.DRAW),n[n.length]=Mt("drawing",null,{"r:id":"rId"+w}),u["!drawing"]=x),u["!comments"].length>0&&(w=ga(a,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Hr.VML),n[n.length]=Mt("legacyDrawing",null,{"r:id":"rId"+w}),u["!legacy"]=w),n.length>1&&(n[n.length]="</worksheet>",n[1]=n[1].replace("/>",">")),n.join("")}function fV(e,t){var r={},a=e.l+t;r.r=e.read_shift(4),e.l+=4;var n=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=a,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=n/20),r}function hV(e,t,r){var a=ht(145),n=(r["!rows"]||[])[e]||{};a.write_shift(4,e),a.write_shift(4,0);var s=320;n.hpx?s=up(n.hpx)*20:n.hpt&&(s=n.hpt*20),a.write_shift(2,s),a.write_shift(1,0);var o=0;n.level&&(o|=n.level),n.hidden&&(o|=16),(n.hpx||n.hpt)&&(o|=32),a.write_shift(1,o),a.write_shift(1,0);var c=0,u=a.l;a.l+=4;for(var h={r:e,c:0},p=0;p<16;++p)if(!(t.s.c>p+1<<10||t.e.c<p<<10)){for(var x=-1,v=-1,g=p<<10;g<p+1<<10;++g){h.c=g;var w=Array.isArray(r)?(r[h.r]||[])[h.c]:r[vr(h)];w&&(x<0&&(x=g),v=g)}x<0||(++c,a.write_shift(4,x),a.write_shift(4,v))}var b=a.l;return a.l=u,a.write_shift(4,c),a.l=b,a.length>a.l?a.slice(0,a.l):a}function dV(e,t,r,a){var n=hV(a,r,t);(n.length>17||(t["!rows"]||[])[a])&&Nt(e,0,n)}var pV=s0,mV=Nh;function xV(){}function gV(e,t){var r={},a=e[e.l];return++e.l,r.above=!(a&64),r.left=!(a&128),e.l+=18,r.name=w9(e),r}function vV(e,t,r){r==null&&(r=ht(84+4*e.length));var a=192;t&&(t.above&&(a&=-65),t.left&&(a&=-129)),r.write_shift(1,a);for(var n=1;n<3;++n)r.write_shift(1,0);return k1({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),i6(e,r),r.slice(0,r.l)}function yV(e){var t=Do(e);return[t]}function wV(e,t,r){return r==null&&(r=ht(8)),r0(t,r)}function bV(e){var t=a0(e);return[t]}function SV(e,t,r){return r==null&&(r=ht(4)),n0(t,r)}function NV(e){var t=Do(e),r=e.read_shift(1);return[t,r,"b"]}function AV(e,t,r){return r==null&&(r=ht(9)),r0(t,r),r.write_shift(1,e.v?1:0),r}function _V(e){var t=a0(e),r=e.read_shift(1);return[t,r,"b"]}function TV(e,t,r){return r==null&&(r=ht(5)),n0(t,r),r.write_shift(1,e.v?1:0),r}function kV(e){var t=Do(e),r=e.read_shift(1);return[t,r,"e"]}function EV(e,t,r){return r==null&&(r=ht(9)),r0(t,r),r.write_shift(1,e.v),r}function jV(e){var t=a0(e),r=e.read_shift(1);return[t,r,"e"]}function CV(e,t,r){return r==null&&(r=ht(8)),n0(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function DV(e){var t=Do(e),r=e.read_shift(4);return[t,r,"s"]}function FV(e,t,r){return r==null&&(r=ht(12)),r0(t,r),r.write_shift(4,t.v),r}function PV(e){var t=a0(e),r=e.read_shift(4);return[t,r,"s"]}function LV(e,t,r){return r==null&&(r=ht(8)),n0(t,r),r.write_shift(4,t.v),r}function OV(e){var t=Do(e),r=Ys(e);return[t,r,"n"]}function RV(e,t,r){return r==null&&(r=ht(16)),r0(t,r),$f(e.v,r),r}function fT(e){var t=a0(e),r=Ys(e);return[t,r,"n"]}function MV(e,t,r){return r==null&&(r=ht(12)),n0(t,r),$f(e.v,r),r}function IV(e){var t=Do(e),r=Iy(e);return[t,r,"n"]}function BV(e,t,r){return r==null&&(r=ht(12)),r0(t,r),o6(e.v,r),r}function UV(e){var t=a0(e),r=Iy(e);return[t,r,"n"]}function zV(e,t,r){return r==null&&(r=ht(8)),n0(t,r),o6(e.v,r),r}function HV(e){var t=Do(e),r=Oy(e);return[t,r,"is"]}function VV(e){var t=Do(e),r=Ks(e);return[t,r,"str"]}function qV(e,t,r){return r==null&&(r=ht(12+4*e.v.length)),r0(t,r),us(e.v,r),r.length>r.l?r.slice(0,r.l):r}function GV(e){var t=a0(e),r=Ks(e);return[t,r,"str"]}function WV(e,t,r){return r==null&&(r=ht(8+4*e.v.length)),n0(t,r),us(e.v,r),r.length>r.l?r.slice(0,r.l):r}function $V(e,t,r){var a=e.l+t,n=Do(e);n.r=r["!row"];var s=e.read_shift(1),o=[n,s,"b"];if(r.cellFormula){e.l+=2;var c=ax(e,a-e.l,r);o[3]=Ws(c,null,n,r.supbooks,r)}else e.l=a;return o}function XV(e,t,r){var a=e.l+t,n=Do(e);n.r=r["!row"];var s=e.read_shift(1),o=[n,s,"e"];if(r.cellFormula){e.l+=2;var c=ax(e,a-e.l,r);o[3]=Ws(c,null,n,r.supbooks,r)}else e.l=a;return o}function YV(e,t,r){var a=e.l+t,n=Do(e);n.r=r["!row"];var s=Ys(e),o=[n,s,"n"];if(r.cellFormula){e.l+=2;var c=ax(e,a-e.l,r);o[3]=Ws(c,null,n,r.supbooks,r)}else e.l=a;return o}function JV(e,t,r){var a=e.l+t,n=Do(e);n.r=r["!row"];var s=Ks(e),o=[n,s,"str"];if(r.cellFormula){e.l+=2;var c=ax(e,a-e.l,r);o[3]=Ws(c,null,n,r.supbooks,r)}else e.l=a;return o}var KV=s0,ZV=Nh;function QV(e,t){return t==null&&(t=ht(4)),t.write_shift(4,e),t}function eq(e,t){var r=e.l+t,a=s0(e),n=Ry(e),s=Ks(e),o=Ks(e),c=Ks(e);e.l=r;var u={rfx:a,relId:n,loc:s,display:c};return o&&(u.Tooltip=o),u}function tq(e,t){var r=ht(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Nh({s:sn(e[0]),e:sn(e[0])},r),My("rId"+t,r);var a=e[1].Target.indexOf("#"),n=a==-1?"":e[1].Target.slice(a+1);return us(n||"",r),us(e[1].Tooltip||"",r),us("",r),r.slice(0,r.l)}function rq(){}function aq(e,t,r){var a=e.l+t,n=l6(e),s=e.read_shift(1),o=[n];if(o[2]=s,r.cellFormula){var c=kH(e,a-e.l,r);o[1]=c}else e.l=a;return o}function nq(e,t,r){var a=e.l+t,n=s0(e),s=[n];if(r.cellFormula){var o=jH(e,a-e.l,r);s[1]=o,e.l=a}else e.l=a;return s}function sq(e,t,r){r==null&&(r=ht(18));var a=nx(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(a.width||10)*256),r.write_shift(4,0);var n=0;return t.hidden&&(n|=1),typeof a.width=="number"&&(n|=2),t.level&&(n|=t.level<<8),r.write_shift(2,n),r}var hT=["left","right","top","bottom","header","footer"];function iq(e){var t={};return hT.forEach(function(r){t[r]=Ys(e)}),t}function oq(e,t){return t==null&&(t=ht(6*8)),Uf(e),hT.forEach(function(r){$f(e[r],t)}),t}function lq(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function cq(e,t,r){r==null&&(r=ht(30));var a=924;return(((t||{}).Views||[])[0]||{}).RTL&&(a|=32),r.write_shift(2,a),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function uq(e){var t=ht(24);return t.write_shift(4,4),t.write_shift(4,1),Nh(e,t),t}function fq(e,t){return t==null&&(t=ht(16*4+2)),t.write_shift(2,e.password?qy(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function hq(){}function dq(){}function pq(e,t,r,a,n,s,o){if(!e)return e;var c=t||{};a||(a={"!id":{}});var u=c.dense?[]:{},h,p={s:{r:2e6,c:2e6},e:{r:0,c:0}},x=!1,v=!1,g,w,b,N,_,E,j,M,U,V=[];c.biff=12,c["!row"]=0;var I=0,z=!1,H=[],re={},R=c.supbooks||n.supbooks||[[]];if(R.sharedf=re,R.arrayf=H,R.SheetNames=n.SheetNames||n.Sheets.map(function(te){return te.name}),!c.supbooks&&(c.supbooks=R,n.Names))for(var F=0;F<n.Names.length;++F)R[0][F+1]=n.Names[F];var Y=[],K=[],X=!1;fp[16]={n:"BrtShortReal",f:fT};var Z;if(Gc(e,function(Q,G,ye){if(!v)switch(ye){case 148:h=Q;break;case 0:g=Q,c.sheetRows&&c.sheetRows<=g.r&&(v=!0),M=jn(N=g.r),c["!row"]=g.r,(Q.hidden||Q.hpt||Q.level!=null)&&(Q.hpt&&(Q.hpx=ph(Q.hpt)),K[Q.r]=Q);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(w={t:Q[2]},Q[2]){case"n":w.v=Q[1];break;case"s":j=Od[Q[1]],w.v=j.t,w.r=j.r;break;case"b":w.v=!!Q[1];break;case"e":w.v=Q[1],c.cellText!==!1&&(w.w=Wc[w.v]);break;case"str":w.t="s",w.v=Q[1];break;case"is":w.t="s",w.v=Q[1].t;break}if((b=o.CellXf[Q[0].iStyleRef])&&lT(w,b.numFmtId,null,c,s,o),_=Q[0].c==-1?_+1:Q[0].c,c.dense?(u[N]||(u[N]=[]),u[N][_]=w):u[nn(_)+M]=w,c.cellFormula){for(z=!1,I=0;I<H.length;++I){var D=H[I];g.r>=D[0].s.r&&g.r<=D[0].e.r&&_>=D[0].s.c&&_<=D[0].e.c&&(w.F=jr(D[0]),z=!0)}!z&&Q.length>3&&(w.f=Q[3])}if(p.s.r>g.r&&(p.s.r=g.r),p.s.c>_&&(p.s.c=_),p.e.r<g.r&&(p.e.r=g.r),p.e.c<_&&(p.e.c=_),c.cellDates&&b&&w.t=="n"&&wh(xr[b.numFmtId])){var O=Pf(w.v);O&&(w.t="d",w.v=new Date(O.y,O.m-1,O.d,O.H,O.M,O.S,O.u))}Z&&(Z.type=="XLDAPR"&&(w.D=!0),Z=void 0);break;case 1:case 12:if(!c.sheetStubs||x)break;w={t:"z",v:void 0},_=Q[0].c==-1?_+1:Q[0].c,c.dense?(u[N]||(u[N]=[]),u[N][_]=w):u[nn(_)+M]=w,p.s.r>g.r&&(p.s.r=g.r),p.s.c>_&&(p.s.c=_),p.e.r<g.r&&(p.e.r=g.r),p.e.c<_&&(p.e.c=_),Z&&(Z.type=="XLDAPR"&&(w.D=!0),Z=void 0);break;case 176:V.push(Q);break;case 49:Z=((c.xlmeta||{}).Cell||[])[Q-1];break;case 494:var L=a["!id"][Q.relId];for(L?(Q.Target=L.Target,Q.loc&&(Q.Target+="#"+Q.loc),Q.Rel=L):Q.relId==""&&(Q.Target="#"+Q.loc),N=Q.rfx.s.r;N<=Q.rfx.e.r;++N)for(_=Q.rfx.s.c;_<=Q.rfx.e.c;++_)c.dense?(u[N]||(u[N]=[]),u[N][_]||(u[N][_]={t:"z",v:void 0}),u[N][_].l=Q):(E=vr({c:_,r:N}),u[E]||(u[E]={t:"z",v:void 0}),u[E].l=Q);break;case 426:if(!c.cellFormula)break;H.push(Q),U=c.dense?u[N][_]:u[nn(_)+M],U.f=Ws(Q[1],p,{r:g.r,c:_},R,c),U.F=jr(Q[0]);break;case 427:if(!c.cellFormula)break;re[vr(Q[0].s)]=Q[1],U=c.dense?u[N][_]:u[nn(_)+M],U.f=Ws(Q[1],p,{r:g.r,c:_},R,c);break;case 60:if(!c.cellStyles)break;for(;Q.e>=Q.s;)Y[Q.e--]={width:Q.w/256,hidden:!!(Q.flags&1),level:Q.level},X||(X=!0,Gy(Q.w/256)),zu(Y[Q.e+1]);break;case 161:u["!autofilter"]={ref:jr(Q)};break;case 476:u["!margins"]=Q;break;case 147:n.Sheets[r]||(n.Sheets[r]={}),Q.name&&(n.Sheets[r].CodeName=Q.name),(Q.above||Q.left)&&(u["!outline"]={above:Q.above,left:Q.left});break;case 137:n.Views||(n.Views=[{}]),n.Views[0]||(n.Views[0]={}),Q.RTL&&(n.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:x=!0;break;case 36:x=!1;break;case 37:x=!0;break;case 38:x=!1;break;default:if(!G.T){if(!x||c.WTF)throw new Error("Unexpected record 0x"+ye.toString(16))}}},c),delete c.supbooks,delete c["!row"],!u["!ref"]&&(p.s.r<2e6||h&&(h.e.r>0||h.e.c>0||h.s.r>0||h.s.c>0))&&(u["!ref"]=jr(h||p)),c.sheetRows&&u["!ref"]){var ce=aa(u["!ref"]);c.sheetRows<=+ce.e.r&&(ce.e.r=c.sheetRows-1,ce.e.r>p.e.r&&(ce.e.r=p.e.r),ce.e.r<ce.s.r&&(ce.s.r=ce.e.r),ce.e.c>p.e.c&&(ce.e.c=p.e.c),ce.e.c<ce.s.c&&(ce.s.c=ce.e.c),u["!fullref"]=u["!ref"],u["!ref"]=jr(ce))}return V.length>0&&(u["!merges"]=V),Y.length>0&&(u["!cols"]=Y),K.length>0&&(u["!rows"]=K),u}function mq(e,t,r,a,n,s,o){if(t.v===void 0)return!1;var c="";switch(t.t){case"b":c=t.v?"1":"0";break;case"d":t=Va(t),t.z=t.z||xr[14],t.v=Yn(Ha(t.v)),t.t="n";break;case"n":case"e":c=""+t.v;break;default:c=t.v;break}var u={r,c:a};switch(u.s=$u(n.cellXfs,t,n),t.l&&s["!links"].push([vr(u),t.l]),t.c&&s["!comments"].push([vr(u),t.c]),t.t){case"s":case"str":return n.bookSST?(c=Jy(n.Strings,t.v,n.revStrings),u.t="s",u.v=c,o?Nt(e,18,LV(t,u)):Nt(e,7,FV(t,u))):(u.t="str",o?Nt(e,17,WV(t,u)):Nt(e,6,qV(t,u))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?o?Nt(e,13,zV(t,u)):Nt(e,2,BV(t,u)):o?Nt(e,16,MV(t,u)):Nt(e,5,RV(t,u)),!0;case"b":return u.t="b",o?Nt(e,15,TV(t,u)):Nt(e,4,AV(t,u)),!0;case"e":return u.t="e",o?Nt(e,14,CV(t,u)):Nt(e,3,EV(t,u)),!0}return o?Nt(e,12,SV(t,u)):Nt(e,1,wV(t,u)),!0}function xq(e,t,r,a){var n=aa(t["!ref"]||"A1"),s,o="",c=[];Nt(e,145);var u=Array.isArray(t),h=n.e.r;t["!rows"]&&(h=Math.max(n.e.r,t["!rows"].length-1));for(var p=n.s.r;p<=h;++p){o=jn(p),dV(e,t,n,p);var x=!1;if(p<=n.e.r)for(var v=n.s.c;v<=n.e.c;++v){p===n.s.r&&(c[v]=nn(v)),s=c[v]+o;var g=u?(t[p]||[])[v]:t[s];if(!g){x=!1;continue}x=mq(e,g,p,v,a,t,x)}}Nt(e,146)}function gq(e,t){!t||!t["!merges"]||(Nt(e,177,QV(t["!merges"].length)),t["!merges"].forEach(function(r){Nt(e,176,ZV(r))}),Nt(e,178))}function vq(e,t){!t||!t["!cols"]||(Nt(e,390),t["!cols"].forEach(function(r,a){r&&Nt(e,60,sq(a,r))}),Nt(e,391))}function yq(e,t){!t||!t["!ref"]||(Nt(e,648),Nt(e,649,uq(aa(t["!ref"]))),Nt(e,650))}function wq(e,t,r){t["!links"].forEach(function(a){if(a[1].Target){var n=ga(r,-1,a[1].Target.replace(/#.*$/,""),Hr.HLINK);Nt(e,494,tq(a,n))}}),delete t["!links"]}function bq(e,t,r,a){if(t["!comments"].length>0){var n=ga(a,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Hr.VML);Nt(e,551,My("rId"+n)),t["!legacy"]=n}}function Sq(e,t,r,a){if(t["!autofilter"]){var n=t["!autofilter"],s=typeof n.ref=="string"?n.ref:jr(n.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,c=Ci(s);c.s.r==c.e.r&&(c.e.r=Ci(t["!ref"]).e.r,s=jr(c));for(var u=0;u<o.length;++u){var h=o[u];if(h.Name=="_xlnm._FilterDatabase"&&h.Sheet==a){h.Ref="'"+r.SheetNames[a]+"'!"+s;break}}u==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+r.SheetNames[a]+"'!"+s}),Nt(e,161,Nh(aa(s))),Nt(e,162)}}function Nq(e,t,r){Nt(e,133),Nt(e,137,cq(t,r)),Nt(e,138),Nt(e,134)}function Aq(e,t){t["!protect"]&&Nt(e,535,fq(t["!protect"]))}function _q(e,t,r,a){var n=ji(),s=r.SheetNames[e],o=r.Sheets[s]||{},c=s;try{r&&r.Workbook&&(c=r.Workbook.Sheets[e].CodeName||c)}catch{}var u=aa(o["!ref"]||"A1");if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],Nt(n,129),(r.vbaraw||o["!outline"])&&Nt(n,147,vV(c,o["!outline"])),Nt(n,148,mV(u)),Nq(n,o,r.Workbook),vq(n,o),xq(n,o,e,t),Aq(n,o),Sq(n,o,r,e),gq(n,o),wq(n,o,a),o["!margins"]&&Nt(n,476,oq(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&yq(n,o),bq(n,o,e,a),Nt(n,130),n.end()}function Tq(e){var t=[],r=e.match(/^<c:numCache>/),a;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var o=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(t[+o[1]]=r?+o[2]:o[2])});var n=ra((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){a=s.replace(/<.*?>/g,"")}),[t,n,a]}function kq(e,t,r,a,n,s){var o=s||{"!type":"chart"};if(!e)return s;var c=0,u=0,h="A",p={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(x){var v=Tq(x);p.s.r=p.s.c=0,p.e.c=c,h=nn(c),v[0].forEach(function(g,w){o[h+jn(w)]={t:"n",v:g,z:v[1]},u=w}),p.e.r<u&&(p.e.r=u),++c}),c>0&&(o["!ref"]=jr(p)),o}function Eq(e,t,r,a,n){if(!e)return e;a||(a={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o,c=e.match(cT);return c&&Ky(c[0],s,n,r),(o=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=o[1]),a["!id"][s["!rel"]]&&(s["!drawel"]=a["!id"][s["!rel"]]),s}function jq(e,t){e.l+=10;var r=Ks(e);return{name:r}}function Cq(e,t,r,a,n){if(!e)return e;a||(a={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o=!1;return Gc(e,function(u,h,p){switch(p){case 550:s["!rel"]=u;break;case 651:n.Sheets[r]||(n.Sheets[r]={}),u.name&&(n.Sheets[r].CodeName=u.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(h.T>0)){if(!(h.T<0)){if(!o||t.WTF)throw new Error("Unexpected record 0x"+p.toString(16))}}}},t),a["!id"][s["!rel"]]&&(s["!drawel"]=a["!id"][s["!rel"]]),s}var Zy=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],Dq=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Fq=[],Pq=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function gS(e,t){for(var r=0;r!=e.length;++r)for(var a=e[r],n=0;n!=t.length;++n){var s=t[n];if(a[s[0]]==null)a[s[0]]=s[1];else switch(s[2]){case"bool":typeof a[s[0]]=="string"&&(a[s[0]]=Ua(a[s[0]]));break;case"int":typeof a[s[0]]=="string"&&(a[s[0]]=parseInt(a[s[0]],10));break}}}function vS(e,t){for(var r=0;r!=t.length;++r){var a=t[r];if(e[a[0]]==null)e[a[0]]=a[1];else switch(a[2]){case"bool":typeof e[a[0]]=="string"&&(e[a[0]]=Ua(e[a[0]]));break;case"int":typeof e[a[0]]=="string"&&(e[a[0]]=parseInt(e[a[0]],10));break}}}function dT(e){vS(e.WBProps,Zy),vS(e.CalcPr,Pq),gS(e.WBView,Dq),gS(e.Sheets,Fq),oh.date1904=Ua(e.WBProps.date1904)}function Lq(e){return!e.Workbook||!e.Workbook.WBProps?"false":Ua(e.Workbook.WBProps.date1904)?"true":"false"}var Oq="][*?/\\".split("");function pT(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return Oq.forEach(function(a){if(e.indexOf(a)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function Rq(e,t,r){e.forEach(function(a,n){pT(a);for(var s=0;s<n;++s)if(a==e[s])throw new Error("Duplicate Sheet Name: "+a);if(r){var o=t&&t[n]&&t[n].CodeName||a;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function Mq(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];Rq(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)LH(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var Iq=/<\w+:workbook/;function Bq(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},a=!1,n="xmlns",s={},o=0;if(e.replace(Qs,function(u,h){var p=wr(u);switch(Ql(p[0])){case"<?xml":break;case"<workbook":u.match(Iq)&&(n="xmlns"+u.match(/<(\w+):/)[1]),r.xmlns=p[n];break;case"</workbook>":break;case"<fileVersion":delete p[0],r.AppVersion=p;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Zy.forEach(function(x){if(p[x[0]]!=null)switch(x[2]){case"bool":r.WBProps[x[0]]=Ua(p[x[0]]);break;case"int":r.WBProps[x[0]]=parseInt(p[x[0]],10);break;default:r.WBProps[x[0]]=p[x[0]]}}),p.codeName&&(r.WBProps.CodeName=Na(p.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete p[0],r.WBView.push(p);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(p.state){case"hidden":p.Hidden=1;break;case"veryHidden":p.Hidden=2;break;default:p.Hidden=0}delete p.state,p.name=ra(Na(p.name)),delete p[0],r.Sheets.push(p);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":a=!0;break;case"</definedNames>":a=!1;break;case"<definedName":s={},s.Name=Na(p.name),p.comment&&(s.Comment=p.comment),p.localSheetId&&(s.Sheet=+p.localSheetId),Ua(p.hidden||"0")&&(s.Hidden=!0),o=h+u.length;break;case"</definedName>":s.Ref=ra(Na(e.slice(o,h))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete p[0],r.CalcPr=p;break;case"<calcPr/>":delete p[0],r.CalcPr=p;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":a=!0;break;case"</AlternateContent>":a=!1;break;case"<revisionPtr":break;default:if(!a&&t.WTF)throw new Error("unrecognized "+p[0]+" in workbook")}return u}),t0.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return dT(r),r}function mT(e){var t=[Cn];t[t.length]=Mt("workbook",null,{xmlns:t0[0],"xmlns:r":Xn.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,a={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Zy.forEach(function(c){e.Workbook.WBProps[c[0]]!=null&&e.Workbook.WBProps[c[0]]!=c[1]&&(a[c[0]]=e.Workbook.WBProps[c[0]])}),e.Workbook.WBProps.CodeName&&(a.codeName=e.Workbook.WBProps.CodeName,delete a.CodeName)),t[t.length]=Mt("workbookPr",null,a);var n=e.Workbook&&e.Workbook.Sheets||[],s=0;if(n&&n[0]&&n[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=e.SheetNames.length&&!(!n[s]||!n[s].Hidden);++s);s==e.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var o={name:ya(e.SheetNames[s].slice(0,31))};if(o.sheetId=""+(s+1),o["r:id"]="rId"+(s+1),n[s])switch(n[s].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}t[t.length]=Mt("sheet",null,o)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(c){var u={name:c.Name};c.Comment&&(u.comment=c.Comment),c.Sheet!=null&&(u.localSheetId=""+c.Sheet),c.Hidden&&(u.hidden="1"),c.Ref&&(t[t.length]=Mt("definedName",ya(c.Ref),u))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function Uq(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=cv(e),r.name=Ks(e),r}function zq(e,t){return t||(t=ht(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),My(e.strRelID,t),us(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function Hq(e,t){var r={},a=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var n=t>8?Ks(e):"";return n.length>0&&(r.CodeName=n),r.autoCompressPictures=!!(a&65536),r.backupFile=!!(a&64),r.checkCompatibility=!!(a&4096),r.date1904=!!(a&1),r.filterPrivacy=!!(a&8),r.hidePivotFieldList=!!(a&1024),r.promptedSolutions=!!(a&16),r.publishItems=!!(a&2048),r.refreshAllConnections=!!(a&262144),r.saveExternalLinkValues=!!(a&128),r.showBorderUnselectedTables=!!(a&4),r.showInkAnnotation=!!(a&32),r.showObjects=["all","placeholders","none"][a>>13&3],r.showPivotChartFilter=!!(a&32768),r.updateLinks=["userSet","never","always"][a>>8&3],r}function Vq(e,t){t||(t=ht(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),i6(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function qq(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function Gq(e,t,r){var a=e.l+t;e.l+=4,e.l+=1;var n=e.read_shift(4),s=b9(e),o=EH(e,0,r),c=Ry(e);e.l=a;var u={Name:s,Ptg:o};return n<268435455&&(u.Sheet=n),c&&(u.Comment=c),u}function Wq(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},a=[],n=!1;t||(t={}),t.biff=12;var s=[],o=[[]];return o.SheetNames=[],o.XTI=[],fp[16]={n:"BrtFRTArchID$",f:qq},Gc(e,function(u,h,p){switch(p){case 156:o.SheetNames.push(u.name),r.Sheets.push(u);break;case 153:r.WBProps=u;break;case 39:u.Sheet!=null&&(t.SID=u.Sheet),u.Ref=Ws(u.Ptg,null,null,o,t),delete t.SID,delete u.Ptg,s.push(u);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([p,u]):o[0]=[p,u],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(u),o.XTI=o.XTI.concat(u);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:a.push(p),n=!0;break;case 36:a.pop(),n=!1;break;case 37:a.push(p),n=!0;break;case 38:a.pop(),n=!1;break;case 16:break;default:if(!h.T){if(!n||t.WTF&&a[a.length-1]!=37&&a[a.length-1]!=35)throw new Error("Unexpected record 0x"+p.toString(16))}}},t),dT(r),r.Names=s,r.supbooks=o,r}function $q(e,t){Nt(e,143);for(var r=0;r!=t.SheetNames.length;++r){var a=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,n={Hidden:a,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};Nt(e,156,zq(n))}Nt(e,144)}function Xq(e,t){t||(t=ht(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return us("SheetJS",t),us(w1.version,t),us(w1.version,t),us("7262",t),t.length>t.l?t.slice(0,t.l):t}function Yq(e,t){t||(t=ht(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function Jq(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,a=0,n=-1,s=-1;a<r.length;++a)!r[a]||!r[a].Hidden&&n==-1?n=a:r[a].Hidden==1&&s==-1&&(s=a);s>n||(Nt(e,135),Nt(e,158,Yq(n)),Nt(e,136))}}function Kq(e,t){var r=ji();return Nt(r,131),Nt(r,128,Xq()),Nt(r,153,Vq(e.Workbook&&e.Workbook.WBProps||null)),Jq(r,e),$q(r,e),Nt(r,132),r.end()}function Zq(e,t,r){return t.slice(-4)===".bin"?Wq(e,r):Bq(e,r)}function Qq(e,t,r,a,n,s,o,c){return t.slice(-4)===".bin"?pq(e,a,r,n,s,o,c):GH(e,a,r,n,s,o,c)}function eG(e,t,r,a,n,s,o,c){return t.slice(-4)===".bin"?Cq(e,a,r,n,s):Eq(e,a,r,n,s)}function tG(e,t,r,a,n,s,o,c){return t.slice(-4)===".bin"?az():nz()}function rG(e,t,r,a,n,s,o,c){return t.slice(-4)===".bin"?tz():rz()}function aG(e,t,r,a){return t.slice(-4)===".bin"?ZB(e,r,a):UB(e,r,a)}function nG(e,t,r){return Y6(e,r)}function sG(e,t,r){return t.slice(-4)===".bin"?sB(e,r):rB(e,r)}function iG(e,t,r){return t.slice(-4)===".bin"?JU(e,r):zU(e,r)}function oG(e,t,r){return t.slice(-4)===".bin"?IU(e):RU(e)}function lG(e,t,r,a){return r.slice(-4)===".bin"?BU(e,t,r,a):void 0}function cG(e,t,r){return t.slice(-4)===".bin"?PU(e,t,r):OU(e,t,r)}function uG(e,t,r){return(t.slice(-4)===".bin"?Kq:mT)(e)}function fG(e,t,r,a,n){return(t.slice(-4)===".bin"?_q:uT)(e,r,a,n)}function hG(e,t,r){return(t.slice(-4)===".bin"?lU:$6)(e,r)}function dG(e,t,r){return(t.slice(-4)===".bin"?lB:B6)(e,r)}function pG(e,t,r){return(t.slice(-4)===".bin"?KU:Z6)(e)}function mG(e){return(e.slice(-4)===".bin"?LU:J6)()}var xT=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,gT=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function tl(e,t){var r=e.split(/\s+/),a=[];if(a[0]=r[0],r.length===1)return a;var n=e.match(xT),s,o,c,u;if(n)for(u=0;u!=n.length;++u)s=n[u].match(gT),(o=s[1].indexOf(":"))===-1?a[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?c="xmlns"+s[1].slice(6):c=s[1].slice(o+1),a[c]=s[2].slice(1,s[2].length-1));return a}function xG(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var a=e.match(xT),n,s,o,c;if(a)for(c=0;c!=a.length;++c)n=a[c].match(gT),(s=n[1].indexOf(":"))===-1?r[n[1]]=n[2].slice(1,n[2].length-1):(n[1].slice(0,6)==="xmlns:"?o="xmlns"+n[1].slice(6):o=n[1].slice(s+1),r[o]=n[2].slice(1,n[2].length-1));return r}var Md;function gG(e,t){var r=Md[e]||ra(e);return r==="General"?Gf(t):Co(r,t)}function vG(e,t,r,a){var n=a;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":n=Ua(a);break;case"i2":case"int":n=parseInt(a,10);break;case"r4":case"float":n=parseFloat(a);break;case"date":case"dateTime.tz":n=Ha(a);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[ra(t)]=n}function yG(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||Wc[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=rp(e.v):e.w=Gf(e.v):e.w=gG(t||"General",e.v)}catch(s){if(r.WTF)throw s}try{var a=Md[t]||t||"General";if(r.cellNF&&(e.z=a),r.cellDates&&e.t=="n"&&wh(a)){var n=Pf(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}catch(s){if(r.WTF)throw s}}}function wG(e,t,r){if(r.cellStyles&&t.Interior){var a=t.Interior;a.Pattern&&(a.patternType=FB[a.Pattern]||a.Pattern)}e[t.ID]=t}function bG(e,t,r,a,n,s,o,c,u,h){var p="General",x=a.StyleID,v={};h=h||{};var g=[],w=0;for(x===void 0&&c&&(x=c.StyleID),x===void 0&&o&&(x=o.StyleID);s[x]!==void 0&&(s[x].nf&&(p=s[x].nf),s[x].Interior&&g.push(s[x].Interior),!!s[x].Parent);)x=s[x].Parent;switch(r.Type){case"Boolean":a.t="b",a.v=Ua(e);break;case"String":a.t="s",a.r=O3(ra(e)),a.v=e.indexOf("<")>-1?ra(t||e).replace(/<.*?>/g,""):a.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),a.v=(Ha(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),a.v!==a.v?a.v=ra(e):a.v<60&&(a.v=a.v-1),(!p||p=="General")&&(p="yyyy-mm-dd");case"Number":a.v===void 0&&(a.v=+e),a.t||(a.t="n");break;case"Error":a.t="e",a.v=f6[e],h.cellText!==!1&&(a.w=e);break;default:e==""&&t==""?a.t="z":(a.t="s",a.v=O3(t||e));break}if(yG(a,p,h),h.cellFormula!==!1)if(a.Formula){var b=ra(a.Formula);b.charCodeAt(0)==61&&(b=b.slice(1)),a.f=ih(b,n),delete a.Formula,a.ArrayRange=="RC"?a.F=ih("RC:RC",n):a.ArrayRange&&(a.F=ih(a.ArrayRange,n),u.push([aa(a.F),a.F]))}else for(w=0;w<u.length;++w)n.r>=u[w][0].s.r&&n.r<=u[w][0].e.r&&n.c>=u[w][0].s.c&&n.c<=u[w][0].e.c&&(a.F=u[w][1]);h.cellStyles&&(g.forEach(function(N){!v.patternType&&N.patternType&&(v.patternType=N.patternType)}),a.s=v),a.StyleID!==void 0&&(a.ixfe=a.StyleID)}function SG(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function d2(e,t){var r=t||{};bh();var a=bd(Cy(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(a=Na(a));var n=a.slice(0,1024).toLowerCase(),s=!1;if(n=n.replace(/".*?"/g,""),(n.indexOf(">")&1023)>Math.min(n.indexOf(",")&1023,n.indexOf(";")&1023)){var o=Va(r);return o.type="string",dh.to_workbook(a,o)}if(n.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Ue){n.indexOf("<"+Ue)>=0&&(s=!0)}),s)return oW(a,r);Md={"General Number":"General","General Date":xr[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":xr[15],"Short Date":xr[14],"Long Time":xr[19],"Medium Time":xr[18],"Short Time":xr[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:xr[2],Standard:xr[4],Percent:xr[10],Scientific:xr[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var c,u=[],h,p={},x=[],v=r.dense?[]:{},g="",w={},b={},N=tl('<Data ss:Type="String">'),_=0,E=0,j=0,M={s:{r:2e6,c:2e6},e:{r:0,c:0}},U={},V={},I="",z=0,H=[],re={},R={},F=0,Y=[],K=[],X={},Z=[],ce,te=!1,Q=[],G=[],ye={},D=0,O=0,L={Sheets:[],WBProps:{date1904:!1}},q={};sp.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"");for(var oe="";c=sp.exec(a);)switch(c[3]=(oe=c[3]).toLowerCase()){case"data":if(oe=="data"){if(c[1]==="/"){if((h=u.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&u.push([c[3],!0]);break}if(u[u.length-1][1])break;c[1]==="/"?bG(a.slice(_,c.index),I,N,u[u.length-1][0]=="comment"?X:w,{c:E,r:j},U,Z[E],b,Q,r):(I="",N=tl(c[0]),_=c.index+c[0].length);break;case"cell":if(c[1]==="/")if(K.length>0&&(w.c=K),(!r.sheetRows||r.sheetRows>j)&&w.v!==void 0&&(r.dense?(v[j]||(v[j]=[]),v[j][E]=w):v[nn(E)+jn(j)]=w),w.HRef&&(w.l={Target:ra(w.HRef)},w.HRefScreenTip&&(w.l.Tooltip=w.HRefScreenTip),delete w.HRef,delete w.HRefScreenTip),(w.MergeAcross||w.MergeDown)&&(D=E+(parseInt(w.MergeAcross,10)|0),O=j+(parseInt(w.MergeDown,10)|0),H.push({s:{c:E,r:j},e:{c:D,r:O}})),!r.sheetStubs)w.MergeAcross?E=D+1:++E;else if(w.MergeAcross||w.MergeDown){for(var be=E;be<=D;++be)for(var ve=j;ve<=O;++ve)(be>E||ve>j)&&(r.dense?(v[ve]||(v[ve]=[]),v[ve][be]={t:"z"}):v[nn(be)+jn(ve)]={t:"z"});E=D+1}else++E;else w=xG(c[0]),w.Index&&(E=+w.Index-1),E<M.s.c&&(M.s.c=E),E>M.e.c&&(M.e.c=E),c[0].slice(-2)==="/>"&&++E,K=[];break;case"row":c[1]==="/"||c[0].slice(-2)==="/>"?(j<M.s.r&&(M.s.r=j),j>M.e.r&&(M.e.r=j),c[0].slice(-2)==="/>"&&(b=tl(c[0]),b.Index&&(j=+b.Index-1)),E=0,++j):(b=tl(c[0]),b.Index&&(j=+b.Index-1),ye={},(b.AutoFitHeight=="0"||b.Height)&&(ye.hpx=parseInt(b.Height,10),ye.hpt=up(ye.hpx),G[j]=ye),b.Hidden=="1"&&(ye.hidden=!0,G[j]=ye));break;case"worksheet":if(c[1]==="/"){if((h=u.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"));x.push(g),M.s.r<=M.e.r&&M.s.c<=M.e.c&&(v["!ref"]=jr(M),r.sheetRows&&r.sheetRows<=M.e.r&&(v["!fullref"]=v["!ref"],M.e.r=r.sheetRows-1,v["!ref"]=jr(M))),H.length&&(v["!merges"]=H),Z.length>0&&(v["!cols"]=Z),G.length>0&&(v["!rows"]=G),p[g]=v}else M={s:{r:2e6,c:2e6},e:{r:0,c:0}},j=E=0,u.push([c[3],!1]),h=tl(c[0]),g=ra(h.Name),v=r.dense?[]:{},H=[],Q=[],G=[],q={name:g,Hidden:0},L.Sheets.push(q);break;case"table":if(c[1]==="/"){if((h=u.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else{if(c[0].slice(-2)=="/>")break;u.push([c[3],!1]),Z=[],te=!1}break;case"style":c[1]==="/"?wG(U,V,r):V=tl(c[0]);break;case"numberformat":V.nf=ra(tl(c[0]).Format||"General"),Md[V.nf]&&(V.nf=Md[V.nf]);for(var ue=0;ue!=392&&xr[ue]!=V.nf;++ue);if(ue==392){for(ue=57;ue!=392;++ue)if(xr[ue]==null){Rc(V.nf,ue);break}}break;case"column":if(u[u.length-1][0]!=="table")break;if(ce=tl(c[0]),ce.Hidden&&(ce.hidden=!0,delete ce.Hidden),ce.Width&&(ce.wpx=parseInt(ce.Width,10)),!te&&ce.wpx>10){te=!0,$s=G6;for(var fe=0;fe<Z.length;++fe)Z[fe]&&zu(Z[fe])}te&&zu(ce),Z[ce.Index-1||Z.length]=ce;for(var Ee=0;Ee<+ce.Span;++Ee)Z[Z.length]=Va(ce);break;case"namedrange":if(c[1]==="/")break;L.Names||(L.Names=[]);var J=wr(c[0]),Pe={Name:J.Name,Ref:ih(J.RefersTo.slice(1),{r:0,c:0})};L.Sheets.length>0&&(Pe.Sheet=L.Sheets.length-1),L.Names.push(Pe);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(c[0].slice(-2)==="/>")break;c[1]==="/"?I+=a.slice(z,c.index):z=c.index+c[0].length;break;case"interior":if(!r.cellStyles)break;V.Interior=tl(c[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(c[0].slice(-2)==="/>")break;c[1]==="/"?W9(re,oe,a.slice(F,c.index)):F=c.index+c[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(c[1]==="/"){if((h=u.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else u.push([c[3],!1]);break;case"comment":if(c[1]==="/"){if((h=u.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"));SG(X),K.push(X)}else u.push([c[3],!1]),h=tl(c[0]),X={a:h.Author};break;case"autofilter":if(c[1]==="/"){if((h=u.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else if(c[0].charAt(c[0].length-2)!=="/"){var st=tl(c[0]);v["!autofilter"]={ref:ih(st.Range).replace(/\$/g,"")},u.push([c[3],!0])}break;case"name":break;case"datavalidation":if(c[1]==="/"){if((h=u.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&u.push([c[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(c[1]==="/"){if((h=u.pop())[0]!==c[3])throw new Error("Bad state: "+h.join("|"))}else c[0].charAt(c[0].length-2)!=="/"&&u.push([c[3],!0]);break;case"null":break;default:if(u.length==0&&c[3]=="document"||u.length==0&&c[3]=="uof")return NS(a,r);var ke=!0;switch(u[u.length-1][0]){case"officedocumentsettings":switch(c[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:ke=!1}break;case"componentoptions":switch(c[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:ke=!1}break;case"excelworkbook":switch(c[3]){case"date1904":L.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:ke=!1}break;case"workbookoptions":switch(c[3]){case"owcversion":break;case"height":break;case"width":break;default:ke=!1}break;case"worksheetoptions":switch(c[3]){case"visible":if(c[0].slice(-2)!=="/>")if(c[1]==="/")switch(a.slice(F,c.index)){case"SheetHidden":q.Hidden=1;break;case"SheetVeryHidden":q.Hidden=2;break}else F=c.index+c[0].length;break;case"header":v["!margins"]||Uf(v["!margins"]={},"xlml"),isNaN(+wr(c[0]).Margin)||(v["!margins"].header=+wr(c[0]).Margin);break;case"footer":v["!margins"]||Uf(v["!margins"]={},"xlml"),isNaN(+wr(c[0]).Margin)||(v["!margins"].footer=+wr(c[0]).Margin);break;case"pagemargins":var de=wr(c[0]);v["!margins"]||Uf(v["!margins"]={},"xlml"),isNaN(+de.Top)||(v["!margins"].top=+de.Top),isNaN(+de.Left)||(v["!margins"].left=+de.Left),isNaN(+de.Right)||(v["!margins"].right=+de.Right),isNaN(+de.Bottom)||(v["!margins"].bottom=+de.Bottom);break;case"displayrighttoleft":L.Views||(L.Views=[]),L.Views[0]||(L.Views[0]={}),L.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":v["!outline"]||(v["!outline"]={}),v["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":v["!outline"]||(v["!outline"]={}),v["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:ke=!1}break;case"pivottable":case"pivotcache":switch(c[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:ke=!1}break;case"pagebreaks":switch(c[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:ke=!1}break;case"autofilter":switch(c[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:ke=!1}break;case"querytable":switch(c[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:ke=!1}break;case"datavalidation":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:ke=!1}break;case"sorting":case"conditionalformatting":switch(c[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:ke=!1}break;case"mapinfo":case"schema":case"data":switch(c[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:ke=!1}break;case"smarttags":break;default:ke=!1;break}if(ke||c[3].match(/!\[CDATA/))break;if(!u[u.length-1][1])throw"Unrecognized tag: "+c[3]+"|"+u.join("|");if(u[u.length-1][0]==="customdocumentproperties"){if(c[0].slice(-2)==="/>")break;c[1]==="/"?vG(R,oe,Y,a.slice(F,c.index)):(Y=c,F=c.index+c[0].length);break}if(r.WTF)throw"Unrecognized tag: "+c[3]+"|"+u.join("|")}var rt={};return!r.bookSheets&&!r.bookProps&&(rt.Sheets=p),rt.SheetNames=x,rt.Workbook=L,rt.SSF=Va(xr),rt.Props=re,rt.Custprops=R,rt}function xv(e,t){switch(e5(t=t||{}),t.type||"base64"){case"base64":return d2(ro(e),t);case"binary":case"buffer":case"file":return d2(e,t);case"array":return d2(Gu(e),t)}}function NG(e,t){var r=[];return e.Props&&r.push($9(e.Props,t)),e.Custprops&&r.push(X9(e.Props,e.Custprops)),r.join("")}function AG(){return""}function _G(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(a,n){var s=[];s.push(Mt("NumberFormat",null,{"ss:Format":ya(xr[a.numFmtId])}));var o={"ss:ID":"s"+(21+n)};r.push(Mt("Style",s.join(""),o))}),Mt("Styles",r.join(""))}function vT(e){return Mt("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Xy(e.Ref,{r:0,c:0})})}function TG(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],a=0;a<t.length;++a){var n=t[a];n.Sheet==null&&(n.Name.match(/^_xlfn\./)||r.push(vT(n)))}return Mt("Names",r.join(""))}function kG(e,t,r,a){if(!e||!((a||{}).Workbook||{}).Names)return"";for(var n=a.Workbook.Names,s=[],o=0;o<n.length;++o){var c=n[o];c.Sheet==r&&(c.Name.match(/^_xlfn\./)||s.push(vT(c)))}return s.join("")}function EG(e,t,r,a){if(!e)return"";var n=[];if(e["!margins"]&&(n.push("<PageSetup>"),e["!margins"].header&&n.push(Mt("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&n.push(Mt("Footer",null,{"x:Margin":e["!margins"].footer})),n.push(Mt("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),n.push("</PageSetup>")),a&&a.Workbook&&a.Workbook.Sheets&&a.Workbook.Sheets[r])if(a.Workbook.Sheets[r].Hidden)n.push(Mt("Visible",a.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(a.Workbook.Sheets[s]&&!a.Workbook.Sheets[s].Hidden);++s);s==r&&n.push("<Selected/>")}return((((a||{}).Workbook||{}).Views||[])[0]||{}).RTL&&n.push("<DisplayRightToLeft/>"),e["!protect"]&&(n.push(Ns("ProtectContents","True")),e["!protect"].objects&&n.push(Ns("ProtectObjects","True")),e["!protect"].scenarios&&n.push(Ns("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?n.push(Ns("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&n.push(Ns("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&n.push("<"+o[1]+"/>")})),n.length==0?"":Mt("WorksheetOptions",n.join(""),{xmlns:Yi.x})}function jG(e){return e.map(function(t){var r=JR(t.t||""),a=Mt("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Mt("Comment",a,{"ss:Author":t.a})}).join("")}function CG(e,t,r,a,n,s,o){if(!e||e.v==null&&e.f==null)return"";var c={};if(e.f&&(c["ss:Formula"]="="+ya(Xy(e.f,o))),e.F&&e.F.slice(0,t.length)==t){var u=sn(e.F.slice(t.length+1));c["ss:ArrayRange"]="RC:R"+(u.r==o.r?"":"["+(u.r-o.r)+"]")+"C"+(u.c==o.c?"":"["+(u.c-o.c)+"]")}if(e.l&&e.l.Target&&(c["ss:HRef"]=ya(e.l.Target),e.l.Tooltip&&(c["x:HRefScreenTip"]=ya(e.l.Tooltip))),r["!merges"])for(var h=r["!merges"],p=0;p!=h.length;++p)h[p].s.c!=o.c||h[p].s.r!=o.r||(h[p].e.c>h[p].s.c&&(c["ss:MergeAcross"]=h[p].e.c-h[p].s.c),h[p].e.r>h[p].s.r&&(c["ss:MergeDown"]=h[p].e.r-h[p].s.r));var x="",v="";switch(e.t){case"z":if(!a.sheetStubs)return"";break;case"n":x="Number",v=String(e.v);break;case"b":x="Boolean",v=e.v?"1":"0";break;case"e":x="Error",v=Wc[e.v];break;case"d":x="DateTime",v=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||xr[14]);break;case"s":x="String",v=YR(e.v||"");break}var g=$u(a.cellXfs,e,a);c["ss:StyleID"]="s"+(21+g),c["ss:Index"]=o.c+1;var w=e.v!=null?v:"",b=e.t=="z"?"":'<Data ss:Type="'+x+'">'+w+"</Data>";return(e.c||[]).length>0&&(b+=jG(e.c)),Mt("Cell",b,c)}function DG(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=ph(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function FG(e,t,r,a){if(!e["!ref"])return"";var n=aa(e["!ref"]),s=e["!merges"]||[],o=0,c=[];e["!cols"]&&e["!cols"].forEach(function(N,_){zu(N);var E=!!N.width,j=nx(_,N),M={"ss:Index":_+1};E&&(M["ss:Width"]=lp(j.width)),N.hidden&&(M["ss:Hidden"]="1"),c.push(Mt("Column",null,M))});for(var u=Array.isArray(e),h=n.s.r;h<=n.e.r;++h){for(var p=[DG(h,(e["!rows"]||[])[h])],x=n.s.c;x<=n.e.c;++x){var v=!1;for(o=0;o!=s.length;++o)if(!(s[o].s.c>x)&&!(s[o].s.r>h)&&!(s[o].e.c<x)&&!(s[o].e.r<h)){(s[o].s.c!=x||s[o].s.r!=h)&&(v=!0);break}if(!v){var g={r:h,c:x},w=vr(g),b=u?(e[h]||[])[x]:e[w];p.push(CG(b,w,e,t,r,a,g))}}p.push("</Row>"),p.length>2&&c.push(p.join(""))}return c.join("")}function PG(e,t,r){var a=[],n=r.SheetNames[e],s=r.Sheets[n],o=s?kG(s,t,e,r):"";return o.length>0&&a.push("<Names>"+o+"</Names>"),o=s?FG(s,t,e,r):"",o.length>0&&a.push("<Table>"+o+"</Table>"),a.push(EG(s,t,e,r)),a.join("")}function LG(e,t){t||(t={}),e.SSF||(e.SSF=Va(xr)),e.SSF&&(bh(),K1(e.SSF),t.revssf=Q1(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],$u(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(NG(e,t)),r.push(AG()),r.push(""),r.push("");for(var a=0;a<e.SheetNames.length;++a)r.push(Mt("Worksheet",PG(a,t,e),{"ss:Name":ya(e.SheetNames[a])}));return r[2]=_G(e,t),r[3]=TG(e),Cn+Mt("Workbook",r.join(""),{xmlns:Yi.ss,"xmlns:o":Yi.o,"xmlns:x":Yi.x,"xmlns:ss":Yi.ss,"xmlns:dt":Yi.dt,"xmlns:html":Yi.html})}function OG(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=T9(r),r.length-r.l<=4)return t;var a=r.read_shift(4);if(a==0||a>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(a=r.read_shift(4),a!==1907505652)||(t.UnicodeClipboardFormat=k9(r),a=r.read_shift(4),a==0||a>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var RG=[60,1084,2066,2165,2175];function MG(e,t,r,a,n){var s=a,o=[],c=r.slice(r.l,r.l+s);if(n&&n.enc&&n.enc.insitu&&c.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:n.enc.insitu(c)}o.push(c),r.l+=s;for(var u=Dc(r,r.l),h=gv[u],p=0;h!=null&&RG.indexOf(u)>-1;)s=Dc(r,r.l+2),p=r.l+4,u==2066?p+=4:(u==2165||u==2175)&&(p+=12),c=r.slice(p,r.l+4+s),o.push(c),r.l+=4+s,h=gv[u=Dc(r,r.l)];var x=cs(o);Ss(x,0);var v=0;x.lens=[];for(var g=0;g<o.length;++g)x.lens.push(v),v+=o[g].length;if(x.length<a)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+x.length+" < "+a;return t.f(x,x.length,n)}function Ul(e,t,r){if(e.t!=="z"&&e.XF){var a=0;try{a=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=xr[a])}catch(s){if(t.WTF)throw s}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Wc[e.v]:a===0||a=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=rp(e.v):e.w=Gf(e.v):e.w=Co(a,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(s){if(t.WTF)throw s}if(t.cellDates&&a&&e.t=="n"&&wh(xr[a]||String(a))){var n=Pf(e.v);n&&(e.t="d",e.v=new Date(n.y,n.m-1,n.d,n.H,n.M,n.S,n.u))}}}function zm(e,t,r){return{v:e,ixfe:t,t:r}}function IG(e,t){var r={opts:{}},a={},n=t.dense?[]:{},s={},o={},c=null,u=[],h="",p={},x,v="",g,w,b,N,_={},E=[],j,M,U=[],V=[],I={Sheets:[],WBProps:{date1904:!1},Views:[{}]},z={},H=function(Ct){return Ct<8?Mf[Ct]:Ct<64&&V[Ct-8]||Mf[Ct]},re=function(Ct,wt,hr){var zt=wt.XF.data;if(!(!zt||!zt.patternType||!hr||!hr.cellStyles)){wt.s={},wt.s.patternType=zt.patternType;var Yt;(Yt=op(H(zt.icvFore)))&&(wt.s.fgColor={rgb:Yt}),(Yt=op(H(zt.icvBack)))&&(wt.s.bgColor={rgb:Yt})}},R=function(Ct,wt,hr){if(!(ye>1)&&!(hr.sheetRows&&Ct.r>=hr.sheetRows)){if(hr.cellStyles&&wt.XF&&wt.XF.data&&re(Ct,wt,hr),delete wt.ixfe,delete wt.XF,x=Ct,v=vr(Ct),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),Ct.r<o.s.r&&(o.s.r=Ct.r),Ct.c<o.s.c&&(o.s.c=Ct.c),Ct.r+1>o.e.r&&(o.e.r=Ct.r+1),Ct.c+1>o.e.c&&(o.e.c=Ct.c+1),hr.cellFormula&&wt.f){for(var zt=0;zt<E.length;++zt)if(!(E[zt][0].s.c>Ct.c||E[zt][0].s.r>Ct.r)&&!(E[zt][0].e.c<Ct.c||E[zt][0].e.r<Ct.r)){wt.F=jr(E[zt][0]),(E[zt][0].s.c!=Ct.c||E[zt][0].s.r!=Ct.r)&&delete wt.f,wt.f&&(wt.f=""+Ws(E[zt][1],o,Ct,Q,F));break}}hr.dense?(n[Ct.r]||(n[Ct.r]=[]),n[Ct.r][Ct.c]=wt):n[v]=wt}},F={enc:!1,sbcch:0,snames:[],sharedf:_,arrayf:E,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(F.password=t.password);var Y,K=[],X=[],Z=[],ce=[],te=!1,Q=[];Q.SheetNames=F.snames,Q.sharedf=F.sharedf,Q.arrayf=F.arrayf,Q.names=[],Q.XTI=[];var G=0,ye=0,D=0,O=[],L=[],q;F.codepage=1200,il(1200);for(var oe=!1;e.l<e.length-1;){var be=e.l,ve=e.read_shift(2);if(ve===0&&G===10)break;var ue=e.l===e.length?0:e.read_shift(2),fe=gv[ve];if(fe&&fe.f){if(t.bookSheets&&G===133&&ve!==133)break;if(G=ve,fe.r===2||fe.r==12){var Ee=e.read_shift(2);if(ue-=2,!F.enc&&Ee!==ve&&((Ee&255)<<8|Ee>>8)!==ve)throw new Error("rt mismatch: "+Ee+"!="+ve);fe.r==12&&(e.l+=10,ue-=10)}var J={};if(ve===10?J=fe.f(e,ue,F):J=MG(ve,fe,e,ue,F),ye==0&&[9,521,1033,2057].indexOf(G)===-1)continue;switch(ve){case 34:r.opts.Date1904=I.WBProps.date1904=J;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(F.enc||(e.l=0),F.enc=J,!t.password)throw new Error("File is password-protected");if(J.valid==null)throw new Error("Encryption scheme unsupported");if(!J.valid)throw new Error("Password is incorrect");break;case 92:F.lastuser=J;break;case 66:var Pe=Number(J);switch(Pe){case 21010:Pe=1200;break;case 32768:Pe=1e4;break;case 32769:Pe=1252;break}il(F.codepage=Pe),oe=!0;break;case 317:F.rrtabid=J;break;case 25:F.winlocked=J;break;case 439:r.opts.RefreshAll=J;break;case 12:r.opts.CalcCount=J;break;case 16:r.opts.CalcDelta=J;break;case 17:r.opts.CalcIter=J;break;case 13:r.opts.CalcMode=J;break;case 14:r.opts.CalcPrecision=J;break;case 95:r.opts.CalcSaveRecalc=J;break;case 15:F.CalcRefMode=J;break;case 2211:r.opts.FullCalc=J;break;case 129:J.fDialog&&(n["!type"]="dialog"),J.fBelow||((n["!outline"]||(n["!outline"]={})).above=!0),J.fRight||((n["!outline"]||(n["!outline"]={})).left=!0);break;case 224:U.push(J);break;case 430:Q.push([J]),Q[Q.length-1].XTI=[];break;case 35:case 547:Q[Q.length-1].push(J);break;case 24:case 536:q={Name:J.Name,Ref:Ws(J.rgce,o,null,Q,F)},J.itab>0&&(q.Sheet=J.itab-1),Q.names.push(q),Q[0]||(Q[0]=[],Q[0].XTI=[]),Q[Q.length-1].push(J),J.Name=="_xlnm._FilterDatabase"&&J.itab>0&&J.rgce&&J.rgce[0]&&J.rgce[0][0]&&J.rgce[0][0][0]=="PtgArea3d"&&(L[J.itab-1]={ref:jr(J.rgce[0][0][1][2])});break;case 22:F.ExternCount=J;break;case 23:Q.length==0&&(Q[0]=[],Q[0].XTI=[]),Q[Q.length-1].XTI=Q[Q.length-1].XTI.concat(J),Q.XTI=Q.XTI.concat(J);break;case 2196:if(F.biff<8)break;q!=null&&(q.Comment=J[1]);break;case 18:n["!protect"]=J;break;case 19:J!==0&&F.WTF&&console.error("Password verifier: "+J);break;case 133:s[J.pos]=J,F.snames.push(J.name);break;case 10:{if(--ye)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,n["!ref"]=jr(o),t.sheetRows&&t.sheetRows<=o.e.r){var st=o.e.r;o.e.r=t.sheetRows-1,n["!fullref"]=n["!ref"],n["!ref"]=jr(o),o.e.r=st}o.e.r++,o.e.c++}K.length>0&&(n["!merges"]=K),X.length>0&&(n["!objects"]=X),Z.length>0&&(n["!cols"]=Z),ce.length>0&&(n["!rows"]=ce),I.Sheets.push(z)}h===""?p=n:a[h]=n,n=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(F.biff===8&&(F.biff={9:2,521:3,1033:4}[ve]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[J.BIFFVer]||8),F.biffguess=J.BIFFVer==0,J.BIFFVer==0&&J.dt==4096&&(F.biff=5,oe=!0,il(F.codepage=28591)),F.biff==8&&J.BIFFVer==0&&J.dt==16&&(F.biff=2),ye++)break;if(n=t.dense?[]:{},F.biff<8&&!oe&&(oe=!0,il(F.codepage=t.codepage||1252)),F.biff<5||J.BIFFVer==0&&J.dt==4096){h===""&&(h="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var ke={pos:e.l-ue,name:h};s[ke.pos]=ke,F.snames.push(h)}else h=(s[be]||{name:""}).name;J.dt==32&&(n["!type"]="chart"),J.dt==64&&(n["!type"]="macro"),K=[],X=[],F.arrayf=E=[],Z=[],ce=[],te=!1,z={Hidden:(s[be]||{hs:0}).hs,name:h}}break;case 515:case 3:case 2:n["!type"]=="chart"&&(t.dense?(n[J.r]||[])[J.c]:n[vr({c:J.c,r:J.r})])&&++J.c,j={ixfe:J.ixfe,XF:U[J.ixfe]||{},v:J.val,t:"n"},D>0&&(j.z=O[j.ixfe>>8&63]),Ul(j,t,r.opts.Date1904),R({c:J.c,r:J.r},j,t);break;case 5:case 517:j={ixfe:J.ixfe,XF:U[J.ixfe],v:J.val,t:J.t},D>0&&(j.z=O[j.ixfe>>8&63]),Ul(j,t,r.opts.Date1904),R({c:J.c,r:J.r},j,t);break;case 638:j={ixfe:J.ixfe,XF:U[J.ixfe],v:J.rknum,t:"n"},D>0&&(j.z=O[j.ixfe>>8&63]),Ul(j,t,r.opts.Date1904),R({c:J.c,r:J.r},j,t);break;case 189:for(var de=J.c;de<=J.C;++de){var rt=J.rkrec[de-J.c][0];j={ixfe:rt,XF:U[rt],v:J.rkrec[de-J.c][1],t:"n"},D>0&&(j.z=O[j.ixfe>>8&63]),Ul(j,t,r.opts.Date1904),R({c:de,r:J.r},j,t)}break;case 6:case 518:case 1030:{if(J.val=="String"){c=J;break}if(j=zm(J.val,J.cell.ixfe,J.tt),j.XF=U[j.ixfe],t.cellFormula){var Ue=J.formula;if(Ue&&Ue[0]&&Ue[0][0]&&Ue[0][0][0]=="PtgExp"){var Xe=Ue[0][0][1][0],ot=Ue[0][0][1][1],ut=vr({r:Xe,c:ot});_[ut]?j.f=""+Ws(J.formula,o,J.cell,Q,F):j.F=((t.dense?(n[Xe]||[])[ot]:n[ut])||{}).F}else j.f=""+Ws(J.formula,o,J.cell,Q,F)}D>0&&(j.z=O[j.ixfe>>8&63]),Ul(j,t,r.opts.Date1904),R(J.cell,j,t),c=J}break;case 7:case 519:if(c)c.val=J,j=zm(J,c.cell.ixfe,"s"),j.XF=U[j.ixfe],t.cellFormula&&(j.f=""+Ws(c.formula,o,c.cell,Q,F)),D>0&&(j.z=O[j.ixfe>>8&63]),Ul(j,t,r.opts.Date1904),R(c.cell,j,t),c=null;else throw new Error("String record expects Formula");break;case 33:case 545:{E.push(J);var vt=vr(J[0].s);if(g=t.dense?(n[J[0].s.r]||[])[J[0].s.c]:n[vt],t.cellFormula&&g){if(!c||!vt||!g)break;g.f=""+Ws(J[1],o,J[0],Q,F),g.F=jr(J[0])}}break;case 1212:{if(!t.cellFormula)break;if(v){if(!c)break;_[vr(c.cell)]=J[0],g=t.dense?(n[c.cell.r]||[])[c.cell.c]:n[vr(c.cell)],(g||{}).f=""+Ws(J[0],o,x,Q,F)}}break;case 253:j=zm(u[J.isst].t,J.ixfe,"s"),u[J.isst].h&&(j.h=u[J.isst].h),j.XF=U[j.ixfe],D>0&&(j.z=O[j.ixfe>>8&63]),Ul(j,t,r.opts.Date1904),R({c:J.c,r:J.r},j,t);break;case 513:t.sheetStubs&&(j={ixfe:J.ixfe,XF:U[J.ixfe],t:"z"},D>0&&(j.z=O[j.ixfe>>8&63]),Ul(j,t,r.opts.Date1904),R({c:J.c,r:J.r},j,t));break;case 190:if(t.sheetStubs)for(var At=J.c;At<=J.C;++At){var ct=J.ixfe[At-J.c];j={ixfe:ct,XF:U[ct],t:"z"},D>0&&(j.z=O[j.ixfe>>8&63]),Ul(j,t,r.opts.Date1904),R({c:At,r:J.r},j,t)}break;case 214:case 516:case 4:j=zm(J.val,J.ixfe,"s"),j.XF=U[j.ixfe],D>0&&(j.z=O[j.ixfe>>8&63]),Ul(j,t,r.opts.Date1904),R({c:J.c,r:J.r},j,t);break;case 0:case 512:ye===1&&(o=J);break;case 252:u=J;break;case 1054:if(F.biff==4){O[D++]=J[1];for(var ze=0;ze<D+163&&xr[ze]!=J[1];++ze);ze>=163&&Rc(J[1],D+163)}else Rc(J[1],J[0]);break;case 30:{O[D++]=J;for(var pt=0;pt<D+163&&xr[pt]!=J;++pt);pt>=163&&Rc(J,D+163)}break;case 229:K=K.concat(J);break;case 93:X[J.cmo[0]]=F.lastobj=J;break;case 438:F.lastobj.TxO=J;break;case 127:F.lastobj.ImData=J;break;case 440:for(N=J[0].s.r;N<=J[0].e.r;++N)for(b=J[0].s.c;b<=J[0].e.c;++b)g=t.dense?(n[N]||[])[b]:n[vr({c:b,r:N})],g&&(g.l=J[1]);break;case 2048:for(N=J[0].s.r;N<=J[0].e.r;++N)for(b=J[0].s.c;b<=J[0].e.c;++b)g=t.dense?(n[N]||[])[b]:n[vr({c:b,r:N})],g&&g.l&&(g.l.Tooltip=J[1]);break;case 28:{if(F.biff<=5&&F.biff>=2)break;g=t.dense?(n[J[0].r]||[])[J[0].c]:n[vr(J[0])];var Ot=X[J[2]];g||(t.dense?(n[J[0].r]||(n[J[0].r]=[]),g=n[J[0].r][J[0].c]={t:"z"}):g=n[vr(J[0])]={t:"z"},o.e.r=Math.max(o.e.r,J[0].r),o.s.r=Math.min(o.s.r,J[0].r),o.e.c=Math.max(o.e.c,J[0].c),o.s.c=Math.min(o.s.c,J[0].c)),g.c||(g.c=[]),w={a:J[1],t:Ot.TxO.t},g.c.push(w)}break;case 2173:_U(U[J.ixfe],J.ext);break;case 125:{if(!F.cellStyles)break;for(;J.e>=J.s;)Z[J.e--]={width:J.w/256,level:J.level||0,hidden:!!(J.flags&1)},te||(te=!0,Gy(J.w/256)),zu(Z[J.e+1])}break;case 520:{var It={};J.level!=null&&(ce[J.r]=It,It.level=J.level),J.hidden&&(ce[J.r]=It,It.hidden=!0),J.hpt&&(ce[J.r]=It,It.hpt=J.hpt,It.hpx=ph(J.hpt))}break;case 38:case 39:case 40:case 41:n["!margins"]||Uf(n["!margins"]={}),n["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[ve]]=J;break;case 161:n["!margins"]||Uf(n["!margins"]={}),n["!margins"].header=J.header,n["!margins"].footer=J.footer;break;case 574:J.RTL&&(I.Views[0].RTL=!0);break;case 146:V=J;break;case 2198:Y=J;break;case 140:M=J;break;case 442:h?z.CodeName=J||z.name:I.WBProps.CodeName=J||"ThisWorkbook";break}}else fe||console.error("Missing Info for XLS Record 0x"+ve.toString(16)),e.l+=ue}return r.SheetNames=xn(s).sort(function(Lt,Ct){return Number(Lt)-Number(Ct)}).map(function(Lt){return s[Lt].name}),t.bookSheets||(r.Sheets=a),!r.SheetNames.length&&p["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=p)):r.Preamble=p,r.Sheets&&L.forEach(function(Lt,Ct){r.Sheets[r.SheetNames[Ct]]["!autofilter"]=Lt}),r.Strings=u,r.SSF=Va(xr),F.enc&&(r.Encryption=F.enc),Y&&(r.Themes=Y),r.Metadata={},M!==void 0&&(r.Metadata.Country=M),Q.names.length>0&&(I.Names=Q.names),r.Workbook=I,r}var Id={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function BG(e,t,r){var a=cr.find(e,"/!DocumentSummaryInformation");if(a&&a.size>0)try{var n=Q3(a,uv,Id.DSI);for(var s in n)t[s]=n[s]}catch(h){if(r.WTF)throw h}var o=cr.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var c=Q3(o,fv,Id.SI);for(var u in c)t[u]==null&&(t[u]=c[u])}catch(h){if(r.WTF)throw h}t.HeadingPairs&&t.TitlesOfParts&&(g6(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function UG(e,t){var r=[],a=[],n=[],s=0,o,c=j3(uv,"n"),u=j3(fv,"n");if(e.Props)for(o=xn(e.Props),s=0;s<o.length;++s)(Object.prototype.hasOwnProperty.call(c,o[s])?r:Object.prototype.hasOwnProperty.call(u,o[s])?a:n).push([o[s],e.Props[o[s]]]);if(e.Custprops)for(o=xn(e.Custprops),s=0;s<o.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},o[s])||(Object.prototype.hasOwnProperty.call(c,o[s])?r:Object.prototype.hasOwnProperty.call(u,o[s])?a:n).push([o[s],e.Custprops[o[s]]]);var h=[];for(s=0;s<n.length;++s)A6.indexOf(n[s][0])>-1||x6.indexOf(n[s][0])>-1||n[s][1]!=null&&h.push(n[s]);a.length&&cr.utils.cfb_add(t,"/SummaryInformation",eS(a,Id.SI,u,fv)),(r.length||h.length)&&cr.utils.cfb_add(t,"/DocumentSummaryInformation",eS(r,Id.DSI,c,uv,h.length?h:null,Id.UDI))}function yT(e,t){t||(t={}),e5(t),by(),t.codepage&&wy(t.codepage);var r,a;if(e.FullPaths){if(cr.find(e,"/encryption"))throw new Error("File is password-protected");r=cr.find(e,"!CompObj"),a=cr.find(e,"/Workbook")||cr.find(e,"/Book")}else{switch(t.type){case"base64":e=Ki(ro(e));break;case"binary":e=Ki(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Ss(e,0),a={content:e}}var n,s;if(r&&OG(r),t.bookProps&&!t.bookSheets)n={};else{var o=Rr?"buffer":"array";if(a&&a.content)n=IG(a.content,t);else if((s=cr.find(e,"PerfectOffice_MAIN"))&&s.content)n=Bf.to_workbook(s.content,(t.type=o,t));else if((s=cr.find(e,"NativeContent_MAIN"))&&s.content)n=Bf.to_workbook(s.content,(t.type=o,t));else throw(s=cr.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&cr.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(n.vbaraw=QU(e))}var c={};return e.FullPaths&&BG(e,c,t),n.Props=n.Custprops=c,t.bookFiles&&(n.cfb=e),n}function zG(e,t){var r=t||{},a=cr.utils.cfb_new({root:"R"}),n="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":n="/Workbook",r.biff=8;break;case"biff5":n="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return cr.utils.cfb_add(a,n,wT(e,r)),r.biff==8&&(e.Props||e.Custprops)&&UG(e,a),r.biff==8&&e.vbaraw&&ez(a,cr.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),a}var fp={0:{f:fV},1:{f:yV},2:{f:IV},3:{f:kV},4:{f:NV},5:{f:OV},6:{f:VV},7:{f:DV},8:{f:JV},9:{f:YV},10:{f:$V},11:{f:XV},12:{f:bV},13:{f:UV},14:{f:jV},15:{f:_V},16:{f:fT},17:{f:GV},18:{f:PV},19:{f:Oy},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:Gq},40:{},42:{},43:{f:VB},44:{f:zB},45:{f:WB},46:{f:XB},47:{f:$B},48:{},49:{f:p9},50:{},51:{f:EU},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:O6},62:{f:HV},63:{f:MU},64:{f:hq},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Zs,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:lq},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:gV},148:{f:pV,p:16},151:{f:rq},152:{},153:{f:Hq},154:{},155:{},156:{f:Uq},157:{},158:{},159:{T:1,f:nB},160:{T:-1},161:{T:1,f:s0},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:KV},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:TU},336:{T:-1},337:{f:DU,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:cv},357:{},358:{},359:{},360:{T:1},361:{},362:{f:L6},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:aq},427:{f:nq},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:iq},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:xV},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:eq},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:cv},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:XU},633:{T:1},634:{T:-1},635:{T:1,f:WU},636:{T:-1},637:{f:v9},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:jq},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:dq},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},gv={6:{f:f2},10:{f:Eu},12:{f:Bn},13:{f:Bn},14:{f:An},15:{f:An},16:{f:Ys},17:{f:An},18:{f:An},19:{f:Bn},20:{f:iS},21:{f:iS},23:{f:L6},24:{f:lS},25:{f:An},26:{},27:{},28:{f:dI},29:{},34:{f:An},35:{f:oS},38:{f:Ys},39:{f:Ys},40:{f:Ys},41:{f:Ys},42:{f:An},43:{f:An},47:{f:_B},49:{f:UM},51:{f:Bn},60:{},61:{f:OM},64:{f:An},65:{f:BM},66:{f:Bn},77:{},80:{},81:{},82:{},85:{f:Bn},89:{},90:{},91:{},92:{f:AM},93:{f:xI},94:{},95:{f:An},96:{},97:{},99:{f:An},125:{f:O6},128:{f:tI},129:{f:TM},130:{f:Bn},131:{f:An},132:{f:An},133:{f:kM},134:{},140:{f:AI},141:{f:Bn},144:{},146:{f:kI},151:{},152:{},153:{},154:{},155:{},156:{f:Bn},157:{},158:{},160:{f:LI},161:{f:CI},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:KM},190:{f:ZM},193:{f:Eu},197:{},198:{},199:{},200:{},201:{},202:{f:An},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Bn},220:{},221:{f:An},222:{},224:{f:eI},225:{f:NM},226:{f:Eu},227:{},229:{f:pI},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:jM},253:{f:HM},255:{f:DM},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:_6},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:An},353:{f:Eu},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:iI},431:{f:An},432:{},433:{},434:{},437:{},438:{f:yI},439:{f:An},440:{f:wI},441:{},442:{f:Np},443:{},444:{f:Bn},445:{},446:{},448:{f:Eu},449:{f:LM,r:2},450:{f:Eu},512:{f:aS},513:{f:PI},515:{f:nI},516:{f:qM},517:{f:sS},519:{f:OI},520:{f:FM},523:{},545:{f:cS},549:{f:rS},566:{},574:{f:MM},638:{f:JM},659:{},1048:{},1054:{f:WM},1084:{},1212:{f:uI},2048:{f:SI},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Im},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Eu},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:EI,r:12},2173:{f:AU,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:An,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:cI,r:12},2197:{},2198:{f:vU,r:12},2199:{},2200:{},2201:{},2202:{f:fI,r:12},2203:{f:Eu},2204:{},2205:{},2206:{},2207:{},2211:{f:PM},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Bn},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:DI},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:TI},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:aS},1:{},2:{f:UI},3:{f:II},4:{f:MI},5:{f:sS},7:{f:HI},8:{},9:{f:Im},11:{},22:{f:Bn},30:{f:XM},31:{},32:{},33:{f:cS},36:{},37:{f:rS},50:{f:VI},62:{},52:{},67:{},68:{f:Bn},69:{},86:{},126:{},127:{f:RI},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:qI},223:{},234:{},354:{},421:{},518:{f:f2},521:{f:Im},536:{f:lS},547:{f:oS},561:{},579:{},1030:{f:f2},1033:{f:Im},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Bt(e,t,r,a){var n=t;if(!isNaN(n)){var s=a||(r||[]).length||0,o=e.next(4);o.write_shift(2,n),o.write_shift(2,s),s>0&&Fy(r)&&e.push(r)}}function HG(e,t,r,a){var n=(r||[]).length||0;if(n<=8224)return Bt(e,t,r,n);var s=t;if(!isNaN(s)){for(var o=r.parts||[],c=0,u=0,h=0;h+(o[c]||8224)<=8224;)h+=o[c]||8224,c++;var p=e.next(4);for(p.write_shift(2,s),p.write_shift(2,h),e.push(r.slice(u,u+h)),u+=h;u<n;){for(p=e.next(4),p.write_shift(2,60),h=0;h+(o[c]||8224)<=8224;)h+=o[c]||8224,c++;p.write_shift(2,h),e.push(r.slice(u,u+h)),u+=h}}}function kp(e,t,r){return e||(e=ht(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function VG(e,t,r,a){var n=ht(9);return kp(n,e,t),T6(r,a||"b",n),n}function qG(e,t,r){var a=ht(8+2*r.length);return kp(a,e,t),a.write_shift(1,r.length),a.write_shift(r.length,r,"sbcs"),a.l<a.length?a.slice(0,a.l):a}function GG(e,t,r,a){if(t.v!=null)switch(t.t){case"d":case"n":var n=t.t=="d"?Yn(Ha(t.v)):t.v;n==(n|0)&&n>=0&&n<65536?Bt(e,2,zI(r,a,n)):Bt(e,3,BI(r,a,n));return;case"b":case"e":Bt(e,5,VG(r,a,t.v,t.t));return;case"s":case"str":Bt(e,4,qG(r,a,(t.v||"").slice(0,255)));return}Bt(e,1,kp(null,r,a))}function WG(e,t,r,a){var n=Array.isArray(t),s=aa(t["!ref"]||"A1"),o,c="",u=[];if(s.e.c>255||s.e.r>16383){if(a.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),o=jr(s)}for(var h=s.s.r;h<=s.e.r;++h){c=jn(h);for(var p=s.s.c;p<=s.e.c;++p){h===s.s.r&&(u[p]=nn(p)),o=u[p]+c;var x=n?(t[h]||[])[p]:t[o];x&&GG(e,x,h,p)}}}function $G(e,t){for(var r=t||{},a=ji(),n=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==r.sheet&&(n=s);if(n==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Bt(a,r.biff==4?1033:r.biff==3?521:9,Hy(e,16,r)),WG(a,e.Sheets[e.SheetNames[n]],n,r),Bt(a,10),a.end()}function XG(e,t,r){Bt(e,49,zM({sz:12,name:"Arial"},r))}function YG(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var n=a[0];n<=a[1];++n)t[n]!=null&&Bt(e,1054,$M(n,t[n],r))})}function JG(e,t){var r=ht(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Bt(e,2151,r),r=ht(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),D6(aa(t["!ref"]||"A1"),r),r.write_shift(4,4),Bt(e,2152,r)}function KG(e,t){for(var r=0;r<16;++r)Bt(e,224,nS({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(a){Bt(e,224,nS(a,0,t))})}function ZG(e,t){for(var r=0;r<t["!links"].length;++r){var a=t["!links"][r];Bt(e,440,bI(a)),a[1].Tooltip&&Bt(e,2048,NI(a))}delete t["!links"]}function QG(e,t){if(t){var r=0;t.forEach(function(a,n){++r<=256&&a&&Bt(e,125,jI(nx(n,a),n))})}}function eW(e,t,r,a,n){var s=16+$u(n.cellXfs,t,n);if(t.v==null&&!t.bf){Bt(e,513,Yf(r,a,s));return}if(t.bf)Bt(e,6,TH(t,r,a,n,s));else switch(t.t){case"d":case"n":var o=t.t=="d"?Yn(Ha(t.v)):t.v;Bt(e,515,sI(r,a,o,s));break;case"b":case"e":Bt(e,517,aI(r,a,t.v,s,n,t.t));break;case"s":case"str":if(n.bookSST){var c=Jy(n.Strings,t.v,n.revStrings);Bt(e,253,VM(r,a,c,s))}else Bt(e,516,GM(r,a,(t.v||"").slice(0,255),s,n));break;default:Bt(e,513,Yf(r,a,s))}}function tW(e,t,r){var a=ji(),n=r.SheetNames[e],s=r.Sheets[n]||{},o=(r||{}).Workbook||{},c=(o.Sheets||[])[e]||{},u=Array.isArray(s),h=t.biff==8,p,x="",v=[],g=aa(s["!ref"]||"A1"),w=h?65536:16384;if(g.e.c>255||g.e.r>=w){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");g.e.c=Math.min(g.e.c,255),g.e.r=Math.min(g.e.c,w-1)}Bt(a,2057,Hy(r,16,t)),Bt(a,13,To(1)),Bt(a,12,To(100)),Bt(a,15,di(!0)),Bt(a,17,di(!1)),Bt(a,16,$f(.001)),Bt(a,95,di(!0)),Bt(a,42,di(!1)),Bt(a,43,di(!1)),Bt(a,130,To(1)),Bt(a,128,rI()),Bt(a,131,di(!1)),Bt(a,132,di(!1)),h&&QG(a,s["!cols"]),Bt(a,512,YM(g,t)),h&&(s["!links"]=[]);for(var b=g.s.r;b<=g.e.r;++b){x=jn(b);for(var N=g.s.c;N<=g.e.c;++N){b===g.s.r&&(v[N]=nn(N)),p=v[N]+x;var _=u?(s[b]||[])[N]:s[p];_&&(eW(a,_,b,N,t),h&&_.l&&s["!links"].push([p,_.l]))}}var E=c.CodeName||c.name||n;return h&&Bt(a,574,IM((o.Views||[])[0])),h&&(s["!merges"]||[]).length&&Bt(a,229,mI(s["!merges"])),h&&ZG(a,s),Bt(a,442,k6(E)),h&&JG(a,s),Bt(a,10),a.end()}function rW(e,t,r){var a=ji(),n=(e||{}).Workbook||{},s=n.Sheets||[],o=n.WBProps||{},c=r.biff==8,u=r.biff==5;if(Bt(a,2057,Hy(e,5,r)),r.bookType=="xla"&&Bt(a,135),Bt(a,225,c?To(1200):null),Bt(a,193,aM(2)),u&&Bt(a,191),u&&Bt(a,192),Bt(a,226),Bt(a,92,_M("SheetJS",r)),Bt(a,66,To(c?1200:1252)),c&&Bt(a,353,To(0)),c&&Bt(a,448),Bt(a,317,FI(e.SheetNames.length)),c&&e.vbaraw&&Bt(a,211),c&&e.vbaraw){var h=o.CodeName||"ThisWorkbook";Bt(a,442,k6(h))}Bt(a,156,To(17)),Bt(a,25,di(!1)),Bt(a,18,di(!1)),Bt(a,19,To(0)),c&&Bt(a,431,di(!1)),c&&Bt(a,444,To(0)),Bt(a,61,RM()),Bt(a,64,di(!1)),Bt(a,141,To(0)),Bt(a,34,di(Lq(e)=="true")),Bt(a,14,di(!0)),c&&Bt(a,439,di(!1)),Bt(a,218,To(0)),XG(a,e,r),YG(a,e.SSF,r),KG(a,r),c&&Bt(a,352,di(!1));var p=a.end(),x=ji();c&&Bt(x,140,_I()),c&&r.Strings&&HG(x,252,CM(r.Strings)),Bt(x,10);var v=x.end(),g=ji(),w=0,b=0;for(b=0;b<e.SheetNames.length;++b)w+=(c?12:11)+(c?2:1)*e.SheetNames[b].length;var N=p.length+w+v.length;for(b=0;b<e.SheetNames.length;++b){var _=s[b]||{};Bt(g,133,EM({pos:N,hs:_.Hidden||0,dt:0,name:e.SheetNames[b]},r)),N+=t[b].length}var E=g.end();if(w!=E.length)throw new Error("BS8 "+w+" != "+E.length);var j=[];return p.length&&j.push(p),E.length&&j.push(E),v.length&&j.push(v),cs(j)}function aW(e,t){var r=t||{},a=[];e&&!e.SSF&&(e.SSF=Va(xr)),e&&e.SSF&&(bh(),K1(e.SSF),r.revssf=Q1(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,t5(r),r.cellXfs=[],$u(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var n=0;n<e.SheetNames.length;++n)a[a.length]=tW(n,r,e);return a.unshift(rW(e,a,r)),cs(a)}function wT(e,t){for(var r=0;r<=e.SheetNames.length;++r){var a=e.Sheets[e.SheetNames[r]];if(!(!a||!a["!ref"])){var n=Ci(a["!ref"]);n.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=t||{};switch(s.biff||2){case 8:case 5:return aW(e,t);case 4:case 3:case 2:return $G(e,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function yS(e,t){var r=t||{},a=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var n=e.match(/<table/i);if(!n)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),o=n.index,c=s&&s.index||e.length,u=zR(e.slice(o,c),/(:?<tr[^>]*>)/i,"<tr>"),h=-1,p=0,x=0,v=0,g={s:{r:1e7,c:1e7},e:{r:0,c:0}},w=[];for(o=0;o<u.length;++o){var b=u[o].trim(),N=b.slice(0,3).toLowerCase();if(N=="<tr"){if(++h,r.sheetRows&&r.sheetRows<=h){--h;break}p=0;continue}if(!(N!="<td"&&N!="<th")){var _=b.split(/<\/t[dh]>/i);for(c=0;c<_.length;++c){var E=_[c].trim();if(E.match(/<t[dh]/i)){for(var j=E,M=0;j.charAt(0)=="<"&&(M=j.indexOf(">"))>-1;)j=j.slice(M+1);for(var U=0;U<w.length;++U){var V=w[U];V.s.c==p&&V.s.r<h&&h<=V.e.r&&(p=V.e.c+1,U=-1)}var I=wr(E.slice(0,E.indexOf(">")));v=I.colspan?+I.colspan:1,((x=+I.rowspan)>1||v>1)&&w.push({s:{r:h,c:p},e:{r:h+(x||1)-1,c:p+v-1}});var z=I.t||I["data-t"]||"";if(!j.length){p+=v;continue}if(j=q_(j),g.s.r>h&&(g.s.r=h),g.e.r<h&&(g.e.r=h),g.s.c>p&&(g.s.c=p),g.e.c<p&&(g.e.c=p),!j.length){p+=v;continue}var H={t:"s",v:j};r.raw||!j.trim().length||z=="s"||(j==="TRUE"?H={t:"b",v:!0}:j==="FALSE"?H={t:"b",v:!1}:isNaN(ll(j))?isNaN(hh(j).getDate())||(H={t:"d",v:Ha(j)},r.cellDates||(H={t:"n",v:Yn(H.v)}),H.z=r.dateNF||xr[14]):H={t:"n",v:ll(j)}),r.dense?(a[h]||(a[h]=[]),a[h][p]=H):a[vr({r:h,c:p})]=H,p+=v}}}}return a["!ref"]=jr(g),w.length&&(a["!merges"]=w),a}function nW(e,t,r,a){for(var n=e["!merges"]||[],s=[],o=t.s.c;o<=t.e.c;++o){for(var c=0,u=0,h=0;h<n.length;++h)if(!(n[h].s.r>r||n[h].s.c>o)&&!(n[h].e.r<r||n[h].e.c<o)){if(n[h].s.r<r||n[h].s.c<o){c=-1;break}c=n[h].e.r-n[h].s.r+1,u=n[h].e.c-n[h].s.c+1;break}if(!(c<0)){var p=vr({r,c:o}),x=a.dense?(e[r]||[])[o]:e[p],v=x&&x.v!=null&&(x.h||jy(x.w||(Hc(x),x.w)||""))||"",g={};c>1&&(g.rowspan=c),u>1&&(g.colspan=u),a.editable?v='<span contenteditable="true">'+v+"</span>":x&&(g["data-t"]=x&&x.t||"z",x.v!=null&&(g["data-v"]=x.v),x.z!=null&&(g["data-z"]=x.z),x.l&&(x.l.Target||"#").charAt(0)!="#"&&(v='<a href="'+x.l.Target+'">'+v+"</a>")),g.id=(a.id||"sjs")+"-"+p,s.push(Mt("td",v,g))}}var w="<tr>";return w+s.join("")+"</tr>"}var sW='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',iW="</body></html>";function oW(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return Wu(yS(r[0],t),t);var a=n5();return r.forEach(function(n,s){s5(a,yS(n,t),"Sheet"+(s+1))}),a}function lW(e,t,r){var a=[];return a.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function bT(e,t){var r=t||{},a=r.header!=null?r.header:sW,n=r.footer!=null?r.footer:iW,s=[a],o=Ci(e["!ref"]);r.dense=Array.isArray(e),s.push(lW(e,o,r));for(var c=o.s.r;c<=o.e.r;++c)s.push(nW(e,o,c,r));return s.push("</table>"+n),s.join("")}function ST(e,t,r){var a=r||{},n=0,s=0;if(a.origin!=null)if(typeof a.origin=="number")n=a.origin;else{var o=typeof a.origin=="string"?sn(a.origin):a.origin;n=o.r,s=o.c}var c=t.getElementsByTagName("tr"),u=Math.min(a.sheetRows||1e7,c.length),h={s:{r:0,c:0},e:{r:n,c:s}};if(e["!ref"]){var p=Ci(e["!ref"]);h.s.r=Math.min(h.s.r,p.s.r),h.s.c=Math.min(h.s.c,p.s.c),h.e.r=Math.max(h.e.r,p.e.r),h.e.c=Math.max(h.e.c,p.e.c),n==-1&&(h.e.r=n=p.e.r+1)}var x=[],v=0,g=e["!rows"]||(e["!rows"]=[]),w=0,b=0,N=0,_=0,E=0,j=0;for(e["!cols"]||(e["!cols"]=[]);w<c.length&&b<u;++w){var M=c[w];if(wS(M)){if(a.display)continue;g[b]={hidden:!0}}var U=M.children;for(N=_=0;N<U.length;++N){var V=U[N];if(!(a.display&&wS(V))){var I=V.hasAttribute("data-v")?V.getAttribute("data-v"):V.hasAttribute("v")?V.getAttribute("v"):q_(V.innerHTML),z=V.getAttribute("data-z")||V.getAttribute("z");for(v=0;v<x.length;++v){var H=x[v];H.s.c==_+s&&H.s.r<b+n&&b+n<=H.e.r&&(_=H.e.c+1-s,v=-1)}j=+V.getAttribute("colspan")||1,((E=+V.getAttribute("rowspan")||1)>1||j>1)&&x.push({s:{r:b+n,c:_+s},e:{r:b+n+(E||1)-1,c:_+s+(j||1)-1}});var re={t:"s",v:I},R=V.getAttribute("data-t")||V.getAttribute("t")||"";I!=null&&(I.length==0?re.t=R||"z":a.raw||I.trim().length==0||R=="s"||(I==="TRUE"?re={t:"b",v:!0}:I==="FALSE"?re={t:"b",v:!1}:isNaN(ll(I))?isNaN(hh(I).getDate())||(re={t:"d",v:Ha(I)},a.cellDates||(re={t:"n",v:Yn(re.v)}),re.z=a.dateNF||xr[14]):re={t:"n",v:ll(I)})),re.z===void 0&&z!=null&&(re.z=z);var F="",Y=V.getElementsByTagName("A");if(Y&&Y.length)for(var K=0;K<Y.length&&!(Y[K].hasAttribute("href")&&(F=Y[K].getAttribute("href"),F.charAt(0)!="#"));++K);F&&F.charAt(0)!="#"&&(re.l={Target:F}),a.dense?(e[b+n]||(e[b+n]=[]),e[b+n][_+s]=re):e[vr({c:_+s,r:b+n})]=re,h.e.c<_+s&&(h.e.c=_+s),_+=j}}++b}return x.length&&(e["!merges"]=(e["!merges"]||[]).concat(x)),h.e.r=Math.max(h.e.r,b-1+n),e["!ref"]=jr(h),b>=u&&(e["!fullref"]=jr((h.e.r=c.length-w+b-1+n,h))),e}function NT(e,t){var r=t||{},a=r.dense?[]:{};return ST(a,e,t)}function cW(e,t){return Wu(NT(e,t),t)}function wS(e){var t="",r=uW(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function uW(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function fW(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(a,n){return Array(parseInt(n,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=ra(t.replace(/<[^>]*>/g,""));return[r]}var bS={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function AT(e,t){var r=t||{},a=Cy(e),n=[],s,o,c={name:""},u="",h=0,p,x,v={},g=[],w=r.dense?[]:{},b,N,_={value:""},E="",j=0,M=[],U=-1,V=-1,I={s:{r:1e6,c:1e7},e:{r:0,c:0}},z=0,H={},re=[],R={},F=0,Y=0,K=[],X=1,Z=1,ce=[],te={Names:[]},Q={},G=["",""],ye=[],D={},O="",L=0,q=!1,oe=!1,be=0;for(sp.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");b=sp.exec(a);)switch(b[3]=b[3].replace(/_.*$/,"")){case"table":case"工作表":b[1]==="/"?(I.e.c>=I.s.c&&I.e.r>=I.s.r?w["!ref"]=jr(I):w["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=I.e.r&&(w["!fullref"]=w["!ref"],I.e.r=r.sheetRows-1,w["!ref"]=jr(I)),re.length&&(w["!merges"]=re),K.length&&(w["!rows"]=K),p.name=p.名称||p.name,typeof JSON<"u"&&JSON.stringify(p),g.push(p.name),v[p.name]=w,oe=!1):b[0].charAt(b[0].length-2)!=="/"&&(p=wr(b[0],!1),U=V=-1,I.s.r=I.s.c=1e7,I.e.r=I.e.c=0,w=r.dense?[]:{},re=[],K=[],oe=!0);break;case"table-row-group":b[1]==="/"?--z:++z;break;case"table-row":case"行":if(b[1]==="/"){U+=X,X=1;break}if(x=wr(b[0],!1),x.行号?U=x.行号-1:U==-1&&(U=0),X=+x["number-rows-repeated"]||1,X<10)for(be=0;be<X;++be)z>0&&(K[U+be]={level:z});V=-1;break;case"covered-table-cell":b[1]!=="/"&&++V,r.sheetStubs&&(r.dense?(w[U]||(w[U]=[]),w[U][V]={t:"z"}):w[vr({r:U,c:V})]={t:"z"}),E="",M=[];break;case"table-cell":case"数据":if(b[0].charAt(b[0].length-2)==="/")++V,_=wr(b[0],!1),Z=parseInt(_["number-columns-repeated"]||"1",10),N={t:"z",v:null},_.formula&&r.cellFormula!=!1&&(N.f=xS(ra(_.formula))),(_.数据类型||_["value-type"])=="string"&&(N.t="s",N.v=ra(_["string-value"]||""),r.dense?(w[U]||(w[U]=[]),w[U][V]=N):w[vr({r:U,c:V})]=N),V+=Z-1;else if(b[1]!=="/"){++V,E="",j=0,M=[],Z=1;var ve=X?U+X-1:U;if(V>I.e.c&&(I.e.c=V),V<I.s.c&&(I.s.c=V),U<I.s.r&&(I.s.r=U),ve>I.e.r&&(I.e.r=ve),_=wr(b[0],!1),ye=[],D={},N={t:_.数据类型||_["value-type"],v:null},r.cellFormula)if(_.formula&&(_.formula=ra(_.formula)),_["number-matrix-columns-spanned"]&&_["number-matrix-rows-spanned"]&&(F=parseInt(_["number-matrix-rows-spanned"],10)||0,Y=parseInt(_["number-matrix-columns-spanned"],10)||0,R={s:{r:U,c:V},e:{r:U+F-1,c:V+Y-1}},N.F=jr(R),ce.push([R,N.F])),_.formula)N.f=xS(_.formula);else for(be=0;be<ce.length;++be)U>=ce[be][0].s.r&&U<=ce[be][0].e.r&&V>=ce[be][0].s.c&&V<=ce[be][0].e.c&&(N.F=ce[be][1]);switch((_["number-columns-spanned"]||_["number-rows-spanned"])&&(F=parseInt(_["number-rows-spanned"],10)||0,Y=parseInt(_["number-columns-spanned"],10)||0,R={s:{r:U,c:V},e:{r:U+F-1,c:V+Y-1}},re.push(R)),_["number-columns-repeated"]&&(Z=parseInt(_["number-columns-repeated"],10)),N.t){case"boolean":N.t="b",N.v=Ua(_["boolean-value"]);break;case"float":N.t="n",N.v=parseFloat(_.value);break;case"percentage":N.t="n",N.v=parseFloat(_.value);break;case"currency":N.t="n",N.v=parseFloat(_.value);break;case"date":N.t="d",N.v=Ha(_["date-value"]),r.cellDates||(N.t="n",N.v=Yn(N.v)),N.z="m/d/yy";break;case"time":N.t="n",N.v=IR(_["time-value"])/86400,r.cellDates&&(N.t="d",N.v=ex(N.v)),N.z="HH:MM:SS";break;case"number":N.t="n",N.v=parseFloat(_.数据数值);break;default:if(N.t==="string"||N.t==="text"||!N.t)N.t="s",_["string-value"]!=null&&(E=ra(_["string-value"]),M=[]);else throw new Error("Unsupported value type "+N.t)}}else{if(q=!1,N.t==="s"&&(N.v=E||"",M.length&&(N.R=M),q=j==0),Q.Target&&(N.l=Q),ye.length>0&&(N.c=ye,ye=[]),E&&r.cellText!==!1&&(N.w=E),q&&(N.t="z",delete N.v),(!q||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=U))for(var ue=0;ue<X;++ue){if(Z=parseInt(_["number-columns-repeated"]||"1",10),r.dense)for(w[U+ue]||(w[U+ue]=[]),w[U+ue][V]=ue==0?N:Va(N);--Z>0;)w[U+ue][V+Z]=Va(N);else for(w[vr({r:U+ue,c:V})]=N;--Z>0;)w[vr({r:U+ue,c:V+Z})]=Va(N);I.e.c<=V&&(I.e.c=V)}Z=parseInt(_["number-columns-repeated"]||"1",10),V+=Z-1,Z=0,N={},E="",M=[]}Q={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(b[1]==="/"){if((s=n.pop())[0]!==b[3])throw"Bad state: "+s}else b[0].charAt(b[0].length-2)!=="/"&&n.push([b[3],!0]);break;case"annotation":if(b[1]==="/"){if((s=n.pop())[0]!==b[3])throw"Bad state: "+s;D.t=E,M.length&&(D.R=M),D.a=O,ye.push(D)}else b[0].charAt(b[0].length-2)!=="/"&&n.push([b[3],!1]);O="",L=0,E="",j=0,M=[];break;case"creator":b[1]==="/"?O=a.slice(L,b.index):L=b.index+b[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(b[1]==="/"){if((s=n.pop())[0]!==b[3])throw"Bad state: "+s}else b[0].charAt(b[0].length-2)!=="/"&&n.push([b[3],!1]);E="",j=0,M=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(b[1]==="/"){if(H[c.name]=u,(s=n.pop())[0]!==b[3])throw"Bad state: "+s}else b[0].charAt(b[0].length-2)!=="/"&&(u="",c=wr(b[0],!1),n.push([b[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(n[n.length-1][0]){case"time-style":case"date-style":o=wr(b[0],!1),u+=bS[b[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(n[n.length-1][0]){case"time-style":case"date-style":o=wr(b[0],!1),u+=bS[b[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(b[0].slice(-2)==="/>")break;if(b[1]==="/")switch(n[n.length-1][0]){case"number-style":case"date-style":case"time-style":u+=a.slice(h,b.index);break}else h=b.index+b[0].length;break;case"named-range":o=wr(b[0],!1),G=h2(o["cell-range-address"]);var fe={Name:o.name,Ref:G[0]+"!"+G[1]};oe&&(fe.Sheet=g.length),te.Names.push(fe);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(n[n.length-1][0])>-1)break;if(b[1]==="/"&&(!_||!_["string-value"])){var Ee=fW(a.slice(j,b.index));E=(E.length>0?E+`
`:"")+Ee[0]}else wr(b[0],!1),j=b.index+b[0].length;break;case"s":break;case"database-range":if(b[1]==="/")break;try{G=h2(wr(b[0])["target-range-address"]),v[G[0]]["!autofilter"]={ref:G[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(b[1]!=="/"){if(Q=wr(b[0],!1),!Q.href)break;Q.Target=ra(Q.href),delete Q.href,Q.Target.charAt(0)=="#"&&Q.Target.indexOf(".")>-1?(G=h2(Q.Target.slice(1)),Q.Target="#"+G[0]+"!"+G[1]):Q.Target.match(/^\.\.[\\\/]/)&&(Q.Target=Q.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(b[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(r.WTF)throw new Error(b)}}var J={Sheets:v,SheetNames:g,Workbook:te};return r.bookSheets&&delete J.Sheets,J}function SS(e,t){t=t||{},_o(e,"META-INF/manifest.xml")&&I9(In(e,"META-INF/manifest.xml"),t);var r=Zi(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var a=AT(Na(r),t);return _o(e,"meta.xml")&&(a.Props=p6(In(e,"meta.xml"))),a}function NS(e,t){return AT(e,t)}var hW=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+np({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return Cn+t}}(),AS=function(){var e=function(s){return ya(s).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,a=function(s,o,c){var u=[];u.push('      <table:table table:name="'+ya(o.SheetNames[c])+`" table:style-name="ta1">
`);var h=0,p=0,x=Ci(s["!ref"]||"A1"),v=s["!merges"]||[],g=0,w=Array.isArray(s);if(s["!cols"])for(p=0;p<=x.e.c;++p)u.push("        <table:table-column"+(s["!cols"][p]?' table:style-name="co'+s["!cols"][p].ods+'"':"")+`></table:table-column>
`);var b="",N=s["!rows"]||[];for(h=0;h<x.s.r;++h)b=N[h]?' table:style-name="ro'+N[h].ods+'"':"",u.push("        <table:table-row"+b+`></table:table-row>
`);for(;h<=x.e.r;++h){for(b=N[h]?' table:style-name="ro'+N[h].ods+'"':"",u.push("        <table:table-row"+b+`>
`),p=0;p<x.s.c;++p)u.push(t);for(;p<=x.e.c;++p){var _=!1,E={},j="";for(g=0;g!=v.length;++g)if(!(v[g].s.c>p)&&!(v[g].s.r>h)&&!(v[g].e.c<p)&&!(v[g].e.r<h)){(v[g].s.c!=p||v[g].s.r!=h)&&(_=!0),E["table:number-columns-spanned"]=v[g].e.c-v[g].s.c+1,E["table:number-rows-spanned"]=v[g].e.r-v[g].s.r+1;break}if(_){u.push(r);continue}var M=vr({r:h,c:p}),U=w?(s[h]||[])[p]:s[M];if(U&&U.f&&(E["table:formula"]=ya(FH(U.f)),U.F&&U.F.slice(0,M.length)==M)){var V=Ci(U.F);E["table:number-matrix-columns-spanned"]=V.e.c-V.s.c+1,E["table:number-matrix-rows-spanned"]=V.e.r-V.s.r+1}if(!U){u.push(t);continue}switch(U.t){case"b":j=U.v?"TRUE":"FALSE",E["office:value-type"]="boolean",E["office:boolean-value"]=U.v?"true":"false";break;case"n":j=U.w||String(U.v||0),E["office:value-type"]="float",E["office:value"]=U.v||0;break;case"s":case"str":j=U.v==null?"":U.v,E["office:value-type"]="string";break;case"d":j=U.w||Ha(U.v).toISOString(),E["office:value-type"]="date",E["office:date-value"]=Ha(U.v).toISOString(),E["table:style-name"]="ce1";break;default:u.push(t);continue}var I=e(j);if(U.l&&U.l.Target){var z=U.l.Target;z=z.charAt(0)=="#"?"#"+PH(z.slice(1)):z,z.charAt(0)!="#"&&!z.match(/^\w+:/)&&(z="../"+z),I=Mt("text:a",I,{"xlink:href":z.replace(/&/g,"&amp;")})}u.push("          "+Mt("table:table-cell",Mt("text:p",I,{}),E)+`
`)}u.push(`        </table:table-row>
`)}return u.push(`      </table:table>
`),u.join("")},n=function(s,o){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var c=0;o.SheetNames.map(function(h){return o.Sheets[h]}).forEach(function(h){if(h&&h["!cols"]){for(var p=0;p<h["!cols"].length;++p)if(h["!cols"][p]){var x=h["!cols"][p];if(x.width==null&&x.wpx==null&&x.wch==null)continue;zu(x),x.ods=c;var v=h["!cols"][p].wpx+"px";s.push('  <style:style style:name="co'+c+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+v+`"/>
`),s.push(`  </style:style>
`),++c}}});var u=0;o.SheetNames.map(function(h){return o.Sheets[h]}).forEach(function(h){if(h&&h["!rows"]){for(var p=0;p<h["!rows"].length;++p)if(h["!rows"][p]){h["!rows"][p].ods=u;var x=h["!rows"][p].hpx+"px";s.push('  <style:style style:name="ro'+u+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+x+`"/>
`),s.push(`  </style:style>
`),++u}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(o,c){var u=[Cn],h=np({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),p=np({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});c.bookType=="fods"?(u.push("<office:document"+h+p+`>
`),u.push(d6().replace(/office:document-meta/g,"office:meta"))):u.push("<office:document-content"+h+`>
`),n(u,o),u.push(`  <office:body>
`),u.push(`    <office:spreadsheet>
`);for(var x=0;x!=o.SheetNames.length;++x)u.push(a(o.Sheets[o.SheetNames[x]],o,x));return u.push(`    </office:spreadsheet>
`),u.push(`  </office:body>
`),c.bookType=="fods"?u.push("</office:document>"):u.push("</office:document-content>"),u.join("")}}();function _T(e,t){if(t.bookType=="fods")return AS(e,t);var r=Ty(),a="",n=[],s=[];return a="mimetype",Fr(r,a,"application/vnd.oasis.opendocument.spreadsheet"),a="content.xml",Fr(r,a,AS(e,t)),n.push([a,"text/xml"]),s.push([a,"ContentFile"]),a="styles.xml",Fr(r,a,hW(e,t)),n.push([a,"text/xml"]),s.push([a,"StylesFile"]),a="meta.xml",Fr(r,a,Cn+d6()),n.push([a,"text/xml"]),s.push([a,"MetadataFile"]),a="manifest.rdf",Fr(r,a,z9(s)),n.push([a,"application/rdf+xml"]),a="META-INF/manifest.xml",Fr(r,a,B9(n)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Jf(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function vv(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Na(Gu(e))}function dW(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Ki(Gl(e))}function pW(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var a=0;a<t.length;++a)if(e[r+a]!=t[a])continue e;return!0}return!1}function Vu(e){var t=e.reduce(function(n,s){return n+s.length},0),r=new Uint8Array(t),a=0;return e.forEach(function(n){r.set(n,a),a+=n.length}),r}function _S(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function mW(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,a=e[t+14]&1,n=t+13;n>=t;--n)a=a*256+e[n];return(e[t+15]&128?-a:a)*Math.pow(10,r-6176)}function xW(e,t,r){var a=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,n=r/Math.pow(10,a-6176);e[t+15]|=a>>7,e[t+14]|=(a&127)<<1;for(var s=0;n>=1;++s,n/=256)e[t+s]=n&255;e[t+15]|=r>=0?0:128}function hp(e,t){var r=t?t[0]:0,a=e[r]&127;e:if(e[r++]>=128&&(a|=(e[r]&127)<<7,e[r++]<128||(a|=(e[r]&127)<<14,e[r++]<128)||(a|=(e[r]&127)<<21,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(a+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),a}function xa(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function mn(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function oa(e){for(var t=[],r=[0];r[0]<e.length;){var a=r[0],n=hp(e,r),s=n&7;n=Math.floor(n/8);var o=0,c;if(n==0)break;switch(s){case 0:{for(var u=r[0];e[r[0]++]>=128;);c=e.slice(u,r[0])}break;case 5:o=4,c=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,c=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=hp(e,r),c=e.slice(r[0],r[0]+o),r[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(n," at offset ").concat(a))}var h={data:c,type:s};t[n]==null?t[n]=[h]:t[n].push(h)}return t}function ys(e){var t=[];return e.forEach(function(r,a){r.forEach(function(n){n.data&&(t.push(xa(a*8+n.type)),n.type==2&&t.push(xa(n.data.length)),t.push(n.data))})}),Vu(t)}function Qy(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function So(e){for(var t,r=[],a=[0];a[0]<e.length;){var n=hp(e,a),s=oa(e.slice(a[0],a[0]+n));a[0]+=n;var o={id:mn(s[1][0].data),messages:[]};s[2].forEach(function(c){var u=oa(c.data),h=mn(u[3][0].data);o.messages.push({meta:u,data:e.slice(a[0],a[0]+h)}),a[0]+=h}),(t=s[3])!=null&&t[0]&&(o.merge=mn(s[3][0].data)>>>0>0),r.push(o)}return r}function z0(e){var t=[];return e.forEach(function(r){var a=[];a[1]=[{data:xa(r.id),type:0}],a[2]=[],r.merge!=null&&(a[3]=[{data:xa(+!!r.merge),type:0}]);var n=[];r.messages.forEach(function(o){n.push(o.data),o.meta[3]=[{type:0,data:xa(o.data.length)}],a[2].push({data:ys(o.meta),type:2})});var s=ys(a);t.push(xa(s.length)),t.push(s),n.forEach(function(o){return t.push(o)})}),Vu(t)}function gW(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],a=hp(t,r),n=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var c=o-59;o=t[r[0]],c>1&&(o|=t[r[0]+1]<<8),c>2&&(o|=t[r[0]+2]<<16),c>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=c}n.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var u=0,h=0;if(s==1?(h=(t[r[0]]>>2&7)+4,u=(t[r[0]++]&224)<<3,u|=t[r[0]++]):(h=(t[r[0]++]>>2)+1,s==2?(u=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(u=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),n=[Vu(n)],u==0)throw new Error("Invalid offset 0");if(u>n[0].length)throw new Error("Invalid offset beyond length");if(h>=u)for(n.push(n[0].slice(-u)),h-=u;h>=n[n.length-1].length;)n.push(n[n.length-1]),h-=n[n.length-1].length;n.push(n[0].slice(-u,-u+h))}}var p=Vu(n);if(p.length!=a)throw new Error("Unexpected length: ".concat(p.length," != ").concat(a));return p}function No(e){for(var t=[],r=0;r<e.length;){var a=e[r++],n=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(gW(a,e.slice(r,r+n))),r+=n}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Vu(t)}function H0(e){for(var t=[],r=0;r<e.length;){var a=Math.min(e.length-r,268435455),n=new Uint8Array(4);t.push(n);var s=xa(a),o=s.length;t.push(s),a<=60?(o++,t.push(new Uint8Array([a-1<<2]))):a<=256?(o+=2,t.push(new Uint8Array([240,a-1&255]))):a<=65536?(o+=3,t.push(new Uint8Array([244,a-1&255,a-1>>8&255]))):a<=16777216?(o+=4,t.push(new Uint8Array([248,a-1&255,a-1>>8&255,a-1>>16&255]))):a<=4294967296&&(o+=5,t.push(new Uint8Array([252,a-1&255,a-1>>8&255,a-1>>16&255,a-1>>>24&255]))),t.push(e.slice(r,r+a)),o+=a,n[0]=0,n[1]=o&255,n[2]=o>>8&255,n[3]=o>>16&255,r+=a}return Vu(t)}function vW(e,t,r,a){var n=Jf(e),s=n.getUint32(4,!0),o=(a>1?12:8)+_S(s&(a>1?3470:398))*4,c=-1,u=-1,h=NaN,p=new Date(2001,0,1);s&512&&(c=n.getUint32(o,!0),o+=4),o+=_S(s&(a>1?12288:4096))*4,s&16&&(u=n.getUint32(o,!0),o+=4),s&32&&(h=n.getFloat64(o,!0),o+=8),s&64&&(p.setTime(p.getTime()+n.getFloat64(o,!0)*1e3),o+=8);var x;switch(e[2]){case 0:break;case 2:x={t:"n",v:h};break;case 3:x={t:"s",v:t[u]};break;case 5:x={t:"d",v:p};break;case 6:x={t:"b",v:h>0};break;case 7:x={t:"n",v:h/86400};break;case 8:x={t:"e",v:0};break;case 9:if(c>-1)x={t:"s",v:r[c]};else if(u>-1)x={t:"s",v:t[u]};else if(!isNaN(h))x={t:"n",v:h};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return x}function yW(e,t,r){var a=Jf(e),n=a.getUint32(8,!0),s=12,o=-1,c=-1,u=NaN,h=NaN,p=new Date(2001,0,1);n&1&&(u=mW(e,s),s+=16),n&2&&(h=a.getFloat64(s,!0),s+=8),n&4&&(p.setTime(p.getTime()+a.getFloat64(s,!0)*1e3),s+=8),n&8&&(c=a.getUint32(s,!0),s+=4),n&16&&(o=a.getUint32(s,!0),s+=4);var x;switch(e[1]){case 0:break;case 2:x={t:"n",v:u};break;case 3:x={t:"s",v:t[c]};break;case 5:x={t:"d",v:p};break;case 6:x={t:"b",v:h>0};break;case 7:x={t:"n",v:h/86400};break;case 8:x={t:"e",v:0};break;case 9:if(o>-1)x={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(n&31," : ").concat(e.slice(0,4)));break;case 10:x={t:"n",v:u};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(n&31," : ").concat(e.slice(0,4)))}return x}function p2(e,t){var r=new Uint8Array(32),a=Jf(r),n=12,s=0;switch(r[0]=5,e.t){case"n":r[1]=2,xW(r,n,e.v),s|=1,n+=16;break;case"b":r[1]=6,a.setFloat64(n,e.v?1:0,!0),s|=2,n+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,a.setUint32(n,t.indexOf(e.v),!0),s|=8,n+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(8,s,!0),r.slice(0,n)}function m2(e,t){var r=new Uint8Array(32),a=Jf(r),n=12,s=0;switch(r[0]=3,e.t){case"n":r[2]=2,a.setFloat64(n,e.v,!0),s|=32,n+=8;break;case"b":r[2]=6,a.setFloat64(n,e.v?1:0,!0),s|=32,n+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,a.setUint32(n,t.indexOf(e.v),!0),s|=16,n+=4;break;default:throw"unsupported cell type "+e.t}return a.setUint32(4,s,!0),r.slice(0,n)}function wW(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return vW(e,t,r,e[0]);case 5:return yW(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Gs(e){var t=oa(e);return hp(t[1][0].data)}function TS(e,t){var r=oa(t.data),a=mn(r[1][0].data),n=r[3],s=[];return(n||[]).forEach(function(o){var c=oa(o.data),u=mn(c[1][0].data)>>>0;switch(a){case 1:s[u]=vv(c[3][0].data);break;case 8:{var h=e[Gs(c[9][0].data)][0],p=oa(h.data),x=e[Gs(p[1][0].data)][0],v=mn(x.meta[1][0].data);if(v!=2001)throw new Error("2000 unexpected reference to ".concat(v));var g=oa(x.data);s[u]=g[3].map(function(w){return vv(w.data)}).join("")}break}}),s}function bW(e,t){var r,a,n,s,o,c,u,h,p,x,v,g,w,b,N=oa(e),_=mn(N[1][0].data)>>>0,E=mn(N[2][0].data)>>>0,j=((a=(r=N[8])==null?void 0:r[0])==null?void 0:a.data)&&mn(N[8][0].data)>0||!1,M,U;if((s=(n=N[7])==null?void 0:n[0])!=null&&s.data&&t!=0)M=(c=(o=N[7])==null?void 0:o[0])==null?void 0:c.data,U=(h=(u=N[6])==null?void 0:u[0])==null?void 0:h.data;else if((x=(p=N[4])==null?void 0:p[0])!=null&&x.data&&t!=1)M=(g=(v=N[4])==null?void 0:v[0])==null?void 0:g.data,U=(b=(w=N[3])==null?void 0:w[0])==null?void 0:b.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var V=j?4:1,I=Jf(M),z=[],H=0;H<M.length/2;++H){var re=I.getUint16(H*2,!0);re<65535&&z.push([H,re])}if(z.length!=E)throw"Expected ".concat(E," cells, found ").concat(z.length);var R=[];for(H=0;H<z.length-1;++H)R[z[H][0]]=U.subarray(z[H][1]*V,z[H+1][1]*V);return z.length>=1&&(R[z[z.length-1][0]]=U.subarray(z[z.length-1][1]*V)),{R:_,cells:R}}function SW(e,t){var r,a=oa(t.data),n=(r=a==null?void 0:a[7])!=null&&r[0]?mn(a[7][0].data)>>>0>0?1:0:-1,s=Qy(a[5],function(o){return bW(o,n)});return{nrows:mn(a[4][0].data)>>>0,data:s.reduce(function(o,c){return o[c.R]||(o[c.R]=[]),c.cells.forEach(function(u,h){if(o[c.R][h])throw new Error("Duplicate cell r=".concat(c.R," c=").concat(h));o[c.R][h]=u}),o},[])}}function NW(e,t,r){var a,n=oa(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(mn(n[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(n[6][0].data));if(s.e.c=(mn(n[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(n[7][0].data));r["!ref"]=jr(s);var o=oa(n[4][0].data),c=TS(e,e[Gs(o[4][0].data)][0]),u=(a=o[17])!=null&&a[0]?TS(e,e[Gs(o[17][0].data)][0]):[],h=oa(o[3][0].data),p=0;h[1].forEach(function(x){var v=oa(x.data),g=e[Gs(v[2][0].data)][0],w=mn(g.meta[1][0].data);if(w!=6002)throw new Error("6001 unexpected reference to ".concat(w));var b=SW(e,g);b.data.forEach(function(N,_){N.forEach(function(E,j){var M=vr({r:p+_,c:j}),U=wW(E,c,u);U&&(r[M]=U)})}),p+=b.nrows})}function AW(e,t){var r=oa(t.data),a={"!ref":"A1"},n=e[Gs(r[2][0].data)],s=mn(n[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return NW(e,n[0],a),a}function _W(e,t){var r,a=oa(t.data),n={name:(r=a[1])!=null&&r[0]?vv(a[1][0].data):"",sheets:[]},s=Qy(a[2],Gs);return s.forEach(function(o){e[o].forEach(function(c){var u=mn(c.meta[1][0].data);u==6e3&&n.sheets.push(AW(e,c))})}),n}function TW(e,t){var r=n5(),a=oa(t.data),n=Qy(a[1],Gs);if(n.forEach(function(s){e[s].forEach(function(o){var c=mn(o.meta[1][0].data);if(c==2){var u=_W(e,o);u.sheets.forEach(function(h,p){s5(r,h,p==0?u.name:u.name+"_"+p,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function x2(e){var t,r,a,n,s={},o=[];if(e.FullPaths.forEach(function(u){if(u.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(u){if(u.name.match(/\.iwa$/)){var h;try{h=No(u.content)}catch(x){return console.log("?? "+u.content.length+" "+(x.message||x))}var p;try{p=So(h)}catch(x){return console.log("## "+(x.message||x))}p.forEach(function(x){s[x.id]=x.messages,o.push(x.id)})}}),!o.length)throw new Error("File has no messages");var c=((n=(a=(r=(t=s==null?void 0:s[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:a[1])==null?void 0:n[0].data)&&mn(s[1][0].meta[1][0].data)==1&&s[1][0];if(c||o.forEach(function(u){s[u].forEach(function(h){var p=mn(h.meta[1][0].data)>>>0;if(p==1)if(!c)c=h;else throw new Error("Document has multiple roots")})}),!c)throw new Error("Cannot find Document root");return TW(s,c)}function kW(e,t,r){var a,n,s,o;if(!((a=e[6])!=null&&a[0])||!((n=e[7])!=null&&n[0]))throw"Mutation only works on post-BNC storages!";var c=((o=(s=e[8])==null?void 0:s[0])==null?void 0:o.data)&&mn(e[8][0].data)>0||!1;if(c)throw"Math only works with normal offsets";for(var u=0,h=Jf(e[7][0].data),p=0,x=[],v=Jf(e[4][0].data),g=0,w=[],b=0;b<t.length;++b){if(t[b]==null){h.setUint16(b*2,65535,!0),v.setUint16(b*2,65535);continue}h.setUint16(b*2,p,!0),v.setUint16(b*2,g,!0);var N,_;switch(typeof t[b]){case"string":N=p2({t:"s",v:t[b]},r),_=m2({t:"s",v:t[b]},r);break;case"number":N=p2({t:"n",v:t[b]},r),_=m2({t:"n",v:t[b]},r);break;case"boolean":N=p2({t:"b",v:t[b]},r),_=m2({t:"b",v:t[b]},r);break;default:throw new Error("Unsupported value "+t[b])}x.push(N),p+=N.length,w.push(_),g+=_.length,++u}for(e[2][0].data=xa(u);b<e[7][0].data.length/2;++b)h.setUint16(b*2,65535,!0),v.setUint16(b*2,65535,!0);return e[6][0].data=Vu(x),e[3][0].data=Vu(w),u}function EW(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var a=Ci(r["!ref"]);a.s.r=a.s.c=0;var n=!1;a.e.c>9&&(n=!0,a.e.c=9),a.e.r>49&&(n=!0,a.e.r=49),n&&console.error("The Numbers writer is currently limited to ".concat(jr(a)));var s=F1(r,{range:a,header:1}),o=["~Sh33tJ5~"];s.forEach(function(O){return O.forEach(function(L){typeof L=="string"&&o.push(L)})});var c={},u=[],h=cr.read(t.numbers,{type:"base64"});h.FileIndex.map(function(O,L){return[O,h.FullPaths[L]]}).forEach(function(O){var L=O[0],q=O[1];if(L.type==2&&L.name.match(/\.iwa/)){var oe=L.content,be=No(oe),ve=So(be);ve.forEach(function(ue){u.push(ue.id),c[ue.id]={deps:[],location:q,type:mn(ue.messages[0].meta[1][0].data)}})}}),u.sort(function(O,L){return O-L});var p=u.filter(function(O){return O>1}).map(function(O){return[O,xa(O)]});h.FileIndex.map(function(O,L){return[O,h.FullPaths[L]]}).forEach(function(O){var L=O[0];if(O[1],!!L.name.match(/\.iwa/)){var q=So(No(L.content));q.forEach(function(oe){oe.messages.forEach(function(be){p.forEach(function(ve){oe.messages.some(function(ue){return mn(ue.meta[1][0].data)!=11006&&pW(ue.data,ve[1])})&&c[ve[0]].deps.push(oe.id)})})})}});for(var x=cr.find(h,c[1].location),v=So(No(x.content)),g,w=0;w<v.length;++w){var b=v[w];b.id==1&&(g=b)}var N=Gs(oa(g.messages[0].data)[1][0].data);for(x=cr.find(h,c[N].location),v=So(No(x.content)),w=0;w<v.length;++w)b=v[w],b.id==N&&(g=b);for(N=Gs(oa(g.messages[0].data)[2][0].data),x=cr.find(h,c[N].location),v=So(No(x.content)),w=0;w<v.length;++w)b=v[w],b.id==N&&(g=b);for(N=Gs(oa(g.messages[0].data)[2][0].data),x=cr.find(h,c[N].location),v=So(No(x.content)),w=0;w<v.length;++w)b=v[w],b.id==N&&(g=b);var _=oa(g.messages[0].data);{_[6][0].data=xa(a.e.r+1),_[7][0].data=xa(a.e.c+1);var E=Gs(_[46][0].data),j=cr.find(h,c[E].location),M=So(No(j.content));{for(var U=0;U<M.length&&M[U].id!=E;++U);if(M[U].id!=E)throw"Bad ColumnRowUIDMapArchive";var V=oa(M[U].messages[0].data);V[1]=[],V[2]=[],V[3]=[];for(var I=0;I<=a.e.c;++I){var z=[];z[1]=z[2]=[{type:0,data:xa(I+420690)}],V[1].push({type:2,data:ys(z)}),V[2].push({type:0,data:xa(I)}),V[3].push({type:0,data:xa(I)})}V[4]=[],V[5]=[],V[6]=[];for(var H=0;H<=a.e.r;++H)z=[],z[1]=z[2]=[{type:0,data:xa(H+726270)}],V[4].push({type:2,data:ys(z)}),V[5].push({type:0,data:xa(H)}),V[6].push({type:0,data:xa(H)});M[U].messages[0].data=ys(V)}j.content=H0(z0(M)),j.size=j.content.length,delete _[46];var re=oa(_[4][0].data);{re[7][0].data=xa(a.e.r+1);var R=oa(re[1][0].data),F=Gs(R[2][0].data);j=cr.find(h,c[F].location),M=So(No(j.content));{if(M[0].id!=F)throw"Bad HeaderStorageBucket";var Y=oa(M[0].messages[0].data);for(H=0;H<s.length;++H){var K=oa(Y[2][0].data);K[1][0].data=xa(H),K[4][0].data=xa(s[H].length),Y[2][H]={type:Y[2][0].type,data:ys(K)}}M[0].messages[0].data=ys(Y)}j.content=H0(z0(M)),j.size=j.content.length;var X=Gs(re[2][0].data);j=cr.find(h,c[X].location),M=So(No(j.content));{if(M[0].id!=X)throw"Bad HeaderStorageBucket";for(Y=oa(M[0].messages[0].data),I=0;I<=a.e.c;++I)K=oa(Y[2][0].data),K[1][0].data=xa(I),K[4][0].data=xa(a.e.r+1),Y[2][I]={type:Y[2][0].type,data:ys(K)};M[0].messages[0].data=ys(Y)}j.content=H0(z0(M)),j.size=j.content.length;var Z=Gs(re[4][0].data);(function(){for(var O=cr.find(h,c[Z].location),L=So(No(O.content)),q,oe=0;oe<L.length;++oe){var be=L[oe];be.id==Z&&(q=be)}var ve=oa(q.messages[0].data);{ve[3]=[];var ue=[];o.forEach(function(J,Pe){ue[1]=[{type:0,data:xa(Pe)}],ue[2]=[{type:0,data:xa(1)}],ue[3]=[{type:2,data:dW(J)}],ve[3].push({type:2,data:ys(ue)})})}q.messages[0].data=ys(ve);var fe=z0(L),Ee=H0(fe);O.content=Ee,O.size=O.content.length})();var ce=oa(re[3][0].data);{var te=ce[1][0];delete ce[2];var Q=oa(te.data);{var G=Gs(Q[2][0].data);(function(){for(var O=cr.find(h,c[G].location),L=So(No(O.content)),q,oe=0;oe<L.length;++oe){var be=L[oe];be.id==G&&(q=be)}var ve=oa(q.messages[0].data);{delete ve[6],delete ce[7];var ue=new Uint8Array(ve[5][0].data);ve[5]=[];for(var fe=0,Ee=0;Ee<=a.e.r;++Ee){var J=oa(ue);fe+=kW(J,s[Ee],o),J[1][0].data=xa(Ee),ve[5].push({data:ys(J),type:2})}ve[1]=[{type:0,data:xa(a.e.c+1)}],ve[2]=[{type:0,data:xa(a.e.r+1)}],ve[3]=[{type:0,data:xa(fe)}],ve[4]=[{type:0,data:xa(a.e.r+1)}]}q.messages[0].data=ys(ve);var Pe=z0(L),st=H0(Pe);O.content=st,O.size=O.content.length})()}te.data=ys(Q)}re[3][0].data=ys(ce)}_[4][0].data=ys(re)}g.messages[0].data=ys(_);var ye=z0(v),D=H0(ye);return x.content=D,x.size=x.content.length,h}function TT(e){return function(r){for(var a=0;a!=e.length;++a){var n=e[a];r[n[0]]===void 0&&(r[n[0]]=n[1]),n[2]==="n"&&(r[n[0]]=Number(r[n[0]]))}}}function e5(e){TT([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function t5(e){TT([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function jW(e){return Hr.WS.indexOf(e)>-1?"sheet":e==Hr.CS?"chart":e==Hr.DS?"dialog":e==Hr.MS?"macro":e&&e.length?e:"sheet"}function CW(e,t){if(!e)return 0;try{e=t.map(function(a){return a.id||(a.id=a.strRelID),[a.name,e["!id"][a.id].Target,jW(e["!id"][a.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function DW(e,t,r,a,n,s,o,c,u,h,p,x){try{s[a]=Ld(Zi(e,r,!0),t);var v=In(e,t),g;switch(c){case"sheet":g=Qq(v,t,n,u,s[a],h,p,x);break;case"chart":if(g=eG(v,t,n,u,s[a],h,p,x),!g||!g["!drawel"])break;var w=Nd(g["!drawel"].Target,t),b=ip(w),N=UU(Zi(e,w,!0),Ld(Zi(e,b,!0),w)),_=Nd(N,w),E=ip(_);g=kq(Zi(e,_,!0),_,u,Ld(Zi(e,E,!0),_),h,g);break;case"macro":g=tG(v,t,n,u,s[a],h,p,x);break;case"dialog":g=rG(v,t,n,u,s[a],h,p,x);break;default:throw new Error("Unrecognized sheet type "+c)}o[a]=g;var j=[];s&&s[a]&&xn(s[a]).forEach(function(M){var U="";if(s[a][M].Type==Hr.CMNT){U=Nd(s[a][M].Target,t);var V=iG(In(e,U,!0),U,u);if(!V||!V.length)return;fS(g,V,!1)}s[a][M].Type==Hr.TCMNT&&(U=Nd(s[a][M].Target,t),j=j.concat(HU(In(e,U,!0),u)))}),j&&j.length&&fS(g,j,!0,u.people||[])}catch(M){if(u.WTF)throw M}}function wo(e){return e.charAt(0)=="/"?e.slice(1):e}function FW(e,t){if(bh(),t=t||{},e5(t),_o(e,"META-INF/manifest.xml")||_o(e,"objectdata.xml"))return SS(e,t);if(_o(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof x2<"u"){if(e.FileIndex)return x2(e);var r=cr.utils.cfb_new();return F3(e).forEach(function(K){Fr(r,K,VR(e,K))}),x2(r)}throw new Error("Unsupported NUMBERS file")}if(!_o(e,"[Content_Types].xml"))throw _o(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):_o(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var a=F3(e),n=R9(Zi(e,"[Content_Types].xml")),s=!1,o,c;if(n.workbooks.length===0&&(c="xl/workbook.xml",In(e,c,!0)&&n.workbooks.push(c)),n.workbooks.length===0){if(c="xl/workbook.bin",!In(e,c,!0))throw new Error("Could not find workbook");n.workbooks.push(c),s=!0}n.workbooks[0].slice(-3)=="bin"&&(s=!0);var u={},h={};if(!t.bookSheets&&!t.bookProps){if(Od=[],n.sst)try{Od=sG(In(e,wo(n.sst)),n.sst,t)}catch(K){if(t.WTF)throw K}t.cellStyles&&n.themes.length&&(u=nG(Zi(e,n.themes[0].replace(/^\//,""),!0)||"",n.themes[0],t)),n.style&&(h=aG(In(e,wo(n.style)),n.style,u,t))}n.links.map(function(K){try{var X=Ld(Zi(e,ip(wo(K))),K);return lG(In(e,wo(K)),X,K,t)}catch{}});var p=Zq(In(e,wo(n.workbooks[0])),n.workbooks[0],t),x={},v="";n.coreprops.length&&(v=In(e,wo(n.coreprops[0]),!0),v&&(x=p6(v)),n.extprops.length!==0&&(v=In(e,wo(n.extprops[0]),!0),v&&V9(v,x,t)));var g={};(!t.bookSheets||t.bookProps)&&n.custprops.length!==0&&(v=Zi(e,wo(n.custprops[0]),!0),v&&(g=G9(v,t)));var w={};if((t.bookSheets||t.bookProps)&&(p.Sheets?o=p.Sheets.map(function(X){return X.name}):x.Worksheets&&x.SheetNames.length>0&&(o=x.SheetNames),t.bookProps&&(w.Props=x,w.Custprops=g),t.bookSheets&&typeof o<"u"&&(w.SheetNames=o),t.bookSheets?w.SheetNames:t.bookProps))return w;o={};var b={};t.bookDeps&&n.calcchain&&(b=oG(In(e,wo(n.calcchain)),n.calcchain));var N=0,_={},E,j;{var M=p.Sheets;x.Worksheets=M.length,x.SheetNames=[];for(var U=0;U!=M.length;++U)x.SheetNames[U]=M[U].name}var V=s?"bin":"xml",I=n.workbooks[0].lastIndexOf("/"),z=(n.workbooks[0].slice(0,I+1)+"_rels/"+n.workbooks[0].slice(I+1)+".rels").replace(/^\//,"");_o(e,z)||(z="xl/_rels/workbook."+V+".rels");var H=Ld(Zi(e,z,!0),z.replace(/_rels.*/,"s5s"));(n.metadata||[]).length>=1&&(t.xlmeta=cG(In(e,wo(n.metadata[0])),n.metadata[0],t)),(n.people||[]).length>=1&&(t.people=qU(In(e,wo(n.people[0])),t)),H&&(H=CW(H,p.Sheets));var re=In(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(N=0;N!=x.Worksheets;++N){var R="sheet";if(H&&H[N]?(E="xl/"+H[N][1].replace(/[\/]?xl\//,""),_o(e,E)||(E=H[N][1]),_o(e,E)||(E=z.replace(/_rels\/.*$/,"")+H[N][1]),R=H[N][2]):(E="xl/worksheets/sheet"+(N+1-re)+"."+V,E=E.replace(/sheet0\./,"sheet.")),j=E.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(N!=t.sheets)continue e;break;case"string":if(x.SheetNames[N].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var F=!1,Y=0;Y!=t.sheets.length;++Y)typeof t.sheets[Y]=="number"&&t.sheets[Y]==N&&(F=1),typeof t.sheets[Y]=="string"&&t.sheets[Y].toLowerCase()==x.SheetNames[N].toLowerCase()&&(F=1);if(!F)continue e}}DW(e,E,j,x.SheetNames[N],N,_,o,R,t,p,u,h)}return w={Directory:n,Workbook:p,Props:x,Custprops:g,Deps:b,Sheets:o,SheetNames:x.SheetNames,Strings:Od,Styles:h,Themes:u,SSF:Va(xr)},t&&t.bookFiles&&(e.files?(w.keys=a,w.files=e.files):(w.keys=[],w.files={},e.FullPaths.forEach(function(K,X){K=K.replace(/^Root Entry[\/]/,""),w.keys.push(K),w.files[K]=e.FileIndex[X]}))),t&&t.bookVBA&&(n.vba.length>0?w.vbaraw=In(e,wo(n.vba[0]),!0):n.defaults&&n.defaults.bin===ZU&&(w.vbaraw=In(e,"xl/vbaProject.bin",!0))),w}function PW(e,t){var r=t||{},a="Workbook",n=cr.find(e,a);try{if(a="/!DataSpaces/Version",n=cr.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(cB(n.content),a="/!DataSpaces/DataSpaceMap",n=cr.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var s=fB(n.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",n=cr.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var o=hB(n.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+a);if(a="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",n=cr.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);pB(n.content)}catch{}if(a="/EncryptionInfo",n=cr.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);var c=mB(n.content);if(a="/EncryptedPackage",n=cr.find(e,a),!n||!n.content)throw new Error("ECMA-376 Encrypted file missing "+a);if(c[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(c[1],n.content,r.password||"",r);if(c[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(c[1],n.content,r.password||"",r);throw new Error("File is password-protected")}function LW(e,t){return t.bookType=="ods"?_T(e,t):t.bookType=="numbers"?EW(e,t):t.bookType=="xlsb"?OW(e,t):RW(e,t)}function OW(e,t){Z0=1024,e&&!e.SSF&&(e.SSF=Va(xr)),e&&e.SSF&&(bh(),K1(e.SSF),t.revssf=Q1(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Rd?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",a=Q6.indexOf(t.bookType)>-1,n=Uy();t5(t=t||{});var s=Ty(),o="",c=0;if(t.cellXfs=[],$u(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",Fr(s,o,m6(e.Props,t)),n.coreprops.push(o),ga(t.rels,2,o,Hr.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var u=[],h=0;h<e.SheetNames.length;++h)(e.Workbook.Sheets[h]||{}).Hidden!=2&&u.push(e.SheetNames[h]);e.Props.SheetNames=u}for(e.Props.Worksheets=e.Props.SheetNames.length,Fr(s,o,v6(e.Props)),n.extprops.push(o),ga(t.rels,3,o,Hr.EXT_PROPS),e.Custprops!==e.Props&&xn(e.Custprops||{}).length>0&&(o="docProps/custom.xml",Fr(s,o,y6(e.Custprops)),n.custprops.push(o),ga(t.rels,4,o,Hr.CUST_PROPS)),c=1;c<=e.SheetNames.length;++c){var p={"!id":{}},x=e.Sheets[e.SheetNames[c-1]],v=(x||{})["!type"]||"sheet";switch(v){case"chart":default:o="xl/worksheets/sheet"+c+"."+r,Fr(s,o,fG(c-1,o,t,e,p)),n.sheets.push(o),ga(t.wbrels,-1,"worksheets/sheet"+c+"."+r,Hr.WS[0])}if(x){var g=x["!comments"],w=!1,b="";g&&g.length>0&&(b="xl/comments"+c+"."+r,Fr(s,b,pG(g,b)),n.comments.push(b),ga(p,-1,"../comments"+c+"."+r,Hr.CMNT),w=!0),x["!legacy"]&&w&&Fr(s,"xl/drawings/vmlDrawing"+c+".vml",K6(c,x["!comments"])),delete x["!comments"],delete x["!legacy"]}p["!id"].rId1&&Fr(s,ip(o),sh(p))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,Fr(s,o,dG(t.Strings,o,t)),n.strs.push(o),ga(t.wbrels,-1,"sharedStrings."+r,Hr.SST)),o="xl/workbook."+r,Fr(s,o,uG(e,o)),n.workbooks.push(o),ga(t.rels,1,o,Hr.WB),o="xl/theme/theme1.xml",Fr(s,o,Wy(e.Themes,t)),n.themes.push(o),ga(t.wbrels,-1,"theme/theme1.xml",Hr.THEME),o="xl/styles."+r,Fr(s,o,hG(e,o,t)),n.styles.push(o),ga(t.wbrels,-1,"styles."+r,Hr.STY),e.vbaraw&&a&&(o="xl/vbaProject.bin",Fr(s,o,e.vbaraw),n.vba.push(o),ga(t.wbrels,-1,"vbaProject.bin",Hr.VBA)),o="xl/metadata."+r,Fr(s,o,mG(o)),n.metadata.push(o),ga(t.wbrels,-1,"metadata."+r,Hr.XLMETA),Fr(s,"[Content_Types].xml",h6(n,t)),Fr(s,"_rels/.rels",sh(t.rels)),Fr(s,"xl/_rels/workbook."+r+".rels",sh(t.wbrels)),delete t.revssf,delete t.ssf,s}function RW(e,t){Z0=1024,e&&!e.SSF&&(e.SSF=Va(xr)),e&&e.SSF&&(bh(),K1(e.SSF),t.revssf=Q1(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Rd?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",a=Q6.indexOf(t.bookType)>-1,n=Uy();t5(t=t||{});var s=Ty(),o="",c=0;if(t.cellXfs=[],$u(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",Fr(s,o,m6(e.Props,t)),n.coreprops.push(o),ga(t.rels,2,o,Hr.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var u=[],h=0;h<e.SheetNames.length;++h)(e.Workbook.Sheets[h]||{}).Hidden!=2&&u.push(e.SheetNames[h]);e.Props.SheetNames=u}e.Props.Worksheets=e.Props.SheetNames.length,Fr(s,o,v6(e.Props)),n.extprops.push(o),ga(t.rels,3,o,Hr.EXT_PROPS),e.Custprops!==e.Props&&xn(e.Custprops||{}).length>0&&(o="docProps/custom.xml",Fr(s,o,y6(e.Custprops)),n.custprops.push(o),ga(t.rels,4,o,Hr.CUST_PROPS));var p=["SheetJ5"];for(t.tcid=0,c=1;c<=e.SheetNames.length;++c){var x={"!id":{}},v=e.Sheets[e.SheetNames[c-1]],g=(v||{})["!type"]||"sheet";switch(g){case"chart":default:o="xl/worksheets/sheet"+c+"."+r,Fr(s,o,uT(c-1,t,e,x)),n.sheets.push(o),ga(t.wbrels,-1,"worksheets/sheet"+c+"."+r,Hr.WS[0])}if(v){var w=v["!comments"],b=!1,N="";if(w&&w.length>0){var _=!1;w.forEach(function(E){E[1].forEach(function(j){j.T==!0&&(_=!0)})}),_&&(N="xl/threadedComments/threadedComment"+c+"."+r,Fr(s,N,VU(w,p,t)),n.threadedcomments.push(N),ga(x,-1,"../threadedComments/threadedComment"+c+"."+r,Hr.TCMNT)),N="xl/comments"+c+"."+r,Fr(s,N,Z6(w)),n.comments.push(N),ga(x,-1,"../comments"+c+"."+r,Hr.CMNT),b=!0}v["!legacy"]&&b&&Fr(s,"xl/drawings/vmlDrawing"+c+".vml",K6(c,v["!comments"])),delete v["!comments"],delete v["!legacy"]}x["!id"].rId1&&Fr(s,ip(o),sh(x))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,Fr(s,o,B6(t.Strings,t)),n.strs.push(o),ga(t.wbrels,-1,"sharedStrings."+r,Hr.SST)),o="xl/workbook."+r,Fr(s,o,mT(e)),n.workbooks.push(o),ga(t.rels,1,o,Hr.WB),o="xl/theme/theme1.xml",Fr(s,o,Wy(e.Themes,t)),n.themes.push(o),ga(t.wbrels,-1,"theme/theme1.xml",Hr.THEME),o="xl/styles."+r,Fr(s,o,$6(e,t)),n.styles.push(o),ga(t.wbrels,-1,"styles."+r,Hr.STY),e.vbaraw&&a&&(o="xl/vbaProject.bin",Fr(s,o,e.vbaraw),n.vba.push(o),ga(t.wbrels,-1,"vbaProject.bin",Hr.VBA)),o="xl/metadata."+r,Fr(s,o,J6()),n.metadata.push(o),ga(t.wbrels,-1,"metadata."+r,Hr.XLMETA),p.length>1&&(o="xl/persons/person.xml",Fr(s,o,GU(p)),n.people.push(o),ga(t.wbrels,-1,"persons/person.xml",Hr.PEOPLE)),Fr(s,"[Content_Types].xml",h6(n,t)),Fr(s,"_rels/.rels",sh(t.rels)),Fr(s,"xl/_rels/workbook."+r+".rels",sh(t.wbrels)),delete t.revssf,delete t.ssf,s}function r5(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=ro(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function MW(e,t){return cr.find(e,"EncryptedPackage")?PW(e,t):yT(e,t)}function IW(e,t){var r,a=e,n=t||{};return n.type||(n.type=Rr&&Buffer.isBuffer(e)?"buffer":"base64"),r=z_(a,n),FW(r,n)}function kT(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return xv(e.slice(r),t);default:break e}return dh.to_workbook(e,t)}function BW(e,t){var r="",a=r5(e,t);switch(t.type){case"base64":r=ro(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=Wf(e);break;default:throw new Error("Unrecognized type "+t.type)}return a[0]==239&&a[1]==187&&a[2]==191&&(r=Na(r)),t.type="binary",kT(r,t)}function UW(e,t){var r=e;return t.type=="base64"&&(r=ro(r)),r=ov.utils.decode(1200,r.slice(2),"str"),t.type="binary",kT(r,t)}function zW(e){return e.match(/[^\x00-\x7F]/)?Gl(e):e}function g2(e,t,r,a){return a?(r.type="string",dh.to_workbook(e,r)):dh.to_workbook(t,r)}function yv(e,t){by();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return yv(new Uint8Array(e),(r=Va(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var a=e,n=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),oh={},r.dateNF&&(oh.dateNF=r.dateNF),r.type||(r.type=Rr&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Rr?"buffer":"binary",a=OR(e),typeof Uint8Array<"u"&&!Rr&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,a=zW(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),c=new Uint8Array(o);if(c.foo="bar",!c.foo)return r=Va(r),r.type="array",yv(Sy(a),r)}switch((n=r5(a,r))[0]){case 208:if(n[1]===207&&n[2]===17&&n[3]===224&&n[4]===161&&n[5]===177&&n[6]===26&&n[7]===225)return MW(cr.read(a,r),r);break;case 9:if(n[1]<=8)return yT(a,r);break;case 60:return xv(a,r);case 73:if(n[1]===73&&n[2]===42&&n[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(n[1]===68)return WI(a,r);break;case 84:if(n[1]===65&&n[2]===66&&n[3]===76)return M6.to_workbook(a,r);break;case 80:return n[1]===75&&n[2]<9&&n[3]<9?IW(a,r):g2(e,a,r,s);case 239:return n[3]===60?xv(a,r):g2(e,a,r,s);case 255:if(n[1]===254)return UW(a,r);if(n[1]===0&&n[2]===2&&n[3]===0)return Bf.to_workbook(a,r);break;case 0:if(n[1]===0&&(n[2]>=2&&n[3]===0||n[2]===0&&(n[3]===8||n[3]===9)))return Bf.to_workbook(a,r);break;case 3:case 131:case 139:case 140:return mv.to_workbook(a,r);case 123:if(n[1]===92&&n[2]===114&&n[3]===116)return q6.to_workbook(a,r);break;case 10:case 13:case 32:return BW(a,r);case 137:if(n[1]===80&&n[2]===78&&n[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return GI.indexOf(n[0])>-1&&n[2]<=12&&n[3]<=31?mv.to_workbook(a,r):g2(e,a,r,s)}function ET(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return wp(t.file,cr.write(e,{type:Rr?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return cr.write(e,t)}function HW(e,t){var r=Va(t||{}),a=LW(e,r);return VW(a,r)}function VW(e,t){var r={},a=Rr?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=a;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=a;break;default:throw new Error("Unrecognized type "+t.type)}var n=e.FullPaths?cr.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof n=="string"){if(t.type=="binary"||t.type=="base64")return n;n=new Uint8Array(J1(n))}return t.password&&typeof encrypt_agile<"u"?ET(encrypt_agile(n,t.password),t):t.type==="file"?wp(t.file,n):t.type=="string"?Na(n):n}function qW(e,t){var r=t||{},a=zG(e,r);return ET(a,r)}function Vl(e,t,r){r||(r="");var a=r+e;switch(t.type){case"base64":return tp(Gl(a));case"binary":return Gl(a);case"string":return e;case"file":return wp(t.file,a,"utf8");case"buffer":return Rr?qc(a,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(a):Vl(a,{type:"binary"}).split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function GW(e,t){switch(t.type){case"base64":return tp(e);case"binary":return e;case"string":return e;case"file":return wp(t.file,e,"binary");case"buffer":return Rr?qc(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Hm(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",a=0;a<e.length;++a)r+=String.fromCharCode(e[a]);return t.type=="base64"?tp(r):t.type=="string"?Na(r):r;case"file":return wp(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function jT(e,t){by(),Mq(e);var r=Va(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var a=jT(e,r);return r.type="array",J1(a)}var n=0;if(r.sheet&&(typeof r.sheet=="number"?n=r.sheet:n=e.SheetNames.indexOf(r.sheet),!e.SheetNames[n]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Vl(LG(e,r),r);case"slk":case"sylk":return Vl(R6.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"htm":case"html":return Vl(bT(e.Sheets[e.SheetNames[n]],r),r);case"txt":return GW(CT(e.Sheets[e.SheetNames[n]],r),r);case"csv":return Vl(a5(e.Sheets[e.SheetNames[n]],r),r,"\uFEFF");case"dif":return Vl(M6.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"dbf":return Hm(mv.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"prn":return Vl(dh.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"rtf":return Vl(q6.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"eth":return Vl(I6.from_sheet(e.Sheets[e.SheetNames[n]],r),r);case"fods":return Vl(_T(e,r),r);case"wk1":return Hm(Bf.sheet_to_wk1(e.Sheets[e.SheetNames[n]],r),r);case"wk3":return Hm(Bf.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Hm(wT(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),qW(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return HW(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function WW(e,t,r,a,n,s,o,c){var u=jn(r),h=c.defval,p=c.raw||!Object.prototype.hasOwnProperty.call(c,"raw"),x=!0,v=n===1?[]:{};if(n!==1)if(Object.defineProperty)try{Object.defineProperty(v,"__rowNum__",{value:r,enumerable:!1})}catch{v.__rowNum__=r}else v.__rowNum__=r;if(!o||e[r])for(var g=t.s.c;g<=t.e.c;++g){var w=o?e[r][g]:e[a[g]+u];if(w===void 0||w.t===void 0){if(h===void 0)continue;s[g]!=null&&(v[s[g]]=h);continue}var b=w.v;switch(w.t){case"z":if(b==null)break;continue;case"e":b=b==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+w.t)}if(s[g]!=null){if(b==null)if(w.t=="e"&&b===null)v[s[g]]=null;else if(h!==void 0)v[s[g]]=h;else if(p&&b===null)v[s[g]]=null;else continue;else v[s[g]]=p&&(w.t!=="n"||w.t==="n"&&c.rawNumbers!==!1)?b:Hc(w,b,c);b!=null&&(x=!1)}}return{row:v,isempty:x}}function F1(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},a=0,n=1,s=[],o=0,c="",u={s:{r:0,c:0},e:{r:0,c:0}},h=t||{},p=h.range!=null?h.range:e["!ref"];switch(h.header===1?a=1:h.header==="A"?a=2:Array.isArray(h.header)?a=3:h.header==null&&(a=0),typeof p){case"string":u=aa(p);break;case"number":u=aa(e["!ref"]),u.s.r=p;break;default:u=p}a>0&&(n=0);var x=jn(u.s.r),v=[],g=[],w=0,b=0,N=Array.isArray(e),_=u.s.r,E=0,j={};N&&!e[_]&&(e[_]=[]);var M=h.skipHidden&&e["!cols"]||[],U=h.skipHidden&&e["!rows"]||[];for(E=u.s.c;E<=u.e.c;++E)if(!(M[E]||{}).hidden)switch(v[E]=nn(E),r=N?e[_][E]:e[v[E]+x],a){case 1:s[E]=E-u.s.c;break;case 2:s[E]=v[E];break;case 3:s[E]=h.header[E-u.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),c=o=Hc(r,null,h),b=j[o]||0,!b)j[o]=1;else{do c=o+"_"+b++;while(j[c]);j[o]=b,j[c]=1}s[E]=c}for(_=u.s.r+n;_<=u.e.r;++_)if(!(U[_]||{}).hidden){var V=WW(e,u,_,v,a,s,N,h);(V.isempty===!1||(a===1?h.blankrows!==!1:h.blankrows))&&(g[w++]=V.row)}return g.length=w,g}var kS=/"/g;function $W(e,t,r,a,n,s,o,c){for(var u=!0,h=[],p="",x=jn(r),v=t.s.c;v<=t.e.c;++v)if(a[v]){var g=c.dense?(e[r]||[])[v]:e[a[v]+x];if(g==null)p="";else if(g.v!=null){u=!1,p=""+(c.rawNumbers&&g.t=="n"?g.v:Hc(g,null,c));for(var w=0,b=0;w!==p.length;++w)if((b=p.charCodeAt(w))===n||b===s||b===34||c.forceQuotes){p='"'+p.replace(kS,'""')+'"';break}p=="ID"&&(p='"ID"')}else g.f!=null&&!g.F?(u=!1,p="="+g.f,p.indexOf(",")>=0&&(p='"'+p.replace(kS,'""')+'"')):p="";h.push(p)}return c.blankrows===!1&&u?null:h.join(o)}function a5(e,t){var r=[],a=t??{};if(e==null||e["!ref"]==null)return"";var n=aa(e["!ref"]),s=a.FS!==void 0?a.FS:",",o=s.charCodeAt(0),c=a.RS!==void 0?a.RS:`
`,u=c.charCodeAt(0),h=new RegExp((s=="|"?"\\|":s)+"+$"),p="",x=[];a.dense=Array.isArray(e);for(var v=a.skipHidden&&e["!cols"]||[],g=a.skipHidden&&e["!rows"]||[],w=n.s.c;w<=n.e.c;++w)(v[w]||{}).hidden||(x[w]=nn(w));for(var b=0,N=n.s.r;N<=n.e.r;++N)(g[N]||{}).hidden||(p=$W(e,n,N,x,o,u,s,a),p!=null&&(a.strip&&(p=p.replace(h,"")),(p||a.blankrows!==!1)&&r.push((b++?c:"")+p)));return delete a.dense,r.join("")}function CT(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=a5(e,t);return r}function XW(e){var t="",r,a="";if(e==null||e["!ref"]==null)return[];var n=aa(e["!ref"]),s="",o=[],c,u=[],h=Array.isArray(e);for(c=n.s.c;c<=n.e.c;++c)o[c]=nn(c);for(var p=n.s.r;p<=n.e.r;++p)for(s=jn(p),c=n.s.c;c<=n.e.c;++c)if(t=o[c]+s,r=h?(e[p]||[])[c]:e[t],a="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;a=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)a=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)a=""+r.v;else if(r.t=="b")a=r.v?"TRUE":"FALSE";else if(r.w!==void 0)a="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?a="'"+r.v:a=""+r.v}}u[u.length]=t+"="+a}return u}function DT(e,t,r){var a=r||{},n=+!a.skipHeader,s=e||{},o=0,c=0;if(s&&a.origin!=null)if(typeof a.origin=="number")o=a.origin;else{var u=typeof a.origin=="string"?sn(a.origin):a.origin;o=u.r,c=u.c}var h,p={s:{c:0,r:0},e:{c,r:o+t.length-1+n}};if(s["!ref"]){var x=aa(s["!ref"]);p.e.c=Math.max(p.e.c,x.e.c),p.e.r=Math.max(p.e.r,x.e.r),o==-1&&(o=x.e.r+1,p.e.r=o+t.length-1+n)}else o==-1&&(o=0,p.e.r=t.length-1+n);var v=a.header||[],g=0;t.forEach(function(b,N){xn(b).forEach(function(_){(g=v.indexOf(_))==-1&&(v[g=v.length]=_);var E=b[_],j="z",M="",U=vr({c:c+g,r:o+N+n});h=dp(s,U),E&&typeof E=="object"&&!(E instanceof Date)?s[U]=E:(typeof E=="number"?j="n":typeof E=="boolean"?j="b":typeof E=="string"?j="s":E instanceof Date?(j="d",a.cellDates||(j="n",E=Yn(E)),M=a.dateNF||xr[14]):E===null&&a.nullError&&(j="e",E=0),h?(h.t=j,h.v=E,delete h.w,delete h.R,M&&(h.z=M)):s[U]=h={t:j,v:E},M&&(h.z=M))})}),p.e.c=Math.max(p.e.c,c+v.length-1);var w=jn(o);if(n)for(g=0;g<v.length;++g)s[nn(g+c)+w]={t:"s",v:v[g]};return s["!ref"]=jr(p),s}function YW(e,t){return DT(null,e,t)}function dp(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var a=sn(t);return e[a.r]||(e[a.r]=[]),e[a.r][a.c]||(e[a.r][a.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?dp(e,vr(t)):dp(e,vr({r:t,c:r||0}))}function JW(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function n5(){return{SheetNames:[],Sheets:{}}}function s5(e,t,r,a){var n=1;if(!r)for(;n<=65535&&e.SheetNames.indexOf(r="Sheet"+n)!=-1;++n,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);n=s&&+s[2]||0;var o=s&&s[1]||r;for(++n;n<=65535&&e.SheetNames.indexOf(r=o+n)!=-1;++n);}if(pT(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function KW(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var a=JW(e,t);switch(e.Workbook.Sheets[a]||(e.Workbook.Sheets[a]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[a].Hidden=r}function ZW(e,t){return e.z=t,e}function FT(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function QW(e,t,r){return FT(e,"#"+t,r)}function e$(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function t$(e,t,r,a){for(var n=typeof t!="string"?t:aa(t),s=typeof t=="string"?t:jr(t),o=n.s.r;o<=n.e.r;++o)for(var c=n.s.c;c<=n.e.c;++c){var u=dp(e,o,c);u.t="n",u.F=s,delete u.v,o==n.s.r&&c==n.s.c&&(u.f=r,a&&(u.D=!0))}return e}var Vm={encode_col:nn,encode_row:jn,encode_cell:vr,encode_range:jr,decode_col:Ly,decode_row:Py,split_cell:d9,decode_cell:sn,decode_range:Ci,format_cell:Hc,sheet_add_aoa:s6,sheet_add_json:DT,sheet_add_dom:ST,aoa_to_sheet:Sh,json_to_sheet:YW,table_to_sheet:NT,table_to_book:cW,sheet_to_csv:a5,sheet_to_txt:CT,sheet_to_json:F1,sheet_to_html:bT,sheet_to_formulae:XW,sheet_to_row_object_array:F1,sheet_get_cell:dp,book_new:n5,book_append_sheet:s5,book_set_sheet_visibility:KW,cell_set_number_format:ZW,cell_set_hyperlink:FT,cell_set_internal_link:QW,cell_add_comment:e$,sheet_set_array_formula:t$,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const gd=async()=>(await(await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/getsingleproducts")).json()).body,r$=()=>{var ct;const e=[["Fabric",["Meter"]],["Area Based",["Sq.Feet"]],["Running Length based",["Meter","Feet"]],["Piece Based",["Piece","Items","Sets"]],["Fixed Length Items",["Piece"]],["Fixed Area Items",["Piece","Roll"]],["Tailoring",["Parts","Sq.Feet"]]],[t,r]=P.useState(""),[a,n]=P.useState(!1),[s,o]=P.useState([]),[c,u]=P.useState(!1),[h,p]=P.useState(!1),[x,v]=P.useState(""),g=ua(),[w,b]=P.useState(""),[N,_]=P.useState(""),[E,j]=P.useState(""),[M,U]=P.useState(""),[V,I]=P.useState(""),[z,H]=P.useState(!1),[re,R]=P.useState(!1),F=wa();ur(ze=>ze.data.items);const[Y,K]=P.useState(!1),[X,Z]=P.useState(""),ce=((ct=e.find(ze=>ze[0]===X))==null?void 0:ct[1])||[],[te,Q]=P.useState(-1),G=P.useRef([]),ye=P.useRef(null),[D,O]=P.useState(!1),[L,q]=P.useState(!1),[oe,be]=P.useState(null),ve=ze=>{Q(te===ze?-1:ze)},ue=ze=>{n(!0),p(!0),v(ze[0]),b(ze[1]),Z(ze[2]),j(ze[3]),U(ze[4]),I(ze[5]),K(ze[6])};P.useEffect(()=>{const ze=pt=>{G.current.every(Ot=>Ot&&!Ot.contains(pt.target))&&Q(-1)};return document.addEventListener("mousedown",ze),()=>{document.removeEventListener("mousedown",ze)}},[]),P.useEffect(()=>{if(te!==-1&&G.current[te]){const ze=G.current[te];if(ze){const pt=ze.getBoundingClientRect(),Ot=window.innerHeight;pt.bottom>Ot?ze.scrollIntoView({behavior:"smooth",block:"end"}):pt.top<0&&ze.scrollIntoView({behavior:"smooth",block:"start"})}}},[te]),P.useEffect(()=>{(async()=>{const pt=localStorage.getItem("itemData"),Ot=60*60*1e3;if(pt){const{data:Lt,time:Ct}=JSON.parse(pt);if(Date.now()-Ct<Ot&&Array.isArray(Lt)){F(jc(Lt)),o(Lt);return}}const It=await gd();F(jc(It)),o(It),localStorage.setItem("itemData",JSON.stringify({data:It,time:Date.now()}))})()},[a,c,F]);const fe=async ze=>{try{if(!(await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/deletesingleproduct",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({productName:ze})})).ok)throw new Error("Failed to delete the item");const Ot=await gd();F(jc(Ot)),o(Ot),localStorage.setItem("itemData",JSON.stringify({data:Ot,time:Date.now()})),u(It=>!It),Q(-1)}catch(pt){console.error("Error deleting item:",pt),alert("Failed to delete item")}},Ee=async(ze,pt)=>{let Ot=new Date;const It=Ot.getDate(),Lt=Ot.getMonth()+1,Ct=Ot.getFullYear();Ot=It+Lt+Ct;try{if(!(await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/addnewproduct",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({productName:ze[0],description:ze[1],groupTypes:ze[2],sellingUnit:ze[3],mrp:ze[4],taxRate:ze[5],needsTailoring:ze[7],date:Ot})})).ok)throw new Error("Failed to duplicate the item");const hr=await gd(),zt=hr[hr.length-1],Yt=[...s.slice(0,pt+1),zt,...s.slice(pt+1)];F(jc(Yt)),o(Yt),localStorage.setItem("itemData",JSON.stringify({data:Yt,time:Date.now()})),u(Sr=>!Sr),Q(-1)}catch(wt){console.error("Error duplicating item:",wt),alert("Failed to duplicate item")}},J=["Fabric","Area Based","Running length based","Piece based","Fixed length items","Fixed area items","Tailoring"],Pe={Fabric:["Meter"],"Area Based":["Sq. feet","Sq. meter"],"Running length based":["Meter","Feet"],"Piece based":["Piece","Items","Sets"],"Fixed length items":["Piece"],"Fixed area items":["Piece","Roll"],Tailoring:["Parts","Sq. feet"]},[st,ke]=P.useState({productName:"",productDetails:"",groupType:"",sellingUnit:"",mrp:"",taxRate:"",additionalInputs:{},sideDropdown:""}),de=async()=>{try{if(!(await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/updatesingleproduct",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({productName:x,description:w,groupTypes:X,sellingUnit:E,mrp:M,taxRate:V,needsTailoring:Y})})).ok)throw new Error("Failed to update item");alert("Item Updated");const pt=await gd();F(jc(pt)),o(pt),localStorage.setItem("itemData",JSON.stringify({data:pt,time:Date.now()})),n(!1),p(!1),Q(-1),ke({productName:"",productDetails:"",groupType:"",sellingUnit:"",mrp:"",taxRate:"",additionalInputs:{},sideDropdown:""})}catch(ze){console.error("Edit error:",ze),alert("Something went wrong while updating the item.")}},rt=async ze=>{if(!ze.name.endsWith(".xlsx")&&!ze.name.endsWith(".xls")){be("Please upload a valid Excel file (.xlsx or .xls)");return}try{const pt=await ze.arrayBuffer(),Ot=yv(pt,{type:"array"}),It=Ot.SheetNames[0],Lt=Ot.Sheets[It],hr=Vm.sheet_to_json(Lt).map(Yt=>[Yt["Product Name"]||"",Yt.Description||"",Yt["Group Type"]||"",Yt["Costing Type"]||"",Yt.MRP||"",Yt["Tax Rate"]||"",Yt["Added Date"]||new Date().toLocaleDateString(),Yt["Needs Tailoring"]||!1]).filter(Yt=>{var Sr;return Yt[0]&&J.includes(Yt[2])&&((Sr=Pe[Yt[2]])==null?void 0:Sr.includes(Yt[3]))});if(hr.length===0){be("No valid items found in the Excel file");return}for(const Yt of hr)if(!(await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/addnewproduct",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({productName:Yt[0],description:Yt[1],groupTypes:Yt[2],sellingUnit:Yt[3],mrp:Yt[4],taxRate:Yt[5],needsTailoring:Yt[7],date:Yt[6]})})).ok)throw new Error(`Failed to import item: ${Yt[0]}`);const zt=await gd();F(jc(zt)),o(zt),localStorage.setItem("itemData",JSON.stringify({data:zt,time:Date.now()})),O(!1),be(null),alert("Items imported successfully")}catch(pt){console.error("Error importing file:",pt),be("Failed to import Excel file")}},Ue=ze=>{ze.preventDefault(),q(!0)},Xe=()=>{q(!1)},ot=ze=>{ze.preventDefault(),q(!1);const pt=ze.dataTransfer.files[0];pt&&rt(pt)},ut=ze=>{var Ot;const pt=(Ot=ze.target.files)==null?void 0:Ot[0];pt&&rt(pt)},vt=()=>{const ze=new dr;ze.text("Products List",14,20);const pt=["Product Name","Description","Costing Type","Group Type","Added Date"],Ot=s.map(It=>[It[0]||"",It[1]||"",It[3]||"",It[2]||"",It[6]||""]);vy(ze,{head:[pt],body:Ot,startY:30,theme:"striped",styles:{fontSize:10},headStyles:{fillColor:[50,150,150]}}),ze.save("products-table.pdf")},At=()=>{if(!s||s.length===0){alert("No data available to export.");return}try{const ze=["Product Name","Description","Costing Type","Group Type","Added Date"],pt=s.map(zt=>({"Product Name":zt[0]||"",Description:zt[1]||"","Costing Type":zt[3]||"","Group Type":zt[2]||"","Added Date":zt[6]||""})),Ot=Vm.json_to_sheet(pt);Ot["!cols"]=[{wch:20},{wch:30},{wch:15},{wch:15},{wch:15}];const It=Vm.book_new();Vm.book_append_sheet(It,Ot,"Products");const Lt=jT(It,{bookType:"xlsx",type:"array"}),Ct=new Blob([Lt],{type:"application/octet-stream"}),wt=window.URL.createObjectURL(Ct),hr=document.createElement("a");hr.href=wt,hr.download="products-table.xlsx",document.body.appendChild(hr),hr.click(),document.body.removeChild(hr),window.URL.revokeObjectURL(wt)}catch(ze){console.error("Error exporting Excel:",ze),alert("Failed to export Excel file.")}};return f.jsx("div",{className:"bg-gray-50 min-h-screen pt-20 md:p-4",children:f.jsxs("div",{className:"container mx-auto",children:[f.jsxs("div",{className:"flex justify-between flex-wrap items-center mb-4",children:[f.jsxs("div",{className:"flex items-center gap-5",children:[a&&f.jsx("button",{onClick:()=>{n(!1),p(!1)},className:"p-1.5 rounded-lg bg-gray-50 hover:bg-gray-100",children:f.jsx(GS,{})}),f.jsx("h1",{className:"text-2xl font-semibold",children:"Products"})]}),f.jsxs("div",{className:"flex items-center md:!gap-5 flex-wrap gap-2",children:[f.jsxs("div",{className:"dropdown",children:[f.jsx("button",{className:"btn btn-secondary dropdown-toggle",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false",children:"More Options"}),f.jsxs("ul",{className:"dropdown-menu",children:[f.jsx("li",{children:f.jsx("button",{className:"dropdown-item",onClick:()=>O(!0),children:"Import Product"})}),f.jsx("li",{children:f.jsx("button",{className:"dropdown-item",onClick:vt,children:"Export as PDF"})}),f.jsx("li",{children:f.jsx("button",{className:"dropdown-item",onClick:At,children:"Export as Excel"})})]})]}),f.jsxs("button",{className:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600",onClick:()=>g("/add-product"),children:[f.jsx("i",{className:"fas fa-plus"})," + Add Product"]})]})]}),D&&f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:f.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[f.jsxs("div",{className:"flex justify-between items-center mb-4",children:[f.jsx("h2",{className:"text-xl font-semibold",children:"Import Excel File"}),f.jsx("button",{onClick:()=>{O(!1),be(null),q(!1)},className:"text-gray-500 hover:text-gray-700",children:"✕"})]}),f.jsxs("div",{className:`border-2 border-dashed rounded-lg p-6 text-center ${L?"border-blue-500 bg-blue-50":"border-gray-300"}`,onDragOver:Ue,onDragLeave:Xe,onDrop:ot,children:[f.jsx("p",{className:"text-gray-600 mb-2",children:"Drag and drop your Excel file here or"}),f.jsx("label",{htmlFor:"fileInput",className:"cursor-pointer text-blue-500 hover:text-blue-600",children:"click to select a file"}),f.jsx("input",{id:"fileInput",type:"file",accept:".xlsx,.xls",className:"hidden",onChange:ut}),oe&&f.jsx("p",{className:"text-red-500 mt-2",children:oe})]}),f.jsx("div",{className:"mt-4 text-sm text-gray-500",children:f.jsx("p",{children:"Expected columns: Product Name, Description, Group Type, Costing Type, MRP, Tax Rate, Added Date, Needs Tailoring"})}),f.jsx("div",{className:"flex justify-end mt-6",children:f.jsx("button",{onClick:()=>{O(!1),be(null),q(!1)},className:"px-4 py-2 border rounded-lg",children:"Cancel"})})]})}),a&&f.jsxs("div",{className:"max-w-3xl mx-auto p-6 bg-white rounded-lg shadow-md",children:[f.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"Product Details"}),f.jsxs("form",{className:"space-y-4",onSubmit:ze=>{ze.preventDefault()},children:[f.jsxs("div",{children:[f.jsxs("label",{className:"block font-medium",children:["Product Name ",f.jsx("span",{className:"text-red-500",children:"*"})]}),f.jsx("input",{type:"text",name:"productName",value:x,placeholder:"Enter Product Name",onChange:ze=>v(ze.target.value),className:"w-full p-2 border rounded-md",required:!0})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block font-medium",children:"Description"}),f.jsx("textarea",{name:"description",value:w,onChange:ze=>b(ze.target.value),placeholder:"Enter Description",className:"w-full p-2 border rounded-md"})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsxs("label",{className:"block font-medium",children:["Group Type ",f.jsx("span",{className:"text-red-500",children:"*"})]}),f.jsxs("select",{name:"groupType",value:X,onChange:ze=>Z(ze.target.value),className:"w-full p-2 border rounded-md",required:!0,children:[f.jsx("option",{value:"",children:"Select Group Type"}),e.map(([ze])=>f.jsx("option",{value:ze,children:ze},ze))]})]}),f.jsxs("div",{children:[f.jsxs("label",{className:"block font-medium",children:["Selling Unit ",f.jsx("span",{className:"text-red-500",children:"*"})]}),f.jsxs("select",{name:"sellingUnit",value:E,onChange:ze=>j(ze.target.value),className:"w-full p-2 border rounded-md",required:!0,children:[f.jsx("option",{value:"",children:"Select Selling Unit"}),ce.map(ze=>f.jsx("option",{value:ze,children:ze},ze))]})]})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block font-medium",children:"MRP"}),f.jsx("input",{type:"text",name:"mrp",value:M,onChange:ze=>U(ze.target.value),placeholder:"Enter MRP",className:"w-full p-2 border rounded-md"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block font-medium",children:"Tax Rate"}),f.jsx("input",{type:"text",name:"taxRate",value:V,onChange:ze=>I(ze.target.value),placeholder:"Enter Tax Rate",className:"w-full p-2 border rounded-md"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Needs Tailoring"}),f.jsx("div",{className:`w-12 h-6 flex items-center rounded-full p-1 cursor-pointer ${Y?"bg-blue-500":"bg-gray-300"}`,onClick:()=>K(!Y),children:f.jsx("div",{className:`w-5 h-5 bg-white rounded-full shadow-md transform ${Y?"translate-x-6":"translate-x-0"} transition`})})]})]}),f.jsxs("div",{className:"flex gap-2 justify-end space-x-4",children:[f.jsx("button",{type:"button",onClick:()=>{n(!1),p(!1),v(""),b(""),_(""),j(""),U(""),I("")},className:"px-4 py-2 border !rounded-lg",children:"Cancel"}),f.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white !rounded-lg",onClick:de,children:"Save"})]})]})]}),f.jsxs("div",{className:`bg-white shadow rounded-lg p-4 mt-4 overflow-x-auto ${a?"hidden":""}`,ref:ye,children:[f.jsx("input",{type:"text",placeholder:"Search items...",value:t,onChange:ze=>r(ze.target.value),className:"w-full px-4 py-2 border rounded-lg mb-4"}),f.jsxs("table",{className:"w-full text-left border-collapse",children:[f.jsx("thead",{children:f.jsxs("tr",{className:"text-gray-500 bg-sky-50",children:[f.jsx("th",{className:"py-3 px-4",children:"Product Name"}),f.jsx("th",{className:"py-3 px-4",children:"Description"}),f.jsx("th",{className:"py-3 px-4",children:"Costing Type"}),f.jsx("th",{className:"py-3 px-4",children:"Group Type"}),f.jsx("th",{className:"py-3 px-4",children:"Added Date"}),f.jsx("th",{className:"py-3 px-4",children:"Actions"})]})}),f.jsx("tbody",{children:s!=null&&s.map((ze,pt)=>f.jsxs("tr",{className:"border-t relative hover:bg-sky-50",children:[f.jsx("td",{onClick:()=>ue(ze),className:"py-2 px-4",children:ze[0]}),f.jsx("td",{className:"py-2 px-4",children:ze[1]}),f.jsx("td",{className:"py-2 px-4",children:ze[3]}),f.jsx("td",{className:"py-2 px-4",children:ze[2]}),f.jsx("td",{className:"py-2 px-4",children:ze[6]}),f.jsxs("td",{className:"py-2 px-4 relative",children:[f.jsx("button",{onClick:()=>ve(pt),className:"p-2 rounded hover:bg-gray-200 text-gray-600 text-xl","aria-expanded":te===pt,"aria-controls":`menu-${pt}`,children:"⋮"}),f.jsxs("div",{id:`menu-${pt}`,className:`absolute right-4 top-10 w-32 bg-white shadow-md border rounded-md z-50 transition-all duration-200 ease-in-out ${te===pt?"opacity-100 scale-100":"opacity-0 scale-95 pointer-events-none"}`,ref:Ot=>G.current[pt]=Ot,children:[f.jsx("button",{className:"block w-full text-left px-4 py-2 text-sm hover:bg-gray-100",onClick:()=>ue(ze),children:"Edit"}),f.jsx("button",{className:"block w-full text-left px-4 py-2 text-sm hover:bg-gray-100",onClick:()=>Ee(ze,pt),children:"Duplicate"}),f.jsx("button",{className:"block w-full text-left px-4 py-2 text-sm text-red-500 hover:bg-gray-100",onClick:()=>fe(ze[0]),children:"Delete"})]})]})]},pt))})]})]})]})})};async function v2(){try{const e=await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/getallproductgroup",{credentials:"include"});if(!e.ok)throw new Error(`HTTP error! Status: ${e.status}`);const t=await e.json();return Array.isArray(t.body)?t.body:[]}catch(e){return console.error("Error fetching product groups:",e),[]}}function a$(){const e=ua(),[t,r]=P.useState([]),[a,n]=P.useState(""),[s,o]=P.useState(!1),[c,u]=P.useState(null),[h,p]=P.useState(!1),[x,v]=P.useState(""),[g,w]=P.useState(""),[b,N]=P.useState([]),[_,E]=P.useState("#ffffff"),[j,M]=P.useState(!0),[U,V]=P.useState(!1),I=wa(),z=ur(Y=>Y.data.items),H=ur(Y=>Y.data.products);P.useEffect(()=>{const Y=async()=>{const X=await v2();I(Cf(X)),r(X),localStorage.setItem("productGroupData",JSON.stringify({data:X,time:Date.now()}))},K=localStorage.getItem("productGroupData");if(h)Y(),p(!1);else if(H.length>0)r(H);else if(K){const X=JSON.parse(K);Date.now()-X.time<60*60*1e3?(I(Cf(X.data)),r(X.data)):Y()}else Y()},[I,H,h]);async function re(Y){try{const K=await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/deleteproductgroup",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({groupName:Y})}),X=await v2();I(Cf(X)),r(X),localStorage.setItem("productGroupData",JSON.stringify({data:X,time:Date.now()})),K.status===200?(alert("Product group deleted"),p(!0)):alert("Error deleting product group")}catch(K){console.error("Error deleting product group:",K),alert("Error: Network issue or server not responding")}}const R=async()=>{try{const Y=await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/updateproductgroup",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({groupName:x,mainProducts:g,addonProducts:JSON.stringify(b),status:j})}),K=await v2();I(Cf(K)),r(K),localStorage.setItem("productGroupData",JSON.stringify({data:K,time:Date.now()})),Y.status===200?(alert("Product group edited"),o(!1),v(""),w(""),N([]),M(!0)):alert("Error editing product group")}catch(Y){console.error("Error editing product group:",Y),alert("Error: Network issue or server not responding")}},F=Y=>{const K=Array.from(Y.target.selectedOptions).map(X=>X.value);N(K)};return f.jsxs("div",{className:"md:p-6 h-full pt-20 bg-gray-50",children:[f.jsxs("div",{className:"flex justify-between flex-wrap items-center mb-4",children:[f.jsx("h1",{className:"text-2xl font-bold",children:"Product Groups"}),f.jsxs("button",{className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 !rounded-lg hover:bg-blue-700",onClick:()=>e("/product-group-form"),children:[f.jsx(Vc,{size:18})," Add Product Group"]})]}),f.jsxs("div",{className:"bg-white shadow rounded-lg overflow-x-auto p-5",children:[f.jsx("div",{className:"mb-4",children:f.jsx("input",{type:"text",placeholder:"Search product groups...",value:a,onChange:Y=>n(Y.target.value),className:"border px-3 py-2 rounded-md w-full"})}),f.jsxs("table",{className:"w-full",children:[f.jsx("thead",{className:"bg-sky-50",children:f.jsxs("tr",{children:[f.jsx("th",{className:"px-4 py-3",children:"Group Name"}),f.jsx("th",{className:"px-4 py-3",children:"Main Products"}),f.jsx("th",{className:"px-4 py-3",children:"Addon Products"}),f.jsx("th",{className:"px-4 py-3",children:"Status"}),f.jsx("th",{className:"px-4 py-3",children:"Actions"})]})}),f.jsx("tbody",{children:(t==null?void 0:t.length)>0?t.map((Y,K)=>f.jsxs("tr",{className:"hover:bg-sky-50",children:[f.jsx("td",{className:"px-4 py-2",children:Y[0]}),f.jsx("td",{className:"px-4 py-2",children:Y[1]}),f.jsx("td",{className:"px-4 py-2",children:Y[2]}),f.jsx("td",{className:"px-4 py-2",children:Y[3]==="TRUE"?"Available":"Not Available"}),f.jsxs("td",{className:"px-4 py-2 flex gap-2",children:[f.jsx("button",{className:"border px-2 py-1 rounded-md",onClick:()=>{u(Y),M(Y[3]==="TRUE"),N(Array.isArray(Y[2])?Y[2]:Y[2].split(",")),w(Y[1]),v(Y[0]),o(!0)},children:f.jsx(Zf,{size:16})}),f.jsx("button",{className:"border px-2 py-1 rounded-md",onClick:()=>re(Y[0]),children:f.jsx(Kf,{size:16})})]})]},K)):f.jsx("tr",{children:f.jsx("td",{colSpan:5,className:"text-center py-4",children:"No product groups found."})})})]})]}),s&&f.jsx("div",{className:"fixed inset-0 flex items-center justify-center backdrop-blur-sm bg-black/30 z-50",children:f.jsxs("div",{className:"max-w-4xl w-full mx-4 bg-white p-6 rounded-lg shadow-md",children:[f.jsx("h2",{className:"text-2xl font-semibold text-gray-800",children:"Edit Product Group"}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:["Group Name ",f.jsx("span",{className:"text-red-500",children:"*"})]}),f.jsx("input",{type:"text",value:x,onChange:Y=>v(Y.target.value),placeholder:"Enter Product Name",className:"mt-1 block w-full px-4 py-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",required:!0})]}),f.jsxs("div",{children:[f.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:["Main Products ",f.jsx("span",{className:"text-red-500",children:"*"})]}),f.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[f.jsx("button",{onClick:()=>e("/add-product"),className:"bg-blue-500 text-white px-3 py-1 rounded hover:bg-blue-600",children:"+ Product"}),f.jsxs("select",{value:g,onChange:Y=>w(Y.target.value),className:"w-full px-4 py-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",required:!0,children:[f.jsx("option",{value:"",children:"Select Main Product"}),z.map((Y,K)=>f.jsx("option",{value:Y[0],children:Y[0]},K))]})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Addon Products"}),f.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[f.jsx("button",{onClick:()=>e("/add-product"),className:"bg-blue-500 text-white px-3 py-1 rounded hover:bg-blue-600",children:"+ Product"}),f.jsxs("select",{multiple:!0,value:b,onChange:F,className:"w-full px-4 py-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 h-32",children:[f.jsx("option",{value:"",children:"Select Addon Products"}),z.map((Y,K)=>f.jsx("option",{value:Y[0],children:Y[0]},K))]})]}),b.length>0&&f.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Selected: ",b.join(", ")]})]}),f.jsx("div",{className:"grid grid-cols-3 gap-4",children:f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Status"}),f.jsx("div",{className:`w-12 h-6 flex items-center rounded-full p-1 cursor-pointer ${j?"bg-blue-500":"bg-gray-300"}`,onClick:()=>M(!j),children:f.jsx("div",{className:`w-5 h-5 bg-white rounded-full shadow-md transform ${j?"translate-x-6":"translate-x-0"} transition`})})]})}),f.jsxs("div",{className:"flex justify-end gap-3 mt-4",children:[f.jsx("button",{onClick:()=>{v(""),w(""),N([]),M(!0),o(!1)},className:"border px-4 py-2 rounded text-gray-700 hover:bg-gray-100",children:"Cancel"}),f.jsx("button",{onClick:R,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Edit Group"})]})]})]})})]})}const PT=({setDialogOpen:e,setRefresh:t,refresh:r,editingBrand:a,setEditingBrand:n})=>{const s=ua(),o=a,[c,u]=P.useState(a?o[0]:""),[h,p]=P.useState(a?o[1]:""),x=async()=>{(await fetch(a?"https://sheeladecor.netlify.app/.netlify/functions/server/updatebrand":"https://sheeladecor.netlify.app/.netlify/functions/server/addbrand",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({brandName:c,description:h})})).status===200?(alert(a?"Brand updated successfully":"Brand added successfully"),t(!r),n(null),e(!1)):alert("Error saving brand")};return f.jsx("div",{className:"absolute top-0 left-1/2 transform -translate-x-1/2 mt-10 z-50 w-full max-w-md",children:f.jsxs("div",{className:"bg-white p-6 rounded shadow-md w-full border",children:[f.jsx("h2",{className:"text-xl font-bold mb-4",children:a?"Edit Brand":"Add Brand"}),f.jsx("input",{className:"border p-2 rounded w-full mb-2",placeholder:"Brand Name",value:c,onChange:v=>{a||u(v.target.value)}}),f.jsx("input",{className:"border p-2 rounded w-full mb-2",placeholder:"Description",value:h,onChange:v=>p(v.target.value)}),f.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[f.jsx("button",{className:"bg-gray-500 text-white px-4 py-2 rounded",onClick:()=>{s("/masters/brands"),e(!1)},children:"Cancel"}),f.jsx("button",{className:"bg-blue-500 text-white px-4 py-2 rounded",onClick:x,children:"Save"})]})]})})};async function n$(){try{const e=await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/getbrands",{credentials:"include"});if(!e.ok)throw new Error(`HTTP error! Status: ${e.status}`);const t=await e.json();return Array.isArray(t.body)?t.body:[]}catch(e){return console.error("Error fetching brands:",e),[]}}async function s$(e,t){try{const r=await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/deletebrand",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({brandName:e})});if(r.ok)alert("Brand deleted"),t(!0);else{const a=await r.text();alert(`Error deleting brand: ${a||r.statusText}`)}}catch(r){alert("Network or server error while deleting brand"),console.error("Delete brand error:",r)}}function i$(){const[e,t]=P.useState([]),[r,a]=P.useState(""),[n,s]=P.useState(!1),[o,c]=P.useState(null),[u,h]=P.useState(!1),p=ua(),x=wa(),v=ur(g=>g.data.brands);return P.useEffect(()=>{const g=async()=>{var w;try{const b=localStorage.getItem("brandData"),N=Date.now(),_=5*60*1e3;if(b){const j=JSON.parse(b);if(((w=j.data)==null?void 0:w.length)>0&&N-j.time<_){x(yb(j.data)),t(j.data);return}}const E=await n$();Array.isArray(E)?(x(yb(E)),t(E),localStorage.setItem("brandData",JSON.stringify({data:E,time:N}))):console.error("Fetched brand data is invalid:",E)}catch(b){console.error("Error fetching brands:",b)}};u||!v||v.length===0?(g(),h(!1)):t(v)},[v,x,u]),f.jsxs("div",{className:"md:p-6 pt-20 h-full bg-gray-50",children:[f.jsxs("div",{className:"flex flex-wrap justify-between items-center mb-4",children:[f.jsx("h1",{className:"text-2xl font-bold",children:"Brands"}),f.jsxs("button",{className:"flex !rounded-lg items-center gap-2 bg-blue-600 text-white px-4 py-2",onClick:()=>p("/brand-dilog"),children:[f.jsx(Vc,{size:18})," Add Brand"]})]}),f.jsxs("div",{className:"bg-white overflow-x-auto shadow rounded-lg p-5",children:[f.jsx("div",{className:"mb-4",children:f.jsx("input",{type:"text",placeholder:"Search brands...",value:r,onChange:g=>a(g.target.value),className:"border px-3 py-2 rounded-md w-full"})}),f.jsxs("table",{className:"w-full",children:[f.jsx("thead",{className:"bg-sky-50",children:f.jsxs("tr",{children:[f.jsx("th",{className:"px-4 py-3",children:"Brand Name"}),f.jsx("th",{className:"px-4 py-3",children:"Description"}),f.jsx("th",{className:"px-4 py-3",children:"Actions"})]})}),f.jsx("tbody",{children:e.length>0?e.map((g,w)=>f.jsxs("tr",{className:"hover:bg-sky-50",children:[f.jsx("td",{className:"px-4 py-2",children:g[0]}),f.jsx("td",{className:"px-4 py-2",children:g[1]}),f.jsxs("td",{className:"px-4 py-2 flex gap-2",children:[f.jsx("button",{className:"border px-2 py-1 rounded-md",onClick:()=>{c(g),s(!0)},children:f.jsx(Zf,{size:16})}),f.jsx("button",{className:"border px-2 py-1 rounded-md",onClick:()=>s$(g[0],h),children:f.jsx(Kf,{size:16})})]})]},w)):f.jsx("tr",{children:f.jsx("td",{colSpan:3,className:"text-center py-4",children:"No brands found."})})})]})]}),n&&f.jsx(PT,{setDialogOpen:s,setRefresh:h,refresh:u,editingBrand:o,setEditingBrand:c})]})}const LT=({setDialogOpen:e,setRefresh:t,refresh:r,editingCatalogue:a,setEditingCatalogue:n})=>{const s=ua(),o=a,[c,u]=P.useState(a?o[0]:""),[h,p]=P.useState(a?o[1]:""),x=async()=>{(await fetch(a?"https://sheeladecor.netlify.app/.netlify/functions/server/updatecatalogue":"https://sheeladecor.netlify.app/.netlify/functions/server/addcatalogue",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({catalogueName:c,description:h})})).status===200?(alert(a?"Catalogue updated successfully":"Catalogue added successfully"),t(!r),n(null),e(!1)):alert("Error saving catalogue")};return f.jsx("div",{className:"absolute top-0 left-1/2 transform -translate-x-1/2 mt-10 z-50 w-full max-w-md",children:f.jsxs("div",{className:"bg-white p-6 rounded shadow-md w-full border",children:[f.jsx("h2",{className:"text-xl font-bold mb-4",children:a?"Edit Catalogue":"Add Catalogue"}),f.jsx("input",{className:`${a?"hidden":"border"} p-2 rounded w-full mb-2`,placeholder:"Catalogue Name",value:c,onChange:v=>u(v.target.value)}),f.jsx("input",{className:"border p-2 rounded w-full mb-2",placeholder:"Description",value:h,onChange:v=>p(v.target.value)}),f.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[f.jsx("button",{className:"bg-gray-500 text-white px-4 py-2 rounded",onClick:()=>{s("/masters/catalogues"),e(!1)},children:"Cancel"}),f.jsx("button",{className:"bg-blue-500 text-white px-4 py-2 rounded",onClick:x,children:"Save"})]})]})})};async function o$(){try{const e=await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/getcatalogues",{credentials:"include"});if(!e.ok)throw new Error(`HTTP error! Status: ${e.status}`);const t=await e.json();return Array.isArray(t.body)?t.body:[]}catch(e){return console.error("Error fetching catalogues:",e),[]}}async function l$(e,t){try{const r=await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/deletecatalogue",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({catalogueName:e})});if(r.ok)alert("Catalogue deleted"),t(!0);else{const a=await r.text();alert(`Error deleting catalogue: ${a||r.statusText}`)}}catch(r){console.error("Error deleting catalogue:",r),alert("Network or server error while deleting catalogue")}}function c$(){const e=ua(),[t,r]=P.useState([]),[a,n]=P.useState(""),[s,o]=P.useState(!1),[c,u]=P.useState(null),[h,p]=P.useState(!1),x=wa(),v=ur(g=>g.data.catalogues);return P.useEffect(()=>{const g=async()=>{var w;try{const b=localStorage.getItem("catalogueData"),N=Date.now(),_=5*60*1e3;if(b){const j=JSON.parse(b);if(((w=j.data)==null?void 0:w.length)>0&&N-j.time<_){x(r(j.data)),r(j.data);return}}const E=await o$();Array.isArray(E)?(x(r(E)),r(E),localStorage.setItem("catalogueData",JSON.stringify({data:E,time:N}))):console.error("Fetched catalogue data is invalid:",E)}catch(b){console.error("Error fetching catalogues:",b)}};h||!v||v.length===0?(g(),p(!1)):v!==t&&r(v)},[v,x,h]),f.jsxs("div",{className:"md:p-6 pt-20 h-full bg-gray-50",children:[f.jsxs("div",{className:"flex flex-wrap justify-between items-center mb-4",children:[f.jsx("h1",{className:"text-2xl font-bold",children:"Catalogues"}),f.jsxs("button",{className:"flex !rounded-md items-center gap-2 bg-blue-600 text-white px-6 py-2 rounded-md",onClick:()=>e("/catalogue-dialog"),children:[f.jsx(Vc,{size:18})," Add Catalogue"]})]}),f.jsxs("div",{className:"bg-white overflow-x-auto shadow rounded-lg p-5",children:[f.jsx("div",{className:"mb-4",children:f.jsx("input",{type:"text",placeholder:"Search catalogues...",value:a,onChange:g=>n(g.target.value),className:"border px-3 py-2 rounded-md w-full"})}),f.jsxs("table",{className:"w-full",children:[f.jsx("thead",{className:"bg-blue-50",children:f.jsxs("tr",{children:[f.jsx("th",{className:"px-4 py Zinc",children:"Items"}),f.jsx("th",{className:"px-4 py-3",children:"Description"}),f.jsx("th",{className:"px-4 py-3",children:"Actions"})]})}),f.jsx("tbody",{children:t.length>0?t.map((g,w)=>f.jsxs("tr",{className:"hover:bg-blue-50",children:[f.jsx("td",{className:"px-4 py-2",children:g[0]}),f.jsx("td",{className:"px-4 py-2",children:g[1]}),f.jsxs("td",{className:"px-4 py-2 flex gap-2",children:[f.jsx("button",{className:"border px-2 py-1 rounded-md",onClick:()=>{u(g),o(!0)},children:f.jsx(Zf,{size:16})}),f.jsx("button",{className:"border px-2 py-1 rounded-md",onClick:()=>l$(g[0],p),children:f.jsx(Kf,{size:16})})]})]},w)):f.jsx("tr",{children:f.jsx("td",{colSpan:3,className:"text-center py-4",children:"No catalogues found."})})})]})]}),s&&f.jsx(LT,{setDialogOpen:o,setRefresh:p,refresh:h,editingCatalogue:c,setEditingCatalogue:u})]})}const OT=({setDialogOpen:e,setRefresh:t,refresh:r,editingInterior:a,setEditingInterior:n})=>{const s=ua(),o=a,[c,u]=P.useState(a?o[0]:""),[h,p]=P.useState(a?o[1]:""),[x,v]=P.useState(a?o[2]:""),[g,w]=P.useState(a?o[3]:""),b=async()=>{(await fetch(a?"https://sheeladecor.netlify.app/.netlify/functions/server/updateinteriordata":"https://sheeladecor.netlify.app/.netlify/functions/server/sendinteriordata",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({name:c,email:h,phonenumber:x,address:g})})).status===200?(alert(a?"Interior updated successfully":"Interior added successfully"),t(!r),n(null),e(!1)):alert("Error saving interior")};return f.jsx("div",{className:"absolute  top-0 left-1/2 transform -translate-x-1/2 mt-10 z-50 w-full max-w-md",children:f.jsxs("div",{className:"bg-white  p-6 rounded shadow-md w-full border",children:[f.jsx("h2",{className:"text-xl font-bold mb-4",children:a?"Edit Interior":"Add Interior"}),f.jsx("input",{className:`${a?"hidden":"none"} border p-2 rounded w-full mb-2`,placeholder:"Name",value:c,onChange:N=>u(N.target.value)}),f.jsx("input",{className:"border p-2 rounded w-full mb-2",placeholder:"Email",value:h,onChange:N=>p(N.target.value)}),f.jsx("input",{className:"border p-2 rounded w-full mb-2",placeholder:"Phone Number",value:x,onChange:N=>v(N.target.value)}),f.jsx("input",{className:"border p-2 rounded w-full mb-2",placeholder:"Address",value:g,onChange:N=>w(N.target.value)}),f.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[f.jsx("button",{className:"bg-gray-500 text-white px-4 py-2 rounded",onClick:()=>{s("/masters/interiors"),e(!1)},children:"Cancel"}),f.jsx("button",{className:"bg-blue-500 text-white px-4 py-2 rounded",onClick:b,children:"Save"})]})]})})},u$=({interiorData:e,setInteriorOpen:t})=>{const r=wa();ur(u=>u.data.projects);const[a,n]=P.useState([]),[s,o]=P.useState(0),c=async()=>{const u=await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/getprojectdata",{credentials:"include"});if(!u.ok)throw new Error(`HTTP error! Status: ${u.status}`);const h=await u.json();if(!h.body||!Array.isArray(h.body))throw new Error("Invalid data format: Expected an array in data.body");const p=(w,b)=>{try{return typeof w=="string"?JSON.parse(w):w||b}catch(N){return console.warn("Invalid JSON:",w,N),b}},x=w=>JSON.parse(JSON.stringify(w)),v=w=>{if(Array.isArray(w))return w;if(typeof w!="string")return[];try{const b=JSON.parse(w);return Array.isArray(b)?b:[]}catch{try{return w.replace(/^\[|\]$/g,"").split(",").map(N=>N.trim().replace(/^"+|"+$/g,""))}catch{return[]}}};return h.body.map(w=>({projectName:w[0],customerLink:p(w[1],[]),projectReference:w[2]||"",status:w[3]||"",totalAmount:parseFloat(w[4])||0,totalTax:parseFloat(w[5])||0,paid:parseFloat(w[6])||0,discount:parseFloat(w[7])||0,createdBy:w[8]||"",allData:x(p(w[9],[])),projectDate:w[10]||"",additionalRequests:p(w[11],[]),interiorArray:v(w[12]),salesAssociateArray:v(w[13]),additionalItems:x(p(w[14],[])),goodsArray:x(p(w[15],[])),tailorsArray:x(p(w[16],[])),projectAddress:w[17],date:w[18]}))};return P.useEffect(()=>{(async()=>{var h,p;try{const x=localStorage.getItem("projectData"),v=Date.now(),g=5*60*1e3;let w=[];if(x){const b=JSON.parse(x);((h=b==null?void 0:b.data)==null?void 0:h.length)>0&&v-b.time<g&&(w=b.data,r(La(w)))}if(w.length===0){const b=await c();Array.isArray(b)?(w=b,r(La(w)),localStorage.setItem("projectData",JSON.stringify({data:b,time:v}))):console.warn("Fetched project data is not an array:",b)}if(w.length>0&&(e!=null&&e[0])){const b=w.filter(N=>{var _;return((_=N==null?void 0:N.interiorArray)==null?void 0:_[0])===e[0]});o(b.length),n(b)}}catch(x){console.error("Failed to fetch projects:",x);const v=localStorage.getItem("projectData");if(v){const g=JSON.parse(v);if(((p=g==null?void 0:g.data)==null?void 0:p.length)>0&&(r(La(g.data)),e!=null&&e[0])){const w=g.data.filter(b=>{var N;return((N=b==null?void 0:b.interiorArray)==null?void 0:N[0])===e[0]});n(w)}}}})()},[r,e,n]),f.jsxs("div",{className:"flex flex-col gap-4 w-full p-4 sm:p-6 md:p-8",children:[f.jsxs("div",{className:"w-full flex flex-col sm:flex-row sm:justify-between sm:items-center gap-4",children:[f.jsxs("div",{className:"flex flex-col",children:[f.jsx("p",{className:"text-lg sm:text-xl md:text-2xl font-semibold",children:e[0]}),f.jsxs("div",{className:"flex flex-row gap-2 text-sm sm:text-base",children:[f.jsx("p",{onClick:()=>t(!1),className:"cursor-pointer hover:text-sky-600",children:"Interiors"}),f.jsx("span",{children:"•"}),f.jsx("p",{children:e[0]})]})]}),f.jsx("button",{onClick:()=>t(!1),className:"px-4 py-2 bg-sky-600 text-white rounded-lg hover:bg-sky-700 transition-colors w-full sm:w-auto",children:"Cancel"})]}),f.jsxs("div",{className:"flex flex-col gap-3 border rounded-xl p-4 w-full sm:w-11/12 md:w-3/4 lg:w-1/2",children:[f.jsx("p",{className:"text-base sm:text-lg md:text-xl font-medium",children:"Interior Details"}),f.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 text-sm sm:text-base",children:[f.jsx("p",{className:"text-gray-500",children:"Name"}),f.jsx("p",{children:e[0]}),f.jsx("p",{className:"text-gray-500",children:"Email"}),f.jsx("p",{children:e[1]}),f.jsx("p",{className:"text-gray-500",children:"Phone no."}),f.jsx("p",{children:e[2]}),f.jsx("p",{className:"text-gray-500",children:"Address"}),f.jsx("p",{children:e[3]}),f.jsx("p",{className:"text-gray-500",children:"Total Projects"}),f.jsx("p",{children:s})]})]}),f.jsx("div",{className:"w-full flex flex-col p-4 border rounded-xl overflow-x-auto",children:f.jsxs("table",{className:"table-auto w-full min-w-[600px] sm:min-w-0",children:[f.jsx("thead",{children:f.jsxs("tr",{className:"bg-gray-100",children:[f.jsx("th",{className:"border-gray-300 px-4 py-2 text-left text-sm sm:text-base",children:"Sr.No"}),f.jsx("th",{className:"border-gray-300 px-4 py-2 text-left text-sm sm:text-base",children:"Project Name"}),f.jsx("th",{className:"border-gray-300 px-4 py-2 text-left text-sm sm:text-base",children:"Project Amount"}),f.jsx("th",{className:"border-gray-300 px-4 py-2 text-left text-sm sm:text-base",children:"Project Date"})]})}),f.jsx("tbody",{children:a.length>0?a.map((u,h)=>f.jsxs("tr",{className:"hover:bg-sky-50",children:[f.jsx("td",{className:"border-gray-300 px-4 py-2 text-sm sm:text-base",children:h+1}),f.jsx("td",{className:"border-gray-300 px-4 py-2 text-sm sm:text-base",children:u.projectName}),f.jsx("td",{className:"border-gray-300 px-4 py-2 text-sm sm:text-base",children:u.totalAmount}),f.jsx("td",{className:"border-gray-300 px-4 py-2 text-sm sm:text-base",children:u.projectDate})]},h)):f.jsx("tr",{children:f.jsx("td",{colSpan:"4",className:"text-center px-4 py-2 text-sm sm:text-base",children:"No projects found"})})})]})})]})};async function ES(){try{const e=await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/getinteriordata",{credentials:"include"});if(!e.ok)throw new Error(`HTTP error! Status: ${e.status}`);const t=await e.json();return Array.isArray(t.body)?t.body:[]}catch(e){return console.error("Error fetching interiors:",e),[]}}function f$(){const e=ua(),[t,r]=P.useState([]),[a,n]=P.useState(""),[s,o]=P.useState(!1),[c,u]=P.useState(null),[h,p]=P.useState(!1),[x,v]=P.useState(!1),g=wa(),w=ur(E=>E.data.interiors);async function b(E,j){try{const M=await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/deleteinteriordata",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({name:E})});if(M.ok){alert("Interior deleted");const U=await ES();g(Lf(U)),r(U),localStorage.setItem("interiorData",JSON.stringify({data:U,time:Date.now()})),j(!0)}else{const U=await M.text();alert(`Error deleting interior: ${U||M.statusText}`)}}catch(M){console.error("Error deleting interior:",M),alert("Network or server error while deleting interior")}}P.useEffect(()=>{const E=async()=>{var j;try{const M=localStorage.getItem("interiorData"),U=Date.now(),V=5*60*1e3;let I=[];if(M){const H=JSON.parse(M);if(((j=H==null?void 0:H.data)==null?void 0:j.length)>0&&U-H.time<V){I=H.data,g(Lf(I)),r(I);return}}const z=await ES();Array.isArray(z)?(I=z,g(Lf(I)),r(I),localStorage.setItem("interiorData",JSON.stringify({data:I,time:U}))):console.warn("Fetched interior data is not an array:",z)}catch(M){console.error("Error fetching interiors:",M)}};h||!w||w.length===0?(E(),p(!1)):r(w)},[w,g,h]);const[N,_]=P.useState(null);return f.jsxs("div",{className:"md:p-6 pt-20 h-full bg-gray-50",children:[f.jsxs("div",{className:`flex flex-wrap justify-between items-center mb-4 ${x?"hidden":""}`,children:[f.jsx("h1",{className:"text-2xl font-bold",children:"Interiors"}),f.jsxs("button",{className:"flex !rounded-md items-center gap-2 bg-blue-600 text-white px-4 py-2",onClick:()=>e("/interior-dialog"),children:[f.jsx(Vc,{size:18})," Add Interior"]})]}),f.jsxs("div",{className:`bg-white shadow rounded-lg overflow-x-auto p-5 ${x?"hidden":""}`,children:[f.jsx("div",{className:"mb-4",children:f.jsx("input",{type:"text",placeholder:"Search interiors...",value:a,onChange:E=>n(E.target.value),className:"border px-3 py-2 rounded-md w-full"})}),f.jsxs("table",{className:"w-full",children:[f.jsx("thead",{className:"bg-sky-50",children:f.jsxs("tr",{children:[f.jsx("th",{className:"px-4 py-3",children:"Name"}),f.jsx("th",{className:"px-4 py-3",children:"Email"}),f.jsx("th",{className:"px-4 py-3",children:"Phone Number"}),f.jsx("th",{className:"px-4 py-3",children:"Address"}),f.jsx("th",{className:"px-4 py-3",children:"Actions"})]})}),f.jsx("tbody",{children:t.length>0?t.map((E,j)=>f.jsxs("tr",{className:"hover:bg-sky-50",onClick:()=>{_(E),v(!0)},children:[f.jsx("td",{className:"px-4 py-2",children:E[0]}),f.jsx("td",{className:"px-4 py-2",children:E[1]}),f.jsx("td",{className:"px-4 py-2",children:E[2]}),f.jsx("td",{className:"px-4 py-2",children:E[3]}),f.jsxs("td",{className:"px-4 py-2 flex gap-2",children:[f.jsx("button",{className:"border px-2 py-1 rounded-md",onClick:()=>{u(E),o(!0)},children:f.jsx(Zf,{size:16})}),f.jsx("button",{className:"border px-2 py-1 rounded-md",onClick:()=>b(E[0],p),children:f.jsx(Kf,{size:16})})]})]},j)):f.jsx("tr",{children:f.jsx("td",{colSpan:5,className:"text-center py-4",children:"No interiors found."})})})]})]}),x&&f.jsx(u$,{interiorData:N,setInteriorOpen:v}),s&&f.jsx(OT,{setDialogOpen:o,setRefresh:p,refresh:h,editingInterior:c,setEditingInterior:u})]})}const RT=({setDialogOpen:e,setRefresh:t,refresh:r,editingTailor:a,setEditingTailor:n})=>{const s=ua(),o=a,[c,u]=P.useState(a?o[0]:""),[h,p]=P.useState(a?o[1]:""),[x,v]=P.useState(a?o[2]:""),[g,w]=P.useState(a?o[3]:""),b=async()=>{(await fetch(a?"https://sheeladecor.netlify.app/.netlify/functions/server/updatetailor":"https://sheeladecor.netlify.app/.netlify/functions/server/addtailor",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({tailorName:c,phoneNumber:h,email:x,address:g})})).status===200?(alert(a?"Tailor updated successfully":"Tailor added successfully"),t(!r),n(null),e(!1)):alert("Error saving tailor")};return f.jsx("div",{className:"absolute top-0 left-1/2 transform -translate-x-1/2 mt-10 z-50 w-full max-w-md",children:f.jsxs("div",{className:"bg-white p-6 rounded shadow-md w-full border",children:[f.jsx("h2",{className:"text-xl font-bold mb-4",children:a?"Edit Tailor":"Add Tailor"}),f.jsx("input",{className:`${a?"hidden":""} border p-2 rounded w-full mb-2`,placeholder:"Tailor Name",value:c,onChange:N=>u(N.target.value)}),f.jsx("input",{className:"border p-2 rounded w-full mb-2",placeholder:"Phone Number",value:h,onChange:N=>p(N.target.value)}),f.jsx("input",{className:"border p-2 rounded w-full mb-2",placeholder:"Email",value:x,onChange:N=>v(N.target.value)}),f.jsx("input",{className:"border p-2 rounded w-full mb-2",placeholder:"Address",value:g,onChange:N=>w(N.target.value)}),f.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[f.jsx("button",{className:"bg-gray-500 text-white px-4 py-2 rounded",onClick:()=>{s("/masters/tailors"),e(!1)},children:"Cancel"}),f.jsx("button",{className:"bg-blue-500 text-white px-4 py-2 rounded",onClick:b,children:"Save"})]})]})})};async function MT(){try{const e=await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/gettailors",{credentials:"include"});if(!e.ok)throw new Error(`HTTP error! Status: ${e.status}`);const t=await e.json();return Array.isArray(t.body)?t.body:[]}catch(e){return console.error("Error fetching tailors:",e),[]}}async function h$(e,t){try{const r=await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/deletetailor",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({tailorName:e})});if(r.ok){alert("Tailor deleted");const a=await MT();dispatch(i1(a)),setTailors(a),localStorage.setItem("tailorData",JSON.stringify({data:a,time:Date.now()})),t(!0)}else{const a=await r.text();alert(`Error deleting tailor: ${a||r.statusText}`)}}catch(r){console.error("Error deleting tailor:",r),alert("Network or server error while deleting tailor")}}function d$(){const e=ua(),[t,r]=P.useState([]),[a,n]=P.useState(""),[s,o]=P.useState(!1),[c,u]=P.useState(null),[h,p]=P.useState(!1),x=wa(),v=ur(g=>g.data.tailors);return P.useEffect(()=>{const g=async()=>{var w;try{const b=localStorage.getItem("tailorData"),N=Date.now(),_=5*60*1e3;if(b){const j=JSON.parse(b);if(((w=j.data)==null?void 0:w.length)>0&&N-j.time<_){x(i1(j.data)),r(j.data);return}}const E=await MT();Array.isArray(E)?(x(i1(E)),r(E),localStorage.setItem("tailorData",JSON.stringify({data:E,time:N}))):console.error("Fetched tailor data is invalid:",E)}catch(b){console.error("Error fetching tailors:",b)}};h||!v||v.length===0?(g(),p(!1)):v!==t&&r(v)},[v,x,h]),f.jsxs("div",{className:"md:p-6 pt-20 h-full bg-gray-50",children:[f.jsxs("div",{className:"flex flex-wrap justify-between items-center mb-4",children:[f.jsx("h1",{className:"text-2xl font-bold",children:"Tailors"}),f.jsxs("button",{className:"flex !rounded-md items-center gap-2 bg-blue-600 text-white px-4 py-2",onClick:()=>e("/tailor-dialog"),children:[f.jsx(Vc,{size:18})," Add Tailor"]})]}),f.jsxs("div",{className:"bg-white shadow overflow-x-auto rounded-lg p-5",children:[f.jsx("div",{className:"mb-4",children:f.jsx("input",{type:"text",placeholder:"Search tailors...",value:a,onChange:g=>n(g.target.value),className:"border px-3 py-2 rounded-md w-full"})}),f.jsxs("table",{className:"w-full",children:[f.jsx("thead",{className:"bg-sky-50",children:f.jsxs("tr",{children:[f.jsx("th",{className:"px-4 py-3",children:"Tailor Name"}),f.jsx("th",{className:"px-4 py-3",children:"Phone Number"}),f.jsx("th",{className:"px-4 py-3",children:"Email"}),f.jsx("th",{className:"px-4 py-3",children:"Address"}),f.jsx("th",{className:"px-4 py-3",children:"Actions"})]})}),f.jsx("tbody",{children:t.length>0?t.map((g,w)=>f.jsxs("tr",{className:"hover:bg-sky-50",children:[f.jsx("td",{className:"px-4 py-2",children:g[0]}),f.jsx("td",{className:"px-4 py-2",children:g[1]}),f.jsx("td",{className:"px-4 py-2",children:g[2]}),f.jsx("td",{className:"px-4 py-2",children:g[3]}),f.jsxs("td",{className:"px-4 py-2 flex gap-2",children:[f.jsx("button",{className:"border px-2 py-1 rounded-md",onClick:()=>{u(g),o(!0)},children:f.jsx(Zf,{size:16})}),f.jsx("button",{className:"border px-2 py-1 rounded-md",onClick:()=>h$(g[0],p),children:f.jsx(Kf,{size:16})})]})]},w)):f.jsx("tr",{children:f.jsx("td",{colSpan:5,className:"text-center py-4",children:"No tailors found."})})})]})]}),s&&f.jsx(RT,{setDialogOpen:o,setRefresh:p,refresh:h,editingTailor:c,setEditingTailor:u})]})}const IT=({setDialogOpen:e,setRefresh:t,refresh:r,editingSalesAssociate:a,setEditingSalesAssociate:n})=>{const s=ua(),o=a,[c,u]=P.useState(a?o[0]:""),[h,p]=P.useState(a?o[1]:""),[x,v]=P.useState(a?o[2]:""),[g,w]=P.useState(a?o[3]:""),b=async()=>{(await fetch(a?"https://sheeladecor.netlify.app/.netlify/functions/server/updatesalesassociatedata":"https://sheeladecor.netlify.app/.netlify/functions/server/sendsalesassociatedata",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({name:c,email:h,phonenumber:x,address:g})})).status===200?(alert(a?"Sales Associate updated successfully":"Sales Associate added successfully"),t(!r),n(null),e(!1)):alert("Error saving sales associate")};return f.jsx("div",{className:"absolute top-0 left-1/2 transform -translate-x-1/2 mt-10 z-50 w-full max-w-md",children:f.jsxs("div",{className:"bg-white p-6 rounded shadow-md w-full border",children:[f.jsx("h2",{className:"text-xl font-bold mb-4",children:a?"Edit Sales Associate":"Add Sales Associate"}),f.jsx("input",{className:`${a?"hidden":""} border p-2 rounded w-full mb-2`,placeholder:"Name",value:c,onChange:N=>u(N.target.value)}),f.jsx("input",{className:"border p-2 rounded w-full mb-2",placeholder:"Email",value:h,onChange:N=>p(N.target.value)}),f.jsx("input",{className:"border p-2 rounded w-full mb-2",placeholder:"Phone Number",value:x,onChange:N=>v(N.target.value)}),f.jsx("input",{className:"border p-2 rounded w-full mb-2",placeholder:"Address",value:g,onChange:N=>w(N.target.value)}),f.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[f.jsx("button",{className:"bg-gray-500 text-white px-4 py-2 rounded",onClick:()=>{s("/masters/sales-associate"),e(!1)},children:"Cancel"}),f.jsx("button",{className:"bg-blue-500 text-white px-4 py-2 rounded",onClick:b,children:"Save"})]})]})})};async function BT(){try{const e=await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/getsalesassociatedata",{credentials:"include"});if(!e.ok)throw new Error(`HTTP error! Status: ${e.status}`);const t=await e.json();return Array.isArray(t.body)?t.body:[]}catch(e){return console.error("Error fetching sales associates:",e),[]}}async function p$(e,t){try{const r=await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/deletesalesassociatedata",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({name:e})});if(r.ok){alert("Sales Associate deleted");const a=await BT();dispatch(Vf(a)),setSalesAssociates(a),localStorage.setItem("salesAssociateData",JSON.stringify({data:a,time:Date.now()})),t(!0)}else{const a=await r.text();alert(`Error deleting sales associate: ${a||r.statusText}`)}}catch(r){console.error("Error deleting sales associate:",r),alert("Network or server error while deleting sales associate")}}function m$(){const e=ua(),[t,r]=P.useState([]),[a,n]=P.useState(""),[s,o]=P.useState(!1),[c,u]=P.useState(null),[h,p]=P.useState(!1),x=wa(),v=ur(g=>g.data.salesAssociates);return P.useEffect(()=>{const g=async()=>{var w;try{const b=localStorage.getItem("salesAssociateData"),N=Date.now(),_=5*60*1e3;if(b){const j=JSON.parse(b);if(((w=j.data)==null?void 0:w.length)>0&&N-j.time<_){x(Vf(j.data)),r(j.data);return}}const E=await BT();Array.isArray(E)?(x(Vf(E)),r(E),localStorage.setItem("salesAssociateData",JSON.stringify({data:E,time:N}))):console.error("Fetched sales associate data is invalid:",E)}catch(b){console.error("Error fetching sales associates:",b)}};h||!v||v.length===0?(g(),p(!1)):v!==t&&r(v)},[v,x,h]),f.jsxs("div",{className:"md:p-6 pt-20 h-full bg-gray-50",children:[f.jsxs("div",{className:"flex flex-wrap justify-between items-center mb-4",children:[f.jsx("h1",{className:"text-2xl font-bold",children:"Sales Associates"}),f.jsxs("button",{className:"flex !rounded-md items-center gap-2 bg-blue-600 text-white px-4 py-2",onClick:()=>e("/sales-associate-dialog"),children:[f.jsx(Vc,{size:18})," Add Sales Associate"]})]}),f.jsxs("div",{className:"bg-white overflow-x-auto shadow rounded-lg p-5",children:[f.jsx("div",{className:"mb-4",children:f.jsx("input",{type:"text",placeholder:"Search sales associates...",value:a,onChange:g=>n(g.target.value),className:"border px-3 py-2 rounded-md w-full"})}),f.jsxs("table",{className:"w-full",children:[f.jsx("thead",{className:"bg-sky-50",children:f.jsxs("tr",{children:[f.jsx("th",{className:"px-4 py-3",children:"Name"}),f.jsx("th",{className:"px-4 py-3",children:"Email"}),f.jsx("th",{className:"px-4 py-3",children:"Phone Number"}),f.jsx("th",{className:"px-4 py-3",children:"Address"}),f.jsx("th",{className:"px-4 py-3",children:"Actions"})]})}),f.jsx("tbody",{children:t.length>0?t.map((g,w)=>f.jsxs("tr",{className:"hover:bg-sky-50",children:[f.jsx("td",{className:"px-4 py-2",children:g[0]}),f.jsx("td",{className:"px-4 py-2",children:g[1]}),f.jsx("td",{className:"px-4 py-2",children:g[2]}),f.jsx("td",{className:"px-4 py-2",children:g[3]}),f.jsxs("td",{className:"px-4 py-2 flex gap-2",children:[f.jsx("button",{className:"border px-2 py-1 rounded-md",onClick:()=>{u(g),o(!0)},children:f.jsx(Zf,{size:16})}),f.jsx("button",{className:"border px-2 py-1 rounded-md",onClick:()=>p$(g[0],p),children:f.jsx(Kf,{size:16})})]})]},w)):f.jsx("tr",{children:f.jsx("td",{colSpan:5,className:"text-center py-4",children:"No sales associates found."})})})]})]}),s&&f.jsx(IT,{setDialogOpen:o,setRefresh:p,refresh:h,editingSalesAssociate:c,setEditingSalesAssociate:u})]})}const x$=()=>{const[e,t]=P.useState(""),[r,a]=P.useState(""),[n,s]=P.useState(""),[o,c]=P.useState(""),u=async()=>{if(r||o||!e||!n){alert("Please enter valid credentials");return}try{(await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({email:e,password:n})})).status===200?alert("Login Success"):alert("Invalid Credentials")}catch(p){console.error("Login error:",p),alert("Something went wrong. Please try again.")}},h=p=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(p);return P.useEffect(()=>{n.length===0?c(""):n.length<8?c("Password must be at least 8 characters long"):c("")},[n]),P.useEffect(()=>{e===""||h(e)?a(""):a("Enter a valid email")},[e]),f.jsx("div",{className:"flex items-center justify-center font-serif h-screen",children:f.jsxs("div",{className:"flex flex-col w-[75vw] md:w-[30vw] lg:w-[28vw] rounded-2xl border border-gray-300 gap-3",children:[f.jsxs("div",{className:"flex flex-col items-center gap-2 md:mt-2",children:[f.jsx("p",{className:"text-[7.5vw] md:text-[3.2vw] lg:text-[3vw] mt-2 px-2 md:px-4 lg:px-6 leading-tight text-center text-sky-600 font-semibold",children:"Login to your account"}),f.jsx("p",{className:"text-[3vw] md:text-[1.2vw] lg:text-[1.1vw] text-gray-500",children:"Hello, welcome back to your account"})]}),f.jsxs("div",{className:"flex flex-col gap-2 px-2 md:gap-3 md:px-2 md:mt-2 lg:px-4 lg:mt-8",children:[f.jsx("input",{value:e,onChange:p=>t(p.target.value),type:"email",placeholder:"Email Address",className:"text-[3.3vw] md:text-[2vw] lg:text-[1.2vw] pl-2 h-8 md:h-8 lg:h-10 rounded-xl border border-gray-300"}),f.jsx("p",{className:"text-[8px] md:text-[12px] -my-2 pl-1 py-1 text-red-700",children:r}),f.jsx("input",{value:n,onChange:p=>s(p.target.value),type:"password",placeholder:"Password",className:"text-[3.3vw] md:text-[2vw] lg:text-[1.2vw] pl-2 h-8 md:h-8 lg:h-10 rounded-xl border border-gray-300"}),f.jsx("p",{className:"text-[8px] md:text-[12px] pl-1 -my-2 text-red-700",children:o})]}),f.jsx("div",{className:"flex flex-row justify-between px-2 md:px-2 lg:px-4 ml-1",children:f.jsx(xi,{to:"/forgotpass",className:"underline text-gray-500 text-[3vw] md:text-[1.1vw] lg:text-[1vw] hover:text-black",children:"Forgot Password?"})}),f.jsx("button",{onClick:u,className:"rounded-xl bg-sky-400 lg:h-10 hover:bg-sky-500 h-8 md:text-md md:mt-2 md:mb-2 mb-2 mx-2 md:mx-2 md:h-8 text-sm lg:text-lg lg:mt-4 lg:mb-4 lg:mx-4",children:"Login"}),f.jsx("div",{className:"flex items-center justify-center mb-2 -mt-3 md:mb-3 lg:mb-4 lg:-mt-4 text-[2.8vw] md:text-[1.1vw] lg:text-[1vw]",children:f.jsxs("p",{children:["Don't have an account? ",f.jsx(xi,{className:"underline",to:"/register",children:"Register now"})]})})]})})},g$=()=>{const[e,t]=P.useState(""),[r,a]=P.useState(""),n=async()=>{if(r||!e){alert("Please enter a valid email address");return}try{(await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/auth/forgotpassword",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({email:e})})).status===200?alert("Password reset mail sent"):alert("Something went wrong. Please try again.")}catch(o){console.error("Error sending reset email:",o),alert("Error sending reset email. Please try again.")}},s=o=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(o);return P.useEffect(()=>{e===""||s(e)?a(""):a("Invalid email address")},[e]),f.jsx("div",{className:"flex items-center justify-center h-screen font-serif",children:f.jsxs("div",{className:"flex flex-col items-center gap-2 md:gap-3 rounded-2xl border border-gray-400 w-[60vw] md:w-[30vw] lg:w-[28vw]",children:[f.jsxs("div",{className:"flex flex-col items-center mt-2 md:mt-4 px-2",children:[f.jsx("p",{className:"text-[5.8vw] md:text-[3vw] lg:text-[2.4vw] font-semibold text-sky-600",children:"Forgot Password?"}),f.jsxs("p",{className:"text-[2.8vw] md:text-[1.3vw] lg:text-[1.1vw] text-center mt-1",children:["Enter your email address, and ",f.jsx("br",{})," we'll give you reset instructions"]})]}),f.jsxs("div",{className:"flex flex-col w-full px-2 md:px-2 lg:px-4 gap-2 md:gap-2 lg:gap-3 mt-4 lg:mt-5",children:[f.jsx("input",{value:e,onChange:o=>t(o.target.value),type:"email",placeholder:"Email Address",className:"text-[3.3vw] md:text-[2vw] lg:text-[1.2vw] h-8 md:h-8 lg:h-[3vw] border-gray-400 border rounded-xl pl-2"}),f.jsx("p",{className:"text-red-700 md:text-[12px] text-[8px] -my-2 pl-1 py-1",children:r}),f.jsx("button",{onClick:n,className:"lg:h-[3vw] md:h-8 h-8 text-[3.3vw] md:text-[2vw] lg:text-[1.5vw] rounded-xl bg-sky-400 hover:bg-sky-500",children:"Send Instructions"})]}),f.jsx(xi,{to:"/login",className:"text-gray-500 hover:text-black underline text-[2.8vw] md:text-[1.3vw] lg:text-[1vw] mb-2 md:mb-2 lg:mb-4",children:"Back to login"})]})})},v$=()=>{const{token:e}=CE(),t=ua(),[r,a]=P.useState(""),[n,s]=P.useState(""),[o,c]=P.useState("");P.useEffect(()=>{c(r===n?"":"Passwords don't match")},[r,n]);const u=async()=>{if(!e){alert("Invalid token");return}(await fetch(`https://sheeladecor.netlify.app/.netlify/functions/server/auth/passwordreset/${e}`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({password:r,token:e})})).status===200?(alert("Password reset successful"),t("/login")):alert("Error in password reset")};return f.jsx("div",{className:"h-screen flex items-center justify-center font-serif",children:f.jsxs("div",{className:"flex flex-col items-center w-[70vw] md:w-[40vw] lg:w-[30vw] rounded-2xl gap-2 border-1 border-gray-400 p-2 md:p-4",children:[f.jsxs("div",{className:"flex flex-col items-center justify-center gap-2",children:[f.jsx("p",{className:"text-sky-600 font-semibold text-[6vw] md:text-[3.5vw] lg:text-[2.5vw]",children:"New Password"}),f.jsx("p",{className:"text-sm md:text-[1.5vw] lg:text-[1vw] px-2 text-center",children:"Enter a new and strong password"})]}),f.jsx("input",{value:r,onChange:h=>a(h.target.value),className:"text-[3.3vw] md:text-[2vw] lg:text-[1.2vw] lg:h-10 h-8 w-full rounded-xl border-1 border-gray-400 pl-2 mt-4",type:"password",placeholder:"Password"}),f.jsx("input",{value:n,onChange:h=>s(h.target.value),className:"text-[3.3vw] md:text-[2vw] lg:text-[1.2vw] lg:h-10 h-8 w-full rounded-xl border-1 border-gray-400 pl-2",type:"password",placeholder:"Confirm Password"}),f.jsx("p",{className:"text-red-700 md:text-[12px] text-[8px] -my-2 pl-1",children:o}),f.jsx("button",{onClick:u,className:"lg:h-10 h-8 bg-sky-400 w-full rounded-xl hover:bg-sky-500 md:text-lg",children:"Submit"})]})})};function y$(){const e=ua(),[t,r]=P.useState(""),[a,n]=P.useState(""),[s,o]=P.useState(""),[c,u]=P.useState(""),[h,p]=P.useState(""),[x,v]=P.useState(""),[g,w]=P.useState(""),b=_=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(_);P.useEffect(()=>{t?b(t)?n(""):n("Enter a valid email"):n("")},[t]),P.useEffect(()=>{v(h&&h!==s?"Passwords don't match":"")},[h,s]),P.useEffect(()=>{s&&s.length<8?u("Password must be at least 8 characters long"):u("")},[s]);async function N(){if(!g||!t||!s||s!==h){alert("Please fill all fields correctly");return}(await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/auth/register",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({email:t,name:g,password:s})})).status===200&&e("/verify")}return f.jsx("div",{className:"flex items-center justify-center h-screen font-serif",children:f.jsxs("div",{className:"flex flex-col items-center justify-center px-2 lg:px-4 lg:w-[28vw] border border-gray-400 rounded-2xl gap-3 lg:gap-4",children:[f.jsx("p",{className:"text-[6vw] md:text-[3vw] lg:text-[2.6vw] mt-2 lg:mt-4 font-semibold text-sky-600",children:"Register Account"}),f.jsxs("div",{className:"flex flex-col w-full mt-3 lg:mt-4 gap-3 lg:gap-4",children:[f.jsx("input",{type:"text",value:g,onChange:_=>w(_.target.value),placeholder:"Full Name",className:"pl-2 text-[3.3vw] md:text-[2vw] lg:text-[1.2vw] h-8 lg:h-10 rounded-xl border border-gray-400"}),f.jsx("input",{type:"email",value:t,onChange:_=>r(_.target.value),placeholder:"Email Address",className:"pl-2 text-[3.3vw] md:text-[2vw] lg:text-[1.2vw] h-8 lg:h-10 rounded-xl border border-gray-400"}),f.jsx("p",{className:"pl-1 text-[8px] md:text-[12px] text-red-700 -my-2",children:a}),f.jsx("input",{type:"password",value:s,onChange:_=>o(_.target.value),placeholder:"Password",className:"pl-2 text-[3.3vw] md:text-[2vw] lg:text-[1.2vw] h-8 lg:h-10 rounded-xl border border-gray-400"}),f.jsx("p",{className:"pl-1 text-red-700 text-[8px] md:text-[12px] -my-2",children:c}),f.jsx("input",{type:"password",value:h,onChange:_=>p(_.target.value),placeholder:"Confirm Password",className:"pl-2 text-[3.3vw] md:text-[2vw] lg:text-[1.2vw] h-8 lg:h-10 rounded-xl border border-gray-400"}),f.jsx("p",{className:"pl-1 text-[8px] md:text-[12px] text-red-700 -my-2",children:x})]}),f.jsx("p",{className:"text-center text-[2.8vw] px-1 mt-3 lg:mt-4 md:text-[1.4vw] lg:text-[1.1vw]",children:"Click register and we will send you a verification email"}),f.jsx("button",{onClick:N,className:"lg:h-12 h-8 rounded-xl text-sm md:text-[1.8vw] lg:text-[1.2vw] bg-sky-400 w-full hover:bg-sky-500 mb-2 lg:mb-4",children:"Register"}),f.jsx(xi,{to:"/login",className:"-mt-4 underline mb-2 text-gray-500 hover:text-black text-sm md:text-[1.1vw] lg:text-[1vw]",children:"Back to Login"})]})})}function w$(){const e=ua(),[t,r]=P.useState(""),[a,n]=P.useState(""),[s,o]=P.useState(!1);async function c(){if(!t.trim()){n("Please enter the verification code.");return}o(!0),n("");try{const u=await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/auth/verifymail",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({code:t.trim()})});u.ok?(alert("Email verified successfully!"),e("/login")):(console.log(u),n("Invalid or expired code. Please try again."))}catch{n("An error occurred. Please try again.")}finally{o(!1)}}return f.jsx("div",{className:"flex font-serif items-center justify-center h-screen",children:f.jsxs("div",{className:"flex items-center flex-col w-[70vw] md:w-[40vw] lg:w-[30vw] rounded-2xl gap-4 border border-gray-400 p-4",children:[f.jsxs("div",{className:"flex flex-col items-center gap-2",children:[f.jsx("p",{className:"text-[6vw] md:text-[3vw] lg:text-[2.3vw] text-sky-600 font-semibold",children:"Verify Email"}),f.jsx("p",{className:"text-sm md:text-[1.2vw] lg:text-[1vw] text-center px-4",children:"We have sent an email to your address. Enter the verification code to complete registration."})]}),f.jsx("input",{type:"text",value:t,onChange:u=>r(u.target.value),placeholder:"Enter Code",className:"text-[3.3vw] md:text-[2vw] lg:text-[1.2vw] h-8 lg:h-10 rounded-xl border border-gray-400 w-[60vw] md:w-[35vw] lg:w-[24vw] pl-2",disabled:s}),a&&f.jsx("p",{className:"text-red-600 text-sm",children:a}),f.jsx("button",{onClick:c,className:"lg:h-10 h-8 w-[60vw] md:w-[35vw] lg:w-[24vw] rounded-xl bg-sky-400 hover:bg-sky-500 md:text-lg disabled:bg-gray-300",disabled:s,children:s?"Verifying...":"Submit"})]})})}const jS=async()=>(await(await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/getsingleproducts")).json()).body,b$=()=>{var K;const e=ua(),t=wa(),r=[["Fabric",["Meter"],["e.g. Curtains"]],["Area Based",["Sq.Feet"],["e.g. Area Based"]],["Running Length based",["Meter","Feet"],["e.g. Track, Border cloth"]],["Piece Based",["Piece","Items","Sets"],["e.g. Hooks, Tape"]],["Fixed Length Items",["Piece"],["e.g. 12 feet rod"]],["Fixed Area Items",["Piece","Roll"],["e.g. 57 sq.ft. wallpaper"]],["Tailoring",["Parts","Sq.Feet"],["e.g. Stitching"]]],[a,n]=P.useState([]),[s,o]=P.useState(!0),[c,u]=P.useState(!1),h=ur(X=>X.data.items),[p,x]=P.useState(""),[v,g]=P.useState(""),w=((K=r.find(X=>X[0]===p))==null?void 0:K[1])||[],[b,N]=P.useState(""),[_,E]=P.useState(""),[j,M]=P.useState(""),[U,V]=P.useState(""),[I,z]=P.useState(!1),[H,re]=P.useState(!1),R=X=>{const Z=X.target.value,ce=r.find(([te])=>te==Z);ce?(x(ce[0]),console.log(ce[0])):x("")},F=async X=>{X.preventDefault();const Z=new Date;let ce=h;if((!ce||ce.length===0)&&(ce=await jS()),ce.some(Q=>{var G;return((G=Q[0])==null?void 0:G.trim().toLowerCase())===b.trim().toLowerCase()})){alert("Product with this name already exists.");return}try{const Q=await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/addnewproduct",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({productName:b,description:_,groupTypes:p,sellingUnit:v,mrp:j,taxRate:U,date:Z,needsTailoring:c})});if(!Q.ok)throw new Error("Failed to save product");const G=await Q.json();console.log("Saved to backend:",G);const ye=await jS();t(jc(ye)),localStorage.setItem("itemData",JSON.stringify({data:ye,time:Date.now()})),alert("Product saved successfully!"),e("/masters/items")}catch(Q){console.error("Error saving product:",Q),alert("Failed to save product. Please try again.")}},Y=()=>{e(-1)};return s?f.jsxs("div",{className:"max-w-3xl mx-auto p-6 bg-white rounded-lg shadow-md",children:[f.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"Product Details"}),f.jsxs("form",{className:"space-y-4",onSubmit:F,children:[f.jsxs("div",{children:[f.jsxs("label",{className:"block font-medium",children:["Product Name ",f.jsx("span",{className:"text-red-500",children:"*"})]}),f.jsx("input",{type:"text",name:"productName",value:b,onChange:X=>N(X.target.value),placeholder:"Enter Product Name",className:"w-full p-2 border rounded-md",required:!0})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block font-medium",children:"Description"}),f.jsx("textarea",{name:"description",value:_,onChange:X=>E(X.target.value),placeholder:"Enter Description",className:"w-full p-2 border rounded-md"})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsxs("label",{className:"block font-medium",children:["Group Type ",f.jsx("span",{className:"text-red-500",children:"*"})]}),f.jsxs("select",{name:"groupType",value:p,onChange:R,className:"w-full p-2 border rounded-md",required:!0,children:[f.jsx("option",{value:"",children:"Select Group Type"}),r.map(([X,,Z])=>f.jsxs("option",{value:X,children:[X," ",Z!=null&&Z[0]?`(${Z[0]})`:""]},X))]})]}),f.jsxs("div",{children:[f.jsxs("label",{className:"block font-medium",children:["Selling Unit ",f.jsx("span",{className:"text-red-500",children:"*"})]}),f.jsxs("select",{name:"sellingUnit",value:v,onChange:X=>g(X.target.value),className:"w-full p-2 border rounded-md",required:!0,children:[f.jsx("option",{value:"",children:"Select Selling Unit"}),w.map(X=>f.jsx("option",{value:X,children:X},X))]})]})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block font-medium",children:"MRP"}),f.jsx("input",{type:"text",name:"mrp",value:j,onChange:X=>M(X.target.value),placeholder:"Enter MRP",className:"w-full p-2 border rounded-md"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block font-medium",children:"Tax Rate (%)"}),f.jsx("input",{type:"text",name:"taxRate",value:U,onChange:X=>V(X.target.value),placeholder:"Enter Tax Rate",className:"w-full p-2 border rounded-md"})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Needs Tailoring"}),f.jsx("div",{className:`w-12 h-6 flex items-center rounded-full p-1 cursor-pointer ${c?"bg-blue-500":"bg-gray-300"}`,onClick:()=>u(!c),children:f.jsx("div",{className:`w-5 h-5 bg-white rounded-full shadow-md transform ${c?"translate-x-6":"translate-x-0"} transition`})})]}),f.jsxs("div",{className:"flex gap-2 justify-end space-x-4",children:[f.jsx("button",{type:"button",onClick:Y,className:"px-4 py-2 border !rounded-lg",children:"Cancel"}),f.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white !rounded-lg",children:"Save"})]})]})]}):f.jsxs("div",{className:"p-6 text-center text-gray-700",children:[f.jsx("p",{children:"Form is closed."}),f.jsx("button",{onClick:()=>o(!0),className:"mt-4 px-4 py-2 bg-blue-500 text-white rounded",children:"Reopen Form"})]})};async function S$(){try{const e=await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/getallproductgroup",{credentials:"include"});if(!e.ok)throw new Error(`HTTP error! Status: ${e.status}`);const t=await e.json();return Array.isArray(t.body)?t.body:[]}catch(e){return console.error("Error fetching product groups:",e),[]}}const N$=()=>{const e=ua(),[t,r]=P.useState(""),[a,n]=P.useState(""),[s,o]=P.useState([]),[c,u]=P.useState(!1),h=wa(),p=ur(w=>w.data.items),x=P.useCallback(w=>{const b=Array.from(w.target.selectedOptions).map(N=>N.value).filter(N=>N&&!s.includes(N));o(N=>{const _=[...new Set([...N,...b])];return console.log("Updated addonProducts:",_),_})},[s]),v=async()=>{if(!t||!a){alert("Please fill in all required fields: Group Name and Main Product.");return}const w={group_name:t,main_product:a,addon_products:s.length>0?s:[],status:c};try{const b=await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/addproductgroup",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({groupName:w.group_name,mainProducts:w.main_product,addonProducts:JSON.stringify(w.addon_products),status:w.status})});if(!b.ok){const E=await b.text();throw new Error(`Failed to save product group. Status: ${b.status}, Message: ${E}`)}const N=await b.json();console.log("Saved Group:",N);const _=await S$();h(Cf(_)),localStorage.setItem("productGroupData",JSON.stringify({data:_,time:Date.now()})),alert("Product Group saved successfully!"),e("/masters/product-groups")}catch(b){console.error("Error saving product group:",{message:b.message,stack:b.stack}),b.message.includes("Failed to fetch")?alert("Failed to save product group: Unable to connect to the server (possible timeout or network issue). Please check your network connection and try again."):b.message.includes("Status: 400")?alert(`Failed to save product group: Invalid data submitted. The server requires all fields to be filled correctly. Error: ${b.message}. Please check the console for details.`):alert(`Failed to save product group: ${b.message}. Please check the console for details and try again.`)}},g=p.filter(w=>!s.includes(w[0])&&w[0]!==a);return f.jsxs("div",{className:"max-w-4xl mx-auto bg-white p-6 rounded-lg shadow-md",children:[f.jsx("h2",{className:"text-2xl font-semibold text-gray-800",children:"New Product Group"}),f.jsxs("p",{className:"text-gray-500 text-sm mb-6",children:[f.jsx(xi,{className:"text-black !no-underline",to:"/",children:"Dashboard"})," "," > ",f.jsx(xi,{className:"text-black !no-underline",to:"/masters/product-groups",children:"Product Groups"})," "," > ","New Product Group"]}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:["Group Name ",f.jsx("span",{className:"text-red-500",children:"*"})]}),f.jsx("input",{type:"text",value:t,onChange:w=>r(w.target.value),placeholder:"Enter Product Name",className:"mt-1 block w-full px-4 py-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",required:!0})]}),f.jsxs("div",{children:[f.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:["Main Product ",f.jsx("span",{className:"text-red-500",children:"*"})]}),f.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[f.jsx("button",{onClick:()=>e("/add-product"),className:"bg-blue-500 text-white px-3 py-1 rounded hover:bg-blue-600",children:"+ Product"}),f.jsxs("select",{value:a,onChange:w=>n(w.target.value),className:"w-full px-4 py-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",required:!0,children:[f.jsx("option",{value:"",disabled:!0,children:"Select Main Product"}),p.map((w,b)=>f.jsx("option",{value:w[0],children:w[0]},b))]})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Addon Products"}),f.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[f.jsx("button",{onClick:()=>e("/add-product"),className:"bg-blue-500 text-white px-3 py-1 rounded hover:bg-blue-600",children:"+ Product"}),f.jsxs("select",{multiple:!0,value:s,onChange:x,className:"w-full px-4 py-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500",size:5,children:[f.jsx("option",{value:"",disabled:!0,children:"Select Addon Product"}),g.map((w,b)=>f.jsx("option",{value:w[0],children:w[0]},b))]})]}),s.length>0&&f.jsxs("div",{className:"mt-2",children:[f.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Selected Addon Products:"}),f.jsx("ul",{className:"list-disc pl-5",children:s.map((w,b)=>f.jsxs("li",{className:"text-sm text-gray-600",children:[w,f.jsx("button",{className:"ml-2 text-red-500 hover:text-red-700",onClick:()=>{const N=s.filter(_=>_!==w);o(N),console.log("Removed product, new addonProducts:",N)},children:"Remove"})]},b))})]})]}),f.jsx("div",{className:"grid grid-cols-3 gap-4",children:f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Status"}),f.jsx("div",{className:`w-12 h-6 flex items-center rounded-full p-1 cursor-pointer ${c?"bg-blue-500":"bg-gray-300"}`,onClick:()=>u(!c),children:f.jsx("div",{className:`w-5 h-5 bg-white rounded-full shadow-md transform ${c?"translate-x-6":"translate-x-0"} transition`})})]})}),f.jsxs("div",{className:"flex justify-end gap-3 mt-4",children:[f.jsx("button",{onClick:()=>e("/masters/product-groups"),className:"border px-4 py-2 rounded text-gray-700 hover:bg-gray-100",children:"Cancel"}),f.jsx("button",{onClick:v,className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Add Group"})]})]})]})},A$=({customers:e,selectedCustomer:t,setSelectedCustomer:r,projectData:a,setCustomers:n})=>{const s=U=>{if(U.target.value==="")r(null);else{const V=JSON.parse(U.target.value);r(V),a[0]=U.target.value}};async function o(){try{const U=await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/getcustomerdata",{credentials:"include"});if(!U.ok)throw new Error(`HTTP error! Status: ${U.status}`);const V=await U.json();return Array.isArray(V.body)?V.body:[]}catch(U){return console.error("Error fetching customer data:",U),[]}}const[c,u]=P.useState(!1),[h,p]=P.useState(""),[x,v]=P.useState(""),[g,w]=P.useState(""),[b,N]=P.useState(""),[_,E]=P.useState(""),j=wa();ur(U=>U.data.customers);async function M(){const U=x;let V;if(V=new Date().toISOString().slice(0,16),(await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/sendcustomerdata",{method:"POST",headers:{"content-type":"application/json"},credentials:"include",body:JSON.stringify({name:h,phonenumber:U,email:_,address:g,alternatenumber:b,addedDate:V})})).status===200){const re=await o();j(Lc(re)),n(re),localStorage.setItem("customerData",JSON.stringify({data:re,time:Date.now()})),p(""),w(""),v(""),E(""),N(""),alert("Customer added successfully")}else alert("Error in adding customer");u(!1)}return f.jsxs("div",{className:"flex flex-col gap-3 px-3 py-3 rounded-xl shadow-xl w-full border-gray-200 border-2 mt-3",children:[f.jsx("p",{className:"font-semibold ",children:"Customer Details"}),f.jsxs("div",{className:"flex md:!flex-nowrap flex-wrap flex-row justify-between gap-2",children:[f.jsxs("div",{className:"flex  flex-col md:!w-1/2 w-full",children:[f.jsxs("div",{className:"flex  flex-row gap-3 px-2",children:[f.jsx("p",{className:"",children:"Select Customer"}),f.jsxs("button",{className:"mb-3 flex items-center px-2 py-1 border-1 border-blue-400 text-blue-500 font-semibold !rounded-xl hover:bg-blue-50 transition",onClick:()=>u(!0),children:[f.jsx("span",{className:"mr-2 flex justify-center w-6 h-6 border-2 border-blue-500 rounded-full text-lg leading-none text-blue-600",children:"+"})," Customer"]})]}),f.jsxs("select",{className:"border border-black p-2 rounded w-full opacity-50",value:t?JSON.stringify(t):"",onChange:s,children:[f.jsx("option",{value:"",className:"",children:"Select Customer"}),Array.isArray(e)&&e.map((U,V)=>f.jsx("option",{value:JSON.stringify(U),children:U[0]},V))]})]}),t&&f.jsxs("div",{className:"flex flex-col md:!w-1/2 w-full",children:[f.jsx("p",{className:"",children:"Email (optional)"}),f.jsx("input",{type:"text",className:"border p-2 rounded w-full",value:t[2],readOnly:!0})]})]}),t&&f.jsxs("div",{className:"flex md:!flex-nowrap flex-wrap flex-row justify-between gap-2",children:[f.jsxs("div",{className:"flex flex-col md:!w-1/2 w-full",children:[f.jsx("p",{className:"",children:"Phone Number"}),f.jsx("input",{type:"text",className:"border p-2 rounded w-full",value:t[1],readOnly:!0})]}),f.jsxs("div",{className:"flex flex-col md:!w-1/2 w-full",children:[f.jsx("p",{className:"",children:"Alternate Phone Number (optional)"}),f.jsx("input",{type:"text",className:"border p-2 rounded w-full",value:t[4],readOnly:!0})]})]}),c&&f.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center backdrop-blur-sm bg-black/50",children:f.jsxs("div",{className:"bg-transparent w-[300px] p-6 rounded-xl shadow-xl text-center",children:[f.jsx("div",{className:"fixed inset-0 flex items-center justify-center bg-transparent bg-opacity-30 z-50",children:f.jsxs("div",{className:"bg-white p-6 rounded shadow-md w-full max-w-md border",children:[f.jsx("h2",{className:"text-xl font-bold mb-4",children:"Add Customer"}),f.jsx("input",{className:" border p-2 rounded w-full mb-2",placeholder:"Name",value:h,onChange:U=>p(U.target.value)}),f.jsx("input",{className:"border p-2 rounded w-full mb-2",placeholder:"Email",value:_,onChange:U=>E(U.target.value)}),f.jsx("input",{className:"border p-2 rounded w-full mb-2",placeholder:"Mobile Number",value:x,onChange:U=>v(U.target.value)}),f.jsx("input",{className:"border p-2 rounded w-full mb-2",placeholder:"Address",value:g,onChange:U=>w(U.target.value)}),f.jsx("input",{className:"border p-2 rounded w-full mb-2",placeholder:"Alternate Number",value:b,onChange:U=>N(U.target.value)}),f.jsxs("div",{className:"flex justify-end gap-2",children:[f.jsx("button",{className:"bg-gray-500 text-white px-4 py-2 rounded",onClick:()=>{u(!1)},children:"Cancel"}),f.jsx("button",{className:"bg-blue-500 text-white px-4 py-2 rounded",onClick:M,children:"Save"})]})]})}),f.jsxs("div",{className:"w-full flex flex-row justify-between",children:[f.jsx("button",{style:{borderRadius:"6px"},className:"px-2 py-1 text-white bg-sky-600 hover:bg-sky-700",children:"Add"}),f.jsx("button",{onClick:()=>u(!1),className:"px-3 py-1 bg-red-500 text-white rounded hover:bg-red-600",children:"Close"})]})]})})]})},_$=({selectedCustomer:e,interior:t=[],salesdata:r=[],interiorArray:a="",setInteriorArray:n,salesAssociateArray:s="",setSalesAssociateArray:o,projectName:c,setProjectName:u,projectReference:h,setProjectReference:p,user:x,setUser:v,projectDate:g,setProjectDate:w,setAdditionalRequests:b,additionalRequests:N,projectAddress:_,setProjectAddress:E,setSalesData:j,setInterior:M})=>{console.log("Props received:",{salesdata:r,interior:t,salesAssociateArray:s,interiorArray:a});async function U(){try{const J=await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/getinteriordata",{credentials:"include"});if(!J.ok)throw new Error(`HTTP error! Status: ${J.status}`);const Pe=await J.json();return Array.isArray(Pe.body)?Pe.body:[]}catch(J){return console.error("Error fetching interiors:",J),[]}}const[V,I]=P.useState(!1),z=wa(),[H,re]=P.useState(""),[R,F]=P.useState(""),[Y,K]=P.useState(""),[X,Z]=P.useState(""),ce=async()=>{if((await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/sendinteriordata",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({name:H,email:R,phonenumber:Y,address:X})})).status===200){const st=await U();z(Lf(st)),M(st),localStorage.setItem("interiorData",JSON.stringify({data:st,time:Date.now()})),I(!1),re(""),F(""),K(""),Z(""),alert("Interior added successfully")}else alert("Error saving interior")},[te,Q]=P.useState(!1);async function G(){try{const J=await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/getsalesassociatedata",{credentials:"include"});if(!J.ok)throw new Error(`HTTP error! Status: ${J.status}`);const Pe=await J.json();return Array.isArray(Pe.body)?Pe.body:[]}catch(J){return console.error("Error fetching sales associates:",J),[]}}const[ye,D]=P.useState(""),[O,L]=P.useState(""),[q,oe]=P.useState(""),[be,ve]=P.useState(""),ue=async()=>{if((await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/sendsalesassociatedata",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({name:ye,email:O,phonenumber:q,address:be})})).status===200){const st=await G();z(Vf(st)),j(st),localStorage.setItem("salesAssociateData",JSON.stringify({data:st,time:Date.now()})),Q(!1),D(""),L(""),oe(""),ve(""),alert("Sales Associate added successfully")}else alert("Error saving sales associate")},fe=J=>{const Pe=J.target.value;console.log("Selected Sales Associate:",Pe),console.log("Previous salesAssociateArray:",s),o(Pe),console.log("New salesAssociateArray:",Pe)},Ee=J=>{const Pe=J.target.value;console.log("Selected Interior:",Pe),console.log("Previous interiorArray:",a),n(Pe),console.log("New interiorArray:",Pe)};return P.useEffect(()=>{console.log("salesAssociateArray updated:",s)},[s]),P.useEffect(()=>{console.log("interiorArray updated:",a)},[a]),f.jsxs("div",{className:"flex flex-col gap-3 w-full rounded-xl shadow-2xl border-2 border-gray-200 px-3 py-3",children:[f.jsx("p",{className:"text-[1.4vw] font-semibold",children:"Project Details"}),f.jsxs("div",{className:"flex flex-row w-full gap-2",children:[f.jsxs("div",{className:"flex flex-col w-1/2",children:[f.jsx("p",{children:"Project Name (type a unique name)"}),f.jsx("input",{type:"text",className:"border p-2 rounded w-full",value:c||"",onChange:J=>u(J.target.value),placeholder:"Project Name"})]}),f.jsxs("div",{className:"flex flex-col w-1/2",children:[f.jsx("p",{children:"Reference (optional)"}),f.jsx("input",{type:"text",className:"border p-2 rounded w-full",value:h||"",onChange:J=>p(J.target.value),placeholder:"Reference"})]})]}),e&&f.jsx("div",{className:"flex flex-row w-full gap-2",children:f.jsxs("div",{className:"flex flex-col w-full",children:[f.jsx("p",{children:"Address"}),f.jsx("input",{type:"text",className:"border p-2 rounded w-full",value:_||"",onChange:J=>E(J.target.value),placeholder:"Address"})]})}),e&&f.jsx("div",{className:"flex flex-row w-full gap-2",children:f.jsxs("div",{className:"flex flex-col w-full",children:[f.jsx("p",{children:"Any Additional Requests (optional)"}),f.jsx("input",{placeholder:"Additional Requests",type:"text",value:N||"",onChange:J=>b(J.target.value),className:"border p-2 rounded w-full"})]})}),f.jsxs("div",{className:"flex flex-row w-full gap-2",children:[f.jsxs("div",{className:"flex flex-col w-1/2",children:[f.jsxs("div",{className:"flex flex-row gap-3 px-2",children:[f.jsx("p",{children:"Select Interior"}),f.jsxs("button",{className:"mb-3 flex items-center px-2 py-1 border-1 border-blue-400 text-blue-500 font-semibold !rounded-xl hover:bg-blue-50 transition",onClick:()=>I(!0),children:[f.jsx("span",{className:"mr-2 flex justify-center w-6 h-6 border-2 border-blue-500 rounded-full text-lg leading-none text-blue-600",children:"+"})," Interior"]})]}),f.jsxs("select",{className:"border border-black p-2 rounded w-full",value:a,onChange:Ee,children:[f.jsx("option",{value:"",children:"Select Interior Name (optional)"}),Array.isArray(t)&&t.map((J,Pe)=>{const st=J.name||J[0]||"";return f.jsx("option",{value:st,children:st||"Unknown"},Pe)})]})]}),f.jsxs("div",{className:"flex flex-col w-1/2",children:[f.jsxs("div",{className:"flex flex-row gap-3 px-2",children:[f.jsx("p",{children:"Select Sales Associate"}),f.jsxs("button",{onClick:()=>Q(!0),className:"mb-3 flex items-center px-2 py-1 border-1 border-blue-400 text-blue-500 font-semibold !rounded-xl hover:bg-blue-50 transition",children:[f.jsx("span",{className:"mr-2 flex justify-center w-6 h-6 border-2 border-blue-500 rounded-full text-lg leading-none text-blue-600",children:"+"}),"Sales Associate"]})]}),f.jsxs("select",{className:"border border-black p-2 rounded w-full",value:s,onChange:fe,children:[f.jsx("option",{value:"",children:"Select Sales Associate (optional)"}),Array.isArray(r)&&r.map((J,Pe)=>{const st=J.name||J[0]||"";return f.jsx("option",{value:st,children:st||"Unknown"},Pe)})]})]})]}),f.jsxs("div",{className:"flex flex-row w-full gap-2",children:[f.jsxs("div",{className:"flex flex-col w-1/2",children:[f.jsx("p",{children:"Select User"}),f.jsx("input",{type:"text",className:"border p-2 rounded w-full",value:x||"",onChange:J=>v(J.target.value),placeholder:"User Name"})]}),f.jsxs("div",{className:"flex flex-col w-1/2",children:[f.jsx("p",{children:"Project Deadline"}),f.jsx("input",{type:"date",className:"border p-2 rounded w-full",value:g||"",onChange:J=>w(J.target.value)})]})]}),V&&f.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center backdrop-blur-sm bg-black/50",children:f.jsxs("div",{className:"bg-white p-6 rounded shadow-md w-[500px] border",children:[f.jsx("h2",{className:"text-xl font-bold mb-4",children:"Add Interior"}),f.jsx("input",{className:"border p-2 rounded w-full mb-2",placeholder:"Name",value:H,onChange:J=>re(J.target.value)}),f.jsx("input",{className:"border p-2 rounded w-full mb-2",placeholder:"Email",value:R,onChange:J=>F(J.target.value)}),f.jsx("input",{className:"border p-2 rounded w-full mb-2",placeholder:"Phone Number",value:Y,onChange:J=>K(J.target.value)}),f.jsx("input",{className:"border p-2 rounded w-full mb-2",placeholder:"Address",value:X,onChange:J=>Z(J.target.value)}),f.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[f.jsx("button",{className:"bg-gray-500 text-white px-4 py-2 rounded",onClick:()=>{re(""),F(""),K(""),Z(""),I(!1)},children:"Cancel"}),f.jsx("button",{className:"bg-blue-500 text-white px-4 py-2 rounded",onClick:ce,children:"Save"})]})]})}),te&&f.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center backdrop-blur-sm bg-black/50",children:f.jsxs("div",{className:"bg-white p-6 rounded shadow-md w-[500px] border",children:[f.jsx("h2",{className:"text-xl font-bold mb-4",children:"Add Sales Associate"}),f.jsx("input",{className:"border p-2 rounded w-full mb-2",placeholder:"Name",value:ye,onChange:J=>D(J.target.value)}),f.jsx("input",{className:"border p-2 rounded w-full mb-2",placeholder:"Email",value:O,onChange:J=>L(J.target.value)}),f.jsx("input",{className:"border p-2 rounded w-full mb-2",placeholder:"Phone Number",value:q,onChange:J=>oe(J.target.value)}),f.jsx("input",{className:"border p-2 rounded w-full mb-2",placeholder:"Address",value:be,onChange:J=>ve(J.target.value)}),f.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[f.jsx("button",{className:"bg-gray-500 text-white px-4 py-2 rounded",onClick:()=>{D(""),L(""),oe(""),ve(""),Q(!1)},children:"Cancel"}),f.jsx("button",{className:"bg-blue-500 text-white px-4 py-2 rounded",onClick:ue,children:"Save"})]})]})})]})};class T$ extends Pu.Component{constructor(){super(...arguments);zw(this,"state",{hasError:!1,error:null})}static getDerivedStateFromError(r){return{hasError:!0,error:r}}render(){var r;return this.state.hasError?f.jsxs("div",{className:"p-4 text-red-500",children:[f.jsx("h2",{children:"Something went wrong in Project Details."}),f.jsx("p",{children:(r=this.state.error)==null?void 0:r.toString()}),f.jsx("button",{className:"mt-2 bg-blue-500 text-white px-4 py-2 rounded",onClick:()=>this.setState({hasError:!1,error:null}),children:"Try Again"})]}):this.props.children}}const k$=e=>f.jsx(T$,{children:f.jsx(_$,{...e})});function E$(){const e=wa();ur(ie=>ie.data.customers),ur(ie=>ie.data.interiors),ur(ie=>ie.data.salesAssociates),ur(ie=>ie.data.products);const t=ur(ie=>ie.data.items);let r=[];const[a,n]=P.useState(0),[s,o]=P.useState([]),[c,u]=P.useState(null),[h,p]=P.useState([]),[x,v]=P.useState([]),[g,w]=P.useState([]),[b,N]=P.useState([]),[_,E]=P.useState([]),j=ur(ie=>ie.data.catalogs);let M=["D Decor","Asian Paints","ZAMAN"];const U=["514","98","123"],[V,I]=P.useState(0),[z,H]=P.useState(0),[re,R]=P.useState(0),[F,Y]=P.useState(0),[K,X]=P.useState([]),[Z,ce]=P.useState(null),te=ur(ie=>ie.data.projects),[Q,G]=P.useState([]),[ye,D]=P.useState([]),[O,L]=P.useState([]),[q,oe]=P.useState([]),be=async()=>(await(await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/getsingleproducts")).json()).body,ve=async()=>{try{const ie=await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/getcustomerdata",{credentials:"include"});if(!ie.ok)throw new Error(`HTTP error! Status: ${ie.status}`);const Ce=await ie.json();return Array.isArray(Ce.body)?Ce.body:[]}catch(ie){return console.error("Error fetching customer data:",ie),[]}};async function ue(){try{const ie=await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/getcatalogues",{credentials:"include"});if(!ie.ok)throw new Error(`HTTP error! Status: ${ie.status}`);const Ce=await ie.json();return Array.isArray(Ce.body)?Ce.body:[]}catch(ie){return console.error("Error fetching catalogues:",ie),[]}}async function fe(){try{const ie=await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/getinteriordata",{credentials:"include"});if(!ie.ok)throw new Error(`HTTP error! Status: ${ie.status}`);return(await ie.json()).body}catch(ie){return console.error("Error fetching interiors:",ie),[]}}async function Ee(){try{const ie=await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/getsalesassociatedata",{credentials:"include"});if(!ie.ok)throw new Error(`HTTP error! Status: ${ie.status}`);const Ce=await ie.json();return Array.isArray(Ce.body)?Ce.body:[]}catch(ie){return console.error("Error fetching sales associates:",ie),[]}}async function J(){try{const ie=await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/getallproductgroup",{credentials:"include"});if(!ie.ok)throw new Error(`HTTP error! Status: ${ie.status}`);const Ce=await ie.json();return Array.isArray(Ce.body)?Ce.body:[]}catch(ie){return console.error("Error fetching product groups:",ie),[]}}const Pe=()=>{L([...O,{area:"",areacollection:[]}])},st=ie=>{const Ce=O.filter((Oe,Ve)=>Ve!==ie);L(Ce)},ke=(ie,Ce)=>{const Oe=[...O];Oe[ie]&&(Oe[ie].area=Ce),L(Oe)},de=(ie,Ce,Oe)=>{const Ve=[...O];Ve[ie].areacollection||(Ve[ie].areacollection=[]),Ve[ie].areacollection[Ce]||(Ve[ie].areacollection[Ce]={productGroup:null,items:[],catalogue:[],company:null,designNo:null,reference:null,measurement:{unit:"Centimeter (cm)",width:void 0,height:void 0,quantity:void 0},totalAmount:[],totalTax:[],quantities:[]});const kt=Oe.split(",");Ve[ie].areacollection[Ce].productGroup=kt;const Ht=kt;if(!Array.isArray(Ht)||Ht.length<2)return;let Ft=Ht.length>2?Ht.slice(1,-1):null,ir=null;Ft!=null?ir=Ft.map(rr=>t.find(Ur=>Ur[0]===rr)).filter(rr=>Array.isArray(rr)):ir=[Oe],ir.length==0&&(ir=[Oe.split(",")]),Ve[ie].areacollection[Ce].items=ir,L(Ve);const Gt=Q.filter(rr=>!(rr.mainindex===ie&&rr.groupIndex===Ce)),yr=ir.map(rr=>({mainindex:ie,groupIndex:Ce,pg:kt,date:"",status:"Pending",orderID:"",remark:"NA",item:rr}));G([...Gt,...yr]);const Pr=ye.filter(rr=>!(rr.mainindex===ie&&rr.groupIndex===Ce)),er=ir.filter(rr=>rr[7]==!0).map((rr,Ur)=>({mainindex:ie,groupIndex:Ce,pg:kt,rate:0,tailorData:[""],status:"Pending",remark:"NA",item:rr}));D([...Pr,...er])},rt=(ie,Ce,Oe)=>{const Ve=[...O];Ve[ie].areacollection||(Ve[ie].areacollection=[]),Ve[ie].areacollection[Ce]||(Ve[ie].areacollection[Ce]={productGroup:null,items:[""],catalogue:[],company:null,designNo:null,reference:null,measurement:{unit:"Centimeter (cm)",width:void 0,height:void 0,quantity:void 0},totalAmount:[],totalTax:[],quantities:[]}),Ve[ie].areacollection[Ce].catalogue=Oe,L(Ve)},Ue=(ie,Ce,Oe)=>{const Ve=[...O];Ve[ie].areacollection||(Ve[ie].areacollection=[]),Ve[ie].areacollection[Ce]||(Ve[ie].areacollection[Ce]={productGroup:null,items:[""],catalogue:[],company:null,designNo:null,reference:null,measurement:{unit:"Centimeter (cm)",width:void 0,height:void 0,quantity:void 0},totalAmount:[],totalTax:[],quantities:[]}),Ve[ie].areacollection[Ce].company=Oe,L(Ve)},Xe=(ie,Ce,Oe)=>{const Ve=[...O];Ve[ie].areacollection||(Ve[ie].areacollection=[]),Ve[ie].areacollection[Ce]||(Ve[ie].areacollection[Ce]={productGroup:null,items:[""],catalogue:[],company:null,designNo:null,reference:null,measurement:{unit:"Centimeter (cm)",width:void 0,height:void 0,quantity:void 0},totalAmount:[],totalTax:[],quantities:[]}),Ve[ie].areacollection[Ce].designNo=Oe,L(Ve)},ot=(ie,Ce,Oe)=>{const Ve=[...O];Ve[ie].areacollection||(Ve[ie].areacollection=[]),Ve[ie].areacollection[Ce]||(Ve[ie].areacollection[Ce]={productGroup:null,items:[""],catalogue:[],company:null,designNo:null,reference:null,measurement:{unit:"Centimeter (cm)",width:void 0,height:void 0,quantity:void 0},totalAmount:[],totalTax:[],quantities:[]}),Ve[ie].areacollection[Ce].reference=Oe,L(Ve)},ut=(ie,Ce="")=>{var yr;const Oe=[...O];(yr=Oe[ie])!=null&&yr.areacollection||(Oe[ie].areacollection=[]);const Ve=Oe[ie].areacollection.length,kt=Ce?Ce.split(","):[],Ft=(kt.length>2?kt.slice(1,-2):[]).map(Pr=>t.find(er=>er[0]===Pr)).filter(Pr=>Array.isArray(Pr));Oe[ie].areacollection.push({productGroup:kt,company:"",catalogue:[],designNo:"",reference:"",measurement:{unit:"Centimeter (cm)",width:void 0,height:void 0,quantity:void 0},items:Ft,additionalItems:[],totalAmount:[],totalTax:[]}),L(Oe);const ir=Ft.map(Pr=>({mainindex:ie,groupIndex:Ve,pg:kt,date:"",status:"Pending",orderID:"",remark:"NA",item:Pr})),Gt=Ft.filter(Pr=>Pr[7]==!0).map(Pr=>({mainindex:ie,groupIndex:Ve,pg:kt,rate:0,tailorData:[""],status:"Pending",remark:"NA",item:Pr}));G(Pr=>[...Pr,...ir]),D(Pr=>[...Pr,...Gt])},vt=(ie,Ce)=>{const Oe=[...O];Oe[ie].areacollection[Ce]&&Oe[ie].areacollection.splice(Ce,1),L(Oe)},At=["Inches (in)","Centimeter (cm)","Meters (m)","Feet (ft)"],ct=(ie,Ce,Oe)=>{const Ve=[...O];Ve[ie].areacollection[Ce].measurement.width=Oe,L(Ve)},ze=(ie,Ce,Oe)=>{const Ve=[...O];Ve[ie].areacollection[Ce].measurement.height=Oe,L(Ve)},pt=(ie,Ce)=>{const Oe=ie.flatMap(Gt=>Gt.areacollection.flatMap(yr=>yr.totalTax||[])),Ve=ie.flatMap(Gt=>Gt.areacollection.flatMap(yr=>yr.totalAmount||[])),kt=Ce.map(Gt=>parseFloat(Gt.taxAmount.toString())||0),Ht=Ce.map(Gt=>parseFloat(Gt.totalAmount.toString())||0),Ft=parseFloat([...Oe,...kt].reduce((Gt,yr)=>Gt+yr,0).toFixed(2)),ir=parseFloat([...Ve,...Ht].reduce((Gt,yr)=>Gt+yr,0).toFixed(2));return{totalTax:Ft,totalAmount:ir}},Ot=(ie,Ce,Oe)=>{const Ve=[...O],kt=Ve[ie].areacollection[Ce];if(kt.measurement.quantity=Oe,kt.items!==void 0){kt.totalTax||(kt.totalTax=[]),kt.totalAmount||(kt.totalAmount=[]);const ir=kt.items.map((Gt,yr)=>{var ei;const Pr=parseFloat((ei=Ve[ie].areacollection[Ce].quantities)==null?void 0:ei[yr])||0,er=parseFloat(Gt[4])||0,rr=parseFloat(Gt[5])||0,Ur=parseFloat(Oe)*Pr*er,ja=parseFloat((Ur*(rr/100)).toFixed(2)),zn=parseFloat((Ur+ja).toFixed(2));return kt.totalTax[yr]=ja,kt.totalAmount[yr]=zn,[...Gt.slice(0,5),ja,zn]});kt.items=ir}L(Ve);const{totalTax:Ht,totalAmount:Ft}=pt(Ve,K);H(Ht),I(Ft)},It=(ie,Ce,Oe)=>{const Ve=[...O];Ve[ie].areacollection[Ce].measurement.unit=Oe,L(Ve)},[Lt,Ct]=P.useState({}),wt=async(ie,Ce,Oe,Ve,kt,Ht,Ft,ir)=>{const Gt=[...O];Gt[Oe].areacollection[Ve].quantities||(Gt[Oe].areacollection[Ve].quantities=[]),Gt[Oe].areacollection[Ve].quantities[ir]=Ce;const yr=Ht*parseFloat(kt)*parseFloat(Ce),Pr=yr*(Ft/100),er=yr+Pr;Gt[Oe].areacollection[Ve].totalTax||(Gt[Oe].areacollection[Ve].totalTax=[]),Gt[Oe].areacollection[Ve].totalAmount||(Gt[Oe].areacollection[Ve].totalAmount=[]),Gt[Oe].areacollection[Ve].totalTax[ir]=parseFloat(Pr.toFixed(2)),Gt[Oe].areacollection[Ve].totalAmount[ir]=parseFloat(er.toFixed(2)),L(Gt);const{totalTax:rr,totalAmount:Ur}=pt(Gt,K);H(rr),I(Ur)},hr=()=>{X(ie=>[...ie,{name:"",quantity:0,rate:0,netRate:0,tax:0,taxAmount:0,totalAmount:0,remark:""}])},zt=ie=>{const Ce=[...K];Ce.splice(ie,1),X(Ce);const{totalTax:Oe,totalAmount:Ve}=pt(O,Ce);H(Oe),I(Ve)},Yt=(ie,Ce)=>{const Oe=[...K];Oe[ie].name=Ce,X(Oe)},Sr=(ie,Ce)=>{const Oe=[...K];Oe[ie].quantity=parseFloat(Ce)||0,Oe[ie].netRate=parseFloat((Oe[ie].quantity*Oe[ie].rate).toFixed(2)),Oe[ie].taxAmount=parseFloat((Oe[ie].netRate*(Oe[ie].tax/100)).toFixed(2)),Oe[ie].totalAmount=parseFloat((Oe[ie].netRate+Oe[ie].taxAmount).toFixed(2)),X(Oe);const{totalTax:Ve,totalAmount:kt}=pt(O,Oe);H(Ve),I(kt)},[Mr,fa]=P.useState(0),[Ir,gi]=P.useState(0),na=(ie,Ce)=>{const Oe=[...K];Oe[ie].rate=parseFloat(Ce)||0,Oe[ie].netRate=parseFloat((Oe[ie].quantity*Oe[ie].rate).toFixed(2)),Oe[ie].taxAmount=parseFloat((Oe[ie].netRate*(Oe[ie].tax/100)).toFixed(2)),Oe[ie].totalAmount=parseFloat((Oe[ie].netRate+Oe[ie].taxAmount).toFixed(2)),X(Oe);const{totalTax:Ve,totalAmount:kt}=pt(O,Oe);H(Ve),I(kt)},Ja=(ie,Ce)=>{const Oe=[...K];Oe[ie].tax=parseFloat(Ce)||0,Oe[ie].netRate=parseFloat((Oe[ie].quantity*Oe[ie].rate).toFixed(2)),Oe[ie].taxAmount=parseFloat((Oe[ie].netRate*(Oe[ie].tax/100)).toFixed(2)),Oe[ie].totalAmount=parseFloat((Oe[ie].netRate+Oe[ie].taxAmount).toFixed(2)),X(Oe);const{totalTax:Ve,totalAmount:kt}=pt(O,Oe);H(Ve),I(kt)},[Dn,Br]=P.useState("approved"),[sr,kr]=P.useState([]),[As,ka]=P.useState([]),[Ea,gn]=P.useState(""),[Qt,Un]=P.useState(""),[Vr,qa]=P.useState(""),[qr,ha]=P.useState(""),[ne,Ne]=P.useState(""),[pe,ge]=P.useState(""),Se=(ie,Ce)=>{const Oe=[...K];Oe[ie].remark=Ce,X(Oe)},[_e,Ye]=P.useState(null),[lt,We]=P.useState(null),$e=async()=>{const ie=await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/getprojectdata",{credentials:"include"});if(!ie.ok)throw new Error(`HTTP error! Status: ${ie.status}`);const Ce=await ie.json();if(!Ce.body||!Array.isArray(Ce.body))throw new Error("Invalid data format: Expected an array in data.body");const Oe=(Ft,ir)=>{try{return typeof Ft=="string"?JSON.parse(Ft):Ft||ir}catch(Gt){return console.warn("Invalid JSON:",Ft,Gt),ir}},Ve=Ft=>JSON.parse(JSON.stringify(Ft)),kt=Ft=>{if(Array.isArray(Ft))return Ft;if(typeof Ft!="string")return[];try{const ir=JSON.parse(Ft);return Array.isArray(ir)?ir:[]}catch{try{return Ft.replace(/^\[|\]$/g,"").split(",").map(Gt=>Gt.trim().replace(/^"+|"+$/g,""))}catch{return[]}}};return Ce.body.map(Ft=>({projectName:Ft[0],customerLink:Oe(Ft[1],[]),projectReference:Ft[2]||"",status:Ft[3]||"",totalAmount:parseFloat(Ft[4])||0,totalTax:parseFloat(Ft[5])||0,paid:parseFloat(Ft[6])||0,discount:parseFloat(Ft[7])||0,createdBy:Ft[8]||"",allData:Ve(Oe(Ft[9],[])),projectDate:Ft[10]||"",additionalRequests:Oe(Ft[11],[]),interiorArray:kt(Ft[12]),salesAssociateArray:kt(Ft[13]),additionalItems:Ve(Oe(Ft[14],[])),goodsArray:Ve(Oe(Ft[15],[])),tailorsArray:Ve(Oe(Ft[16],[])),projectAddress:Ft[17],date:Ft[18],grandTotal:Ft[19]}))},Qe=async()=>{try{let ie=te;if((!ie||ie.length===0)&&(ie=await $e(),e(La(ie))),ie.some(kt=>{var Ht;return((Ht=kt.projectName)==null?void 0:Ht.toLowerCase().trim())===(Ea==null?void 0:Ea.toLowerCase().trim())})){alert(`Project "${Ea}" already exists.`);return}const Oe=Date.now(),Ve=await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/sendprojectdata",{method:"POST",credentials:"include",headers:{"content-type":"application/json"},body:JSON.stringify({projectName:Ea,customerLink:JSON.stringify(c),projectReference:Qt,status:Dn,totalAmount:V,totalTax:z,paid:re,discount:F,createdBy:Vr,allData:JSON.stringify(O),projectDate:qr,additionalRequests:ne,interiorArray:JSON.stringify(sr),salesAssociateArray:JSON.stringify(As),additionalItems:JSON.stringify(K),goodsArray:JSON.stringify(Q),tailorsArray:JSON.stringify(ye),projectAddress:JSON.stringify(Z),date:Oe,grandTotal})});if(Ve.status===200){alert("Project Added");const kt=await $e();e(La(kt)),localStorage.setItem("projectData",JSON.stringify({data:kt,time:Date.now()}))}else{const kt=await Ve.text();console.error("Error response:",kt),alert("Error: Failed to add project")}}catch(ie){console.error("Fetch error:",ie),alert("Error: Network issue or server not responding")}};P.useEffect(()=>{const ie=async(Oe,Ve,kt,Ht)=>{try{let ir=!0;const Gt=localStorage.getItem(kt);if(Gt){const{data:yr,time:Pr}=JSON.parse(Gt);Date.now()-Pr<36e5?(e(Ve(yr)),Ht==null||Ht(yr),ir=!1):localStorage.removeItem(kt)}if(ir){const yr=await Oe();e(Ve(yr)),Ht==null||Ht(yr),localStorage.setItem(kt,JSON.stringify({data:yr,time:Date.now()}))}}catch(Ft){console.error(`Error fetching ${kt}:`,Ft)}};(async()=>{await Promise.all([ie(fe,Lf,"interiorData",w),ie(be,jc,"itemsData",p),ie(Ee,Vf,"salesAssociateData",N),ie(J,Cf,"productsData",E),ie(ue,Fv,"catalogueData"),ie(ve,Lc,"customerData",o)])})()},[e]),P.useEffect(()=>{async function ie(){try{const Ce=localStorage.getItem("areasData"),Oe=3600*1e3;if(Ce){const{data:Ht,time:Ft}=JSON.parse(Ce);if(Date.now()-Ft<Oe){oe(Ht);return}else localStorage.removeItem("areasData")}const kt=await(await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/getAreas")).json();oe(kt.body),localStorage.setItem("areasData",JSON.stringify({data:kt.body,time:Date.now()}))}catch(Ce){console.error("Error fetching areas:",Ce)}}q.length===0&&ie()},[]);const St=["123213","!23123213","123132"],jt=["sadsdsad","Adasdad"],Ut=()=>{const ie=new dr,Ce=ie.internal.pageSize.getWidth(),Oe=ie.internal.pageSize.getHeight();let Ve=20;ie.setFont("helvetica","normal");const kt=[0,51,102],Ht=[33,33,33],Ft=[0,102,204],ir=[245,245,245];ie.setFillColor(...kt),ie.rect(0,0,Ce,30,"F"),ie.setFillColor(...Ft),ie.rect(0,30,Ce,1,"F"),ie.setFontSize(20),ie.setTextColor(255,255,255),ie.setFont("helvetica","bold"),ie.text("Quotation",Ce/2,18,{align:"center"}),Ve+=15,ie.setFontSize(10),ie.setTextColor(...Ht),ie.setFont("helvetica","normal"),ie.text("Sheela Decor",15,Ve),Ve+=5,ie.text("123 Business Street, City, Country",15,Ve),Ve+=5,ie.text("Email: contact@sheeladecor.com | Phone: +123 456 7890",15,Ve),Ve+=8,ie.setDrawColor(...Ft),ie.setLineWidth(.4),ie.line(15,Ve,Ce-15,Ve),Ve+=8,ie.setFillColor(...ir),ie.roundedRect(15,Ve,Ce-30,25,2,2,"F"),ie.setFontSize(10),ie.setFont("helvetica","bold"),ie.setTextColor(...kt),ie.text("Project Details",20,Ve+6),ie.text("Customer Details",Ce/2+5,Ve+6),Ve+=12,ie.setFont("helvetica","normal"),ie.setTextColor(...Ht),ie.text(`Project Name: ${Ea||"N/A"}`,20,Ve),ie.text(`Customer: ${(c==null?void 0:c.name)||"N/A"}`,Ce/2+5,Ve),Ve+=5,ie.text(`Address: ${Z||"N/A"}`,Ce/2+5,Ve),Ve+=5,ie.text(`Date: ${qr||new Date().toLocaleDateString()}`,20,Ve),Ve+=10;const Gt=[];let yr=1;O.forEach((er,rr)=>{er.areacollection&&er.areacollection.length>0&&(Gt.push([{content:er.area,colSpan:9,styles:{fontStyle:"bold",fontSize:9,fillColor:Ft,textColor:[255,255,255]}}]),er.areacollection.forEach((Ur,ja)=>{const zn=Ur.productGroup;if(!Array.isArray(zn)||zn.length<2)return;(zn.length>2?zn.slice(1,-2):null).map(Aa=>t.find(ca=>ca[0]===Aa)||null).filter(Aa=>Array.isArray(Aa)).forEach((Aa,da)=>{var vi,fs,ao,Zn,Qn;const ca=parseFloat((vi=Ur.quantities)==null?void 0:vi[da])||0,Kn=Aa[0]?`${Aa[0]} * ${Ur.measurement.quantity||0}`:"N/A",ri=(fs=Ur.measurement)!=null&&fs.width&&((ao=Ur.measurement)!=null&&ao.height)?`${Ur.measurement.width} x ${Ur.measurement.height} ${Ur.measurement.unit||""}`:"N/A",_s=parseFloat(Aa[4])*parseFloat(Ur.measurement.quantity||"0")||0,Ts=_s*ca||0,ai=parseFloat(Aa[5])||0,xl=parseFloat((Zn=Ur.totalTax[da])==null?void 0:Zn.toString())||0,ks=parseFloat((Qn=Ur.totalAmount[da])==null?void 0:Qn.toString())||0;Gt.push([yr++,Kn,ri,`INR ${_s.toFixed(2)}`,ca.toString(),`INR ${Ts.toFixed(2)}`,`${ai.toFixed(2)}%`,`INR ${xl.toFixed(2)}`,`INR ${ks.toFixed(2)}`])})}))}),K.length>0&&(Gt.push([{content:"Miscellaneous Items",colSpan:9,styles:{fontStyle:"bold",fillColor:Ft,textColor:[255,255,255],fontSize:9}}]),K.forEach(er=>{var Ka,Aa,da,ca,Kn,ri;const rr=parseFloat((Ka=er.quantity)==null?void 0:Ka.toString())||0,Ur=parseFloat((Aa=er.rate)==null?void 0:Aa.toString())||0,ja=parseFloat((da=er.netRate)==null?void 0:da.toString())||0,zn=parseFloat((ca=er.tax)==null?void 0:ca.toString())||0,ei=parseFloat((Kn=er.taxAmount)==null?void 0:Kn.toString())||0,ti=parseFloat((ri=er.totalAmount)==null?void 0:ri.toString())||0;Gt.push([yr++,er.name||"N/A","N/A",`INR ${Ur.toFixed(2)}`,rr.toString(),`INR ${ja.toFixed(2)}`,`${zn.toFixed(2)}%`,`INR ${ei.toFixed(2)}`,`INR ${ti.toFixed(2)}`])})),vy(ie,{startY:Ve,head:[["Sr. No.","Product Name","Size","MRP","Qty","Subtotal","Tax Rate","Tax Amount","Total"]],body:Gt,theme:"grid",styles:{font:"helvetica",fontSize:6.5,cellPadding:1.5,textColor:Ht,lineColor:[200,200,200],lineWidth:.1,overflow:"linebreak",minCellHeight:0},headStyles:{fillColor:kt,textColor:[255,255,255],fontStyle:"bold",fontSize:7,halign:"center",cellPadding:1.5},alternateRowStyles:{fillColor:ir},columnStyles:{0:{cellWidth:7,halign:"center"},1:{cellWidth:35,overflow:"linebreak"},2:{cellWidth:20,overflow:"linebreak"},3:{cellWidth:15,halign:"right"},4:{cellWidth:8,halign:"center"},5:{cellWidth:15,halign:"right"},6:{cellWidth:10,halign:"center"},7:{cellWidth:15,halign:"right"},8:{cellWidth:15,halign:"right"}},margin:{top:Ve,left:15,right:15,bottom:50},pageBreak:"auto",rowPageBreak:"avoid",didDrawPage:er=>{Ve=er.cursor.y+10,ie.setFontSize(8),ie.setTextColor(100,100,100),ie.text(`Page ${er.pageNumber}`,Ce-15,Oe-10,{align:"right"})},willDrawCell:er=>{if(er.section==="body"&&(er.column.index===1||er.column.index===2)){const rr=er.cell.text.join(" ");rr.length>25&&(er.cell.text=ie.splitTextToSize(rr,er.cell.width-3))}},didParseCell:er=>{er.section==="body"&&[3,5,7,8].includes(er.column.index)&&(er.cell.text=er.cell.text.map(rr=>rr.replace(/^1\s*/,"")))}}),Ve=ie.lastAutoTable.finalY+10,Ve+60>Oe-50&&(ie.addPage(),Ve=15),ie.setFillColor(...ir),ie.roundedRect(Ce-90,Ve-5,75,50,2,2,"F"),ie.setFontSize(10),ie.setFont("helvetica","bold"),ie.setTextColor(...kt),ie.text("Summary",Ce-85,Ve),Ve+=8,ie.setFontSize(8),ie.setFont("helvetica","normal"),ie.setTextColor(...Ht),[{label:"Sub Total",value:`INR ${(V||0).toFixed(2)}`},{label:"Total Tax",value:`INR ${(z||0).toFixed(2)}`},{label:"Total Amount",value:`INR ${(V+z||0).toFixed(2)}`},{label:"Discount",value:`INR ${(F||0).toFixed(2)}`},{label:"Grand Total",value:`INR ${(V+z-F||0).toFixed(2)}`}].forEach(er=>{ie.setFont("helvetica","bold"),ie.text(er.label,Ce-85,Ve),ie.setFont("helvetica","normal"),ie.text(er.value.replace(/^1\s*/,""),Ce-20,Ve,{align:"right"}),Ve+=8}),pe.trim()&&(Ve+30>Oe-50&&(ie.addPage(),Ve=15),Ve+=5,ie.setFontSize(10),ie.setFont("helvetica","bold"),ie.setTextColor(...kt),ie.text("Terms & Conditions",15,Ve),Ve+=5,ie.setFont("helvetica","normal"),ie.setTextColor(...Ht),ie.splitTextToSize(pe,Ce-30).forEach(rr=>{Ve+5>Oe-50&&(ie.addPage(),Ve=15),ie.text(`• ${rr}`,15,Ve),Ve+=5})),Ve+20>Oe-50&&(ie.addPage(),Ve=15),ie.setFillColor(...Ft),ie.rect(0,Oe-25,Ce,1,"F"),ie.setFontSize(8),ie.setTextColor(100,100,100),ie.setFont("helvetica","italic"),ie.text("Thank you for choosing Sheela Decor!",Ce/2,Oe-15,{align:"center"}),ie.setFont("helvetica","normal"),ie.text("Sheela Decor - All Rights Reserved",Ce/2,Oe-8,{align:"center"}),ie.save(`Quotation_${Ea||"Project"}_${qr||new Date().toLocaleDateString()}.pdf`)};return f.jsxs("div",{className:"flex flex-col gap-6 p-6 bg-gray-50 min-h-screen w-full",children:[f.jsxs("div",{className:"flex flex-col gap-2",children:[f.jsx("h1",{className:"text-2xl md:text-3xl font-bold text-gray-800",children:"Add New Project"}),f.jsxs("div",{className:"flex gap-4 text-sm md:text-base",children:[f.jsx(xi,{to:"/",className:"text-blue-600 hover:text-blue-800 transition-colors !no-underline",children:"Dashboard"}),f.jsx(xi,{to:"/projects",className:"text-blue-600 hover:text-blue-800 transition-colors !no-underline",children:"All Projects"})]})]}),f.jsxs("div",{className:"space-y-6",children:[f.jsx("div",{className:"bg-white p-6 rounded-xl shadow-md border border-gray-200",children:f.jsx(A$,{customers:s,selectedCustomer:c,setSelectedCustomer:u,projectData:r,setCustomers:o})}),f.jsx("div",{className:"bg-white p-6 rounded-xl shadow-md border border-gray-200",children:f.jsx(k$,{selectedCustomer:c,interior:g,setInterior:w,salesdata:b,interiorArray:sr,setInteriorArray:kr,salesAssociateArray:As,setSalesAssociateArray:ka,projectName:Ea,setProjectName:gn,projectReference:Qt,setProjectReference:Un,user:Vr,setUser:qa,projectDate:qr,setProjectDate:ha,setAdditionalRequests:Ne,additionalRequests:ne,projectAddress:Z,setProjectAddress:ce,setSalesData:N})}),f.jsx("div",{className:"bg-white p-6 rounded-xl shadow-md border border-gray-200",children:f.jsx(MA,{selections:O,availableAreas:q,availableProductGroups:_,availableCompanies:M,catalogueData:j,designNo:U,handleAddArea:Pe,handleRemoveArea:st,handleAreaChange:ke,handleAddNewGroup:ut,handleProductGroupChange:de,handleCompanyChange:Ue,handleCatalogueChange:rt,handleDesignNoChange:Xe,handleReferenceChange:ot,handleGroupDelete:vt,setAvailableAreas:oe,singleItems:h})}),f.jsx("div",{className:"bg-white p-6 rounded-xl shadow-md border border-gray-200",children:f.jsx(IA,{selections:O,units:At,handleRemoveArea:st,handleReferenceChange:ot,handleunitchange:It,handlewidthchange:ct,handleheightchange:ze,handlequantitychange:Ot,setSelections:L,handleGroupDelete:vt})}),f.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg border border-gray-200",children:[f.jsx("h2",{className:"text-xl md:text-2xl font-semibold text-gray-800 mb-4",children:"Quotation"}),f.jsx("div",{className:"space-y-6",children:O.map((ie,Ce)=>f.jsxs("div",{className:"w-full",children:[f.jsx("h3",{className:"font-semibold text-lg text-gray-700 mb-3",children:ie.area}),f.jsx("div",{className:"overflow-x-auto rounded-lg border border-gray-200",children:f.jsx("table",{className:"w-full bg-white",children:f.jsx("tbody",{children:ie.areacollection&&ie.areacollection.length>0?ie.areacollection.map((Oe,Ve)=>Array.isArray(Oe.items)?Oe.items.map((kt,Ht)=>{var Gt,yr,Pr,er;const Ft=`${Ce}-${Ve}-${Ht}`,ir=((Gt=Oe.quantities)==null?void 0:Gt[Ht])||0;return f.jsxs("tr",{className:"flex flex-col sm:table-row border-b border-gray-200 hover:bg-gray-50",children:[f.jsx("td",{className:"py-3 px-4 text-sm text-center",children:Ht+1}),f.jsx("td",{className:"py-3 px-4 text-sm",children:kt[0]+" * "+Oe.measurement.quantity}),f.jsx("td",{className:"py-3 px-4 text-sm",children:Oe.measurement.width+" x "+Oe.measurement.height+" "+Oe.measurement.unit}),f.jsxs("td",{className:"py-3 px-4 text-sm",children:["INR ",(kt[4]*parseFloat(Oe.measurement.quantity)).toFixed(2)]}),f.jsx("td",{className:"py-3 px-4",children:f.jsxs("div",{className:"flex flex-col gap-1",children:[f.jsx("input",{type:"number",value:((yr=Oe.quantities)==null?void 0:yr[Ht])||"",onChange:rr=>wt(Ft,rr.target.value,Ce,Ve,Oe.measurement.quantity,kt[4],kt[5],Ht),className:"border border-gray-300 rounded-md px-3 py-1 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500 w-20",min:"0"}),f.jsx("p",{className:"text-xs text-gray-500",children:kt[3]})]})}),f.jsxs("td",{className:"py-3 px-4 text-sm",children:["INR ",(kt[4]*parseFloat(Oe.measurement.quantity)*ir).toFixed(2)]}),f.jsxs("td",{className:"py-3 px-4 text-sm",children:[kt[5],"%"]}),f.jsxs("td",{className:"py-3 px-4 text-sm",children:["INR ",((Pr=Oe.totalTax[Ht])==null?void 0:Pr.toFixed(2))||"0.00"]}),f.jsxs("td",{className:"py-3 px-4 text-sm",children:["INR ",((er=Oe.totalAmount[Ht])==null?void 0:er.toFixed(2))||"0.00"]})]},Ft)}):f.jsx("tr",{children:f.jsxs("td",{colSpan:9,className:"text-center text-red-500 py-4 text-sm",children:["No items found for collection ",Ve+1]})},`error-${Ve}`)):f.jsx("tr",{children:f.jsx("td",{colSpan:9,className:"text-center py-4 text-gray-500 text-sm",children:"No product data available."})})})})})]},Ce))}),f.jsxs("div",{className:"mt-6 p-6 bg-gray-50 rounded-lg border border-gray-200",children:[f.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Miscellaneous"}),f.jsx("div",{className:"flex justify-end mb-4",children:f.jsxs("button",{className:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition-colors text-sm font-medium",onClick:hr,children:[f.jsx(qf,{className:"w-4 h-4"}),"Add Item"]})}),f.jsxs("div",{className:"overflow-x-auto rounded-lg border border-gray-200",children:[f.jsxs("table",{className:"w-full bg-white hidden sm:table",children:[f.jsx("thead",{children:f.jsxs("tr",{className:"bg-gray-100 text-gray-700 text-sm font-semibold",children:[f.jsx("th",{className:"py-3 px-4 text-center",children:"SR"}),f.jsx("th",{className:"py-3 px-4",children:"Item Name"}),f.jsx("th",{className:"py-3 px-4",children:"Quantity"}),f.jsx("th",{className:"py-3 px-4",children:"Rate"}),f.jsx("th",{className:"py-3 px-4",children:"Net Rate"}),f.jsx("th",{className:"py-3 px-4",children:"Tax (%)"}),f.jsx("th",{className:"py-3 px-4",children:"Tax Amount"}),f.jsx("th",{className:"py-3 px-4",children:"Total Amount"}),f.jsx("th",{className:"py-3 px-4",children:"Remark"}),f.jsx("th",{className:"py-3 px-4 text-center",children:"Actions"})]})}),f.jsx("tbody",{children:K.map((ie,Ce)=>f.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[f.jsx("td",{className:"py-3 px-4 text-center text-sm",children:Ce+1}),f.jsx("td",{className:"py-3 px-4",children:f.jsx("input",{onChange:Oe=>Yt(Ce,Oe.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-1 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:ie.name||"",type:"text"})}),f.jsx("td",{className:"py-3 px-4",children:f.jsx("input",{onChange:Oe=>Sr(Ce,Oe.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-1 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:ie.quantity||"",type:"number",min:"0"})}),f.jsx("td",{className:"py-3 px-4",children:f.jsx("input",{onChange:Oe=>na(Ce,Oe.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-1 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:ie.rate||"",type:"number",min:"0"})}),f.jsxs("td",{className:"py-3 px-4 text-sm text-center",children:["INR ",ie.netRate.toFixed(2)]}),f.jsx("td",{className:"py-3 px-4",children:f.jsx("input",{onChange:Oe=>Ja(Ce,Oe.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-1 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:ie.tax||"",type:"number",min:"0"})}),f.jsxs("td",{className:"py-3 px-4 text-sm text-center",children:["INR ",ie.taxAmount.toFixed(2)]}),f.jsxs("td",{className:"py-3 px-4 text-sm text-center",children:["INR ",ie.totalAmount.toFixed(2)]}),f.jsx("td",{className:"py-3 px-4",children:f.jsx("input",{onChange:Oe=>Se(Ce,Oe.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-1 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:ie.remark||"",type:"text"})}),f.jsx("td",{className:"py-3 px-4 text-center",children:f.jsx("button",{onClick:()=>zt(Ce),children:f.jsx(Uc,{className:"text-red-500 hover:text-red-600 w-4 h-4"})})})]},Ce))})]}),f.jsx("div",{className:"sm:hidden flex flex-col gap-4 mt-4",children:K.map((ie,Ce)=>f.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200",children:[f.jsxs("div",{className:"flex justify-between items-center mb-3",children:[f.jsxs("span",{className:"font-semibold text-sm",children:["SR: ",Ce+1]}),f.jsx("button",{onClick:()=>zt(Ce),children:f.jsx(Uc,{className:"text-red-500 hover:text-red-600 w-4 h-4"})})]}),f.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Item Name"}),f.jsx("input",{onChange:Oe=>Yt(Ce,Oe.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-1 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:ie.name||"",type:"text"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Quantity"}),f.jsx("input",{onChange:Oe=>Sr(Ce,Oe.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-1 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:ie.quantity||"",type:"number",min:"0"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Rate"}),f.jsx("input",{onChange:Oe=>na(Ce,Oe.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-1 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:ie.rate||"",type:"number",min:"0"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Net Rate"}),f.jsxs("span",{className:"text-sm",children:["INR ",ie.netRate.toFixed(2)]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Tax (%)"}),f.jsx("input",{onChange:Oe=>Ja(Ce,Oe.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-1 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:ie.tax||"",type:"number",min:"0"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Tax Amount"}),f.jsxs("span",{className:"text-sm",children:["INR ",ie.taxAmount.toFixed(2)]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Total Amount"}),f.jsxs("span",{className:"text-sm",children:["INR ",ie.totalAmount.toFixed(2)]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Remark"}),f.jsx("input",{onChange:Oe=>Se(Ce,Oe.target.value),className:"w-full border border-gray-300 rounded-md px-3 py-1 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:ie.remark||"",type:"text"})]})]})]},Ce))})]})]})]}),f.jsxs("div",{className:"flex flex-col md:flex-row gap-6",children:[f.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-md border border-gray-200 w-full md:w-1/2",children:[f.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Bank Details & Terms"}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("select",{className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[f.jsx("option",{value:"",children:"Select Bank Details"}),St.map((ie,Ce)=>f.jsx("option",{value:ie,children:ie},Ce))]}),f.jsx("textarea",{placeholder:"Bank Details Description",className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:3}),f.jsxs("select",{className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[f.jsx("option",{value:"",children:"Select Terms & Conditions"}),jt.map((ie,Ce)=>f.jsx("option",{value:ie,children:ie},Ce))]}),f.jsx("textarea",{placeholder:"Terms & Conditions Description",className:"w-full border border-gray-300 rounded-md px-3 py-2 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:3,value:pe,onChange:ie=>ge(ie.target.value)})]})]}),f.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg border border-gray-200 w-full md:w-1/2",children:[f.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Summary"}),f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"flex justify-between text-sm",children:[f.jsx("span",{className:"text-gray-600",children:"Sub Total"}),f.jsxs("span",{className:"font-medium",children:["INR ",V.toFixed(2)]})]}),f.jsxs("div",{className:"flex justify-between text-sm",children:[f.jsx("span",{className:"text-gray-600",children:"Total Tax Amount"}),f.jsxs("span",{className:"font-medium",children:["INR ",z.toFixed(2)]})]}),f.jsxs("div",{className:"flex justify-between text-sm",children:[f.jsx("span",{className:"text-gray-600",children:"Total Amount"}),f.jsxs("span",{className:"font-medium",children:["INR ",(V+z).toFixed(2)]})]}),f.jsx("hr",{className:"border-gray-200"}),f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("span",{className:"text-sm text-gray-600",children:"Discount"}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsxs("select",{onChange:ie=>setDiscountType(ie.target.value),className:"border border-gray-300 rounded-md px-2 py-1 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[f.jsx("option",{value:"cash",children:"₹"}),f.jsx("option",{value:"percent",children:"%"})]}),f.jsx("input",{className:"w-24 border border-gray-300 rounded-md px-3 py-1 text-sm text-right focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:F,onChange:ie=>Y(parseFloat(ie.target.value)||0),type:"number",min:"0"})]})]}),f.jsx("hr",{className:"border-gray-200"}),f.jsxs("div",{className:"flex justify-between text-sm",children:[f.jsx("span",{className:"text-gray-600 font-semibold",children:"Grand Total"}),f.jsxs("span",{className:"font-semibold text-blue-600",children:["INR ",(V+z-F).toFixed(2)]})]}),f.jsxs("div",{className:" flex gap-2 flex-col",children:[f.jsx("button",{onClick:Qe,className:"w-full bg-blue-600 text-white py-2 rounded-md hover:bg-blue-700 transition-colors text-sm font-medium mt-4",children:"Add Project & Generate Quote"}),f.jsx("button",{onClick:Ut,className:"w-full bg-green-600 text-white py-2 rounded-md hover:bg-green-700 transition-colors text-sm font-medium",children:"Download Quotation PDF"})]})]})]})]})]})]})}const j$=()=>f.jsx("div",{className:"w-full p-6 flex flex-col",children:f.jsx("p",{className:"",children:"Areas"})}),C$=()=>{const e=async()=>(await(await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/getPayments")).json()).message,t=wa(),r=ua(),[a,n]=P.useState(void 0);ur(F=>F.data.paymentData);const s=ur(F=>F.data.projects),[o,c]=P.useState(0),[u,h]=P.useState(""),[p,x]=P.useState(""),[v,g]=P.useState(""),[w,b]=P.useState(!1),[N,_]=P.useState(""),[E,j]=P.useState(""),[M,U]=P.useState(!0),[V,I]=P.useState([]),z=async()=>{const F=await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/getprojectdata",{credentials:"include"});if(!F.ok)throw new Error(`HTTP error! Status: ${F.status}`);const Y=await F.json();if(!Y.body||!Array.isArray(Y.body))throw new Error("Invalid data format: Expected an array in data.body");const K=(te,Q)=>{try{return typeof te=="string"?JSON.parse(te):te||Q}catch(G){return console.warn("Invalid JSON:",te,G),Q}},X=te=>JSON.parse(JSON.stringify(te)),Z=te=>{if(Array.isArray(te))return te;if(typeof te!="string")return[];try{const Q=JSON.parse(te);return Array.isArray(Q)?Q:[]}catch{try{return te.replace(/^\[|\]$/g,"").split(",").map(G=>G.trim().replace(/^"+|"+$/g,""))}catch{return[]}}};return Y.body.map(te=>({projectName:te[0],customerLink:K(te[1],[]),projectReference:te[2]||"",status:te[3]||"",totalAmount:parseFloat(te[4])||0,totalTax:parseFloat(te[5])||0,paid:parseFloat(te[6])||0,discount:parseFloat(te[7])||0,createdBy:te[8]||"",allData:X(K(te[9],[])),projectDate:te[10]||"",additionalRequests:K(te[11],[]),interiorArray:Z(te[12]),salesAssociateArray:Z(te[13]),additionalItems:X(K(te[14],[])),goodsArray:X(K(te[15],[])),tailorsArray:X(K(te[16],[])),projectAddress:te[17]}))};P.useEffect(()=>{let F=!0;const Y=Date.now(),K=5*60*1e3;return(async()=>{var Z,ce;try{let te=[];if(s&&s.length>0)te=s;else{const ye=localStorage.getItem("projectData");if(ye){const D=JSON.parse(ye);((Z=D==null?void 0:D.data)==null?void 0:Z.length)>0&&Y-D.time<K&&(te=D.data,t(La(D.data)))}if(te.length===0){const D=await z();Array.isArray(D)&&(te=D,t(La(D)),localStorage.setItem("projectData",JSON.stringify({data:D,time:Y})))}}let Q=[];const G=localStorage.getItem("paymentData");if(G){const ye=JSON.parse(G);((ce=ye==null?void 0:ye.data)==null?void 0:ce.length)>0&&Y-ye.time<K&&(Q=ye.data,t(Kl(ye.data)))}if(Q.length===0){const ye=await e();Array.isArray(ye)&&(Q=ye,t(Kl(ye)),localStorage.setItem("paymentData",JSON.stringify({data:ye,time:Y})))}if(te.length>0&&Q.length>0&&F){const ye=te.map(O=>O.projectName),D=Q.filter(O=>ye.includes(O[1]));I(D)}}catch(te){console.error("❌ Error fetching project or payment data:",te)}})(),()=>{F=!1}},[t,M]);const H=async(F,Y,K,X,Z,ce)=>{(await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/deletePayment",{credentials:"include",method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({customerName:F,Name:Y,Received:K,ReceivedDate:X,PaymentMode:Z,Remarks:ce})})).status==200?(alert("Deleted"),U(!M)):alert("Error")},re=async()=>{const F=typeof a<"u",Y=F?"https://sheeladecor.netlify.app/.netlify/functions/server/updateProjects":"https://sheeladecor.netlify.app/.netlify/functions/server/addPayment",K=F?{customerName:N,Name:E,Received:o,ReceivedDate:u,PaymentMode:p,Remarks:v}:{customerName:N,Name:E,Received:o,ReceivedDate:u,PaymentMode:p,Remarks:v};try{(await fetch(Y,{credentials:"include",method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify(K)})).status===200?(alert(F?"Payment updated":"Payment added"),b(!1),c(0),h(""),x(""),g(""),U(!M)):alert("Error")}catch(X){console.error("Fetch error:",X),alert("Network or server error")}n(void 0)},R=()=>{a&&(c(0),h(""),x(""),g("NA")),b(!1)};return f.jsxs("div",{className:"w-full p-6 flex flex-col justify-between items-center",children:[f.jsxs("div",{className:"w-full justify-between flex flex-row",children:[f.jsx("p",{className:"text-[1.6vw] font-semibold",children:"Payments"}),f.jsx("button",{onClick:()=>r("/"),style:{borderRadius:"6px"},className:"border rounded-lg text-white bg-sky-600 hover:bg-sky-700 px-2 h-10",children:"Dashboard"})]}),f.jsx("div",{className:"w-full justify-between flex flex-col rounded-xl border p-3 mt-10 max-h-screen overflow-scroll",children:f.jsxs("table",{className:"w-full",children:[f.jsx("tbody",{children:f.jsxs("tr",{className:"text-[1.2vw] font-semibold",children:[f.jsx("th",{className:"",children:"Sr. No."}),f.jsx("th",{children:"Amount"}),f.jsx("th",{children:"Project"}),f.jsx("th",{children:"Mode"}),f.jsx("th",{children:"Date"}),f.jsx("th",{children:"Actions"})]})}),f.jsx("tbody",{children:V.length!=0&&V.map((F,Y)=>f.jsxs("tr",{className:"hover:bg-sky-50",children:[f.jsx("td",{children:Y+1}),f.jsx("td",{children:F[2]}),f.jsx("td",{children:F[1]}),f.jsx("td",{children:F[4]}),f.jsx("td",{children:F[3]||"-"})," ",f.jsxs("td",{className:"py-3 flex flex-row gap-3",children:[f.jsx("button",{onClick:()=>H(F[0],F[1],F[2],F[3],F[4],F[5]),className:"text-red-500 hover:underline",children:f.jsx(Uc,{})}),f.jsx("button",{onClick:()=>{j(F[1]),_(F[0]),b(!0)},className:"text-sky-700 hover:underline",children:f.jsx(ZP,{})})]})]},Y))})]})}),w&&f.jsxs("div",{className:"flex flex-col z-50 justify-between gap-3 w-[50vw] border rounded-xl p-3",children:[f.jsxs("div",{className:"flex flex-col",children:[f.jsxs("div",{className:"flex flex-row gap-1",children:[f.jsx("p",{className:"text-[1.1vw]",children:"Amount Received"}),f.jsx("p",{className:"text-red-500",children:"*"})]}),f.jsx("input",{type:"text",value:o,className:"border-1 rounded-lg pl-2 h-8",onChange:F=>c(F.target.value==""?0:parseFloat(F.target.value))})]}),f.jsxs("div",{className:"flex flex-col",children:[f.jsxs("div",{className:"flex flex-row gap-1",children:[f.jsx("p",{className:"text-[1.1vw]",children:"Payment Date"}),f.jsx("p",{className:"text-red-500",children:"*"})]}),f.jsx("input",{type:"date",value:u,className:"border-1 rounded-lg pl-2 h-8 pr-2",onChange:F=>h(F.target.value)})]}),f.jsxs("div",{className:"flex flex-col",children:[f.jsxs("div",{className:"flex flex-row gap-1",children:[f.jsx("p",{className:"text-[1.1vw]",children:"Payment Mode"}),f.jsx("p",{className:"text-red-500",children:"*"})]}),f.jsx("input",{type:"text",value:p,className:"border-1 rounded-lg pl-2 h-8",onChange:F=>x(F.target.value)})]}),f.jsxs("div",{className:"flex flex-col",children:[f.jsxs("div",{className:"flex flex-row gap-1",children:[f.jsx("p",{className:"text-[1.1vw]",children:"Remarks"}),f.jsx("p",{className:"text-red-500",children:"*"})]}),f.jsx("input",{type:"text",value:v,className:"border-1 rounded-lg pl-2 h-8",onChange:F=>g(F.target.value)})]}),f.jsxs("div",{className:"flex flex-row justify-end gap-3",children:[f.jsx("button",{onClick:()=>{a!=null&&n(void 0),R()},style:{borderRadius:"8px"},className:"border-2 border-sky-700 text-sky-600 bg-white px-2 h-8",children:"Close"}),f.jsx("button",{onClick:()=>re(),style:{borderRadius:"8px"},className:`${a==null?"":"hidden"} text-white bg-sky-600 hover:bg-sky-700 px-2 h-8`,children:"Add Payment"}),f.jsx("button",{onClick:()=>re(),style:{borderRadius:"8px"},className:`${a!=null?"":"hidden"} text-white bg-sky-600 hover:bg-sky-700 px-2 h-8`,children:"Edit Payment"})]})]})]})},D$=()=>{const e=ua(),t=wa(),r=ur(v=>v.data.projects),a=ur(v=>v.data.paymentData),[n,s]=P.useState([]),[o,c]=P.useState([]),[u,h]=P.useState(!1),p=async()=>{const v=await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/getprojectdata",{credentials:"include"});if(!v.ok)throw new Error(`HTTP error! Status: ${v.status}`);const g=await v.json();if(!g.body||!Array.isArray(g.body))throw new Error("Invalid data format: Expected an array in data.body");const w=(E,j)=>{try{return typeof E=="string"?JSON.parse(E):E||j}catch(M){return console.warn("Invalid JSON:",E,M),j}},b=E=>JSON.parse(JSON.stringify(E)),N=E=>{if(Array.isArray(E))return E;if(typeof E!="string")return[];try{const j=JSON.parse(E);return Array.isArray(j)?j:[]}catch{try{return E.replace(/^\[|\]$/g,"").split(",").map(M=>M.trim().replace(/^"+|"+$/g,""))}catch{return[]}}};return g.body.map(E=>({projectName:E[0],customerLink:w(E[1],[]),projectReference:E[2]||"",status:E[3]||"",totalAmount:parseFloat(E[4])||0,totalTax:parseFloat(E[5])||0,paid:parseFloat(E[6])||0,discount:parseFloat(E[7])||0,createdBy:E[8]||"",allData:b(w(E[9],[])),projectDate:E[10]||"",additionalRequests:w(E[11],[]),interiorArray:N(E[12]),salesAssociateArray:N(E[13]),additionalItems:b(w(E[14],[])),goodsArray:b(w(E[15],[])),tailorsArray:b(w(E[16],[])),projectAddress:E[17]}))},x=async()=>(await(await fetch("https://sheeladecor.netlify.app/.netlify/functions/server/getPayments")).json()).message;return P.useEffect(()=>{const v=Date.now(),g=5*60*1e3;(async()=>{var b;try{let N=[];if(r&&r.length>0)N=r,s(r);else{const E=localStorage.getItem("projectData");if(E){const j=JSON.parse(E);((b=j==null?void 0:j.data)==null?void 0:b.length)>0&&v-j.time<g&&(N=j.data,t(La(j.data)),s(j.data))}if(N.length===0){const j=await p();Array.isArray(j)?(N=j,t(La(j)),s(j),localStorage.setItem("projectData",JSON.stringify({data:j,time:v}))):console.warn("Fetched project data is not an array:",j)}}let _=[];if(a&&a.length>0?_=a:(_=await x(),t(Kl(_))),_.length>0&&N.length>0){const E=N.map(j=>{const M=parseFloat(j.totalAmount+j.totalTax),U=parseFloat(j.discount),V=M-U,z=_.filter(re=>re[1]===j.projectName).reduce((re,R)=>{const F=parseFloat(R[2]);return re+(isNaN(F)?0:F)},0),H=V-z;return[j.customerLink,j.projectName,V,z,H]});c(E)}h(!0)}catch(N){console.error("Failed to load project/payment data:",N)}})()},[t,u,a,r]),f.jsx("div",{className:"flex flex-col justify-between items-center w-90vw",children:f.jsxs("div",{className:"flex flex-col w-[80vw] p-3 border rounded-xl",children:[f.jsxs("div",{className:"flex flex-row w-full justify-between",children:[f.jsx("p",{className:"text-[1.6vw] font-semibold",children:"Due Payments"}),f.jsx("button",{onClick:()=>e("/"),style:{borderRadius:"6px"},className:"border px-2 h-10 text-white bg-sky-600 hover:bg-sky-700",children:"Dashboard"})]}),f.jsx("div",{className:"flex flex-col w-full",children:f.jsxs("table",{className:"w-full mt-10",children:[f.jsx("thead",{children:f.jsxs("tr",{children:[f.jsx("th",{children:"Customer Name"}),f.jsx("th",{children:"Project"}),f.jsx("th",{children:"Project Value"}),f.jsx("th",{children:"Paid Amount"}),f.jsx("th",{children:"Due Amount"})]})}),f.jsx("tbody",{children:o.map((v,g)=>f.jsxs("tr",{children:[f.jsx("td",{children:v[0][0]||""}),f.jsx("td",{children:v[1]}),f.jsxs("td",{children:["₹",v[2].toLocaleString("en-IN")]}),f.jsxs("td",{children:["₹",v[3].toLocaleString("en-IN")]}),f.jsxs("td",{className:"py-2",children:["₹",v[4].toLocaleString("en-IN")]})]},g))})]})})]})})},UT=e=>e.length>1&&e.endsWith("/")?e.slice(0,-1):e,F$=e=>{try{const t=e.replace(/\\/g,"");return UT(t)}catch{return e}},P$=({children:e})=>{const t=localStorage.getItem("auth_token"),r=dl(),a=UT(r.pathname);let n=[];try{const o=localStorage.getItem("allowed_routes");if(o){const c=JSON.parse(o);Array.isArray(c)&&(n=c.map(F$))}}catch(o){console.error("❌ Failed to parse routes:",o)}const s=t&&n.includes(a);return P.useEffect(()=>{t?s||(alert("🚫 You do not have permission to access this page."),window.location.href="/"):window.location.href="https://sheeladecor.free.nf/"},[t,s]),s?f.jsx(f.Fragment,{children:e}):null},L$=()=>{const e=dl(),t=ua(),r=new URLSearchParams(e.search);return P.useEffect(()=>{const a=r.get("token"),n=r.get("name"),s=r.get("email"),o=r.get("routes");try{const c=o?JSON.parse(o):[];a&&n&&s&&Array.isArray(c)&&(localStorage.setItem("auth_token",a),localStorage.setItem("auth_name",n),localStorage.setItem("auth_email",s),localStorage.setItem("allowed_routes",JSON.stringify(c)),t(e.pathname,{replace:!0}))}catch(c){console.error("Failed to parse routes:",c)}},[e,t]),null};function O$(){const[e,t]=P.useState(!0);return f.jsx(Ud.Provider,{value:{expanded:e,toggleSidebar:()=>t(r=>!r)},children:f.jsxs(m8,{children:[f.jsx(L$,{})," ",f.jsxs(ab,{children:[f.jsx(Xr,{path:"/login",element:f.jsx(x$,{})}),f.jsx(Xr,{path:"/register",element:f.jsx(y$,{})}),f.jsx(Xr,{path:"/verify",element:f.jsx(w$,{})}),f.jsx(Xr,{path:"/forgotpass",element:f.jsx(g$,{})}),f.jsx(Xr,{path:"/forgotpass/reset/:token",element:f.jsx(v$,{})}),f.jsx(Xr,{path:"*",element:f.jsx(P$,{children:f.jsxs("div",{className:"flex h-screen",children:[f.jsx(sj,{}),f.jsx("div",{className:"flex-1 overflow-y-auto h-screen p-6 transition-all",children:f.jsxs(ab,{children:[f.jsx(Xr,{path:"/",element:f.jsx(aL,{})}),f.jsx(Xr,{path:"/projects",element:f.jsx(HO,{})}),f.jsx(Xr,{path:"/customers",element:f.jsx(XO,{})}),f.jsx(Xr,{path:"/add-product",element:f.jsx(b$,{})}),f.jsx(Xr,{path:"/product-group-form",element:f.jsx(N$,{})}),f.jsx(Xr,{path:"/masters",element:f.jsx(YO,{})}),f.jsx(Xr,{path:"/tasks",element:f.jsx(JO,{})}),f.jsx(Xr,{path:"/reports",element:f.jsx(eR,{})}),f.jsx(Xr,{path:"/settings",element:f.jsx(tR,{})}),f.jsx(Xr,{path:"/add-project",element:f.jsx(E$,{})}),f.jsx(Xr,{path:"/brand-dilog",element:f.jsx(PT,{})}),f.jsx(Xr,{path:"/catalogue-dialog",element:f.jsx(LT,{})}),f.jsx(Xr,{path:"/interior-dialog",element:f.jsx(OT,{})}),f.jsx(Xr,{path:"/tailor-dialog",element:f.jsx(RT,{})}),f.jsx(Xr,{path:"/sales-associateDialog",element:f.jsx(IT,{})}),f.jsx(Xr,{path:"/store-dialog",element:f.jsx(N_,{})}),f.jsx(Xr,{path:"/add-customer",element:f.jsx(S_,{})}),f.jsx(Xr,{path:"/paymentsPage",element:f.jsx(C$,{})}),f.jsx(Xr,{path:"/duePage",element:f.jsx(D$,{})}),f.jsx(Xr,{path:"/areas",element:f.jsx(j$,{})}),f.jsx(Xr,{path:"/masters/stores",element:f.jsx(rR,{})}),f.jsx(Xr,{path:"/masters/items",element:f.jsx(r$,{})}),f.jsx(Xr,{path:"/masters/product-groups",element:f.jsx(a$,{})}),f.jsx(Xr,{path:"/masters/brands",element:f.jsx(i$,{})}),f.jsx(Xr,{path:"/masters/catalogues",element:f.jsx(c$,{})}),f.jsx(Xr,{path:"/masters/interiors",element:f.jsx(f$,{})}),f.jsx(Xr,{path:"/masters/tailors",element:f.jsx(d$,{})}),f.jsx(Xr,{path:"/masters/sales-associate",element:f.jsx(m$,{})}),f.jsx(Xr,{path:"*",element:f.jsx(qE,{to:"/"})})]})})]})})})]})]})})}const R$=Zj({reducer:{data:dC}});eE.createRoot(document.getElementById("root")).render(f.jsx(P.StrictMode,{children:f.jsx(Nj,{store:R$,children:f.jsx(O$,{})})}));export{va as _,I$ as c,CS as g};
